(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();function t_(n){var t=this.constructor;return this.then(function(e){return t.resolve(n()).then(function(){return e})},function(e){return t.resolve(n()).then(function(){return t.reject(e)})})}function e_(n){var t=this;return new t(function(e,r){if(!(n&&typeof n.length<"u"))return r(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(n);if(i.length===0)return e([]);var a=i.length;function s(u,h){if(h&&(typeof h=="object"||typeof h=="function")){var l=h.then;if(typeof l=="function"){l.call(h,function(c){s(u,c)},function(c){i[u]={status:"rejected",reason:c},--a===0&&e(i)});return}}i[u]={status:"fulfilled",value:h},--a===0&&e(i)}for(var o=0;o<i.length;o++)s(o,i[o])})}function Jg(n,t){this.name="AggregateError",this.errors=n,this.message=t||""}Jg.prototype=Error.prototype;function r_(n){var t=this;return new t(function(e,r){if(!(n&&typeof n.length<"u"))return r(new TypeError("Promise.any accepts an array"));var i=Array.prototype.slice.call(n);if(i.length===0)return r();for(var a=[],s=0;s<i.length;s++)try{t.resolve(i[s]).then(e).catch(function(o){a.push(o),a.length===i.length&&r(new Jg(a,"All promises were rejected"))})}catch(o){r(o)}})}var n_=setTimeout;function Qg(n){return!!(n&&typeof n.length<"u")}function i_(){}function a_(n,t){return function(){n.apply(t,arguments)}}function Zt(n){if(!(this instanceof Zt))throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ey(n,this)}function ty(n,t){for(;n._state===3;)n=n._value;if(n._state===0){n._deferreds.push(t);return}n._handled=!0,Zt._immediateFn(function(){var e=n._state===1?t.onFulfilled:t.onRejected;if(e===null){(n._state===1?_c:Ms)(t.promise,n._value);return}var r;try{r=e(n._value)}catch(i){Ms(t.promise,i);return}_c(t.promise,r)})}function _c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var e=t.then;if(t instanceof Zt){n._state=3,n._value=t,wc(n);return}else if(typeof e=="function"){ey(a_(e,t),n);return}}n._state=1,n._value=t,wc(n)}catch(r){Ms(n,r)}}function Ms(n,t){n._state=2,n._value=t,wc(n)}function wc(n){n._state===2&&n._deferreds.length===0&&Zt._immediateFn(function(){n._handled||Zt._unhandledRejectionFn(n._value)});for(var t=0,e=n._deferreds.length;t<e;t++)ty(n,n._deferreds[t]);n._deferreds=null}function s_(n,t,e){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof t=="function"?t:null,this.promise=e}function ey(n,t){var e=!1;try{n(function(r){e||(e=!0,_c(t,r))},function(r){e||(e=!0,Ms(t,r))})}catch(r){if(e)return;e=!0,Ms(t,r)}}Zt.prototype.catch=function(n){return this.then(null,n)};Zt.prototype.then=function(n,t){var e=new this.constructor(i_);return ty(this,new s_(n,t,e)),e};Zt.prototype.finally=t_;Zt.all=function(n){return new Zt(function(t,e){if(!Qg(n))return e(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(n);if(r.length===0)return t([]);var i=r.length;function a(o,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var h=u.then;if(typeof h=="function"){h.call(u,function(l){a(o,l)},e);return}}r[o]=u,--i===0&&t(r)}catch(l){e(l)}}for(var s=0;s<r.length;s++)a(s,r[s])})};Zt.any=r_;Zt.allSettled=e_;Zt.resolve=function(n){return n&&typeof n=="object"&&n.constructor===Zt?n:new Zt(function(t){t(n)})};Zt.reject=function(n){return new Zt(function(t,e){e(n)})};Zt.race=function(n){return new Zt(function(t,e){if(!Qg(n))return e(new TypeError("Promise.race accepts an array"));for(var r=0,i=n.length;r<i;r++)Zt.resolve(n[r]).then(t,e)})};Zt._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){n_(n,0)};Zt._unhandledRejectionFn=function(t){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var fs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function o_(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Np=Object.getOwnPropertySymbols,h_=Object.prototype.hasOwnProperty,l_=Object.prototype.propertyIsEnumerable;function u_(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function c_(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var t={},e=0;e<10;e++)t["_"+String.fromCharCode(e)]=e;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var f_=c_()?Object.assign:function(n,t){for(var e,r=u_(n),i,a=1;a<arguments.length;a++){e=Object(arguments[a]);for(var s in e)h_.call(e,s)&&(r[s]=e[s]);if(Np){i=Np(e);for(var o=0;o<i.length;o++)l_.call(e,i[o])&&(r[i[o]]=e[i[o]])}}return r};const d_=jf(f_);/*!
 * @pixi/polyfill - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */typeof globalThis>"u"&&(typeof self<"u"?self.globalThis=self:typeof global<"u"&&(global.globalThis=global));globalThis.Promise||(globalThis.Promise=Zt);Object.assign||(Object.assign=d_);var p_=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(globalThis.performance&&globalThis.performance.now)){var v_=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-v_}}var kl=Date.now(),kp=["ms","moz","webkit","o"];for(var Ll=0;Ll<kp.length&&!globalThis.requestAnimationFrame;++Ll){var Dl=kp[Ll];globalThis.requestAnimationFrame=globalThis[Dl+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[Dl+"CancelAnimationFrame"]||globalThis[Dl+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(n){if(typeof n!="function")throw new TypeError(n+"is not a function");var t=Date.now(),e=p_+kl-t;return e<0&&(e=0),kl=t,globalThis.self.setTimeout(function(){kl=Date.now(),n(performance.now())},e)});globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(n){return clearTimeout(n)});Math.sign||(Math.sign=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1});Number.isInteger||(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t});globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array);globalThis.Float32Array||(globalThis.Float32Array=Array);globalThis.Uint32Array||(globalThis.Uint32Array=Array);globalThis.Uint16Array||(globalThis.Uint16Array=Array);globalThis.Uint8Array||(globalThis.Uint8Array=Array);globalThis.Int32Array||(globalThis.Int32Array=Array);/*!
 * @pixi/constants - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var vn;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(vn||(vn={}));var Ps;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(Ps||(Ps={}));var Rh;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(Rh||(Rh={}));var at;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(at||(at={}));var cr;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(cr||(cr={}));var et;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(et||(et={}));var gi;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(gi||(gi={}));var ut;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(ut||(ut={}));var Fh;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(Fh||(Fh={}));var je;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(je||(je={}));var zr;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(zr||(zr={}));var qe;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(qe||(qe={}));var sr;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(sr||(sr={}));var Sr;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(Sr||(Sr={}));var Oh;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(Oh||(Oh={}));var ir;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(ir||(ir={}));var he;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(he||(he={}));var Lp;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(Lp||(Lp={}));var Xt;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(Xt||(Xt={}));var Gr;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(Gr||(Gr={}));/*!
 * @pixi/settings - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var m_={createCanvas:function(n,t){var e=document.createElement("canvas");return e.width=n,e.height=t,e},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var n;return(n=document.baseURI)!==null&&n!==void 0?n:window.location.href},fetch:function(n,t){return fetch(n,t)}},Ul=/iPhone/i,Dp=/iPod/i,Up=/iPad/i,Vp=/\biOS-universal(?:.+)Mac\b/i,Vl=/\bAndroid(?:.+)Mobile\b/i,Xp=/Android/i,Xi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,xo=/Silk/i,Kr=/Windows Phone/i,zp=/\bWindows(?:.+)ARM\b/i,Gp=/BlackBerry/i,Yp=/BB10/i,Wp=/Opera Mini/i,Hp=/\b(CriOS|Chrome)(?:.+)Mobile/i,jp=/Mobile(?:.+)Firefox\b/i,$p=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function g_(n){return function(t){return t.test(n)}}function y_(n){var t={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?t.userAgent=n:n&&n.userAgent&&(t={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var e=t.userAgent,r=e.split("[FBAN");typeof r[1]<"u"&&(e=r[0]),r=e.split("Twitter"),typeof r[1]<"u"&&(e=r[0]);var i=g_(e),a={apple:{phone:i(Ul)&&!i(Kr),ipod:i(Dp),tablet:!i(Ul)&&(i(Up)||$p(t))&&!i(Kr),universal:i(Vp),device:(i(Ul)||i(Dp)||i(Up)||i(Vp)||$p(t))&&!i(Kr)},amazon:{phone:i(Xi),tablet:!i(Xi)&&i(xo),device:i(Xi)||i(xo)},android:{phone:!i(Kr)&&i(Xi)||!i(Kr)&&i(Vl),tablet:!i(Kr)&&!i(Xi)&&!i(Vl)&&(i(xo)||i(Xp)),device:!i(Kr)&&(i(Xi)||i(xo)||i(Vl)||i(Xp))||i(/\bokhttp\b/i)},windows:{phone:i(Kr),tablet:i(zp),device:i(Kr)||i(zp)},other:{blackberry:i(Gp),blackberry10:i(Yp),opera:i(Wp),firefox:i(jp),chrome:i(Hp),device:i(Gp)||i(Yp)||i(Wp)||i(jp)||i(Hp)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}var Vr=y_(globalThis.navigator);function x_(){return!Vr.apple.device}function b_(n){var t=!0;if(Vr.tablet||Vr.phone){if(Vr.apple.device){var e=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(e){var r=parseInt(e[1],10);r<11&&(t=!1)}}if(Vr.android.device){var e=navigator.userAgent.match(/Android\s([0-9.]*)/);if(e){var r=parseInt(e[1],10);r<7&&(t=!1)}}}return t?n:4}var ht={ADAPTER:m_,MIPMAP_TEXTURES:qe.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Xt.NONE,SPRITE_MAX_TEXTURES:b_(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:Oh.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:zr.CLAMP,SCALE_MODE:je.LINEAR,PRECISION_VERTEX:ir.HIGH,PRECISION_FRAGMENT:Vr.apple.device?ir.HIGH:ir.MEDIUM,CAN_UPLOAD_SAME_BUFFER:x_(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},ry={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function i(u,h,l){this.fn=u,this.context=h,this.once=l||!1}function a(u,h,l,c,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var d=new i(l,c||u,f),p=e?e+h:h;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],d]:u._events[p].push(d):(u._events[p]=d,u._eventsCount++),u}function s(u,h){--u._eventsCount===0?u._events=new r:delete u._events[h]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var h=[],l,c;if(this._eventsCount===0)return h;for(c in l=this._events)t.call(l,c)&&h.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},o.prototype.listeners=function(h){var l=e?e+h:h,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var f=0,d=c.length,p=new Array(d);f<d;f++)p[f]=c[f].fn;return p},o.prototype.listenerCount=function(h){var l=e?e+h:h,c=this._events[l];return c?c.fn?1:c.length:0},o.prototype.emit=function(h,l,c,f,d,p){var v=e?e+h:h;if(!this._events[v])return!1;var m=this._events[v],g=arguments.length,y,x;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,c),!0;case 4:return m.fn.call(m.context,l,c,f),!0;case 5:return m.fn.call(m.context,l,c,f,d),!0;case 6:return m.fn.call(m.context,l,c,f,d,p),!0}for(x=1,y=new Array(g-1);x<g;x++)y[x-1]=arguments[x];m.fn.apply(m.context,y)}else{var b=m.length,_;for(x=0;x<b;x++)switch(m[x].once&&this.removeListener(h,m[x].fn,void 0,!0),g){case 1:m[x].fn.call(m[x].context);break;case 2:m[x].fn.call(m[x].context,l);break;case 3:m[x].fn.call(m[x].context,l,c);break;case 4:m[x].fn.call(m[x].context,l,c,f);break;default:if(!y)for(_=1,y=new Array(g-1);_<g;_++)y[_-1]=arguments[_];m[x].fn.apply(m[x].context,y)}}return!0},o.prototype.on=function(h,l,c){return a(this,h,l,c,!1)},o.prototype.once=function(h,l,c){return a(this,h,l,c,!0)},o.prototype.removeListener=function(h,l,c,f){var d=e?e+h:h;if(!this._events[d])return this;if(!l)return s(this,d),this;var p=this._events[d];if(p.fn)p.fn===l&&(!f||p.once)&&(!c||p.context===c)&&s(this,d);else{for(var v=0,m=[],g=p.length;v<g;v++)(p[v].fn!==l||f&&!p[v].once||c&&p[v].context!==c)&&m.push(p[v]);m.length?this._events[d]=m.length===1?m[0]:m:s(this,d)}return this},o.prototype.removeAllListeners=function(h){var l;return h?(l=e?e+h:h,this._events[l]&&s(this,l)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,n.exports=o})(ry);var __=ry.exports;const ao=jf(__);var $f={exports:{}};$f.exports=cl;$f.exports.default=cl;function cl(n,t,e){e=e||2;var r=t&&t.length,i=r?t[0]*e:n.length,a=ny(n,0,i,e,!0),s=[];if(!a||a.next===a.prev)return s;var o,u,h,l,c,f,d;if(r&&(a=A_(n,t,a,e)),n.length>80*e){o=h=n[0],u=l=n[1];for(var p=e;p<i;p+=e)c=n[p],f=n[p+1],c<o&&(o=c),f<u&&(u=f),c>h&&(h=c),f>l&&(l=f);d=Math.max(h-o,l-u),d=d!==0?32767/d:0}return Is(a,s,e,o,u,d,0),s}function ny(n,t,e,r,i){var a,s;if(i===Tc(n,t,e,r)>0)for(a=t;a<e;a+=r)s=qp(a,n[a],n[a+1],s);else for(a=e-r;a>=t;a-=r)s=qp(a,n[a],n[a+1],s);return s&&fl(s,s.next)&&(Rs(s),s=s.next),s}function wi(n,t){if(!n)return n;t||(t=n);var e=n,r;do if(r=!1,!e.steiner&&(fl(e,e.next)||$t(e.prev,e,e.next)===0)){if(Rs(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Is(n,t,e,r,i,a,s){if(n){!s&&a&&R_(n,r,i,a);for(var o=n,u,h;n.prev!==n.next;){if(u=n.prev,h=n.next,a?S_(n,r,i,a):w_(n)){t.push(u.i/e|0),t.push(n.i/e|0),t.push(h.i/e|0),Rs(n),n=h.next,o=h.next;continue}if(n=h,n===o){s?s===1?(n=E_(wi(n),t,e),Is(n,t,e,r,i,a,2)):s===2&&T_(n,t,e,r,i,a):Is(wi(n),t,e,r,i,a,1);break}}}}function w_(n){var t=n.prev,e=n,r=n.next;if($t(t,e,r)>=0)return!1;for(var i=t.x,a=e.x,s=r.x,o=t.y,u=e.y,h=r.y,l=i<a?i<s?i:s:a<s?a:s,c=o<u?o<h?o:h:u<h?u:h,f=i>a?i>s?i:s:a>s?a:s,d=o>u?o>h?o:h:u>h?u:h,p=r.next;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=c&&p.y<=d&&ua(i,o,a,u,s,h,p.x,p.y)&&$t(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function S_(n,t,e,r){var i=n.prev,a=n,s=n.next;if($t(i,a,s)>=0)return!1;for(var o=i.x,u=a.x,h=s.x,l=i.y,c=a.y,f=s.y,d=o<u?o<h?o:h:u<h?u:h,p=l<c?l<f?l:f:c<f?c:f,v=o>u?o>h?o:h:u>h?u:h,m=l>c?l>f?l:f:c>f?c:f,g=Sc(d,p,t,e,r),y=Sc(v,m,t,e,r),x=n.prevZ,b=n.nextZ;x&&x.z>=g&&b&&b.z<=y;){if(x.x>=d&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==s&&ua(o,l,u,c,h,f,x.x,x.y)&&$t(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=d&&b.x<=v&&b.y>=p&&b.y<=m&&b!==i&&b!==s&&ua(o,l,u,c,h,f,b.x,b.y)&&$t(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=d&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==s&&ua(o,l,u,c,h,f,x.x,x.y)&&$t(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=d&&b.x<=v&&b.y>=p&&b.y<=m&&b!==i&&b!==s&&ua(o,l,u,c,h,f,b.x,b.y)&&$t(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function E_(n,t,e){var r=n;do{var i=r.prev,a=r.next.next;!fl(i,a)&&iy(i,r,r.next,a)&&Cs(i,a)&&Cs(a,i)&&(t.push(i.i/e|0),t.push(r.i/e|0),t.push(a.i/e|0),Rs(r),Rs(r.next),r=n=a),r=r.next}while(r!==n);return wi(r)}function T_(n,t,e,r,i,a){var s=n;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&B_(s,o)){var u=ay(s,o);s=wi(s,s.next),u=wi(u,u.next),Is(s,t,e,r,i,a,0),Is(u,t,e,r,i,a,0);return}o=o.next}s=s.next}while(s!==n)}function A_(n,t,e,r){var i=[],a,s,o,u,h;for(a=0,s=t.length;a<s;a++)o=t[a]*r,u=a<s-1?t[a+1]*r:n.length,h=ny(n,o,u,r,!1),h===h.next&&(h.steiner=!0),i.push(O_(h));for(i.sort(M_),a=0;a<i.length;a++)e=P_(i[a],e);return e}function M_(n,t){return n.x-t.x}function P_(n,t){var e=I_(n,t);if(!e)return t;var r=ay(e,n);return wi(r,r.next),wi(e,e.next)}function I_(n,t){var e=t,r=n.x,i=n.y,a=-1/0,s;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var o=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=r&&o>a&&(a=o,s=e.x<e.next.x?e:e.next,o===r))return s}e=e.next}while(e!==t);if(!s)return null;var u=s,h=s.x,l=s.y,c=1/0,f;e=s;do r>=e.x&&e.x>=h&&r!==e.x&&ua(i<l?r:a,i,h,l,i<l?a:r,i,e.x,e.y)&&(f=Math.abs(i-e.y)/(r-e.x),Cs(e,n)&&(f<c||f===c&&(e.x>s.x||e.x===s.x&&C_(s,e)))&&(s=e,c=f)),e=e.next;while(e!==u);return s}function C_(n,t){return $t(n.prev,n,t.prev)<0&&$t(t.next,n,n.next)<0}function R_(n,t,e,r){var i=n;do i.z===0&&(i.z=Sc(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,F_(i)}function F_(n){var t,e,r,i,a,s,o,u,h=1;do{for(e=n,n=null,a=null,s=0;e;){for(s++,r=e,o=0,t=0;t<h&&(o++,r=r.nextZ,!!r);t++);for(u=h;o>0||u>0&&r;)o!==0&&(u===0||!r||e.z<=r.z)?(i=e,e=e.nextZ,o--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:n=i,i.prevZ=a,a=i;e=r}a.nextZ=null,h*=2}while(s>1);return n}function Sc(n,t,e,r,i){return n=(n-e)*i|0,t=(t-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function O_(n){var t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function ua(n,t,e,r,i,a,s,o){return(i-s)*(t-o)>=(n-s)*(a-o)&&(n-s)*(r-o)>=(e-s)*(t-o)&&(e-s)*(a-o)>=(i-s)*(r-o)}function B_(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!N_(n,t)&&(Cs(n,t)&&Cs(t,n)&&k_(n,t)&&($t(n.prev,n,t.prev)||$t(n,t.prev,t))||fl(n,t)&&$t(n.prev,n,n.next)>0&&$t(t.prev,t,t.next)>0)}function $t(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function fl(n,t){return n.x===t.x&&n.y===t.y}function iy(n,t,e,r){var i=_o($t(n,t,e)),a=_o($t(n,t,r)),s=_o($t(e,r,n)),o=_o($t(e,r,t));return!!(i!==a&&s!==o||i===0&&bo(n,e,t)||a===0&&bo(n,r,t)||s===0&&bo(e,n,r)||o===0&&bo(e,t,r))}function bo(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function _o(n){return n>0?1:n<0?-1:0}function N_(n,t){var e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&iy(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function Cs(n,t){return $t(n.prev,n,n.next)<0?$t(n,t,n.next)>=0&&$t(n,n.prev,t)>=0:$t(n,t,n.prev)<0||$t(n,n.next,t)<0}function k_(n,t){var e=n,r=!1,i=(n.x+t.x)/2,a=(n.y+t.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&i<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==n);return r}function ay(n,t){var e=new Ec(n.i,n.x,n.y),r=new Ec(t.i,t.x,t.y),i=n.next,a=t.prev;return n.next=t,t.prev=n,e.next=i,i.prev=e,r.next=e,e.prev=r,a.next=r,r.prev=a,r}function qp(n,t,e,r){var i=new Ec(n,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Rs(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Ec(n,t,e){this.i=n,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}cl.deviation=function(n,t,e,r){var i=t&&t.length,a=i?t[0]*e:n.length,s=Math.abs(Tc(n,0,a,e));if(i)for(var o=0,u=t.length;o<u;o++){var h=t[o]*e,l=o<u-1?t[o+1]*e:n.length;s-=Math.abs(Tc(n,h,l,e))}var c=0;for(o=0;o<r.length;o+=3){var f=r[o]*e,d=r[o+1]*e,p=r[o+2]*e;c+=Math.abs((n[f]-n[p])*(n[d+1]-n[f+1])-(n[f]-n[d])*(n[p+1]-n[f+1]))}return s===0&&c===0?0:Math.abs((c-s)/s)};function Tc(n,t,e,r){for(var i=0,a=t,s=e-r;a<e;a+=r)i+=(n[s]-n[a])*(n[a+1]+n[s+1]),s=a;return i}cl.flatten=function(n){for(var t=n[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,i=0;i<n.length;i++){for(var a=0;a<n[i].length;a++)for(var s=0;s<t;s++)e.vertices.push(n[i][a][s]);i>0&&(r+=n[i-1].length,e.holes.push(r))}return e};var L_=$f.exports;const sy=jf(L_);var Bh={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Bh.exports;(function(n,t){(function(e){var r=t&&!t.nodeType&&t,i=n&&!n.nodeType&&n,a=typeof fs=="object"&&fs;(a.global===a||a.window===a||a.self===a)&&(e=a);var s,o=2147483647,u=36,h=1,l=26,c=38,f=700,d=72,p=128,v="-",m=/^xn--/,g=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=u-h,_=Math.floor,w=String.fromCharCode,S;function E(L){throw new RangeError(x[L])}function T(L,U){for(var G=L.length,V=[];G--;)V[G]=U(L[G]);return V}function A(L,U){var G=L.split("@"),V="";G.length>1&&(V=G[0]+"@",L=G[1]),L=L.replace(y,".");var O=L.split("."),z=T(O,U).join(".");return V+z}function P(L){for(var U=[],G=0,V=L.length,O,z;G<V;)O=L.charCodeAt(G++),O>=55296&&O<=56319&&G<V?(z=L.charCodeAt(G++),(z&64512)==56320?U.push(((O&1023)<<10)+(z&1023)+65536):(U.push(O),G--)):U.push(O);return U}function M(L){return T(L,function(U){var G="";return U>65535&&(U-=65536,G+=w(U>>>10&1023|55296),U=56320|U&1023),G+=w(U),G}).join("")}function R(L){return L-48<10?L-22:L-65<26?L-65:L-97<26?L-97:u}function F(L,U){return L+22+75*(L<26)-((U!=0)<<5)}function N(L,U,G){var V=0;for(L=G?_(L/f):L>>1,L+=_(L/U);L>b*l>>1;V+=u)L=_(L/b);return _(V+(b+1)*L/(L+c))}function D(L){var U=[],G=L.length,V,O=0,z=p,j=d,K,Z,Q,nt,J,it,st,ot,pt;for(K=L.lastIndexOf(v),K<0&&(K=0),Z=0;Z<K;++Z)L.charCodeAt(Z)>=128&&E("not-basic"),U.push(L.charCodeAt(Z));for(Q=K>0?K+1:0;Q<G;){for(nt=O,J=1,it=u;Q>=G&&E("invalid-input"),st=R(L.charCodeAt(Q++)),(st>=u||st>_((o-O)/J))&&E("overflow"),O+=st*J,ot=it<=j?h:it>=j+l?l:it-j,!(st<ot);it+=u)pt=u-ot,J>_(o/pt)&&E("overflow"),J*=pt;V=U.length+1,j=N(O-nt,V,nt==0),_(O/V)>o-z&&E("overflow"),z+=_(O/V),O%=V,U.splice(O++,0,z)}return M(U)}function X(L){var U,G,V,O,z,j,K,Z,Q,nt,J,it=[],st,ot,pt,ct;for(L=P(L),st=L.length,U=p,G=0,z=d,j=0;j<st;++j)J=L[j],J<128&&it.push(w(J));for(V=O=it.length,O&&it.push(v);V<st;){for(K=o,j=0;j<st;++j)J=L[j],J>=U&&J<K&&(K=J);for(ot=V+1,K-U>_((o-G)/ot)&&E("overflow"),G+=(K-U)*ot,U=K,j=0;j<st;++j)if(J=L[j],J<U&&++G>o&&E("overflow"),J==U){for(Z=G,Q=u;nt=Q<=z?h:Q>=z+l?l:Q-z,!(Z<nt);Q+=u)ct=Z-nt,pt=u-nt,it.push(w(F(nt+ct%pt,0))),Z=_(ct/pt);it.push(w(F(Z,0))),z=N(G,ot,V==O),G=0,++V}++G,++U}return it.join("")}function q(L){return A(L,function(U){return m.test(U)?D(U.slice(4).toLowerCase()):U})}function W(L){return A(L,function(U){return g.test(U)?"xn--"+X(U):U})}if(s={version:"1.4.1",ucs2:{decode:P,encode:M},decode:D,encode:X,toASCII:W,toUnicode:q},r&&i)if(n.exports==r)i.exports=s;else for(S in s)s.hasOwnProperty(S)&&(r[S]=s[S]);else e.punycode=s})(fs)})(Bh,Bh.exports);var D_=Bh.exports,ka=TypeError;const U_={},V_=Object.freeze(Object.defineProperty({__proto__:null,default:U_},Symbol.toStringTag,{value:"Module"})),X_=o_(V_);var qf=typeof Map=="function"&&Map.prototype,Xl=Object.getOwnPropertyDescriptor&&qf?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Nh=qf&&Xl&&typeof Xl.get=="function"?Xl.get:null,Zp=qf&&Map.prototype.forEach,Zf=typeof Set=="function"&&Set.prototype,zl=Object.getOwnPropertyDescriptor&&Zf?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,kh=Zf&&zl&&typeof zl.get=="function"?zl.get:null,Kp=Zf&&Set.prototype.forEach,z_=typeof WeakMap=="function"&&WeakMap.prototype,ds=z_?WeakMap.prototype.has:null,G_=typeof WeakSet=="function"&&WeakSet.prototype,ps=G_?WeakSet.prototype.has:null,Y_=typeof WeakRef=="function"&&WeakRef.prototype,Jp=Y_?WeakRef.prototype.deref:null,W_=Boolean.prototype.valueOf,H_=Object.prototype.toString,j_=Function.prototype.toString,$_=String.prototype.match,Kf=String.prototype.slice,kn=String.prototype.replace,q_=String.prototype.toUpperCase,Qp=String.prototype.toLowerCase,oy=RegExp.prototype.test,tv=Array.prototype.concat,Dr=Array.prototype.join,Z_=Array.prototype.slice,ev=Math.floor,Ac=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Gl=Object.getOwnPropertySymbols,Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ma=typeof Symbol=="function"&&typeof Symbol.iterator=="object",vs=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ma||!0)?Symbol.toStringTag:null,hy=Object.prototype.propertyIsEnumerable,rv=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function nv(n,t){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||oy.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var r=n<0?-ev(-n):ev(n);if(r!==n){var i=String(r),a=Kf.call(t,i.length+1);return kn.call(i,e,"$&_")+"."+kn.call(kn.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return kn.call(t,e,"$&_")}var Pc=X_,iv=Pc.custom,av=cy(iv)?iv:null,ly={__proto__:null,double:'"',single:"'"},K_={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},dl=function n(t,e,r,i){var a=e||{};if(ln(a,"quoteStyle")&&!ln(ly,a.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ln(a,"maxStringLength")&&(typeof a.maxStringLength=="number"?a.maxStringLength<0&&a.maxStringLength!==1/0:a.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=ln(a,"customInspect")?a.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ln(a,"indent")&&a.indent!==null&&a.indent!=="	"&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ln(a,"numericSeparator")&&typeof a.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=a.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return dy(t,a);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return o?nv(t,u):u}if(typeof t=="bigint"){var h=String(t)+"n";return o?nv(t,h):h}var l=typeof a.depth>"u"?5:a.depth;if(typeof r>"u"&&(r=0),r>=l&&l>0&&typeof t=="object")return Ic(t)?"[Array]":"[Object]";var c=vw(a,r);if(typeof i>"u")i=[];else if(fy(i,t)>=0)return"[Circular]";function f(R,F,N){if(F&&(i=Z_.call(i),i.push(F)),N){var D={depth:a.depth};return ln(a,"quoteStyle")&&(D.quoteStyle=a.quoteStyle),n(R,D,r+1,i)}return n(R,a,r+1,i)}if(typeof t=="function"&&!sv(t)){var d=sw(t),p=wo(t,f);return"[Function"+(d?": "+d:" (anonymous)")+"]"+(p.length>0?" { "+Dr.call(p,", ")+" }":"")}if(cy(t)){var v=Ma?kn.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Mc.call(t);return typeof t=="object"&&!Ma?qa(v):v}if(fw(t)){for(var m="<"+Qp.call(String(t.nodeName)),g=t.attributes||[],y=0;y<g.length;y++)m+=" "+g[y].name+"="+uy(J_(g[y].value),"double",a);return m+=">",t.childNodes&&t.childNodes.length&&(m+="..."),m+="</"+Qp.call(String(t.nodeName))+">",m}if(Ic(t)){if(t.length===0)return"[]";var x=wo(t,f);return c&&!pw(x)?"["+Cc(x,c)+"]":"[ "+Dr.call(x,", ")+" ]"}if(tw(t)){var b=wo(t,f);return!("cause"in Error.prototype)&&"cause"in t&&!hy.call(t,"cause")?"{ ["+String(t)+"] "+Dr.call(tv.call("[cause]: "+f(t.cause),b),", ")+" }":b.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Dr.call(b,", ")+" }"}if(typeof t=="object"&&s){if(av&&typeof t[av]=="function"&&Pc)return Pc(t,{depth:l-r});if(s!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(ow(t)){var _=[];return Zp&&Zp.call(t,function(R,F){_.push(f(F,t,!0)+" => "+f(R,t))}),ov("Map",Nh.call(t),_,c)}if(uw(t)){var w=[];return Kp&&Kp.call(t,function(R){w.push(f(R,t))}),ov("Set",kh.call(t),w,c)}if(hw(t))return Yl("WeakMap");if(cw(t))return Yl("WeakSet");if(lw(t))return Yl("WeakRef");if(rw(t))return qa(f(Number(t)));if(iw(t))return qa(f(Ac.call(t)));if(nw(t))return qa(W_.call(t));if(ew(t))return qa(f(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof fs<"u"&&t===fs)return"{ [object globalThis] }";if(!Q_(t)&&!sv(t)){var S=wo(t,f),E=rv?rv(t)===Object.prototype:t instanceof Object||t.constructor===Object,T=t instanceof Object?"":"null prototype",A=!E&&vs&&Object(t)===t&&vs in t?Kf.call(Gn(t),8,-1):T?"Object":"",P=E||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",M=P+(A||T?"["+Dr.call(tv.call([],A||[],T||[]),": ")+"] ":"");return S.length===0?M+"{}":c?M+"{"+Cc(S,c)+"}":M+"{ "+Dr.call(S,", ")+" }"}return String(t)};function uy(n,t,e){var r=e.quoteStyle||t,i=ly[r];return i+n+i}function J_(n){return kn.call(String(n),/"/g,"&quot;")}function Oi(n){return!vs||!(typeof n=="object"&&(vs in n||typeof n[vs]<"u"))}function Ic(n){return Gn(n)==="[object Array]"&&Oi(n)}function Q_(n){return Gn(n)==="[object Date]"&&Oi(n)}function sv(n){return Gn(n)==="[object RegExp]"&&Oi(n)}function tw(n){return Gn(n)==="[object Error]"&&Oi(n)}function ew(n){return Gn(n)==="[object String]"&&Oi(n)}function rw(n){return Gn(n)==="[object Number]"&&Oi(n)}function nw(n){return Gn(n)==="[object Boolean]"&&Oi(n)}function cy(n){if(Ma)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!Mc)return!1;try{return Mc.call(n),!0}catch{}return!1}function iw(n){if(!n||typeof n!="object"||!Ac)return!1;try{return Ac.call(n),!0}catch{}return!1}var aw=Object.prototype.hasOwnProperty||function(n){return n in this};function ln(n,t){return aw.call(n,t)}function Gn(n){return H_.call(n)}function sw(n){if(n.name)return n.name;var t=$_.call(j_.call(n),/^function\s*([\w$]+)/);return t?t[1]:null}function fy(n,t){if(n.indexOf)return n.indexOf(t);for(var e=0,r=n.length;e<r;e++)if(n[e]===t)return e;return-1}function ow(n){if(!Nh||!n||typeof n!="object")return!1;try{Nh.call(n);try{kh.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function hw(n){if(!ds||!n||typeof n!="object")return!1;try{ds.call(n,ds);try{ps.call(n,ps)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function lw(n){if(!Jp||!n||typeof n!="object")return!1;try{return Jp.call(n),!0}catch{}return!1}function uw(n){if(!kh||!n||typeof n!="object")return!1;try{kh.call(n);try{Nh.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function cw(n){if(!ps||!n||typeof n!="object")return!1;try{ps.call(n,ps);try{ds.call(n,ds)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function fw(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function dy(n,t){if(n.length>t.maxStringLength){var e=n.length-t.maxStringLength,r="... "+e+" more character"+(e>1?"s":"");return dy(Kf.call(n,0,t.maxStringLength),t)+r}var i=K_[t.quoteStyle||"single"];i.lastIndex=0;var a=kn.call(kn.call(n,i,"\\$1"),/[\x00-\x1f]/g,dw);return uy(a,"single",t)}function dw(n){var t=n.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+q_.call(t.toString(16))}function qa(n){return"Object("+n+")"}function Yl(n){return n+" { ? }"}function ov(n,t,e,r){var i=r?Cc(e,r):Dr.call(e,", ");return n+" ("+t+") {"+i+"}"}function pw(n){for(var t=0;t<n.length;t++)if(fy(n[t],`
`)>=0)return!1;return!0}function vw(n,t){var e;if(n.indent==="	")e="	";else if(typeof n.indent=="number"&&n.indent>0)e=Dr.call(Array(n.indent+1)," ");else return null;return{base:e,prev:Dr.call(Array(t+1),e)}}function Cc(n,t){if(n.length===0)return"";var e=`
`+t.prev+t.base;return e+Dr.call(n,","+e)+`
`+t.prev}function wo(n,t){var e=Ic(n),r=[];if(e){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=ln(n,i)?t(n[i],n):""}var a=typeof Gl=="function"?Gl(n):[],s;if(Ma){s={};for(var o=0;o<a.length;o++)s["$"+a[o]]=a[o]}for(var u in n)ln(n,u)&&(e&&String(Number(u))===u&&u<n.length||Ma&&s["$"+u]instanceof Symbol||(oy.call(/[^\w$]/,u)?r.push(t(u,n)+": "+t(n[u],n)):r.push(u+": "+t(n[u],n))));if(typeof Gl=="function")for(var h=0;h<a.length;h++)hy.call(n,a[h])&&r.push("["+t(a[h])+"]: "+t(n[a[h]],n));return r}var mw=dl,gw=ka,pl=function(n,t,e){for(var r=n,i;(i=r.next)!=null;r=i)if(i.key===t)return r.next=i.next,e||(i.next=n.next,n.next=i),i},yw=function(n,t){if(n){var e=pl(n,t);return e&&e.value}},xw=function(n,t,e){var r=pl(n,t);r?r.value=e:n.next={key:t,next:n.next,value:e}},bw=function(n,t){return n?!!pl(n,t):!1},_w=function(n,t){if(n)return pl(n,t,!0)},ww=function(){var t,e={assert:function(r){if(!e.has(r))throw new gw("Side channel does not contain "+mw(r))},delete:function(r){var i=t&&t.next,a=_w(t,r);return a&&i&&i===a&&(t=void 0),!!a},get:function(r){return yw(t,r)},has:function(r){return bw(t,r)},set:function(r,i){t||(t={next:void 0}),xw(t,r,i)}};return e},py=Object,Sw=Error,Ew=EvalError,Tw=RangeError,Aw=ReferenceError,Mw=SyntaxError,Pw=URIError,Iw=Math.abs,Cw=Math.floor,Rw=Math.max,Fw=Math.min,Ow=Math.pow,Bw=Math.round,Nw=Number.isNaN||function(t){return t!==t},kw=Nw,Lw=function(t){return kw(t)||t===0?t:t<0?-1:1},Dw=Object.getOwnPropertyDescriptor,Th=Dw;if(Th)try{Th([],"length")}catch{Th=null}var vy=Th,Ah=Object.defineProperty||!1;if(Ah)try{Ah({},"a",{value:1})}catch{Ah=!1}var Uw=Ah,Wl,hv;function Vw(){return hv||(hv=1,Wl=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),r=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var s=Object.getOwnPropertySymbols(t);if(s.length!==1||s[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),Wl}var Hl,lv;function Xw(){if(lv)return Hl;lv=1;var n=typeof Symbol<"u"&&Symbol,t=Vw();return Hl=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Hl}var jl,uv;function my(){return uv||(uv=1,jl=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),jl}var $l,cv;function gy(){if(cv)return $l;cv=1;var n=py;return $l=n.getPrototypeOf||null,$l}var zw="Function.prototype.bind called on incompatible ",Gw=Object.prototype.toString,Yw=Math.max,Ww="[object Function]",fv=function(t,e){for(var r=[],i=0;i<t.length;i+=1)r[i]=t[i];for(var a=0;a<e.length;a+=1)r[a+t.length]=e[a];return r},Hw=function(t,e){for(var r=[],i=e,a=0;i<t.length;i+=1,a+=1)r[a]=t[i];return r},jw=function(n,t){for(var e="",r=0;r<n.length;r+=1)e+=n[r],r+1<n.length&&(e+=t);return e},$w=function(t){var e=this;if(typeof e!="function"||Gw.apply(e)!==Ww)throw new TypeError(zw+e);for(var r=Hw(arguments,1),i,a=function(){if(this instanceof i){var l=e.apply(this,fv(r,arguments));return Object(l)===l?l:this}return e.apply(t,fv(r,arguments))},s=Yw(0,e.length-r.length),o=[],u=0;u<s;u++)o[u]="$"+u;if(i=Function("binder","return function ("+jw(o,",")+"){ return binder.apply(this,arguments); }")(a),e.prototype){var h=function(){};h.prototype=e.prototype,i.prototype=new h,h.prototype=null}return i},qw=$w,vl=Function.prototype.bind||qw,Jf=Function.prototype.call,ql,dv;function yy(){return dv||(dv=1,ql=Function.prototype.apply),ql}var Zw=typeof Reflect<"u"&&Reflect&&Reflect.apply,Kw=vl,Jw=yy(),Qw=Jf,t1=Zw,e1=t1||Kw.call(Qw,Jw),r1=vl,n1=ka,i1=Jf,a1=e1,xy=function(t){if(t.length<1||typeof t[0]!="function")throw new n1("a function is required");return a1(r1,i1,t)},Zl,pv;function s1(){if(pv)return Zl;pv=1;var n=xy,t=vy,e;try{e=[].__proto__===Array.prototype}catch(s){if(!s||typeof s!="object"||!("code"in s)||s.code!=="ERR_PROTO_ACCESS")throw s}var r=!!e&&t&&t(Object.prototype,"__proto__"),i=Object,a=i.getPrototypeOf;return Zl=r&&typeof r.get=="function"?n([r.get]):typeof a=="function"?function(o){return a(o==null?o:i(o))}:!1,Zl}var Kl,vv;function o1(){if(vv)return Kl;vv=1;var n=my(),t=gy(),e=s1();return Kl=n?function(i){return n(i)}:t?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return t(i)}:e?function(i){return e(i)}:null,Kl}var Jl,mv;function h1(){if(mv)return Jl;mv=1;var n=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=vl;return Jl=e.call(n,t),Jl}var wt,l1=py,u1=Sw,c1=Ew,f1=Tw,d1=Aw,Pa=Mw,ya=ka,p1=Pw,v1=Iw,m1=Cw,g1=Rw,y1=Fw,x1=Ow,b1=Bw,_1=Lw,by=Function,Ql=function(n){try{return by('"use strict"; return ('+n+").constructor;")()}catch{}},Fs=vy,w1=Uw,tu=function(){throw new ya},S1=Fs?function(){try{return arguments.callee,tu}catch{try{return Fs(arguments,"callee").get}catch{return tu}}}():tu,zi=Xw()(),Te=o1(),E1=gy(),T1=my(),_y=yy(),so=Jf,oa={},A1=typeof Uint8Array>"u"||!Te?wt:Te(Uint8Array),yi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?wt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?wt:ArrayBuffer,"%ArrayIteratorPrototype%":zi&&Te?Te([][Symbol.iterator]()):wt,"%AsyncFromSyncIteratorPrototype%":wt,"%AsyncFunction%":oa,"%AsyncGenerator%":oa,"%AsyncGeneratorFunction%":oa,"%AsyncIteratorPrototype%":oa,"%Atomics%":typeof Atomics>"u"?wt:Atomics,"%BigInt%":typeof BigInt>"u"?wt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?wt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?wt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?wt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":u1,"%eval%":eval,"%EvalError%":c1,"%Float16Array%":typeof Float16Array>"u"?wt:Float16Array,"%Float32Array%":typeof Float32Array>"u"?wt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?wt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?wt:FinalizationRegistry,"%Function%":by,"%GeneratorFunction%":oa,"%Int8Array%":typeof Int8Array>"u"?wt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?wt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?wt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":zi&&Te?Te(Te([][Symbol.iterator]())):wt,"%JSON%":typeof JSON=="object"?JSON:wt,"%Map%":typeof Map>"u"?wt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!zi||!Te?wt:Te(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":l1,"%Object.getOwnPropertyDescriptor%":Fs,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?wt:Promise,"%Proxy%":typeof Proxy>"u"?wt:Proxy,"%RangeError%":f1,"%ReferenceError%":d1,"%Reflect%":typeof Reflect>"u"?wt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?wt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!zi||!Te?wt:Te(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?wt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":zi&&Te?Te(""[Symbol.iterator]()):wt,"%Symbol%":zi?Symbol:wt,"%SyntaxError%":Pa,"%ThrowTypeError%":S1,"%TypedArray%":A1,"%TypeError%":ya,"%Uint8Array%":typeof Uint8Array>"u"?wt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?wt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?wt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?wt:Uint32Array,"%URIError%":p1,"%WeakMap%":typeof WeakMap>"u"?wt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?wt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?wt:WeakSet,"%Function.prototype.call%":so,"%Function.prototype.apply%":_y,"%Object.defineProperty%":w1,"%Object.getPrototypeOf%":E1,"%Math.abs%":v1,"%Math.floor%":m1,"%Math.max%":g1,"%Math.min%":y1,"%Math.pow%":x1,"%Math.round%":b1,"%Math.sign%":_1,"%Reflect.getPrototypeOf%":T1};if(Te)try{null.error}catch(n){var M1=Te(Te(n));yi["%Error.prototype%"]=M1}var P1=function n(t){var e;if(t==="%AsyncFunction%")e=Ql("async function () {}");else if(t==="%GeneratorFunction%")e=Ql("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Ql("async function* () {}");else if(t==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(e=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=n("%AsyncGenerator%");i&&Te&&(e=Te(i.prototype))}return yi[t]=e,e},gv={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},oo=vl,Lh=h1(),I1=oo.call(so,Array.prototype.concat),C1=oo.call(_y,Array.prototype.splice),yv=oo.call(so,String.prototype.replace),Dh=oo.call(so,String.prototype.slice),R1=oo.call(so,RegExp.prototype.exec),F1=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,O1=/\\(\\)?/g,B1=function(t){var e=Dh(t,0,1),r=Dh(t,-1);if(e==="%"&&r!=="%")throw new Pa("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&e!=="%")throw new Pa("invalid intrinsic syntax, expected opening `%`");var i=[];return yv(t,F1,function(a,s,o,u){i[i.length]=o?yv(u,O1,"$1"):s||a}),i},N1=function(t,e){var r=t,i;if(Lh(gv,r)&&(i=gv[r],r="%"+i[0]+"%"),Lh(yi,r)){var a=yi[r];if(a===oa&&(a=P1(r)),typeof a>"u"&&!e)throw new ya("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:a}}throw new Pa("intrinsic "+t+" does not exist!")},Qf=function(t,e){if(typeof t!="string"||t.length===0)throw new ya("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new ya('"allowMissing" argument must be a boolean');if(R1(/^%?[^%]*%?$/,t)===null)throw new Pa("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=B1(t),i=r.length>0?r[0]:"",a=N1("%"+i+"%",e),s=a.name,o=a.value,u=!1,h=a.alias;h&&(i=h[0],C1(r,I1([0,1],h)));for(var l=1,c=!0;l<r.length;l+=1){var f=r[l],d=Dh(f,0,1),p=Dh(f,-1);if((d==='"'||d==="'"||d==="`"||p==='"'||p==="'"||p==="`")&&d!==p)throw new Pa("property names with quotes must have matching quotes");if((f==="constructor"||!c)&&(u=!0),i+="."+f,s="%"+i+"%",Lh(yi,s))o=yi[s];else if(o!=null){if(!(f in o)){if(!e)throw new ya("base intrinsic for "+t+" exists, but the property is not available.");return}if(Fs&&l+1>=r.length){var v=Fs(o,f);c=!!v,c&&"get"in v&&!("originalValue"in v.get)?o=v.get:o=o[f]}else c=Lh(o,f),o=o[f];c&&!u&&(yi[s]=o)}}return o},wy=Qf,Sy=xy,k1=Sy([wy("%String.prototype.indexOf%")]),Ey=function(t,e){var r=wy(t,!!e);return typeof r=="function"&&k1(t,".prototype.")>-1?Sy([r]):r},L1=Qf,ho=Ey,D1=dl,U1=ka,xv=L1("%Map%",!0),V1=ho("Map.prototype.get",!0),X1=ho("Map.prototype.set",!0),z1=ho("Map.prototype.has",!0),G1=ho("Map.prototype.delete",!0),Y1=ho("Map.prototype.size",!0),Ty=!!xv&&function(){var t,e={assert:function(r){if(!e.has(r))throw new U1("Side channel does not contain "+D1(r))},delete:function(r){if(t){var i=G1(t,r);return Y1(t)===0&&(t=void 0),i}return!1},get:function(r){if(t)return V1(t,r)},has:function(r){return t?z1(t,r):!1},set:function(r,i){t||(t=new xv),X1(t,r,i)}};return e},W1=Qf,ml=Ey,H1=dl,So=Ty,j1=ka,Gi=W1("%WeakMap%",!0),$1=ml("WeakMap.prototype.get",!0),q1=ml("WeakMap.prototype.set",!0),Z1=ml("WeakMap.prototype.has",!0),K1=ml("WeakMap.prototype.delete",!0),J1=Gi?function(){var t,e,r={assert:function(i){if(!r.has(i))throw new j1("Side channel does not contain "+H1(i))},delete:function(i){if(Gi&&i&&(typeof i=="object"||typeof i=="function")){if(t)return K1(t,i)}else if(So&&e)return e.delete(i);return!1},get:function(i){return Gi&&i&&(typeof i=="object"||typeof i=="function")&&t?$1(t,i):e&&e.get(i)},has:function(i){return Gi&&i&&(typeof i=="object"||typeof i=="function")&&t?Z1(t,i):!!e&&e.has(i)},set:function(i,a){Gi&&i&&(typeof i=="object"||typeof i=="function")?(t||(t=new Gi),q1(t,i,a)):So&&(e||(e=So()),e.set(i,a))}};return r}:So,Q1=ka,tS=dl,eS=ww,rS=Ty,nS=J1,iS=nS||rS||eS,Ay=function(){var t,e={assert:function(r){if(!e.has(r))throw new Q1("Side channel does not contain "+tS(r))},delete:function(r){return!!t&&t.delete(r)},get:function(r){return t&&t.get(r)},has:function(r){return!!t&&t.has(r)},set:function(r,i){t||(t=iS()),t.set(r,i)}};return e},aS=String.prototype.replace,sS=/%20/g,eu={RFC1738:"RFC1738",RFC3986:"RFC3986"},td={default:eu.RFC3986,formatters:{RFC1738:function(n){return aS.call(n,sS,"+")},RFC3986:function(n){return String(n)}},RFC1738:eu.RFC1738,RFC3986:eu.RFC3986},oS=td,hS=Ay,ru=Object.prototype.hasOwnProperty,ui=Array.isArray,gl=hS(),My=function(t,e){return gl.set(t,e),t},Uh=function(t){return gl.has(t)},Rc=function(t){return gl.get(t)},Py=function(t,e){gl.set(t,e)},Fr=function(){for(var n=[],t=0;t<256;++t)n.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return n}(),lS=function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(ui(r)){for(var i=[],a=0;a<r.length;++a)typeof r[a]<"u"&&i.push(r[a]);e.obj[e.prop]=i}}},ed=function(t,e){for(var r=e&&e.plainObjects?{__proto__:null}:{},i=0;i<t.length;++i)typeof t[i]<"u"&&(r[i]=t[i]);return r},uS=function n(t,e,r){if(!e)return t;if(typeof e!="object"&&typeof e!="function"){if(ui(t))t.push(e);else if(t&&typeof t=="object")if(Uh(t)){var i=Rc(t)+1;t[i]=e,Py(t,i)}else(r&&(r.plainObjects||r.allowPrototypes)||!ru.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object"){if(Uh(e)){for(var a=Object.keys(e),s=r&&r.plainObjects?{__proto__:null,0:t}:{0:t},o=0;o<a.length;o++){var u=parseInt(a[o],10);s[u+1]=e[a[o]]}return My(s,Rc(e)+1)}return[t].concat(e)}var h=t;return ui(t)&&!ui(e)&&(h=ed(t,r)),ui(t)&&ui(e)?(e.forEach(function(l,c){if(ru.call(t,c)){var f=t[c];f&&typeof f=="object"&&l&&typeof l=="object"?t[c]=n(f,l,r):t.push(l)}else t[c]=l}),t):Object.keys(e).reduce(function(l,c){var f=e[c];return ru.call(l,c)?l[c]=n(l[c],f,r):l[c]=f,l},h)},cS=function(t,e){return Object.keys(e).reduce(function(r,i){return r[i]=e[i],r},t)},fS=function(n,t,e){var r=n.replace(/\+/g," ");if(e==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},nu=1024,dS=function(t,e,r,i,a){if(t.length===0)return t;var s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),r==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var o="",u=0;u<s.length;u+=nu){for(var h=s.length>=nu?s.slice(u,u+nu):s,l=[],c=0;c<h.length;++c){var f=h.charCodeAt(c);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===oS.RFC1738&&(f===40||f===41)){l[l.length]=h.charAt(c);continue}if(f<128){l[l.length]=Fr[f];continue}if(f<2048){l[l.length]=Fr[192|f>>6]+Fr[128|f&63];continue}if(f<55296||f>=57344){l[l.length]=Fr[224|f>>12]+Fr[128|f>>6&63]+Fr[128|f&63];continue}c+=1,f=65536+((f&1023)<<10|h.charCodeAt(c)&1023),l[l.length]=Fr[240|f>>18]+Fr[128|f>>12&63]+Fr[128|f>>6&63]+Fr[128|f&63]}o+=l.join("")}return o},pS=function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],i=0;i<e.length;++i)for(var a=e[i],s=a.obj[a.prop],o=Object.keys(s),u=0;u<o.length;++u){var h=o[u],l=s[h];typeof l=="object"&&l!==null&&r.indexOf(l)===-1&&(e.push({obj:s,prop:h}),r.push(l))}return lS(e),t},vS=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},mS=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},gS=function(t,e,r,i){if(Uh(t)){var a=Rc(t)+1;return t[a]=e,Py(t,a),t}var s=[].concat(t,e);return s.length>r?My(ed(s,{plainObjects:i}),s.length-1):s},yS=function(t,e){if(ui(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(e(t[i]));return r}return e(t)},Iy={arrayToObject:ed,assign:cS,combine:gS,compact:pS,decode:fS,encode:dS,isBuffer:mS,isOverflow:Uh,isRegExp:vS,maybeMap:yS,merge:uS},Cy=Ay,Mh=Iy,ms=td,xS=Object.prototype.hasOwnProperty,Ry={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},kr=Array.isArray,bS=Array.prototype.push,Fy=function(n,t){bS.apply(n,kr(t)?t:[t])},_S=Date.prototype.toISOString,bv=ms.default,ge={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Mh.encode,encodeValuesOnly:!1,filter:void 0,format:bv,formatter:ms.formatters[bv],indices:!1,serializeDate:function(t){return _S.call(t)},skipNulls:!1,strictNullHandling:!1},wS=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},iu={},SS=function n(t,e,r,i,a,s,o,u,h,l,c,f,d,p,v,m,g,y){for(var x=t,b=y,_=0,w=!1;(b=b.get(iu))!==void 0&&!w;){var S=b.get(t);if(_+=1,typeof S<"u"){if(S===_)throw new RangeError("Cyclic object value");w=!0}typeof b.get(iu)>"u"&&(_=0)}if(typeof l=="function"?x=l(e,x):x instanceof Date?x=d(x):r==="comma"&&kr(x)&&(x=Mh.maybeMap(x,function(L){return L instanceof Date?d(L):L})),x===null){if(s)return h&&!m?h(e,ge.encoder,g,"key",p):e;x=""}if(wS(x)||Mh.isBuffer(x)){if(h){var E=m?e:h(e,ge.encoder,g,"key",p);return[v(E)+"="+v(h(x,ge.encoder,g,"value",p))]}return[v(e)+"="+v(String(x))]}var T=[];if(typeof x>"u")return T;var A;if(r==="comma"&&kr(x))m&&h&&(x=Mh.maybeMap(x,h)),A=[{value:x.length>0?x.join(",")||null:void 0}];else if(kr(l))A=l;else{var P=Object.keys(x);A=c?P.sort(c):P}var M=u?String(e).replace(/\./g,"%2E"):String(e),R=i&&kr(x)&&x.length===1?M+"[]":M;if(a&&kr(x)&&x.length===0)return R+"[]";for(var F=0;F<A.length;++F){var N=A[F],D=typeof N=="object"&&N&&typeof N.value<"u"?N.value:x[N];if(!(o&&D===null)){var X=f&&u?String(N).replace(/\./g,"%2E"):String(N),q=kr(x)?typeof r=="function"?r(R,X):R:R+(f?"."+X:"["+X+"]");y.set(t,_);var W=Cy();W.set(iu,y),Fy(T,n(D,q,r,i,a,s,o,u,r==="comma"&&m&&kr(x)?null:h,l,c,f,d,p,v,m,g,W))}}return T},ES=function(t){if(!t)return ge;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||ge.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=ms.default;if(typeof t.format<"u"){if(!xS.call(ms.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i=ms.formatters[r],a=ge.filter;(typeof t.filter=="function"||kr(t.filter))&&(a=t.filter);var s;if(t.arrayFormat in Ry?s=t.arrayFormat:"indices"in t?s=t.indices?"indices":"repeat":s=ge.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:ge.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:ge.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ge.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ge.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?ge.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:ge.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:ge.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:ge.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:ge.encodeValuesOnly,filter:a,format:r,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:ge.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:ge.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ge.strictNullHandling}},TS=function(n,t){var e=n,r=ES(t),i,a;typeof r.filter=="function"?(a=r.filter,e=a("",e)):kr(r.filter)&&(a=r.filter,i=a);var s=[];if(typeof e!="object"||e===null)return"";var o=Ry[r.arrayFormat],u=o==="comma"&&r.commaRoundTrip;i||(i=Object.keys(e)),r.sort&&i.sort(r.sort);for(var h=Cy(),l=0;l<i.length;++l){var c=i[l],f=e[c];r.skipNulls&&f===null||Fy(s,SS(f,c,o,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,h))}var d=s.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""},Vn=Iy,Ph=Object.prototype.hasOwnProperty,_v=Array.isArray,Kt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Vn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},AS=function(n){return n.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Oy=function(n,t,e){if(n&&typeof n=="string"&&t.comma&&n.indexOf(",")>-1)return n.split(",");if(t.throwOnLimitExceeded&&e>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(t.arrayLimit===1?"":"s")+" allowed in an array.");return n},MS="utf8=%26%2310003%3B",PS="utf8=%E2%9C%93",IS=function(t,e){var r={__proto__:null},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var a=e.parameterLimit===1/0?void 0:e.parameterLimit,s=i.split(e.delimiter,e.throwOnLimitExceeded?a+1:a);if(e.throwOnLimitExceeded&&s.length>a)throw new RangeError("Parameter limit exceeded. Only "+a+" parameter"+(a===1?"":"s")+" allowed.");var o=-1,u,h=e.charset;if(e.charsetSentinel)for(u=0;u<s.length;++u)s[u].indexOf("utf8=")===0&&(s[u]===PS?h="utf-8":s[u]===MS&&(h="iso-8859-1"),o=u,u=s.length);for(u=0;u<s.length;++u)if(u!==o){var l=s[u],c=l.indexOf("]="),f=c===-1?l.indexOf("="):c+1,d,p;if(f===-1?(d=e.decoder(l,Kt.decoder,h,"key"),p=e.strictNullHandling?null:""):(d=e.decoder(l.slice(0,f),Kt.decoder,h,"key"),d!==null&&(p=Vn.maybeMap(Oy(l.slice(f+1),e,_v(r[d])?r[d].length:0),function(m){return e.decoder(m,Kt.decoder,h,"value")}))),p&&e.interpretNumericEntities&&h==="iso-8859-1"&&(p=AS(String(p))),l.indexOf("[]=")>-1&&(p=_v(p)?[p]:p),d!==null){var v=Ph.call(r,d);v&&e.duplicates==="combine"?r[d]=Vn.combine(r[d],p,e.arrayLimit,e.plainObjects):(!v||e.duplicates==="last")&&(r[d]=p)}}return r},CS=function(n,t,e,r){var i=0;if(n.length>0&&n[n.length-1]==="[]"){var a=n.slice(0,-1).join("");i=Array.isArray(t)&&t[a]?t[a].length:0}for(var s=r?t:Oy(t,e,i),o=n.length-1;o>=0;--o){var u,h=n[o];if(h==="[]"&&e.parseArrays)Vn.isOverflow(s)?u=s:u=e.allowEmptyArrays&&(s===""||e.strictNullHandling&&s===null)?[]:Vn.combine([],s,e.arrayLimit,e.plainObjects);else{u=e.plainObjects?{__proto__:null}:{};var l=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,c=e.decodeDotInKeys?l.replace(/%2E/g,"."):l,f=parseInt(c,10);!e.parseArrays&&c===""?u={0:s}:!isNaN(f)&&h!==c&&String(f)===c&&f>=0&&e.parseArrays&&f<=e.arrayLimit?(u=[],u[f]=s):c!=="__proto__"&&(u[c]=s)}s=u}return s},RS=function(t,e){var r=e.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t;if(e.depth<=0)return!e.plainObjects&&Ph.call(Object.prototype,r)&&!e.allowPrototypes?void 0:[r];var i=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,s=i.exec(r),o=s?r.slice(0,s.index):r,u=[];if(o){if(!e.plainObjects&&Ph.call(Object.prototype,o)&&!e.allowPrototypes)return;u.push(o)}for(var h=0;(s=a.exec(r))!==null&&h<e.depth;){h+=1;var l=s[1].slice(1,-1);if(!e.plainObjects&&Ph.call(Object.prototype,l)&&!e.allowPrototypes)return;u.push(s[1])}if(s){if(e.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+e.depth+" and strictDepth is true");u.push("["+r.slice(s.index)+"]")}return u},FS=function(t,e,r,i){if(t){var a=RS(t,r);if(a)return CS(a,e,r,i)}},OS=function(t){if(!t)return Kt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof t.throwOnLimitExceeded<"u"&&typeof t.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=typeof t.charset>"u"?Kt.charset:t.charset,r=typeof t.duplicates>"u"?Kt.duplicates:t.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:Kt.allowDots:!!t.allowDots;return{allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Kt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Kt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Kt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Kt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Kt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:Kt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:Kt.decoder,delimiter:typeof t.delimiter=="string"||Vn.isRegExp(t.delimiter)?t.delimiter:Kt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Kt.depth,duplicates:r,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Kt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Kt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Kt.plainObjects,strictDepth:typeof t.strictDepth=="boolean"?!!t.strictDepth:Kt.strictDepth,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kt.strictNullHandling,throwOnLimitExceeded:typeof t.throwOnLimitExceeded=="boolean"?t.throwOnLimitExceeded:!1}},BS=function(n,t){var e=OS(t);if(n===""||n===null||typeof n>"u")return e.plainObjects?{__proto__:null}:{};for(var r=typeof n=="string"?IS(n,e):n,i=e.plainObjects?{__proto__:null}:{},a=Object.keys(r),s=0;s<a.length;++s){var o=a[s],u=FS(o,r[o],e,typeof n=="string");i=Vn.merge(i,u,e)}return e.allowSparse===!0?i:Vn.compact(i)},NS=TS,kS=BS,LS=td,DS={formats:LS,parse:kS,stringify:NS},US=D_;function Ar(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var VS=/^([a-z0-9.+-]+:)/i,XS=/:[0-9]*$/,zS=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,GS=["<",">",'"',"`"," ","\r",`
`,"	"],YS=["{","}","|","\\","^","`"].concat(GS),Fc=["'"].concat(YS),wv=["%","/","?",";","#"].concat(Fc),Sv=["/","?","#"],WS=255,Ev=/^[+a-z0-9A-Z_-]{0,63}$/,HS=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jS={javascript:!0,"javascript:":!0},Oc={javascript:!0,"javascript:":!0},xa={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Bc=DS;function yl(n,t,e){if(n&&typeof n=="object"&&n instanceof Ar)return n;var r=new Ar;return r.parse(n,t,e),r}Ar.prototype.parse=function(n,t,e){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var r=n.indexOf("?"),i=r!==-1&&r<n.indexOf("#")?"?":"#",a=n.split(i),s=/\\/g;a[0]=a[0].replace(s,"/"),n=a.join(i);var o=n;if(o=o.trim(),!e&&n.split("#").length===1){var u=zS.exec(o);if(u)return this.path=o,this.href=o,this.pathname=u[1],u[2]?(this.search=u[2],t?this.query=Bc.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=VS.exec(o);if(h){h=h[0];var l=h.toLowerCase();this.protocol=l,o=o.substr(h.length)}if(e||h||o.match(/^\/\/[^@/]+@[^@/]+/)){var c=o.substr(0,2)==="//";c&&!(h&&Oc[h])&&(o=o.substr(2),this.slashes=!0)}if(!Oc[h]&&(c||h&&!xa[h])){for(var f=-1,d=0;d<Sv.length;d++){var p=o.indexOf(Sv[d]);p!==-1&&(f===-1||p<f)&&(f=p)}var v,m;f===-1?m=o.lastIndexOf("@"):m=o.lastIndexOf("@",f),m!==-1&&(v=o.slice(0,m),o=o.slice(m+1),this.auth=decodeURIComponent(v)),f=-1;for(var d=0;d<wv.length;d++){var p=o.indexOf(wv[d]);p!==-1&&(f===-1||p<f)&&(f=p)}f===-1&&(f=o.length),this.host=o.slice(0,f),o=o.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var y=this.hostname.split(/\./),d=0,x=y.length;d<x;d++){var b=y[d];if(b&&!b.match(Ev)){for(var _="",w=0,S=b.length;w<S;w++)b.charCodeAt(w)>127?_+="x":_+=b[w];if(!_.match(Ev)){var E=y.slice(0,d),T=y.slice(d+1),A=b.match(HS);A&&(E.push(A[1]),T.unshift(A[2])),T.length&&(o="/"+T.join(".")+o),this.hostname=E.join(".");break}}}this.hostname.length>WS?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=US.toASCII(this.hostname));var P=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+P,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!jS[l])for(var d=0,x=Fc.length;d<x;d++){var R=Fc[d];if(o.indexOf(R)!==-1){var F=encodeURIComponent(R);F===R&&(F=escape(R)),o=o.split(R).join(F)}}var N=o.indexOf("#");N!==-1&&(this.hash=o.substr(N),o=o.slice(0,N));var D=o.indexOf("?");if(D!==-1?(this.search=o.substr(D),this.query=o.substr(D+1),t&&(this.query=Bc.parse(this.query)),o=o.slice(0,D)):t&&(this.search="",this.query={}),o&&(this.pathname=o),xa[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var P=this.pathname||"",X=this.search||"";this.path=P+X}return this.href=this.format(),this};function $S(n){return typeof n=="string"&&(n=yl(n)),n instanceof Ar?n.format():Ar.prototype.format.call(n)}Ar.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var t=this.protocol||"",e=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=n+this.host:this.hostname&&(i=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(a=Bc.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||a&&"?"+a||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||xa[t])&&i!==!1?(i="//"+(i||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),s&&s.charAt(0)!=="?"&&(s="?"+s),e=e.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),s=s.replace("#","%23"),t+i+e+s+r};function qS(n,t){return yl(n,!1,!0).resolve(t)}Ar.prototype.resolve=function(n){return this.resolveObject(yl(n,!1,!0)).format()};Ar.prototype.resolveObject=function(n){if(typeof n=="string"){var t=new Ar;t.parse(n,!1,!0),n=t}for(var e=new Ar,r=Object.keys(this),i=0;i<r.length;i++){var a=r[i];e[a]=this[a]}if(e.hash=n.hash,n.href==="")return e.href=e.format(),e;if(n.slashes&&!n.protocol){for(var s=Object.keys(n),o=0;o<s.length;o++){var u=s[o];u!=="protocol"&&(e[u]=n[u])}return xa[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(n.protocol&&n.protocol!==e.protocol){if(!xa[n.protocol]){for(var h=Object.keys(n),l=0;l<h.length;l++){var c=h[l];e[c]=n[c]}return e.href=e.format(),e}if(e.protocol=n.protocol,!n.host&&!Oc[n.protocol]){for(var x=(n.pathname||"").split("/");x.length&&!(n.host=x.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),x[0]!==""&&x.unshift(""),x.length<2&&x.unshift(""),e.pathname=x.join("/")}else e.pathname=n.pathname;if(e.search=n.search,e.query=n.query,e.host=n.host||"",e.auth=n.auth,e.hostname=n.hostname||n.host,e.port=n.port,e.pathname||e.search){var f=e.pathname||"",d=e.search||"";e.path=f+d}return e.slashes=e.slashes||n.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",v=n.host||n.pathname&&n.pathname.charAt(0)==="/",m=v||p||e.host&&n.pathname,g=m,y=e.pathname&&e.pathname.split("/")||[],x=n.pathname&&n.pathname.split("/")||[],b=e.protocol&&!xa[e.protocol];if(b&&(e.hostname="",e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(x[0]===""?x[0]=n.host:x.unshift(n.host)),n.host=null),m=m&&(x[0]===""||y[0]==="")),v)e.host=n.host||n.host===""?n.host:e.host,e.hostname=n.hostname||n.hostname===""?n.hostname:e.hostname,e.search=n.search,e.query=n.query,y=x;else if(x.length)y||(y=[]),y.pop(),y=y.concat(x),e.search=n.search,e.query=n.query;else if(n.search!=null){if(b){e.host=y.shift(),e.hostname=e.host;var _=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;_&&(e.auth=_.shift(),e.hostname=_.shift(),e.host=e.hostname)}return e.search=n.search,e.query=n.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!y.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var w=y.slice(-1)[0],S=(e.host||n.host||y.length>1)&&(w==="."||w==="..")||w==="",E=0,T=y.length;T>=0;T--)w=y[T],w==="."?y.splice(T,1):w===".."?(y.splice(T,1),E++):E&&(y.splice(T,1),E--);if(!m&&!g)for(;E--;E)y.unshift("..");m&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),S&&y.join("/").substr(-1)!=="/"&&y.push("");var A=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(b){e.hostname=A?"":y.length?y.shift():"",e.host=e.hostname;var _=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;_&&(e.auth=_.shift(),e.hostname=_.shift(),e.host=e.hostname)}return m=m||e.host&&y.length,m&&!A&&y.unshift(""),y.length>0?e.pathname=y.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=n.auth||e.auth,e.slashes=e.slashes||n.slashes,e.href=e.format(),e};Ar.prototype.parseHost=function(){var n=this.host,t=XS.exec(n);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),n=n.substr(0,n.length-t.length)),n&&(this.hostname=n)};var ZS=yl,KS=qS,JS=$S;/*!
 * @pixi/utils - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ca={parse:ZS,format:JS,resolve:KS};ht.RETINA_PREFIX=/@([0-9\.]+)x/;ht.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Tv=!1,Av="6.5.10";function QS(n){var t;if(!Tv){if(ht.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var e=[`
 %c %c %c PixiJS `+Av+" -  "+n+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=globalThis.console).log.apply(t,e)}else globalThis.console&&globalThis.console.log("PixiJS "+Av+" - "+n+" - http://www.pixijs.com/");Tv=!0}}var au;function tE(){return typeof au>"u"&&(au=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:ht.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ht.ADAPTER.getWebGLRenderingContext())return!1;var e=ht.ADAPTER.createCanvas(),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!!(r&&r.getContextAttributes().stencil);if(r){var a=r.getExtension("WEBGL_lose_context");a&&a.loseContext()}return r=null,i}catch{return!1}}()),au}var eE="#f0f8ff",rE="#faebd7",nE="#00ffff",iE="#7fffd4",aE="#f0ffff",sE="#f5f5dc",oE="#ffe4c4",hE="#000000",lE="#ffebcd",uE="#0000ff",cE="#8a2be2",fE="#a52a2a",dE="#deb887",pE="#5f9ea0",vE="#7fff00",mE="#d2691e",gE="#ff7f50",yE="#6495ed",xE="#fff8dc",bE="#dc143c",_E="#00ffff",wE="#00008b",SE="#008b8b",EE="#b8860b",TE="#a9a9a9",AE="#006400",ME="#a9a9a9",PE="#bdb76b",IE="#8b008b",CE="#556b2f",RE="#ff8c00",FE="#9932cc",OE="#8b0000",BE="#e9967a",NE="#8fbc8f",kE="#483d8b",LE="#2f4f4f",DE="#2f4f4f",UE="#00ced1",VE="#9400d3",XE="#ff1493",zE="#00bfff",GE="#696969",YE="#696969",WE="#1e90ff",HE="#b22222",jE="#fffaf0",$E="#228b22",qE="#ff00ff",ZE="#dcdcdc",KE="#f8f8ff",JE="#daa520",QE="#ffd700",tT="#808080",eT="#008000",rT="#adff2f",nT="#808080",iT="#f0fff0",aT="#ff69b4",sT="#cd5c5c",oT="#4b0082",hT="#fffff0",lT="#f0e68c",uT="#fff0f5",cT="#e6e6fa",fT="#7cfc00",dT="#fffacd",pT="#add8e6",vT="#f08080",mT="#e0ffff",gT="#fafad2",yT="#d3d3d3",xT="#90ee90",bT="#d3d3d3",_T="#ffb6c1",wT="#ffa07a",ST="#20b2aa",ET="#87cefa",TT="#778899",AT="#778899",MT="#b0c4de",PT="#ffffe0",IT="#00ff00",CT="#32cd32",RT="#faf0e6",FT="#ff00ff",OT="#800000",BT="#66cdaa",NT="#0000cd",kT="#ba55d3",LT="#9370db",DT="#3cb371",UT="#7b68ee",VT="#00fa9a",XT="#48d1cc",zT="#c71585",GT="#191970",YT="#f5fffa",WT="#ffe4e1",HT="#ffe4b5",jT="#ffdead",$T="#000080",qT="#fdf5e6",ZT="#808000",KT="#6b8e23",JT="#ffa500",QT="#ff4500",tA="#da70d6",eA="#eee8aa",rA="#98fb98",nA="#afeeee",iA="#db7093",aA="#ffefd5",sA="#ffdab9",oA="#cd853f",hA="#ffc0cb",lA="#dda0dd",uA="#b0e0e6",cA="#800080",fA="#663399",dA="#ff0000",pA="#bc8f8f",vA="#4169e1",mA="#8b4513",gA="#fa8072",yA="#f4a460",xA="#2e8b57",bA="#fff5ee",_A="#a0522d",wA="#c0c0c0",SA="#87ceeb",EA="#6a5acd",TA="#708090",AA="#708090",MA="#fffafa",PA="#00ff7f",IA="#4682b4",CA="#d2b48c",RA="#008080",FA="#d8bfd8",OA="#ff6347",BA="#40e0d0",NA="#ee82ee",kA="#f5deb3",LA="#ffffff",DA="#f5f5f5",UA="#ffff00",VA="#9acd32",XA={aliceblue:eE,antiquewhite:rE,aqua:nE,aquamarine:iE,azure:aE,beige:sE,bisque:oE,black:hE,blanchedalmond:lE,blue:uE,blueviolet:cE,brown:fE,burlywood:dE,cadetblue:pE,chartreuse:vE,chocolate:mE,coral:gE,cornflowerblue:yE,cornsilk:xE,crimson:bE,cyan:_E,darkblue:wE,darkcyan:SE,darkgoldenrod:EE,darkgray:TE,darkgreen:AE,darkgrey:ME,darkkhaki:PE,darkmagenta:IE,darkolivegreen:CE,darkorange:RE,darkorchid:FE,darkred:OE,darksalmon:BE,darkseagreen:NE,darkslateblue:kE,darkslategray:LE,darkslategrey:DE,darkturquoise:UE,darkviolet:VE,deeppink:XE,deepskyblue:zE,dimgray:GE,dimgrey:YE,dodgerblue:WE,firebrick:HE,floralwhite:jE,forestgreen:$E,fuchsia:qE,gainsboro:ZE,ghostwhite:KE,goldenrod:JE,gold:QE,gray:tT,green:eT,greenyellow:rT,grey:nT,honeydew:iT,hotpink:aT,indianred:sT,indigo:oT,ivory:hT,khaki:lT,lavenderblush:uT,lavender:cT,lawngreen:fT,lemonchiffon:dT,lightblue:pT,lightcoral:vT,lightcyan:mT,lightgoldenrodyellow:gT,lightgray:yT,lightgreen:xT,lightgrey:bT,lightpink:_T,lightsalmon:wT,lightseagreen:ST,lightskyblue:ET,lightslategray:TT,lightslategrey:AT,lightsteelblue:MT,lightyellow:PT,lime:IT,limegreen:CT,linen:RT,magenta:FT,maroon:OT,mediumaquamarine:BT,mediumblue:NT,mediumorchid:kT,mediumpurple:LT,mediumseagreen:DT,mediumslateblue:UT,mediumspringgreen:VT,mediumturquoise:XT,mediumvioletred:zT,midnightblue:GT,mintcream:YT,mistyrose:WT,moccasin:HT,navajowhite:jT,navy:$T,oldlace:qT,olive:ZT,olivedrab:KT,orange:JT,orangered:QT,orchid:tA,palegoldenrod:eA,palegreen:rA,paleturquoise:nA,palevioletred:iA,papayawhip:aA,peachpuff:sA,peru:oA,pink:hA,plum:lA,powderblue:uA,purple:cA,rebeccapurple:fA,red:dA,rosybrown:pA,royalblue:vA,saddlebrown:mA,salmon:gA,sandybrown:yA,seagreen:xA,seashell:bA,sienna:_A,silver:wA,skyblue:SA,slateblue:EA,slategray:TA,slategrey:AA,snow:MA,springgreen:PA,steelblue:IA,tan:CA,teal:RA,thistle:FA,tomato:OA,turquoise:BA,violet:NA,wheat:kA,white:LA,whitesmoke:DA,yellow:UA,yellowgreen:VA};function Si(n,t){return t===void 0&&(t=[]),t[0]=(n>>16&255)/255,t[1]=(n>>8&255)/255,t[2]=(n&255)/255,t}function By(n){var t=n.toString(16);return t="000000".substring(0,6-t.length)+t,"#"+t}function Ny(n){return typeof n=="string"&&(n=XA[n.toLowerCase()]||n,n[0]==="#"&&(n=n.slice(1))),parseInt(n,16)}function su(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function zA(){for(var n=[],t=[],e=0;e<32;e++)n[e]=e,t[e]=e;n[at.NORMAL_NPM]=at.NORMAL,n[at.ADD_NPM]=at.ADD,n[at.SCREEN_NPM]=at.SCREEN,t[at.NORMAL]=at.NORMAL_NPM,t[at.ADD]=at.ADD_NPM,t[at.SCREEN]=at.SCREEN_NPM;var r=[];return r.push(t),r.push(n),r}var ky=zA();function Ly(n,t){return ky[t?1:0][n]}function GA(n,t,e,r){return e=e||new Float32Array(4),r||r===void 0?(e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t):(e[0]=n[0],e[1]=n[1],e[2]=n[2]),e[3]=t,e}function rd(n,t){if(t===1)return(t*255<<24)+n;if(t===0)return 0;var e=n>>16&255,r=n>>8&255,i=n&255;return e=e*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(t*255<<24)+(e<<16)+(r<<8)+i}function Dy(n,t,e,r){return e=e||new Float32Array(4),e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,(r||r===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function YA(n,t){t===void 0&&(t=null);var e=n*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+e);for(var r=0,i=0;r<e;r+=6,i+=4)t[r+0]=i+0,t[r+1]=i+1,t[r+2]=i+2,t[r+3]=i+0,t[r+4]=i+2,t[r+5]=i+3;return t}function Uy(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function Vh(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function Mv(n){return!(n&n-1)&&!!n}function Pv(n){var t=(n>65535?1:0)<<4;n>>>=t;var e=(n>255?1:0)<<3;return n>>>=e,t|=e,e=(n>15?1:0)<<2,n>>>=e,t|=e,e=(n>3?1:0)<<1,n>>>=e,t|=e,t|n>>1}function ba(n,t,e){var r=n.length,i;if(!(t>=r||e===0)){e=t+e>r?r-t:e;var a=r-e;for(i=t;i<a;++i)n[i]=n[i+e];n.length=a}}function fa(n){return n===0?0:n<0?-1:1}var WA=0;function Ei(){return++WA}var Iv={};function Mr(n,t,e){if(e===void 0&&(e=3),!Iv[t]){var r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+n):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+`
Deprecated since v`+n),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+n),console.warn(r))),Iv[t]=!0}}var Cv={},on=Object.create(null),qn=Object.create(null),Rv=function(){function n(t,e,r){this.canvas=ht.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=r||ht.RESOLUTION,this.resize(t,e)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},n.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),n}();function HA(n){var t=n.width,e=n.height,r=n.getContext("2d",{willReadFrequently:!0}),i=r.getImageData(0,0,t,e),a=i.data,s=a.length,o={top:null,left:null,right:null,bottom:null},u=null,h,l,c;for(h=0;h<s;h+=4)a[h+3]!==0&&(l=h/4%t,c=~~(h/4/t),o.top===null&&(o.top=c),(o.left===null||l<o.left)&&(o.left=l),(o.right===null||o.right<l)&&(o.right=l+1),(o.bottom===null||o.bottom<c)&&(o.bottom=c));return o.top!==null&&(t=o.right-o.left,e=o.bottom-o.top+1,u=r.getImageData(o.left,o.top,t,e)),{height:e,width:t,data:u}}var Eo;function jA(n,t){if(t===void 0&&(t=globalThis.location),n.indexOf("data:")===0)return"";t=t||globalThis.location,Eo||(Eo=document.createElement("a")),Eo.href=n;var e=ca.parse(Eo.href),r=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!r||e.protocol!==t.protocol?"anonymous":""}function Xh(n,t){var e=ht.RETINA_PREFIX.exec(n);return e?parseFloat(e[1]):t!==void 0?t:1}/*!
 * @pixi/math - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var zh=Math.PI*2,$A=180/Math.PI,qA=Math.PI/180,Me;(function(n){n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC"})(Me||(Me={}));var Ut=function(){function n(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},n.prototype.copyTo=function(t){return t.set(this.x,this.y),t},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},n.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x=t,this.y=e,this},n.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},n}(),To=[new Ut,new Ut,new Ut,new Ut],St=function(){function n(t,e,r,i){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Me.RECT}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n,"EMPTY",{get:function(){return new n(0,0,0,0)},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},n.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},n.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},n.prototype.intersects=function(t,e){if(!e){var r=this.x<t.x?t.x:this.x,i=this.right>t.right?t.right:this.right;if(i<=r)return!1;var a=this.y<t.y?t.y:this.y,s=this.bottom>t.bottom?t.bottom:this.bottom;return s>a}var o=this.left,u=this.right,h=this.top,l=this.bottom;if(u<=o||l<=h)return!1;var c=To[0].set(t.left,t.top),f=To[1].set(t.left,t.bottom),d=To[2].set(t.right,t.top),p=To[3].set(t.right,t.bottom);if(d.x<=c.x||f.y<=c.y)return!1;var v=Math.sign(e.a*e.d-e.b*e.c);if(v===0||(e.apply(c,c),e.apply(f,f),e.apply(d,d),e.apply(p,p),Math.max(c.x,f.x,d.x,p.x)<=o||Math.min(c.x,f.x,d.x,p.x)>=u||Math.max(c.y,f.y,d.y,p.y)<=h||Math.min(c.y,f.y,d.y,p.y)>=l))return!1;var m=v*(f.y-c.y),g=v*(c.x-f.x),y=m*o+g*h,x=m*u+g*h,b=m*o+g*l,_=m*u+g*l;if(Math.max(y,x,b,_)<=m*c.x+g*c.y||Math.min(y,x,b,_)>=m*p.x+g*p.y)return!1;var w=v*(c.y-d.y),S=v*(d.x-c.x),E=w*o+S*h,T=w*u+S*h,A=w*o+S*l,P=w*u+S*l;return!(Math.max(E,T,A,P)<=w*c.x+S*c.y||Math.min(E,T,A,P)>=w*p.x+S*p.y)},n.prototype.pad=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this},n.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),a=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(a-i,0),this},n.prototype.ceil=function(t,e){t===void 0&&(t=1),e===void 0&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},n.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),a=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=a-i,this},n.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),ZA=function(){function n(t,e,r){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Me.CIRC}return n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,a=this.y-e;return i*=i,a*=a,i+a<=r},n.prototype.getBounds=function(){return new St(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},n.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},n}(),KA=function(){function n(t,e,r,i){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Me.ELIP}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return r*=r,i*=i,r+i<=1},n.prototype.getBounds=function(){return new St(this.x-this.width,this.y-this.height,this.width,this.height)},n.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),gs=function(){function n(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){for(var a=[],s=0,o=i.length;s<o;s++)a.push(i[s].x,i[s].y);i=a}this.points=i,this.type=Me.POLY,this.closeStroke=!0}return n.prototype.clone=function(){var t=this.points.slice(),e=new n(t);return e.closeStroke=this.closeStroke,e},n.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,a=0,s=i-1;a<i;s=a++){var o=this.points[a*2],u=this.points[a*2+1],h=this.points[s*2],l=this.points[s*2+1],c=u>e!=l>e&&t<(h-o)*((e-u)/(l-u))+o;c&&(r=!r)}return r},n.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(t,e){return t+", "+e},"")+"]")},n}(),JA=function(){function n(t,e,r,i,a){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=a,this.type=Me.RREC}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)},n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;var i=t-(this.x+r),a=e-(this.y+r),s=r*r;if(i*i+a*a<=s||(i=t-(this.x+this.width-r),i*i+a*a<=s)||(a=e-(this.y+this.height-r),i*i+a*a<=s)||(i=t-(this.x+r),i*i+a*a<=s))return!0}return!1},n.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},n}(),da=function(){function n(t,e,r,i){r===void 0&&(r=0),i===void 0&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return n.prototype.clone=function(t,e){return t===void 0&&(t=this.cb),e===void 0&&(e=this.scope),new n(t,e,this._x,this._y)},n.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this},n.prototype.copyFrom=function(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},n.prototype.copyTo=function(t){return t.set(this._x,this._y),t},n.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},n.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),n}(),te=function(){function n(t,e,r,i,a,s){t===void 0&&(t=1),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=1),a===void 0&&(a=0),s===void 0&&(s=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=a,this.ty=s}return n.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},n.prototype.set=function(t,e,r,i,a,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=a,this.ty=s,this},n.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},n.prototype.apply=function(t,e){e=e||new Ut;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},n.prototype.applyInverse=function(t,e){e=e||new Ut;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,a=t.y;return e.x=this.d*r*i+-this.c*r*a+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*a+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},n.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},n.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},n.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,a=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=a*e-this.d*r,this.d=a*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this},n.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,a=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*a,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*a,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*a+this.ty,this},n.prototype.setTransform=function(t,e,r,i,a,s,o,u,h){return this.a=Math.cos(o+h)*a,this.b=Math.sin(o+h)*a,this.c=-Math.sin(o-u)*s,this.d=Math.cos(o-u)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},n.prototype.prepend=function(t){var e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},n.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,a=this.d,s=t.pivot,o=-Math.atan2(-i,a),u=Math.atan2(r,e),h=Math.abs(o+u);return h<1e-5||Math.abs(zh-h)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=u),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+a*a),t.position.x=this.tx+(s.x*e+s.y*i),t.position.y=this.ty+(s.x*r+s.y*a),t},n.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,a=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*a)/s,this.ty=-(t*this.ty-e*a)/s,this},n.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.prototype.clone=function(){var t=new n;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},n.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(n,"IDENTITY",{get:function(){return new n},enumerable:!1,configurable:!0}),Object.defineProperty(n,"TEMP_MATRIX",{get:function(){return new n},enumerable:!1,configurable:!0}),n}(),si=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],oi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],hi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],li=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Nc=[],Vy=[],Ao=Math.sign;function QA(){for(var n=0;n<16;n++){var t=[];Nc.push(t);for(var e=0;e<16;e++)for(var r=Ao(si[n]*si[e]+hi[n]*oi[e]),i=Ao(oi[n]*si[e]+li[n]*oi[e]),a=Ao(si[n]*hi[e]+hi[n]*li[e]),s=Ao(oi[n]*hi[e]+li[n]*li[e]),o=0;o<16;o++)if(si[o]===r&&oi[o]===i&&hi[o]===a&&li[o]===s){t.push(o);break}}for(var n=0;n<16;n++){var u=new te;u.set(si[n],oi[n],hi[n],li[n],0,0),Vy.push(u)}}QA();var Ht={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(n){return si[n]},uY:function(n){return oi[n]},vX:function(n){return hi[n]},vY:function(n){return li[n]},inv:function(n){return n&8?n&15:-n&7},add:function(n,t){return Nc[n][t]},sub:function(n,t){return Nc[n][Ht.inv(t)]},rotate180:function(n){return n^4},isVertical:function(n){return(n&3)===2},byDirection:function(n,t){return Math.abs(n)*2<=Math.abs(t)?t>=0?Ht.S:Ht.N:Math.abs(t)*2<=Math.abs(n)?n>0?Ht.E:Ht.W:t>0?n>0?Ht.SE:Ht.SW:n>0?Ht.NE:Ht.NW},matrixAppendRotationInv:function(n,t,e,r){e===void 0&&(e=0),r===void 0&&(r=0);var i=Vy[Ht.inv(t)];i.tx=e,i.ty=r,n.append(i)}},nd=function(){function n(){this.worldTransform=new te,this.localTransform=new te,this.position=new da(this.onChange,this,0,0),this.scale=new da(this.onChange,this,1,1),this.pivot=new da(this.onChange,this,0,0),this.skew=new da(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return n.prototype.onChange=function(){this._localID++},n.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},n.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},n.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},n.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},n.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),n.IDENTITY=new n,n}();/*!
 * @pixi/display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ht.SORTABLE_CHILDREN=!1;var Gh=function(){function n(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return n.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},n.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},n.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?St.EMPTY:(t=t||new St(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},n.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},n.prototype.addPointMatrix=function(t,e){var r=t.a,i=t.b,a=t.c,s=t.d,o=t.tx,u=t.ty,h=r*e.x+a*e.y+o,l=i*e.x+s*e.y+u;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)},n.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,a=this.maxY,s=t[0],o=t[1];e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,a=o>a?o:a,s=t[2],o=t[3],e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,a=o>a?o:a,s=t[4],o=t[5],e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,a=o>a?o:a,s=t[6],o=t[7],e=s<e?s:e,r=o<r?o:r,i=s>i?s:i,a=o>a?o:a,this.minX=e,this.minY=r,this.maxX=i,this.maxY=a},n.prototype.addFrame=function(t,e,r,i,a){this.addFrameMatrix(t.worldTransform,e,r,i,a)},n.prototype.addFrameMatrix=function(t,e,r,i,a){var s=t.a,o=t.b,u=t.c,h=t.d,l=t.tx,c=t.ty,f=this.minX,d=this.minY,p=this.maxX,v=this.maxY,m=s*e+u*r+l,g=o*e+h*r+c;f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=s*i+u*r+l,g=o*i+h*r+c,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=s*e+u*a+l,g=o*e+h*a+c,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=s*i+u*a+l,g=o*i+h*a+c,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,this.minX=f,this.minY=d,this.maxX=p,this.maxY=v},n.prototype.addVertexData=function(t,e,r){for(var i=this.minX,a=this.minY,s=this.maxX,o=this.maxY,u=e;u<r;u+=2){var h=t[u],l=t[u+1];i=h<i?h:i,a=l<a?l:a,s=h>s?h:s,o=l>o?l:o}this.minX=i,this.minY=a,this.maxX=s,this.maxY=o},n.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},n.prototype.addVerticesMatrix=function(t,e,r,i,a,s){a===void 0&&(a=0),s===void 0&&(s=a);for(var o=t.a,u=t.b,h=t.c,l=t.d,c=t.tx,f=t.ty,d=this.minX,p=this.minY,v=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=e[g],x=e[g+1],b=o*y+h*x+c,_=l*x+u*y+f;d=Math.min(d,b-a),v=Math.max(v,b+a),p=Math.min(p,_-s),m=Math.max(m,_+s)}this.minX=d,this.minY=p,this.maxX=v,this.maxY=m},n.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,a=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>a?t.maxY:a},n.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,a=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=a&&i<=s){var o=this.minX,u=this.minY,h=this.maxX,l=this.maxY;this.minX=r<o?r:o,this.minY=i<u?i:u,this.maxX=a>h?a:h,this.maxY=s>l?s:l}},n.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},n.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,a=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=a&&i<=s){var o=this.minX,u=this.minY,h=this.maxX,l=this.maxY;this.minX=r<o?r:o,this.minY=i<u?i:u,this.maxX=a>h?a:h,this.maxY=s>l?s:l}},n.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},n.prototype.addFramePad=function(t,e,r,i,a,s){t-=a,e-=s,r+=a,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kc=function(n,t){return kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},kc(n,t)};function id(n,t){kc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var ae=function(n){id(t,n);function t(){var e=n.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new nd,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Gh,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return t.mixin=function(e){for(var r=Object.keys(e),i=0;i<r.length;++i){var a=r[i];Object.defineProperty(t.prototype,a,Object.getOwnPropertyDescriptor(e,a))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new St),r=this._boundsRect),this._bounds.getRectangle(r)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new St),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Gh);var r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var a=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,e);return this.parent=i,this.transform=r,this._bounds=a,this._bounds.updateID+=this._boundsID-s,o},t.prototype.toGlobal=function(e,r,i){return i===void 0&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)},t.prototype.toLocal=function(e,r,i,a){return r&&(e=r.toGlobal(e,i,a)),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,r,i,a,s,o,u,h,l){return e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=1),a===void 0&&(a=1),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),h===void 0&&(h=0),l===void 0&&(l=0),this.position.x=e,this.position.y=r,this.scale.x=i||1,this.scale.y=a||1,this.rotation=s,this.skew.x=o,this.skew.y=u,this.pivot.x=h,this.pivot.y=l,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Xy),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*$A},set:function(e){this.transform.rotation=e*qA},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){if(this._mask){var r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){var r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}},enumerable:!1,configurable:!0}),t}(ao),Xy=function(n){id(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.sortDirty=null,e}return t}(ae);ae.prototype.displayObjectUpdateTransform=ae.prototype.updateTransform;function tM(n,t){return n.zIndex===t.zIndex?n._lastSortedIndex-t._lastSortedIndex:n.zIndex-t.zIndex}var $e=function(n){id(t,n);function t(){var e=n.call(this)||this;return e.children=[],e.sortableChildren=ht.SORTABLE_CHILDREN,e.sortDirty=!1,e}return t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];if(r.length>1)for(var a=0;a<r.length;a++)this.addChild(r[a]);else{var s=r[0];s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.push(s),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this)}return r[0]},t.prototype.addChildAt=function(e,r){if(r<0||r>this.children.length)throw new Error(e+"addChildAt: The index "+r+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e},t.prototype.swapChildren=function(e,r){if(e!==r){var i=this.getChildIndex(e),a=this.getChildIndex(r);this.children[i]=r,this.children[a]=e,this.onChildrenChange(i<a?i:a)}},t.prototype.getChildIndex=function(e){var r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r},t.prototype.setChildIndex=function(e,r){if(r<0||r>=this.children.length)throw new Error("The index "+r+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(e);ba(this.children,i,1),this.children.splice(r,0,e),this.onChildrenChange(r)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];if(r.length>1)for(var a=0;a<r.length;a++)this.removeChild(r[a]);else{var s=r[0],o=this.children.indexOf(s);if(o===-1)return null;s.parent=null,s.transform._parentID=-1,ba(this.children,o,1),this._boundsID++,this.onChildrenChange(o),s.emit("removed",this),this.emit("childRemoved",s,this,o)}return r[0]},t.prototype.removeChildAt=function(e){var r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,ba(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r},t.prototype.removeChildren=function(e,r){e===void 0&&(e=0),r===void 0&&(r=this.children.length);var i=e,a=r,s=a-i,o;if(s>0&&s<=a){o=this.children.splice(i,s);for(var u=0;u<o.length;++u)o[u].parent=null,o[u].transform&&(o[u].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var u=0;u<o.length;++u)o[u].emit("removed",this),this.emit("childRemoved",o[u],this,u);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,r=0,i=this.children.length;r<i;++r){var a=this.children[r];a._lastSortedIndex=r,!e&&a.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(tM),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,r=this.children.length;e<r;++e){var i=this.children[e];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var r=this.children[e];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){var i=r._mask.isMaskData?r._mask.maskObject:r._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(r._bounds,i._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,r){r===void 0&&(r=!1);var i=n.prototype.getLocalBounds.call(this,e);if(!r)for(var a=0,s=this.children.length;a<s;++a){var o=this.children[a];o.visible&&o.updateTransform()}return i},t.prototype._calculateBounds=function(){},t.prototype._renderWithCulling=function(e){var r=e.renderTexture.sourceFrame;if(r.width>0&&r.height>0){var i,a;if(this.cullArea?(i=this.cullArea,a=this.worldTransform):this._render!==t.prototype._render&&(i=this.getBounds(!0)),i&&r.intersects(i,a))this._render(e);else if(this.cullArea)return;for(var s=0,o=this.children.length;s<o;++s){var u=this.children[s],h=u.cullable;u.cullable=h||!this.cullArea,u.render(e),u.cullable=h}}},t.prototype.render=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var r=0,i=this.children.length;r<i;++r)this.children[r].render(e)}},t.prototype.renderAdvanced=function(e){var r=this.filters,i=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var a=0;a<r.length;a++)r[a].enabled&&this._enabledFilters.push(r[a])}var s=r&&this._enabledFilters&&this._enabledFilters.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==he.NONE));if(s&&e.batch.flush(),r&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(var a=0,o=this.children.length;a<o;++a)this.children[a].render(e)}s&&e.batch.flush(),i&&e.mask.pop(this),r&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){n.prototype.destroy.call(this),this.sortDirty=!1;var r=typeof e=="boolean"?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var a=0;a<i.length;++a)i[a].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var r=this.getLocalBounds().width;r!==0?this.scale.x=e/r:this.scale.x=1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var r=this.getLocalBounds().height;r!==0?this.scale.y=e/r:this.scale.y=1,this._height=e},enumerable:!1,configurable:!0}),t}(ae);$e.prototype.containerUpdateTransform=$e.prototype.updateTransform;/*!
 * @pixi/extensions - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ys=function(){return ys=Object.assign||function(t){for(var e=arguments,r,i=1,a=arguments.length;i<a;i++){r=e[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ys.apply(this,arguments)},Bt;(function(n){n.Application="application",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Loader="loader",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser"})(Bt||(Bt={}));var Fv=function(n){if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");var t=typeof n.extension!="object"?{type:n.extension}:n.extension;n=ys(ys({},t),{ref:n})}if(typeof n=="object")n=ys({},n);else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},gn={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var n=arguments,t=this,e=[],r=0;r<arguments.length;r++)e[r]=n[r];return e.map(Fv).forEach(function(i){i.type.forEach(function(a){var s,o;return(o=(s=t._removeHandlers)[a])===null||o===void 0?void 0:o.call(s,i)})}),this},add:function(){for(var n=arguments,t=this,e=[],r=0;r<arguments.length;r++)e[r]=n[r];return e.map(Fv).forEach(function(i){i.type.forEach(function(a){var s=t._addHandlers,o=t._queue;s[a]?s[a](i):(o[a]=o[a]||[],o[a].push(i))})}),this},handle:function(n,t,e){var r=this._addHandlers=this._addHandlers||{},i=this._removeHandlers=this._removeHandlers||{};if(r[n]||i[n])throw new Error("Extension type "+n+" already has a handler");r[n]=t,i[n]=e;var a=this._queue;return a[n]&&(a[n].forEach(function(s){return t(s)}),delete a[n]),this},handleByMap:function(n,t){return this.handle(n,function(e){t[e.name]=e.ref},function(e){delete t[e.name]})},handleByList:function(n,t){return this.handle(n,function(e){var r,i;t.includes(e.ref)||(t.push(e.ref),n===Bt.Loader&&((i=(r=e.ref).add)===null||i===void 0||i.call(r)))},function(e){var r=t.indexOf(e.ref);r!==-1&&t.splice(r,1)})}};/*!
 * @pixi/runner - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Re=function(){function n(t){this.items=[],this._name=t,this._aliasCount=0}return n.prototype.emit=function(t,e,r,i,a,s,o,u){if(arguments.length>8)throw new Error("max arguments reached");var h=this,l=h.name,c=h.items;this._aliasCount++;for(var f=0,d=c.length;f<d;f++)c[f][l](t,e,r,i,a,s,o,u);return c===this.items&&this._aliasCount--,this},n.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},n.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},n.prototype.remove=function(t){var e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},n.prototype.contains=function(t){return this.items.indexOf(t)!==-1},n.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},n.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(n.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),n}();Object.defineProperties(Re.prototype,{dispatch:{value:Re.prototype.emit},run:{value:Re.prototype.emit}});/*!
 * @pixi/ticker - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ht.TARGET_FPMS=.06;var mn;(function(n){n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY"})(mn||(mn={}));var ou=function(){function n(t,e,r,i){e===void 0&&(e=null),r===void 0&&(r=0),i===void 0&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=i}return n.prototype.match=function(t,e){return e===void 0&&(e=null),this.fn===t&&this.context===e},n.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},n.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},n.prototype.destroy=function(t){t===void 0&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},n}(),Fe=function(){function n(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ou(null,null,1/0),this.deltaMS=1/ht.TARGET_FPMS,this.elapsedMS=1/ht.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return n.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},n.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},n.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},n.prototype.add=function(t,e,r){return r===void 0&&(r=mn.NORMAL),this._addListener(new ou(t,e,r))},n.prototype.addOnce=function(t,e,r){return r===void 0&&(r=mn.NORMAL),this._addListener(new ou(t,e,r,!0))},n.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this},n.prototype.remove=function(t,e){for(var r=this._head.next;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(n.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},n.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},n.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},n.prototype.update=function(t){t===void 0&&(t=performance.now());var e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ht.TARGET_FPMS;for(var i=this._head,a=i.next;a;)a=a.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(n.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,ht.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(t===0)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"shared",{get:function(){if(!n._shared){var t=n._shared=new n;t.autoStart=!0,t._protected=!0}return n._shared},enumerable:!1,configurable:!0}),Object.defineProperty(n,"system",{get:function(){if(!n._system){var t=n._system=new n;t.autoStart=!0,t._protected=!0}return n._system},enumerable:!1,configurable:!0}),n}(),eM=function(){function n(){}return n.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,mn.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Fe.shared:new Fe,t.autoStart&&this.start()},n.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},n.extension=Bt.Application,n}();/*!
 * @pixi/core - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ht.PREFER_ENV=Vr.any?vn.WEBGL:vn.WEBGL2;ht.STRICT_TEXTURE_CACHE=!1;var Lc=[];function zy(n,t){if(!n)return null;var e="";if(typeof n=="string"){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);r&&(e=r[1].toLowerCase())}for(var i=Lc.length-1;i>=0;--i){var a=Lc[i];if(a.test&&a.test(n,e))return new a(n,t)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dc=function(n,t){return Dc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Dc(n,t)};function kt(n,t){Dc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Uc=function(){return Uc=Object.assign||function(t){for(var e=arguments,r,i=1,a=arguments.length;i<a;i++){r=e[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Uc.apply(this,arguments)};function rM(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e}var Os=function(){function n(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Re("setRealSize"),this.onUpdate=new Re("update"),this.onError=new Re("onError")}return n.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},n.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},n.prototype.resize=function(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(n.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.destroyed||this.onUpdate.emit()},n.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),n.prototype.style=function(t,e,r){return!1},n.prototype.dispose=function(){},n.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},n.test=function(t,e){return!1},n}(),lo=function(n){kt(t,n);function t(e,r){var i=this,a=r||{},s=a.width,o=a.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return i=n.call(this,s,o)||this,i.data=e,i}return t.prototype.upload=function(e,r,i){var a=e.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===sr.UNPACK);var s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?a.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,a.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(Os),nM={scaleMode:je.NEAREST,format:et.RGBA,alphaMode:sr.NPM},Mt=function(n){kt(t,n);function t(e,r){e===void 0&&(e=null),r===void 0&&(r=null);var i=n.call(this)||this;r=r||{};var a=r.alphaMode,s=r.mipmap,o=r.anisotropicLevel,u=r.scaleMode,h=r.width,l=r.height,c=r.wrapMode,f=r.format,d=r.type,p=r.target,v=r.resolution,m=r.resourceOptions;return e&&!(e instanceof Os)&&(e=zy(e,m),e.internal=!0),i.resolution=v||ht.RESOLUTION,i.width=Math.round((h||0)*i.resolution)/i.resolution,i.height=Math.round((l||0)*i.resolution)/i.resolution,i._mipmap=s!==void 0?s:ht.MIPMAP_TEXTURES,i.anisotropicLevel=o!==void 0?o:ht.ANISOTROPIC_LEVEL,i._wrapMode=c||ht.WRAP_MODE,i._scaleMode=u!==void 0?u:ht.SCALE_MODE,i.format=f||et.RGBA,i.type=d||ut.UNSIGNED_BYTE,i.target=p||gi.TEXTURE_2D,i.alphaMode=a!==void 0?a:sr.UNPACK,i.uid=Ei(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=h>0&&l>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mipmap",{get:function(){return this._mipmap},set:function(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,r){var i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,i=!0),i&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,r,i){return i=i||this.resolution,this.setRealSize(e*i,r*i,i)},t.prototype.setRealSize=function(e,r,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(r)/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Mv(this.realWidth)&&Mv(this.realHeight)},t.prototype.setResolution=function(e){var r=this.resolution;return r===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*r)/e,this.height=Math.round(this.height*r)/e,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete qn[this.cacheId],delete on[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,i){i===void 0&&(i=ht.STRICT_TEXTURE_CACHE);var a=typeof e=="string",s=null;if(a)s=e;else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+Ei()}s=e._pixiId}var u=qn[s];if(a&&i&&!u)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return u||(u=new t(e,r),u.cacheId=s,t.addToCache(u,s)),u},t.fromBuffer=function(e,r,i,a){e=e||new Float32Array(r*i*4);var s=new lo(e,{width:r,height:i}),o=e instanceof Float32Array?ut.FLOAT:ut.UNSIGNED_BYTE;return new t(s,Object.assign({},nM,a||{width:r,height:i,type:o}))},t.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),qn[r]&&console.warn("BaseTexture added to the cache with an id ["+r+"] that already had an entry"),qn[r]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var r=qn[e];if(r){var i=r.textureCacheIds.indexOf(e);return i>-1&&r.textureCacheIds.splice(i,1),delete qn[e],r}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)delete qn[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(ao),Gy=function(n){kt(t,n);function t(e,r){var i=this,a=r||{},s=a.width,o=a.height;i=n.call(this,s,o)||this,i.items=[],i.itemDirtyIds=[];for(var u=0;u<e;u++){var h=new Mt;i.items.push(h),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return t.prototype.initFromArray=function(e,r){for(var i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof Os?this.addResourceAt(e[i],i):this.addResourceAt(zy(e[i],r),i))},t.prototype.dispose=function(){for(var e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,r){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this},t.prototype.bind=function(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");n.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},t.prototype.unbind=function(e){n.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.items.map(function(a){return a.resource}).filter(function(a){return a}),i=r.map(function(a){return a.load()});return this._load=Promise.all(i).then(function(){var a=e.items[0],s=a.realWidth,o=a.realHeight;return e.resize(s,o),Promise.resolve(e)}),this._load},t}(Os),iM=function(n){kt(t,n);function t(e,r){var i=this,a=r||{},s=a.width,o=a.height,u,h;return Array.isArray(e)?(u=e,h=e.length):h=e,i=n.call(this,h,{width:s,height:o})||this,u&&i.initFromArray(u,r),i}return t.prototype.addBaseTextureAt=function(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this},t.prototype.bind=function(e){n.prototype.bind.call(this,e),e.target=gi.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,r,i){var a=this,s=a.length,o=a.itemDirtyIds,u=a.items,h=e.gl;i.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,r.format,i.type,null);for(var l=0;l<s;l++){var c=u[l];o[l]<c.dirtyId&&(o[l]=c.dirtyId,c.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,l,c.resource.width,c.resource.height,1,r.format,i.type,c.resource.source))}return!0},t}(Gy),Xn=function(n){kt(t,n);function t(e){var r=this,i=e,a=i.naturalWidth||i.videoWidth||i.width,s=i.naturalHeight||i.videoHeight||i.height;return r=n.call(this,a,s)||this,r.source=e,r.noSubImage=!1,r}return t.crossOrigin=function(e,r,i){i===void 0&&r.indexOf("data:")!==0?e.crossOrigin=jA(r):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")},t.prototype.upload=function(e,r,i,a){var s=e.gl,o=r.realWidth,u=r.realHeight;if(a=a||this.source,a instanceof HTMLImageElement){if(!a.complete||a.naturalWidth===0)return!1}else if(a instanceof HTMLVideoElement&&a.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===sr.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&i.width===o&&i.height===u?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,i.type,a):(i.width=o,i.height=u,s.texImage2D(r.target,0,i.internalFormat,r.format,i.type,a)),!0},t.prototype.update=function(){if(!this.destroyed){var e=this.source,r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(r,i),n.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Os),aM=function(n){kt(t,n);function t(e){return n.call(this,e)||this}return t.test=function(e){var r=globalThis.OffscreenCanvas;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement},t}(Xn),sM=function(n){kt(t,n);function t(e,r){var i=this,a=r||{},s=a.width,o=a.height,u=a.autoLoad,h=a.linkBaseTexture;if(e&&e.length!==t.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");i=n.call(this,6,{width:s,height:o})||this;for(var l=0;l<t.SIDES;l++)i.items[l].target=gi.TEXTURE_CUBE_MAP_POSITIVE_X+l;return i.linkBaseTexture=h!==!1,e&&i.initFromArray(e,r),u!==!1&&i.load(),i}return t.prototype.bind=function(e){n.prototype.bind.call(this,e),e.target=gi.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,r,i){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=gi.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this},t.prototype.upload=function(e,r,i){for(var a=this.itemDirtyIds,s=0;s<t.SIDES;s++){var o=this.items[s];(a[s]<o.dirtyId||i.dirtyId<r.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),a[s]=o.dirtyId):a[s]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),a[s]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(Gy),Yy=function(n){kt(t,n);function t(e,r){var i=this;if(r=r||{},!(e instanceof HTMLImageElement)){var a=new Image;Xn.crossOrigin(a,e,r.crossorigin),a.src=e,e=a}return i=n.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(r.createBitmap!==void 0?r.createBitmap:ht.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,i.bitmap=null,i._load=null,r.autoLoad!==!1&&i.load(),i}return t.prototype.load=function(e){var r=this;return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise(function(i,a){var s=r.source;r.url=s.src;var o=function(){r.destroyed||(s.onload=null,s.onerror=null,r.resize(s.width,s.height),r._load=null,r.createBitmap?i(r.process()):i(r))};s.complete&&s.src?o():(s.onload=o,s.onerror=function(u){a(u),r.onError.emit(u)})}),this._load)},t.prototype.process=function(){var e=this,r=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var i=globalThis.createImageBitmap,a=!r.crossOrigin||r.crossOrigin==="anonymous";return this._process=fetch(r.src,{mode:a?"cors":"no-cors"}).then(function(s){return s.blob()}).then(function(s){return i(s,0,0,r.width,r.height,{premultiplyAlpha:e.alphaMode===null||e.alphaMode===sr.UNPACK?"premultiply":"none"})}).then(function(s){return e.destroyed?Promise.reject():(e.bitmap=s,e.update(),e._process=null,Promise.resolve(e))}),this._process},t.prototype.upload=function(e,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return n.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(n.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var a=!0,s=r._glTextures;for(var o in s){var u=s[o];if(u!==i&&u.dirtyId!==r.dirtyId){a=!1;break}}a&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,n.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return typeof e=="string"||e instanceof HTMLImageElement},t}(Xn),oM=function(n){kt(t,n);function t(e,r){var i=this;return r=r||{},i=n.call(this,ht.ADAPTER.createCanvas())||this,i._width=0,i._height=0,i.svg=e,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,r.autoLoad!==!1&&i.load(),i}return t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(r){if(e._resolve=function(){e.resize(e.source.width,e.source.height),r(e)},t.SVG_XML.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,r=new Image;Xn.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(i){e._resolve&&(r.onerror=null,e.onError.emit(i))},r.onload=function(){if(e._resolve){var i=r.width,a=r.height;if(!i||!a)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var s=i*e.scale,o=a*e.scale;(e._overrideWidth||e._overrideHeight)&&(s=e._overrideWidth||e._overrideHeight/a*i,o=e._overrideHeight||e._overrideWidth/i*a),s=Math.round(s),o=Math.round(o);var u=e.source;u.width=s,u.height=o,u._pixiId="canvas_"+Ei(),u.getContext("2d").drawImage(r,0,0,i,a,0,0,s,o),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},t.prototype.dispose=function(){n.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,r){return r==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&t.SVG_XML.test(e)},t.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(Xn),hM=function(n){kt(t,n);function t(e,r){var i=this;if(r=r||{},!(e instanceof HTMLVideoElement)){var a=document.createElement("video");a.setAttribute("preload","auto"),a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);var s=e[0].src||e[0];Xn.crossOrigin(a,s,r.crossorigin);for(var o=0;o<e.length;++o){var u=document.createElement("source"),h=e[o],l=h.src,c=h.mime;l=l||e[o];var f=l.split("?").shift().toLowerCase(),d=f.slice(f.lastIndexOf(".")+1);c=c||t.MIME_TYPES[d]||"video/"+d,u.src=l,u.type=c,a.appendChild(u)}e=a}return i=n.call(this,e)||this,i.noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=r.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=r.autoPlay!==!1,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),r.autoLoad!==!1&&i.load(),i}return t.prototype.update=function(e){if(!this.destroyed){var r=Fe.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(n.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.source;return(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart.bind(this)),r.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise(function(i){e.valid?i(e):(e._resolve=i,r.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()},t.prototype._isSourceReady=function(){var e=this.source;return e.readyState>2},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Fe.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Fe.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var r=this.valid;this.resize(e.videoWidth,e.videoHeight),!r&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&(Fe.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),n.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Fe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Fe.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(Xn),lM=function(n){kt(t,n);function t(e){return n.call(this,e)||this}return t.test=function(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&e instanceof ImageBitmap},t}(Xn);Lc.push(Yy,lM,aM,hM,oM,lo,sM,iM);var uM=function(n){kt(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.upload=function(e,r,i){var a=e.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===sr.UNPACK);var s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?a.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,a.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0},t}(lo),Vc=function(){function n(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Re("disposeFramebuffer"),this.multisample=Xt.NONE}return Object.defineProperty(n.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),n.prototype.addColorTexture=function(t,e){return t===void 0&&(t=0),this.colorTextures[t]=e||new Mt(null,{scaleMode:je.NEAREST,resolution:1,mipmap:qe.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Mt(new uM(null,{width:this.width,height:this.height}),{scaleMode:je.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:qe.OFF,format:et.DEPTH_COMPONENT,type:ut.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],a=i.resolution;i.setSize(t/a,e/a)}if(this.depthTexture){var a=this.depthTexture.resolution;this.depthTexture.setSize(t/a,e/a)}}},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},n}(),Wy=function(n){kt(t,n);function t(e){e===void 0&&(e={});var r=this;if(typeof e=="number"){var i=arguments[0],a=arguments[1],s=arguments[2],o=arguments[3];e={width:i,height:a,scaleMode:s,resolution:o}}return e.width=e.width||100,e.height=e.height||100,e.multisample=e.multisample!==void 0?e.multisample:Xt.NONE,r=n.call(this,null,e)||this,r.mipmap=qe.OFF,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Vc(r.realWidth,r.realHeight).addColorTexture(0,r),r.framebuffer.multisample=e.multisample,r.maskStack=[],r.filterStack=[{}],r}return t.prototype.resize=function(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(Mt),Hy=function(){function n(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return n.prototype.set=function(t,e,r){var i=e.width,a=e.height;if(r){var s=t.width/2/i,o=t.height/2/a,u=t.x/i+s,h=t.y/a+o;r=Ht.add(r,Ht.NW),this.x0=u+s*Ht.uX(r),this.y0=h+o*Ht.uY(r),r=Ht.add(r,2),this.x1=u+s*Ht.uX(r),this.y1=h+o*Ht.uY(r),r=Ht.add(r,2),this.x2=u+s*Ht.uX(r),this.y2=h+o*Ht.uY(r),r=Ht.add(r,2),this.x3=u+s*Ht.uX(r),this.y3=h+o*Ht.uY(r)}else this.x0=t.x/i,this.y0=t.y/a,this.x1=(t.x+t.width)/i,this.y1=t.y/a,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/a,this.x3=t.x/i,this.y3=(t.y+t.height)/a;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},n.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},n}(),Ov=new Hy;function Mo(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}var vt=function(n){kt(t,n);function t(e,r,i,a,s,o){var u=n.call(this)||this;if(u.noFrame=!1,r||(u.noFrame=!0,r=new St(0,0,1,1)),e instanceof t&&(e=e.baseTexture),u.baseTexture=e,u._frame=r,u.trim=a,u.valid=!1,u._uvs=Ov,u.uvMatrix=null,u.orig=i||r,u._rotate=Number(s||0),s===!0)u._rotate=2;else if(u._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=o?new Ut(o.x,o.y):new Ut(0,0),u._updateID=0,u.textureCacheIds=[],e.valid?u.noFrame?e.valid&&u.onBaseTextureUpdated(e):u.frame=r:e.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&e.on("update",u.onBaseTextureUpdated,u),u}return t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture.resource;r&&r.url&&on[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){var e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),i=new t(this.baseTexture,!this.noFrame&&e,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=e),i},t.prototype.updateUvs=function(){this._uvs===Ov&&(this._uvs=new Hy),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,i){r===void 0&&(r={}),i===void 0&&(i=ht.STRICT_TEXTURE_CACHE);var a=typeof e=="string",s=null;if(a)s=e;else if(e instanceof Mt){if(!e.cacheId){var o=r&&r.pixiIdPrefix||"pixiid";e.cacheId=o+"-"+Ei(),Mt.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+Ei()}s=e._pixiId}var u=on[s];if(a&&i&&!u)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return!u&&!(e instanceof Mt)?(r.resolution||(r.resolution=Xh(e)),u=new t(new Mt(e,r)),u.baseTexture.cacheId=s,Mt.addToCache(u.baseTexture,s),t.addToCache(u,s)):!u&&e instanceof Mt&&(u=new t(e),t.addToCache(u,s)),u},t.fromURL=function(e,r){var i=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),a=t.from(e,Object.assign({resourceOptions:i},r),!1),s=a.baseTexture.resource;return a.baseTexture.valid?Promise.resolve(a):s.load().then(function(){return Promise.resolve(a)})},t.fromBuffer=function(e,r,i,a){return new t(Mt.fromBuffer(e,r,i,a))},t.fromLoader=function(e,r,i,a){var s=new Mt(e,Object.assign({scaleMode:ht.SCALE_MODE,resolution:Xh(r)},a)),o=s.resource;o instanceof Yy&&(o.url=r);var u=new t(s);return i||(i=r),Mt.addToCache(u.baseTexture,i),t.addToCache(u,i),i!==r&&(Mt.addToCache(u.baseTexture,r),t.addToCache(u,r)),u.baseTexture.valid?Promise.resolve(u):new Promise(function(h){u.baseTexture.once("loaded",function(){return h(u)})})},t.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),on[r]&&console.warn("Texture added to the cache with an id ["+r+"] that already had an entry"),on[r]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var r=on[e];if(r){var i=r.textureCacheIds.indexOf(e);return i>-1&&r.textureCacheIds.splice(i,1),delete on[e],r}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)on[e.textureCacheIds[a]]===e&&delete on[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var r=e.x,i=e.y,a=e.width,s=e.height,o=r+a>this.baseTexture.width,u=i+s>this.baseTexture.height;if(o||u){var h=o&&u?"and":"or",l="X: "+r+" + "+a+" = "+(r+a)+" > "+this.baseTexture.width,c="Y: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(l+" "+h+" "+c))}this.valid=a&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(t,"EMPTY",{get:function(){return t._EMPTY||(t._EMPTY=new t(new Mt),Mo(t._EMPTY),Mo(t._EMPTY.baseTexture)),t._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WHITE",{get:function(){if(!t._WHITE){var e=ht.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),t._WHITE=new t(Mt.from(e)),Mo(t._WHITE),Mo(t._WHITE.baseTexture)}return t._WHITE},enumerable:!1,configurable:!0}),t}(ao),Ti=function(n){kt(t,n);function t(e,r){var i=n.call(this,e,r)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(e){this.framebuffer.multisample=e},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,r,i){i===void 0&&(i=!0);var a=this.baseTexture.resolution,s=Math.round(e*a)/a,o=Math.round(r*a)/a;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()},t.prototype.setResolution=function(e){var r=this.baseTexture;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))},t.create=function(e){for(var r=arguments,i=[],a=1;a<arguments.length;a++)i[a-1]=r[a];return typeof e=="number"&&(Mr("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:i[0],scaleMode:i[1],resolution:i[2]}),new t(new Wy(e))},t}(vt),cM=function(){function n(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return n.prototype.createTexture=function(t,e,r){r===void 0&&(r=Xt.NONE);var i=new Wy(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new Ti(i)},n.prototype.getOptimalTexture=function(t,e,r,i){r===void 0&&(r=1),i===void 0&&(i=Xt.NONE);var a;t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Vh(t),e=Vh(e),a=((t&65535)<<16|e&65535)>>>0,i>1&&(a+=i*4294967296)):a=i>1?-i:-1,this.texturePool[a]||(this.texturePool[a]=[]);var s=this.texturePool[a].pop();return s||(s=this.createTexture(t,e,i)),s.filterPoolKey=a,s.setResolution(r),s},n.prototype.getFilterTexture=function(t,e,r){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||Xt.NONE);return i.filterFrame=t.filterFrame,i},n.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},n.prototype.returnFilterTexture=function(t){this.returnTexture(t)},n.prototype.clear=function(t){if(t=t!==!1,t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},n.prototype.setScreenSize=function(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(var e in this.texturePool)if(Number(e)<0){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},n.SCREEN_KEY=-1,n}(),Bv=function(){function n(t,e,r,i,a,s,o){e===void 0&&(e=0),r===void 0&&(r=!1),i===void 0&&(i=ut.FLOAT),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=a,this.start=s,this.instance=o}return n.prototype.destroy=function(){this.buffer=null},n.from=function(t,e,r,i,a){return new n(t,e,r,i,a)},n}(),fM=0,xe=function(){function n(t,e,r){e===void 0&&(e=!0),r===void 0&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=fM++,this.disposeRunner=new Re("disposeBuffer")}return n.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(n.prototype,"index",{get:function(){return this.type===Gr.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?Gr.ELEMENT_ARRAY_BUFFER:Gr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),n.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new n(t)},n}(),dM={Float32Array,Uint32Array,Int32Array,Uint8Array};function pM(n,t){for(var e=0,r=0,i={},a=0;a<n.length;a++)r+=t[a],e+=n[a].length;for(var s=new ArrayBuffer(e*4),o=null,u=0,a=0;a<n.length;a++){var h=t[a],l=n[a],c=Uy(l);i[c]||(i[c]=new dM[c](s)),o=i[c];for(var f=0;f<l.length;f++){var d=(f/h|0)*r+u,p=f%h;o[d+p]=l[f]}u+=h}return new Float32Array(s)}var Nv={5126:4,5123:2,5121:1},vM=0,mM={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},uo=function(){function n(t,e){t===void 0&&(t=[]),e===void 0&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=vM++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Re("disposeGeometry"),this.refCount=0}return n.prototype.addAttribute=function(t,e,r,i,a,s,o,u){if(r===void 0&&(r=0),i===void 0&&(i=!1),u===void 0&&(u=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof xe||(e instanceof Array&&(e=new Float32Array(e)),e=new xe(e));var h=t.split("|");if(h.length>1){for(var l=0;l<h.length;l++)this.addAttribute(h[l],e,r,i,a);return this}var c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Bv(c,r,i,a,s,o,u),this.instanced=this.instanced||u,this},n.prototype.getAttribute=function(t){return this.attributes[t]},n.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},n.prototype.addIndex=function(t){return t instanceof xe||(t instanceof Array&&(t=new Uint16Array(t)),t=new xe(t)),t.type=Gr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.indexOf(t)===-1&&this.buffers.push(t),this},n.prototype.getIndex=function(){return this.indexBuffer},n.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var t=[],e=[],r=new xe,i;for(i in this.attributes){var a=this.attributes[i],s=this.buffers[a.buffer];t.push(s.data),e.push(a.size*Nv[a.type]/4),a.buffer=0}for(r.data=pM(t,e),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},n.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t],r=this.buffers[e.buffer];return r.data.length/(e.stride/4||e.size)}return 0},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},n.prototype.clone=function(){for(var t=new n,e=0;e<this.buffers.length;e++)t.buffers[e]=new xe(this.buffers[e].data.slice(0));for(var e in this.attributes){var r=this.attributes[e];t.attributes[e]=new Bv(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Gr.ELEMENT_ARRAY_BUFFER),t},n.merge=function(t){for(var e=new n,r=[],i=[],a=[],s,o=0;o<t.length;o++){s=t[o];for(var u=0;u<s.buffers.length;u++)i[u]=i[u]||0,i[u]+=s.buffers[u].data.length,a[u]=0}for(var o=0;o<s.buffers.length;o++)r[o]=new mM[Uy(s.buffers[o].data)](i[o]),e.buffers[o]=new xe(r[o]);for(var o=0;o<t.length;o++){s=t[o];for(var u=0;u<s.buffers.length;u++)r[u].set(s.buffers[u].data,a[u]),a[u]+=s.buffers[u].data.length}if(e.attributes=s.attributes,s.indexBuffer){e.indexBuffer=e.buffers[s.buffers.indexOf(s.indexBuffer)],e.indexBuffer.type=Gr.ELEMENT_ARRAY_BUFFER;for(var h=0,l=0,c=0,f=0,o=0;o<s.buffers.length;o++)if(s.buffers[o]!==s.indexBuffer){f=o;break}for(var o in s.attributes){var d=s.attributes[o];(d.buffer|0)===f&&(l+=d.size*Nv[d.type]/4)}for(var o=0;o<t.length;o++){for(var p=t[o].indexBuffer.data,u=0;u<p.length;u++)e.indexBuffer.data[u+c]+=h;h+=t[o].buffers[f].data.length/l,c+=p.length}}return e},n}(),gM=function(n){kt(t,n);function t(){var e=n.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return t}(uo),jy=function(n){kt(t,n);function t(){var e=n.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new xe(e.vertices),e.uvBuffer=new xe(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return t.prototype.map=function(e,r){var i=0,a=0;return this.uvs[0]=i,this.uvs[1]=a,this.uvs[2]=i+r.width/e.width,this.uvs[3]=a,this.uvs[4]=i+r.width/e.width,this.uvs[5]=a+r.height/e.height,this.uvs[6]=i,this.uvs[7]=a+r.height/e.height,i=r.x,a=r.y,this.vertices[0]=i,this.vertices[1]=a,this.vertices[2]=i+r.width,this.vertices[3]=a,this.vertices[4]=i+r.width,this.vertices[5]=a+r.height,this.vertices[6]=i,this.vertices[7]=a+r.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(uo),yM=0,xi=function(){function n(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=yM++,this.static=!!e,this.ubo=!!r,t instanceof xe?(this.buffer=t,this.buffer.type=Gr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new xe(new Float32Array(1)),this.buffer.type=Gr.UNIFORM_BUFFER,this.autoManage=!0))}return n.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},n.prototype.add=function(t,e,r){if(!this.ubo)this.uniforms[t]=new n(e,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},n.from=function(t,e,r){return new n(t,e,r)},n.uboFrom=function(t,e){return new n(t,e??!0,!0)},n}(),xM=function(){function n(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Xt.NONE,this.sourceFrame=new St,this.destinationFrame=new St,this.bindingSourceFrame=new St,this.bindingDestinationFrame=new St,this.filters=[],this.transform=null}return n.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},n}(),Po=[new Ut,new Ut,new Ut,new Ut],hu=new te,bM=function(){function n(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new cM,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new gM,this.quadUv=new jy,this.tempRect=new St,this.activeState={},this.globalUniforms=new xi({outputFrame:new St,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return n.prototype.push=function(t,e){for(var r,i,a=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new xM,u=this.renderer.renderTexture,h=e[0].resolution,l=e[0].multisample,c=e[0].padding,f=e[0].autoFit,d=(r=e[0].legacy)!==null&&r!==void 0?r:!0,p=1;p<e.length;p++){var v=e[p];h=Math.min(h,v.resolution),l=Math.min(l,v.multisample),c=this.useMaxPadding?Math.max(c,v.padding):c+v.padding,f=f&&v.autoFit,d=d||((i=v.legacy)!==null&&i!==void 0?i:!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=u.current),s.push(o),o.resolution=h,o.multisample=l,o.legacy=d,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(c);var m=this.tempRect.copyFrom(u.sourceFrame);a.projection.transform&&this.transformAABB(hu.copyFrom(a.projection.transform).invert(),m),f?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,u.current?u.current.resolution:a.resolution,u.sourceFrame,u.destinationFrame,a.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,l),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var g=this.tempRect;g.x=0,g.y=0,g.width=o.sourceFrame.width,g.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(u.sourceFrame),o.bindingDestinationFrame.copyFrom(u.destinationFrame),o.transform=a.projection.transform,a.projection.transform=null,u.bind(o.renderTexture,o.sourceFrame,g),a.framebuffer.clear(0,0,0,0)},n.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var a=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],s[0]=Math.round(a[0]*e.resolution),s[1]=Math.round(a[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*a[2]-.5*s[2],o[3]=e.sourceFrame.height*a[3]-.5*s[3],e.legacy){var u=i.filterArea;u[0]=e.destinationFrame.width,u[1]=e.destinationFrame.height,u[2]=e.sourceFrame.x,u[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,e.renderTexture,h.renderTexture,Sr.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;var f=0;for(f=0;f<r.length-1;++f){f===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,e.resolution),c.filterFrame=l.filterFrame),r[f].apply(this,l,c,Sr.CLEAR,e);var d=l;l=c,c=d}r[f].apply(this,l,h.renderTexture,Sr.BLEND,e),f>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)},n.prototype.bindAndClear=function(t,e){e===void 0&&(e=Sr.CLEAR);var r=this.renderer,i=r.renderTexture,a=r.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var s=this.tempRect;s.x=0,s.y=0,s.width=t.filterFrame.width,s.height=t.filterFrame.height,i.bind(t,t.filterFrame,s)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=a.stateId&1||this.forceClear;(e===Sr.CLEAR||e===Sr.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},n.prototype.applyFilter=function(t,e,r,i){var a=this.renderer;a.state.set(t.state),this.bindAndClear(r,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(cr.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(cr.TRIANGLE_STRIP))},n.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,a=r.destinationFrame,s=e._texture.orig,o=t.set(a.width,0,0,a.height,i.x,i.y),u=e.worldTransform.copyTo(te.TEMP_MATRIX);return u.invert(),o.prepend(u),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},n.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},n.prototype.getOptimalFilterTexture=function(t,e,r,i){return r===void 0&&(r=1),i===void 0&&(i=Xt.NONE),this.texturePool.getOptimalTexture(t,e,r,i)},n.prototype.getFilterTexture=function(t,e,r){if(typeof t=="number"){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var a=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||Xt.NONE);return a.filterFrame=t.filterFrame,a},n.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},n.prototype.emptyPool=function(){this.texturePool.clear(!0)},n.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},n.prototype.transformAABB=function(t,e){var r=Po[0],i=Po[1],a=Po[2],s=Po[3];r.set(e.left,e.top),i.set(e.left,e.bottom),a.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(r,r),t.apply(i,i),t.apply(a,a),t.apply(s,s);var o=Math.min(r.x,i.x,a.x,s.x),u=Math.min(r.y,i.y,a.y,s.y),h=Math.max(r.x,i.x,a.x,s.x),l=Math.max(r.y,i.y,a.y,s.y);e.x=o,e.y=u,e.width=h-o,e.height=l-u},n.prototype.roundFrame=function(t,e,r,i,a){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(a){var s=a.a,o=a.b,u=a.c,h=a.d;if((Math.abs(o)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(h)>1e-4))return}a=a?hu.copyFrom(a):hu.identity(),a.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(a,t),t.ceil(e),this.transformAABB(a.invert(),t)}},n}(),xl=function(){function n(t){this.renderer=t}return n.prototype.flush=function(){},n.prototype.destroy=function(){this.renderer=null},n.prototype.start=function(){},n.prototype.stop=function(){this.flush()},n.prototype.render=function(t){},n}(),_M=function(){function n(t){this.renderer=t,this.emptyRenderer=new xl(t),this.currentRenderer=this.emptyRenderer}return n.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},n.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},n.prototype.boundArray=function(t,e,r,i){for(var a=t.elements,s=t.ids,o=t.count,u=0,h=0;h<o;h++){var l=a[h],c=l._batchLocation;if(c>=0&&c<i&&e[c]===l){s[h]=c;continue}for(;u<i;){var f=e[u];if(f&&f._batchEnabled===r&&f._batchLocation===u){u++;continue}s[h]=u,l._batchLocation=u,e[u]=l;break}}},n.prototype.destroy=function(){this.renderer=null},n}(),kv=0,wM=function(){function n(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(n.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),n.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=kv++},n.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=kv++,this.renderer.runners.contextChange.emit(t)},n.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},n.prototype.createContext=function(t,e){var r;if(ht.PREFER_ENV>=vn.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},n.prototype.getExtensions=function(){var t=this.gl,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},n.prototype.handleContextLost=function(t){var e=this;t.preventDefault(),setTimeout(function(){e.gl.isContextLost()&&e.extensions.loseContext&&e.extensions.loseContext.restoreContext()},0)},n.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},n.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},n.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},n.prototype.validateContext=function(t){var e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},n}(),SM=function(){function n(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Xt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return n}(),EM=new St,TM=function(){function n(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Vc(10,10),this.msaaSamples=null}return n.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new St,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;ht.PREFER_ENV===vn.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(i){return e.drawBuffersWEBGL(i)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},n.prototype.bind=function(t,e,r){r===void 0&&(r=0);var i=this.gl;if(t){var a=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,a.mipLevel=r),a.dirtyId!==t.dirtyId&&(a.dirtyId=t.dirtyId,a.dirtyFormat!==t.dirtyFormat?(a.dirtyFormat=t.dirtyFormat,a.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):a.dirtySize!==t.dirtySize&&(a.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var o=t.colorTextures[s];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var u=e.width>>r,h=e.height>>r,l=u/e.width;this.setViewport(e.x*l,e.y*l,u,h)}else{var u=t.width>>r,h=t.height>>r;this.setViewport(0,0,u,h)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},n.prototype.setViewport=function(t,e,r,i){var a=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),i=Math.round(i),(a.width!==r||a.height!==i||a.x!==t||a.y!==e)&&(a.x=t,a.y=e,a.width=r,a.height=i,this.gl.viewport(t,e,r,i))},Object.defineProperty(n.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),n.prototype.clear=function(t,e,r,i,a){a===void 0&&(a=Rh.COLOR|Rh.DEPTH);var s=this.gl;s.clearColor(t,e,r,i),s.clear(a)},n.prototype.initFramebuffer=function(t){var e=this.gl,r=new SM(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r},n.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.RGBA8,t.width,t.height)),r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,a=i.length;e.drawBuffers||(a=Math.min(a,1));for(var s=0;s<a;s++){var o=i[s],u=o.parentTextureArray||o;this.renderer.texture.bind(u,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},n.prototype.updateFramebuffer=function(t,e){var r=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],a=t.colorTextures,s=a.length;r.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.RGBA8,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],u=0;u<s;u++){var h=a[u],l=h.parentTextureArray||h;this.renderer.texture.bind(l,0),!(u===0&&i.msaaBuffer)&&(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+u,h.target,l._glTextures[this.CONTEXT_UID].texture,e),o.push(r.COLOR_ATTACHMENT0+u))}if(o.length>1&&r.drawBuffers(o),t.depthTexture){var c=this.writeDepthTexture;if(c){var f=t.depthTexture;this.renderer.texture.bind(f,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,e)}}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i.stencil)):i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null)},n.prototype.canMultisampleFramebuffer=function(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture},n.prototype.detectSamples=function(t){var e=this.msaaSamples,r=Xt.NONE;if(t<=1||e===null)return r;for(var i=0;i<e.length;i++)if(e[i]<=t){r=e[i];break}return r===1&&(r=Xt.NONE),r},n.prototype.blit=function(t,e,r){var i=this,a=i.current,s=i.renderer,o=i.gl,u=i.CONTEXT_UID;if(s.context.webGLVersion===2&&a){var h=a.glFramebuffers[u];if(h){if(!t){if(!h.msaaBuffer)return;var l=a.colorTextures[0];if(!l)return;h.blitFramebuffer||(h.blitFramebuffer=new Vc(a.width,a.height),h.blitFramebuffer.addColorTexture(0,l)),t=h.blitFramebuffer,t.colorTextures[0]!==l&&(t.colorTextures[0]=l,t.dirtyId++,t.dirtyFormat++),(t.width!==a.width||t.height!==a.height)&&(t.width=a.width,t.height=a.height,t.dirtyId++,t.dirtySize++)}e||(e=EM,e.width=a.width,e.height=a.height),r||(r=e);var c=e.width===r.width&&e.height===r.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR)}}},n.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var a=this.managedFramebuffers.indexOf(t);a>=0&&this.managedFramebuffers.splice(a,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&r.blitFramebuffer.dispose()}},n.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},n.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(!(!e||e.stencil)){t.stencil=!0;var r=t.width,i=t.height,a=this.gl,s=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,s),e.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,e.multisample,a.DEPTH24_STENCIL8,r,i):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,r,i),e.stencil=s,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,s)}}},n.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new St},n.prototype.destroy=function(){this.renderer=null},n}(),lu={5126:4,5123:2,5121:1},AM=function(){function n(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return n.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){var r=this.renderer.context.extensions.vertexArrayObject;ht.PREFER_ENV===vn.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(a){return r.bindVertexArrayOES(a)},t.deleteVertexArray=function(a){return r.deleteVertexArrayOES(a)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(e.webGLVersion!==2){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(a,s){return i.vertexAttribDivisorANGLE(a,s)},t.drawElementsInstanced=function(a,s,o,u,h){return i.drawElementsInstancedANGLE(a,s,o,u,h)},t.drawArraysInstanced=function(a,s,o,u){return i.drawArraysInstancedANGLE(a,s,o,u)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex},n.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],a=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},a=!0);var s=i[e.program.id]||this.initGeometryVao(t,e,a);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?r.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()},n.prototype.reset=function(){this.unbind()},n.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,r=0;r<t.buffers.length;r++){var i=t.buffers[r];e.update(i)}},n.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var a in i)if(!r[a])throw new Error('shader and geometry incompatible, geometry missing the "'+a+'" attribute')},n.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,a=["g",t.id];for(var s in r)i[s]&&a.push(s,i[s].location);return a.join("-")},n.prototype.initGeometryVao=function(t,e,r){r===void 0&&(r=!0);var i=this.gl,a=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[a]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var u=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID],l=h[u];if(l)return h[o.id]=l,l;var c=t.buffers,f=t.attributes,d={},p={};for(var v in c)d[v]=0,p[v]=0;for(var v in f)!f[v].size&&o.attributeData[v]?f[v].size=o.attributeData[v].size:f[v].size||console.warn("PIXI Geometry attribute '"+v+"' size cannot be determined (likely the bound shader does not have the attribute)"),d[f[v].buffer]+=f[v].size*lu[f[v].type];for(var v in f){var m=f[v],g=m.size;m.stride===void 0&&(d[m.buffer]===g*lu[m.type]?m.stride=0:m.stride=d[m.buffer]),m.start===void 0&&(m.start=p[m.buffer],p[m.buffer]+=g*lu[m.type])}l=i.createVertexArray(),i.bindVertexArray(l);for(var y=0;y<c.length;y++){var x=c[y];s.bind(x),r&&x._glBuffers[a].refCount++}return this.activateVao(t,o),this._activeVao=l,h[o.id]=l,h[u]=l,l},n.prototype.disposeGeometry=function(t,e){var r;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],a=this.gl,s=t.buffers,o=(r=this.renderer)===null||r===void 0?void 0:r.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(var u=0;u<s.length;u++){var h=s[u]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&o.dispose(s[u],e))}if(!e){for(var l in i)if(l[0]==="g"){var c=i[l];this._activeVao===c&&this.unbind(),a.deleteVertexArray(c)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},n.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)},n.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,a=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&a.bind(t.indexBuffer);var u=null;for(var h in o){var l=o[h],c=s[l.buffer],f=c._glBuffers[i];if(e.attributeData[h]){u!==f&&(a.bind(c),u=f);var d=e.attributeData[h].location;if(r.enableVertexAttribArray(d),r.vertexAttribPointer(d,l.size,l.type||r.FLOAT,l.normalized,l.stride,l.start),l.instance)if(this.hasInstance)r.vertexAttribDivisor(d,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},n.prototype.draw=function(t,e,r,i){var a=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,u=o===2?a.UNSIGNED_SHORT:a.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?s.instanced?a.drawElementsInstanced(t,e||s.indexBuffer.data.length,u,(r||0)*o,i||1):a.drawElements(t,e||s.indexBuffer.data.length,u,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?a.drawArraysInstanced(t,r,e||s.getSize(),i||1):a.drawArrays(t,r,e||s.getSize());return this},n.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},n.prototype.destroy=function(){this.renderer=null},n}(),MM=function(){function n(t){t===void 0&&(t=null),this.type=he.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ht.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(n.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),n.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=he.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},n.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},n}();function Lv(n,t,e){var r=n.createShader(t);return n.shaderSource(r,e),n.compileShader(r),r}function Dv(n,t){var e=n.getShaderSource(t).split(`
`).map(function(h,l){return l+": "+h}),r=n.getShaderInfoLog(t),i=r.split(`
`),a={},s=i.map(function(h){return parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(h){return h&&!a[h]?(a[h]=!0,!0):!1}),o=[""];s.forEach(function(h){e[h-1]="%c"+e[h-1]+"%c",o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var u=e.join(`
`);o[0]=u,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,o),console.groupEnd()}function PM(n,t,e,r){n.getProgramParameter(t,n.LINK_STATUS)||(n.getShaderParameter(e,n.COMPILE_STATUS)||Dv(n,e),n.getShaderParameter(r,n.COMPILE_STATUS)||Dv(n,r),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(t)))}function uu(n){for(var t=new Array(n),e=0;e<t.length;e++)t[e]=!1;return t}function $y(n,t){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return uu(2*t);case"bvec3":return uu(3*t);case"bvec4":return uu(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var qy={},Za=qy;function IM(){if(Za===qy||Za&&Za.isContextLost()){var n=ht.ADAPTER.createCanvas(),t=void 0;ht.PREFER_ENV>=vn.WEBGL2&&(t=n.getContext("webgl2",{})),t||(t=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Za=t}return Za}var Io;function CM(){if(!Io){Io=ir.MEDIUM;var n=IM();if(n&&n.getShaderPrecisionFormat){var t=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);Io=t.precision?ir.HIGH:ir.MEDIUM}}return Io}function Uv(n,t,e){if(n.substring(0,9)!=="precision"){var r=t;return t===ir.HIGH&&e!==ir.HIGH&&(r=ir.MEDIUM),"precision "+r+` float;
`+n}else if(e!==ir.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}var RM={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Zy(n){return RM[n]}var Co=null,Vv={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Ky(n,t){if(!Co){var e=Object.keys(Vv);Co={};for(var r=0;r<e.length;++r){var i=e[r];Co[n[i]]=Vv[i]}}return Co[t]}var _a=[{test:function(n){return n.type==="float"&&n.size===1&&!n.isArray},code:function(n){return`
            if(uv["`+n+'"] !== ud["'+n+`"].value)
            {
                ud["`+n+'"].value = uv["'+n+`"]
                gl.uniform1f(ud["`+n+'"].location, uv["'+n+`"])
            }
            `}},{test:function(n,t){return(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(t==null||t.castToBaseTexture!==void 0)},code:function(n){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+n+`"], t);

            if(ud["`+n+`"].value !== t)
            {
                ud["`+n+`"].value = t;
                gl.uniform1i(ud["`+n+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(n,t){return n.type==="mat3"&&n.size===1&&!n.isArray&&t.a!==void 0},code:function(n){return`
            gl.uniformMatrix3fv(ud["`+n+'"].location, false, uv["'+n+`"].toArray(true));
            `},codeUbo:function(n){return`
                var `+n+"_matrix = uv."+n+`.toArray(true);

                data[offset] = `+n+`_matrix[0];
                data[offset+1] = `+n+`_matrix[1];
                data[offset+2] = `+n+`_matrix[2];
        
                data[offset + 4] = `+n+`_matrix[3];
                data[offset + 5] = `+n+`_matrix[4];
                data[offset + 6] = `+n+`_matrix[5];
        
                data[offset + 8] = `+n+`_matrix[6];
                data[offset + 9] = `+n+`_matrix[7];
                data[offset + 10] = `+n+`_matrix[8];
            `}},{test:function(n,t){return n.type==="vec2"&&n.size===1&&!n.isArray&&t.x!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+n+`"].location, v.x, v.y);
                }`},codeUbo:function(n){return`
                v = uv.`+n+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(n){return n.type==="vec2"&&n.size===1&&!n.isArray},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+n+`"].location, v[0], v[1]);
                }
            `}},{test:function(n,t){return n.type==="vec4"&&n.size===1&&!n.isArray&&t.width!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+n+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(n){return`
                    v = uv.`+n+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(n){return n.type==="vec4"&&n.size===1&&!n.isArray},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+n+`"].location, v[0], v[1], v[2], v[3])
                }`}}],FM={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},OM={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function BM(n,t){var e,r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var i in n.uniforms){var a=t[i];if(!a){!((e=n.uniforms[i])===null||e===void 0)&&e.group&&(n.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+i+", '"+i+`');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.`+i+`, syncData);
                    `));continue}for(var s=n.uniforms[i],o=!1,u=0;u<_a.length;u++)if(_a[u].test(a,s)){r.push(_a[u].code(i,s)),o=!0;break}if(!o){var h=a.size===1&&!a.isArray?FM:OM,l=h[a.type].replace("location",'ud["'+i+'"].location');r.push(`
            cu = ud["`+i+`"];
            cv = cu.value;
            v = uv["`+i+`"];
            `+l+";")}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var NM=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function kM(n){for(var t="",e=0;e<n;++e)e>0&&(t+=`
else `),e<n-1&&(t+="if(test == "+e+".0){}");return t}function LM(n,t){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var e=t.createShader(t.FRAGMENT_SHADER);;){var r=NM.replace(/%forloop%/gi,kM(n));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))n=n/2|0;else break}return n}var Ka;function DM(){if(typeof Ka=="boolean")return Ka;try{var n=new Function("param1","param2","param3","return param1[param2] === param3;");Ka=n({a:"b"},"a","b")===!0}catch{Ka=!1}return Ka}var UM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,VM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,XM=0,Ro={},co=function(){function n(t,e,r){r===void 0&&(r="pixi-shader"),this.id=XM++,this.vertexSrc=t||n.defaultVertexSrc,this.fragmentSrc=e||n.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Ro[r]?(Ro[r]++,r+="-"+Ro[r]):Ro[r]=1,this.vertexSrc="#define SHADER_NAME "+r+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+`
`+this.fragmentSrc,this.vertexSrc=Uv(this.vertexSrc,ht.PRECISION_VERTEX,ir.HIGH),this.fragmentSrc=Uv(this.fragmentSrc,ht.PRECISION_FRAGMENT,CM())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(n,"defaultVertexSrc",{get:function(){return VM},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentSrc",{get:function(){return UM},enumerable:!1,configurable:!0}),n.from=function(t,e,r){var i=t+e,a=Cv[i];return a||(Cv[i]=a=new n(t,e,r)),a},n}(),Un=function(){function n(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof xi?this.uniformGroup=e:this.uniformGroup=new xi(e):this.uniformGroup=new xi({}),this.disposeRunner=new Re("disposeShader")}return n.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},n.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(n.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),n.from=function(t,e,r){var i=co.from(t,e);return new n(i,r)},n}(),cu=0,fu=1,du=2,pu=3,vu=4,mu=5,Bi=function(){function n(){this.data=0,this.blendMode=at.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(n.prototype,"blend",{get:function(){return!!(this.data&1<<cu)},set:function(t){!!(this.data&1<<cu)!==t&&(this.data^=1<<cu)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offsets",{get:function(){return!!(this.data&1<<fu)},set:function(t){!!(this.data&1<<fu)!==t&&(this.data^=1<<fu)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"culling",{get:function(){return!!(this.data&1<<du)},set:function(t){!!(this.data&1<<du)!==t&&(this.data^=1<<du)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthTest",{get:function(){return!!(this.data&1<<pu)},set:function(t){!!(this.data&1<<pu)!==t&&(this.data^=1<<pu)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthMask",{get:function(){return!!(this.data&1<<mu)},set:function(t){!!(this.data&1<<mu)!==t&&(this.data^=1<<mu)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<vu)},set:function(t){!!(this.data&1<<vu)!==t&&(this.data^=1<<vu)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==at.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},n.for2d=function(){var t=new n;return t.depthTest=!1,t.blend=!0,t},n}(),zM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,GM=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Yn=function(n){kt(t,n);function t(e,r,i){var a=this,s=co.from(e||t.defaultVertexSrc,r||t.defaultFragmentSrc);return a=n.call(this,s,i)||this,a.padding=0,a.resolution=ht.FILTER_RESOLUTION,a.multisample=ht.FILTER_MULTISAMPLE,a.enabled=!0,a.autoFit=!0,a.state=new Bi,a}return t.prototype.apply=function(e,r,i,a,s){e.applyFilter(this,r,i,a)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._resolution=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return GM},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return zM},enumerable:!1,configurable:!0}),t}(Un),YM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,WM=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Xv=new te,ad=function(){function n(t,e){this._texture=t,this.mapCoord=new te,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}return Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),n.prototype.multiplyUvs=function(t,e){e===void 0&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var a=t[i],s=t[i+1];e[i]=a*r.a+s*r.c+r.tx,e[i+1]=a*r.b+s*r.d+r.ty}return e},n.prototype.update=function(t){var e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,a=e.trim;a&&(Xv.set(i.width/a.width,0,0,i.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(Xv));var s=e.baseTexture,o=this.uClampFrame,u=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+u+h)/s.width,o[1]=(e._frame.y+u+h)/s.height,o[2]=(e._frame.x+e._frame.width-u+h)/s.width,o[3]=(e._frame.y+e._frame.height-u+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&e.rotate===0,!0},n}(),HM=function(n){kt(t,n);function t(e,r,i){var a=this,s=null;return typeof e!="string"&&r===void 0&&i===void 0&&(s=e,e=void 0,r=void 0,i=void 0),a=n.call(this,e||YM,r||WM,i)||this,a.maskSprite=s,a.maskMatrix=new te,a}return Object.defineProperty(t.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),t.prototype.apply=function(e,r,i,a){var s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new ad(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,i,a))},t}(Yn),jM=function(){function n(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return n.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},n.prototype.push=function(t,e){var r=e;if(!r.isMaskData){var i=this.maskDataPool.pop()||new MM;i.pooled=!0,i.maskObject=e,r=i}var a=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(a),r._colorMask=a?a._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==he.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case he.SCISSOR:this.renderer.scissor.push(r);break;case he.STENCIL:this.renderer.stencil.push(r);break;case he.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case he.COLOR:this.pushColorMask(r);break}r.type===he.SPRITE&&this.maskStack.push(r)},n.prototype.pop=function(t){var e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case he.SCISSOR:this.renderer.scissor.pop(e);break;case he.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case he.SPRITE:this.popSpriteMask(e);break;case he.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){var r=this.maskStack[this.maskStack.length-1];r.type===he.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}},n.prototype.detect=function(t){var e=t.maskObject;e?e.isSprite?t.type=he.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=he.SCISSOR:t.type=he.STENCIL:t.type=he.COLOR},n.prototype.pushSpriteMask=function(t){var e,r,i=t.maskObject,a=t._target,s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new HM]));var o=this.renderer,u=o.renderTexture,h,l;if(u.current){var c=u.current;h=t.resolution||c.resolution,l=(e=t.multisample)!==null&&e!==void 0?e:c.multisample}else h=t.resolution||o.resolution,l=(r=t.multisample)!==null&&r!==void 0?r:o.multisample;s[0].resolution=h,s[0].multisample=l,s[0].maskSprite=i;var f=a.filterArea;a.filterArea=i.getBounds(!0),o.filter.push(a,s),a.filterArea=f,t._filters||this.alphaMaskIndex++},n.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},n.prototype.pushColorMask=function(t){var e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)},n.prototype.popColorMask=function(t){var e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)},n.prototype.destroy=function(){this.renderer=null},n}(),Jy=function(){function n(t){this.renderer=t,this.maskStack=[],this.glConst=0}return n.prototype.getStackLength=function(){return this.maskStack.length},n.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(i===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},n.prototype._useCurrent=function(){},n.prototype.destroy=function(){this.renderer=null,this.maskStack=null},n}(),zv=new te,Gv=[],$M=function(n){kt(t,n);function t(e){var r=n.call(this,e)||this;return r.glConst=ht.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,r}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.calcScissorRect=function(e){var r;if(!e._scissorRectLocal){var i=e._scissorRect,a=e.maskObject,s=this.renderer,o=s.renderTexture,u=a.getBounds(!0,(r=Gv.pop())!==null&&r!==void 0?r:new St);this.roundFrameToPixels(u,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),i&&u.fit(i),e._scissorRectLocal=u}},t.isMatrixRotated=function(e){if(!e)return!1;var r=e.a,i=e.b,a=e.c,s=e.d;return(Math.abs(i)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(r)>1e-4||Math.abs(s)>1e-4)},t.prototype.testScissor=function(e){var r=e.maskObject;if(!r.isFastRect||!r.isFastRect()||t.isMatrixRotated(r.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);var i=e._scissorRectLocal;return i.width>0&&i.height>0},t.prototype.roundFrameToPixels=function(e,r,i,a,s){t.isMatrixRotated(s)||(s=s?zv.copyFrom(s):zv.identity(),s.translate(-i.x,-i.y).scale(a.width/i.width,a.height/i.height).translate(a.x,a.y),this.renderer.filter.transformAABB(s,e),e.fit(a),e.x=Math.round(e.x*r),e.y=Math.round(e.y*r),e.width=Math.round(e.width*r),e.height=Math.round(e.height*r))},t.prototype.push=function(e){e._scissorRectLocal||this.calcScissorRect(e);var r=this.renderer.gl;e._scissorRect||r.enable(r.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()},t.prototype.pop=function(e){var r=this.renderer.gl;e&&Gv.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():r.disable(r.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,r;this.renderer.renderTexture.current?r=e.y:r=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,r,e.width,e.height)},t}(Jy),qM=function(n){kt(t,n);function t(e){var r=n.call(this,e)||this;return r.glConst=ht.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,r}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var r=e.maskObject,i=this.renderer.gl,a=e._stencilCounter;a===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;var s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,a,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()},t.prototype.pop=function(e){var r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{var i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,a=i?i._colorMask:15;a!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,a!==0&&(i._colorMask=a,r.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()}},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t}(Jy),ZM=function(){function n(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new te,this.transform=null}return n.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)},n.prototype.calculateProjection=function(t,e,r,i){var a=this.projectionMatrix,s=i?-1:1;a.identity(),a.a=1/e.width*2,a.d=s*(1/e.height*2),a.tx=-1-e.x*a.a,a.ty=-s-e.y*a.d},n.prototype.setTransform=function(t){},n.prototype.destroy=function(){this.renderer=null},n}(),Zn=new St,Ja=new St,KM=function(){function n(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new St,this.destinationFrame=new St,this.viewportFrame=new St}return n.prototype.bind=function(t,e,r){t===void 0&&(t=null);var i=this.renderer;this.current=t;var a,s,o;t?(a=t.baseTexture,o=a.resolution,e||(Zn.width=t.frame.width,Zn.height=t.frame.height,e=Zn),r||(Ja.x=t.frame.x,Ja.y=t.frame.y,Ja.width=e.width,Ja.height=e.height,r=Ja),s=a.framebuffer):(o=i.resolution,e||(Zn.width=i.screen.width,Zn.height=i.screen.height,e=Zn),r||(r=Zn,r.width=e.width,r.height=e.height));var u=this.viewportFrame;u.x=r.x*o,u.y=r.y*o,u.width=r.width*o,u.height=r.height*o,t||(u.y=i.view.height-(u.y+u.height)),u.ceil(),this.renderer.framebuffer.bind(s,u),this.renderer.projection.update(r,e,o,!s),t?this.renderer.mask.setMaskStack(a.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)},n.prototype.clear=function(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.clearColor;var r=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,a=r.width!==i.width||r.height!==i.height;if(a){var s=this.viewportFrame,o=s.x,u=s.y,h=s.width,l=s.height;o=Math.round(o),u=Math.round(u),h=Math.round(h),l=Math.round(l),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,u,h,l)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),a&&this.renderer.scissor.pop()},n.prototype.resize=function(){this.bind(null)},n.prototype.reset=function(){this.bind(null)},n.prototype.destroy=function(){this.renderer=null},n}();function JM(n,t,e,r,i){e.buffer.update(i)}var QM={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Qy={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function tP(n){for(var t=n.map(function(u){return{data:u,offset:0,dataLen:0,dirty:0}}),e=0,r=0,i=0,a=0;a<t.length;a++){var s=t[a];if(e=Qy[s.data.type],s.data.size>1&&(e=Math.max(e,16)*s.data.size),s.dataLen=e,r%e!==0&&r<16){var o=r%e%16;r+=o,i+=o}r+e>16?(i=Math.ceil(i/16)*16,s.offset=i,i+=e,r=e):(s.offset=i,r+=e,i+=e)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function eP(n,t){var e=[];for(var r in n)t[r]&&e.push(t[r]);return e.sort(function(i,a){return i.index-a.index}),e}function rP(n,t){if(!n.autoManage)return{size:0,syncFunc:JM};for(var e=eP(n.uniforms,t),r=tP(e),i=r.uboElements,a=r.size,s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],o=0;o<i.length;o++){for(var u=i[o],h=n.uniforms[u.data.name],l=u.data.name,c=!1,f=0;f<_a.length;f++){var d=_a[f];if(d.codeUbo&&d.test(u.data,h)){s.push("offset = "+u.offset/4+";",_a[f].codeUbo(u.data.name,h)),c=!0;break}}if(!c)if(u.data.size>1){var p=Zy(u.data.type),v=Math.max(Qy[u.data.type]/16,1),m=p/v,g=(4-m%4)%4;s.push(`
                cv = ud.`+l+`.value;
                v = uv.`+l+`;
                offset = `+u.offset/4+`;

                t = 0;

                for(var i=0; i < `+u.data.size*v+`; i++)
                {
                    for(var j = 0; j < `+m+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+g+`;
                }

                `)}else{var y=QM[u.data.type];s.push(`
                cv = ud.`+l+`.value;
                v = uv.`+l+`;
                offset = `+u.offset/4+`;
                `+y+`;
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:a,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}var nP=function(){function n(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return n.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},n}();function iP(n,t){for(var e={},r=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=t.getActiveAttrib(n,i);if(a.name.indexOf("gl_")!==0){var s=Ky(t,a.type),o={type:s,name:a.name,size:Zy(s),location:t.getAttribLocation(n,a.name)};e[a.name]=o}}return e}function aP(n,t){for(var e={},r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),i=0;i<r;i++){var a=t.getActiveUniform(n,i),s=a.name.replace(/\[.*?\]$/,""),o=!!a.name.match(/\[.*?\]$/),u=Ky(t,a.type);e[s]={name:s,index:i,type:u,size:a.size,isArray:o,value:$y(u,a.size)}}return e}function sP(n,t){var e=Lv(n,n.VERTEX_SHADER,t.vertexSrc),r=Lv(n,n.FRAGMENT_SHADER,t.fragmentSrc),i=n.createProgram();if(n.attachShader(i,e),n.attachShader(i,r),n.linkProgram(i),n.getProgramParameter(i,n.LINK_STATUS)||PM(n,i,e,r),t.attributeData=iP(i,n),t.uniformData=aP(i,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){var a=Object.keys(t.attributeData);a.sort(function(l,c){return l>c?1:-1});for(var s=0;s<a.length;s++)t.attributeData[a[s]].location=s,n.bindAttribLocation(i,s,a[s]);n.linkProgram(i)}n.deleteShader(e),n.deleteShader(r);var o={};for(var s in t.uniformData){var u=t.uniformData[s];o[s]={location:n.getUniformLocation(i,s),value:$y(u.type,u.size)}}var h=new nP(i,o);return h}var oP=0,Fo={textureCount:0,uboCount:0},hP=function(){function n(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=oP++}return n.prototype.systemCheck=function(){if(!DM())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},n.prototype.contextChange=function(t){this.gl=t,this.reset()},n.prototype.bind=function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(Fo.textureCount=0,Fo.uboCount=0,this.syncUniformGroup(t.uniformGroup,Fo)),i},n.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},n.prototype.syncUniformGroup=function(t,e){var r=this.getGlProgram();(!t.static||t.dirtyId!==r.uniformDirtyGroups[t.id])&&(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},n.prototype.syncUniforms=function(t,e,r){var i=t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t);i(e.uniformData,t.uniforms,this.renderer,r)},n.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=BM(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},n.prototype.syncUniformBufferGroup=function(t,e){var r=this.getGlProgram();if(!t.static||t.dirtyId!==0||!r.uniformGroups[t.id]){t.dirtyId=0;var i=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),i(r.uniformData,t.uniforms,this.renderer,Fo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])},n.prototype.createSyncBufferGroup=function(t,e,r){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var a=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,a,this.shader.uniformBindCount),this.shader.uniformBindCount++;var s=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[s];if(o||(o=this._uboCache[s]=rP(t,this.shader.program.uniformData)),t.autoManage){var u=new Float32Array(o.size/4);t.buffer.update(u)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},n.prototype.getSignature=function(t,e,r){var i=t.uniforms,a=[r+"-"];for(var s in i)a.push(s),e[s]&&a.push(e[s].type);return a.join("-")},n.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},n.prototype.generateProgram=function(t){var e=this.gl,r=t.program,i=sP(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i},n.prototype.reset=function(){this.program=null,this.shader=null},n.prototype.disposeShader=function(t){this.shader===t&&(this.shader=null)},n.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},n}();function lP(n,t){return t===void 0&&(t=[]),t[at.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.ADD]=[n.ONE,n.ONE],t[at.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.NONE]=[0,0],t[at.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],t[at.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[at.SRC_IN]=[n.DST_ALPHA,n.ZERO],t[at.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],t[at.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[at.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],t[at.DST_IN]=[n.ZERO,n.SRC_ALPHA],t[at.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],t[at.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],t[at.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[at.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],t}var uP=0,cP=1,fP=2,dP=3,pP=4,vP=5,mP=function(){function n(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=at.NONE,this._blendEq=!1,this.map=[],this.map[uP]=this.setBlend,this.map[cP]=this.setOffset,this.map[fP]=this.setCullFace,this.map[dP]=this.setDepthTest,this.map[pP]=this.setFrontFace,this.map[vP]=this.setDepthMask,this.checks=[],this.defaultState=new Bi,this.defaultState.blend=!0}return n.prototype.contextChange=function(t){this.gl=t,this.blendModes=lP(t),this.set(this.defaultState),this.reset()},n.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},n.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},n.prototype.setBlend=function(t){this.updateCheck(n.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},n.prototype.setOffset=function(t){this.updateCheck(n.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},n.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},n.prototype.setDepthMask=function(t){this.gl.depthMask(t)},n.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},n.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},n.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},n.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},n.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},n.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)},n.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},n.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},n.prototype.destroy=function(){this.gl=null},n}(),gP=function(){function n(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=ht.GC_MAX_IDLE,this.checkCountMax=ht.GC_MAX_CHECK_COUNT,this.mode=ht.GC_MODE}return n.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Oh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},n.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var a=e[i];!a.framebuffer&&this.count-a.touched>this.maxIdle&&(t.destroyTexture(a,!0),e[i]=null,r=!0)}if(r){for(var s=0,i=0;i<e.length;i++)e[i]!==null&&(e[s++]=e[i]);e.length=s}},n.prototype.unload=function(t){var e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},n.prototype.destroy=function(){this.renderer=null},n}();function yP(n){var t,e,r,i,a,s,o,u,h,l,c,f,d,p,v,m,g,y,x,b,_,w,S;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?S=(t={},t[ut.UNSIGNED_BYTE]=(e={},e[et.RGBA]=n.RGBA8,e[et.RGB]=n.RGB8,e[et.RG]=n.RG8,e[et.RED]=n.R8,e[et.RGBA_INTEGER]=n.RGBA8UI,e[et.RGB_INTEGER]=n.RGB8UI,e[et.RG_INTEGER]=n.RG8UI,e[et.RED_INTEGER]=n.R8UI,e[et.ALPHA]=n.ALPHA,e[et.LUMINANCE]=n.LUMINANCE,e[et.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,e),t[ut.BYTE]=(r={},r[et.RGBA]=n.RGBA8_SNORM,r[et.RGB]=n.RGB8_SNORM,r[et.RG]=n.RG8_SNORM,r[et.RED]=n.R8_SNORM,r[et.RGBA_INTEGER]=n.RGBA8I,r[et.RGB_INTEGER]=n.RGB8I,r[et.RG_INTEGER]=n.RG8I,r[et.RED_INTEGER]=n.R8I,r),t[ut.UNSIGNED_SHORT]=(i={},i[et.RGBA_INTEGER]=n.RGBA16UI,i[et.RGB_INTEGER]=n.RGB16UI,i[et.RG_INTEGER]=n.RG16UI,i[et.RED_INTEGER]=n.R16UI,i[et.DEPTH_COMPONENT]=n.DEPTH_COMPONENT16,i),t[ut.SHORT]=(a={},a[et.RGBA_INTEGER]=n.RGBA16I,a[et.RGB_INTEGER]=n.RGB16I,a[et.RG_INTEGER]=n.RG16I,a[et.RED_INTEGER]=n.R16I,a),t[ut.UNSIGNED_INT]=(s={},s[et.RGBA_INTEGER]=n.RGBA32UI,s[et.RGB_INTEGER]=n.RGB32UI,s[et.RG_INTEGER]=n.RG32UI,s[et.RED_INTEGER]=n.R32UI,s[et.DEPTH_COMPONENT]=n.DEPTH_COMPONENT24,s),t[ut.INT]=(o={},o[et.RGBA_INTEGER]=n.RGBA32I,o[et.RGB_INTEGER]=n.RGB32I,o[et.RG_INTEGER]=n.RG32I,o[et.RED_INTEGER]=n.R32I,o),t[ut.FLOAT]=(u={},u[et.RGBA]=n.RGBA32F,u[et.RGB]=n.RGB32F,u[et.RG]=n.RG32F,u[et.RED]=n.R32F,u[et.DEPTH_COMPONENT]=n.DEPTH_COMPONENT32F,u),t[ut.HALF_FLOAT]=(h={},h[et.RGBA]=n.RGBA16F,h[et.RGB]=n.RGB16F,h[et.RG]=n.RG16F,h[et.RED]=n.R16F,h),t[ut.UNSIGNED_SHORT_5_6_5]=(l={},l[et.RGB]=n.RGB565,l),t[ut.UNSIGNED_SHORT_4_4_4_4]=(c={},c[et.RGBA]=n.RGBA4,c),t[ut.UNSIGNED_SHORT_5_5_5_1]=(f={},f[et.RGBA]=n.RGB5_A1,f),t[ut.UNSIGNED_INT_2_10_10_10_REV]=(d={},d[et.RGBA]=n.RGB10_A2,d[et.RGBA_INTEGER]=n.RGB10_A2UI,d),t[ut.UNSIGNED_INT_10F_11F_11F_REV]=(p={},p[et.RGB]=n.R11F_G11F_B10F,p),t[ut.UNSIGNED_INT_5_9_9_9_REV]=(v={},v[et.RGB]=n.RGB9_E5,v),t[ut.UNSIGNED_INT_24_8]=(m={},m[et.DEPTH_STENCIL]=n.DEPTH24_STENCIL8,m),t[ut.FLOAT_32_UNSIGNED_INT_24_8_REV]=(g={},g[et.DEPTH_STENCIL]=n.DEPTH32F_STENCIL8,g),t):S=(y={},y[ut.UNSIGNED_BYTE]=(x={},x[et.RGBA]=n.RGBA,x[et.RGB]=n.RGB,x[et.ALPHA]=n.ALPHA,x[et.LUMINANCE]=n.LUMINANCE,x[et.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,x),y[ut.UNSIGNED_SHORT_5_6_5]=(b={},b[et.RGB]=n.RGB,b),y[ut.UNSIGNED_SHORT_4_4_4_4]=(_={},_[et.RGBA]=n.RGBA,_),y[ut.UNSIGNED_SHORT_5_5_5_1]=(w={},w[et.RGBA]=n.RGBA,w),y),S}var gu=function(){function n(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ut.UNSIGNED_BYTE,this.internalFormat=et.RGBA,this.samplerType=0}return n}(),xP=function(){function n(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Mt,this.hasIntegerTextures=!1}return n.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=yP(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new gu(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new gu(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var r=0;r<this.boundTextures.length;r++)this.bind(null,r)},n.prototype.bind=function(t,e){e===void 0&&(e=0);var r=this.gl;if(t=t==null?void 0:t.castToBaseTexture(),t&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},n.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},n.prototype.unbind=function(t){var e=this,r=e.gl,i=e.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var a=0;a<i.length;a++)i[a]===this.unknownTexture&&this.bind(null,a)}for(var a=0;a<i.length;a++)i[a]===t&&(this.currentLocation!==a&&(r.activeTexture(r.TEXTURE0+a),this.currentLocation=a),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[a]=null)},n.prototype.ensureSamplerType=function(t){var e=this,r=e.boundTextures,i=e.hasIntegerTextures,a=e.CONTEXT_UID;if(i)for(var s=t-1;s>=0;--s){var o=r[s];if(o){var u=o._glTextures[a];u.samplerType!==Fh.FLOAT&&this.renderer.texture.unbind(o)}}},n.prototype.initTexture=function(t){var e=new gu(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},n.prototype.initTextureType=function(t,e){var r,i;e.internalFormat=(i=(r=this.internalFormats[t.type])===null||r===void 0?void 0:r[t.format])!==null&&i!==void 0?i:t.format,this.webGLVersion===2&&t.type===ut.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},n.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e))e.samplerType!==Fh.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,a=t.realHeight,s=r.gl;(e.width!==i||e.height!==a||e.dirtyId<0)&&(e.width=i,e.height=a,s.texImage2D(t.target,0,e.internalFormat,i,a,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},n.prototype.destroyTexture=function(t,e){var r=this.gl;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);i!==-1&&ba(this.managedTextures,i,1)}},n.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===qe.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=zr.CLAMP:e.wrapMode=t.wrapMode,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},n.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&t.mipmap!==qe.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===je.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===je.LINEAR){var a=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===je.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===je.LINEAR?r.LINEAR:r.NEAREST)},n.prototype.destroy=function(){this.renderer=null},n}(),yu=new te,bP=function(n){kt(t,n);function t(e,r){e===void 0&&(e=Ps.UNKNOWN);var i=n.call(this)||this;return r=Object.assign({},ht.RENDER_OPTIONS,r),i.options=r,i.type=e,i.screen=new St(0,0,r.width,r.height),i.view=r.view||ht.ADAPTER.createCanvas(),i.resolution=r.resolution||ht.RESOLUTION,i.useContextAlpha=r.useContextAlpha,i.autoDensity=!!r.autoDensity,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i.backgroundAlpha=r.backgroundAlpha,r.transparent!==void 0&&(Mr("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=r.transparent,i.backgroundAlpha=r.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return t.prototype.initPlugins=function(e){for(var r in e)this.plugins[r]=new e[r](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,r){this.view.width=Math.round(e*this.resolution),this.view.height=Math.round(r*this.resolution);var i=this.view.width/this.resolution,a=this.view.height/this.resolution;this.screen.width=i,this.screen.height=a,this.autoDensity&&(this.view.style.width=i+"px",this.view.style.height=a+"px"),this.emit("resize",i,a)},t.prototype.generateTexture=function(e,r,i,a){r===void 0&&(r={}),typeof r=="number"&&(Mr("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),r={scaleMode:r,resolution:i,region:a});var s=r.region,o=rM(r,["region"]);a=s||e.getLocalBounds(null,!0),a.width===0&&(a.width=1),a.height===0&&(a.height=1);var u=Ti.create(Uc({width:a.width,height:a.height},o));return yu.tx=-a.x,yu.ty=-a.y,this.render(e,{renderTexture:u,clear:!1,transform:yu,skipUpdateTransform:!!e.parent}),u},t.prototype.destroy=function(e){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var i=this;i.plugins=null,i.type=Ps.UNKNOWN,i.view=null,i.screen=null,i._tempDisplayObjectParent=null,i.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=By(e),Si(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),t}(ao),_P=function(){function n(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return n}(),wP=function(){function n(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return n.prototype.destroy=function(){this.renderer=null},n.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},n.prototype.bind=function(t){var e=this,r=e.gl,i=e.CONTEXT_UID,a=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,a.buffer)},n.prototype.bindBufferBase=function(t,e){var r=this,i=r.gl,a=r.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var s=t._glBuffers[a]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,s.buffer)}},n.prototype.bindBufferRange=function(t,e,r){var i=this,a=i.gl,s=i.CONTEXT_UID;r=r||0;var o=t._glBuffers[s]||this.createGLBuffer(t);a.bindBufferRange(a.UNIFORM_BUFFER,e||0,o.buffer,r*256,256)},n.prototype.update=function(t){var e=this,r=e.gl,i=e.CONTEXT_UID,a=t._glBuffers[i];if(t._updateID!==a.updateID)if(a.updateID=t._updateID,r.bindBuffer(t.type,a.buffer),a.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{var s=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;a.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,s)}},n.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},n.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)},n.prototype.createGLBuffer=function(t){var e=this,r=e.CONTEXT_UID,i=e.gl;return t._glBuffers[r]=new _P(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]},n}(),t0=function(n){kt(t,n);function t(e){var r=n.call(this,Ps.WEBGL,e)||this;return e=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new Re("destroy"),contextChange:new Re("contextChange"),reset:new Re("reset"),update:new Re("update"),postrender:new Re("postrender"),prerender:new Re("prerender"),resize:new Re("resize")},r.runners.contextChange.add(r),r.globalUniforms=new xi({projectionMatrix:new te},!0),r.addSystem(jM,"mask").addSystem(wM,"context").addSystem(mP,"state").addSystem(hP,"shader").addSystem(xP,"texture").addSystem(wP,"buffer").addSystem(AM,"geometry").addSystem(TM,"framebuffer").addSystem($M,"scissor").addSystem(qM,"stencil").addSystem(ZM,"projection").addSystem(gP,"textureGC").addSystem(bM,"filter").addSystem(KM,"renderTexture").addSystem(_M,"batch"),r.initPlugins(t.__plugins),r.multisample=void 0,e.context?r.context.initFromContext(e.context):r.context.initFromOptions({alpha:!!r.useContextAlpha,antialias:e.antialias,premultipliedAlpha:r.useContextAlpha&&r.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,QS(r.context.webGLVersion===2?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return t.create=function(e){if(tE())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.contextChange=function(){var e=this.gl,r;if(this.context.webGLVersion===1){var i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{var i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}r>=Xt.HIGH?this.multisample=Xt.HIGH:r>=Xt.MEDIUM?this.multisample=Xt.MEDIUM:r>=Xt.LOW?this.multisample=Xt.LOW:this.multisample=Xt.NONE},t.prototype.addSystem=function(e,r){var i=new e(this);if(this[r])throw new Error('Whoops! The name "'+r+'" is already in use');this[r]=i;for(var a in this.runners)this.runners[a].add(i);return this},t.prototype.render=function(e,r){var i,a,s,o;if(r&&(r instanceof Ti?(Mr("6.0.0","Renderer#render arguments changed, use options instead."),i=r,a=arguments[2],s=arguments[3],o=arguments[4]):(i=r.renderTexture,a=r.clear,s=r.transform,o=r.skipUpdateTransform)),this.renderingToScreen=!i,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=s,!this.context.isLost){if(i||(this._lastObjectRendered=e),!o){var u=e.enableTempParent();e.updateTransform(),e.disableTempParent(u)}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(a!==void 0?a:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.generateTexture=function(e,r,i,a){r===void 0&&(r={});var s=n.prototype.generateTexture.call(this,e,r,i,a);return this.framebuffer.blit(),s},t.prototype.resize=function(e,r){n.prototype.resize.call(this,e,r),this.runners.resize.emit(this.screen.height,this.screen.width)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(e){this.runners.destroy.emit();for(var r in this.runners)this.runners[r].destroy();n.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(t.prototype,"extract",{get:function(){return Mr("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),t.registerPlugin=function(e,r){Mr("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),gn.add({name:e,type:Bt.RendererPlugin,ref:r})},t.__plugins={},t}(bP);gn.handleByMap(Bt.RendererPlugin,t0.__plugins);function SP(n){return t0.create(n)}var EP=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,TP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,AP=EP,e0=TP,Xc=function(){function n(){this.texArray=null,this.blend=0,this.type=cr.TRIANGLES,this.start=0,this.size=0,this.data=null}return n}(),zc=function(){function n(){this.elements=[],this.ids=[],this.count=0}return n.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},n}(),Gc=function(){function n(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(n.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),n.prototype.view=function(t){return this[t+"View"]},n.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},n.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},n}(),MP=function(n){kt(t,n);function t(e){var r=n.call(this,e)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=Bi.for2d(),r.size=ht.SPRITE_BATCH_SIZE*4,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),e.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return t.prototype.contextChange=function(){var e=this.renderer.gl;ht.PREFER_ENV===vn.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ht.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=LM(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,i=this.size/4,a=Math.floor(i/this.MAX_TEXTURES)+1;e.length<i;)e.push(new Xc);for(;r.length<a;)r.push(new zc);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this,r=e._bufferedTextures,i=e.MAX_TEXTURES,a=t._textureArrayPool,s=this.renderer.batch,o=this._tempBoundTextures,u=this.renderer.textureGC.count,h=++Mt._globalBatch,l=0,c=a[0],f=0;s.copyBoundTextures(o,i);for(var d=0;d<this._bufferSize;++d){var p=r[d];r[d]=null,p._batchEnabled!==h&&(c.count>=i&&(s.boundArray(c,o,h,i),this.buildDrawCalls(c,f,d),f=d,c=a[++l],++h),p._batchEnabled=h,p.touched=u,c.elements[c.count++]=p)}c.count>0&&(s.boundArray(c,o,h,i),this.buildDrawCalls(c,f,this._bufferSize),++l,++h);for(var d=0;d<o.length;d++)o[d]=null;Mt._globalBatch=h},t.prototype.buildDrawCalls=function(e,r,i){var a=this,s=a._bufferedElements,o=a._attributeBuffer,u=a._indexBuffer,h=a.vertexSize,l=t._drawCallPool,c=this._dcIndex,f=this._aIndex,d=this._iIndex,p=l[c];p.start=this._iIndex,p.texArray=e;for(var v=r;v<i;++v){var m=s[v],g=m._texture.baseTexture,y=ky[g.alphaMode?1:0][m.blendMode];s[v]=null,r<v&&p.blend!==y&&(p.size=d-p.start,r=v,p=l[++c],p.texArray=e,p.start=d),this.packInterleavedGeometry(m,o,u,f,d),f+=m.vertexData.length/2*h,d+=m.indices.length,p.blend=y}r<i&&(p.size=d-p.start,++c),this._dcIndex=c,this._aIndex=f,this._iIndex=d},t.prototype.bindAndClearTexArray=function(e){for(var r=this.renderer.texture,i=0;i<e.count;i++)r.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,r=e._packedGeometries,i=e._attributeBuffer,a=e._indexBuffer;ht.CAN_UPLOAD_SAME_BUFFER?(r[this._flushId]._buffer.update(i.rawBinaryData),r[this._flushId]._indexBuffer.update(a),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,r[this._flushId]=new this.geometryClass),r[this._flushId]._buffer.update(i.rawBinaryData),r[this._flushId]._indexBuffer.update(a),this.renderer.geometry.bind(r[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,i=r.gl,a=r.state,s=t._drawCallPool,o=null,u=0;u<e;u++){var h=s[u],l=h.texArray,c=h.type,f=h.size,d=h.start,p=h.blend;o!==l&&(o=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,a.set(this.state),i.drawElements(c,f,i.UNSIGNED_SHORT,d*2)}},t.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),ht.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),n.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var r=Vh(Math.ceil(e/8)),i=Pv(r),a=r*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._aBuffers[a];return s||(this._aBuffers[a]=s=new Gc(a*this.vertexSize*4)),s},t.prototype.getIndexBuffer=function(e){var r=Vh(Math.ceil(e/12)),i=Pv(r),a=r*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(a)),s},t.prototype.packInterleavedGeometry=function(e,r,i,a,s){for(var o=r.uint32View,u=r.float32View,h=a/this.vertexSize,l=e.uvs,c=e.indices,f=e.vertexData,d=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),v=p<1&&e._texture.baseTexture.alphaMode?rd(e._tintRGB,p):e._tintRGB+(p*255<<24),m=0;m<f.length;m+=2)u[a++]=f[m],u[a++]=f[m+1],u[a++]=l[m],u[a++]=l[m+1],o[a++]=v,u[a++]=d;for(var m=0;m<c.length;m++)i[s++]=h+c[m]},t._drawCallPool=[],t._textureArrayPool=[],t}(xl),PP=function(){function n(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return n.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=xi.from({uSamplers:e},!0);var i=this.fragTemplate;i=i.replace(/%count%/gi,""+t),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new co(this.vertexSrc,i)}var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new te,default:this.defaultGroupCache[t]};return new Un(this.programCache[t],a)},n.prototype.generateSampleSrc=function(t){var e="";e+=`
`,e+=`
`;for(var r=0;r<t;r++)r>0&&(e+=`
else `),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+=`
{`,e+=`
	color = texture2D(uSamplers[`+r+"], vTextureCoord);",e+=`
}`;return e+=`
`,e+=`
`,e},n}(),r0=function(n){kt(t,n);function t(e){e===void 0&&(e=!1);var r=n.call(this)||this;return r._buffer=new xe(null,e,!1),r._indexBuffer=new xe(null,e,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,ut.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,ut.FLOAT).addAttribute("aColor",r._buffer,4,!0,ut.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,ut.FLOAT).addIndex(r._indexBuffer),r}return t}(uo),Yv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Wv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,IP=function(){function n(){}return n.create=function(t){var e=Object.assign({vertex:Yv,fragment:Wv,geometryClass:r0,vertexSize:6},t),r=e.vertex,i=e.fragment,a=e.vertexSize,s=e.geometryClass;return function(o){kt(u,o);function u(h){var l=o.call(this,h)||this;return l.shaderGenerator=new PP(r,i),l.geometryClass=s,l.vertexSize=a,l}return u}(MP)},Object.defineProperty(n,"defaultVertexSrc",{get:function(){return Yv},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentTemplate",{get:function(){return Wv},enumerable:!1,configurable:!0}),n}(),n0=IP.create();Object.assign(n0,{extension:{name:"batch",type:Bt.RendererPlugin}});/*!
 * @pixi/accessibility - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var CP={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ae.mixin(CP);var RP=9,Oo=100,FP=0,OP=0,Hv=2,jv=1,BP=-1e3,NP=-1e3,kP=2,LP=function(){function n(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Vr.tablet||Vr.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width=Oo+"px",e.style.height=Oo+"px",e.style.position="absolute",e.style.top=FP+"px",e.style.left=OP+"px",e.style.zIndex=Hv.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(n.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),n.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width=jv+"px",e.style.height=jv+"px",e.style.position="absolute",e.style.top=BP+"px",e.style.left=NP+"px",e.style.zIndex=kP.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},n.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},n.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)===null||t===void 0||t.appendChild(this.div))},n.prototype.deactivate=function(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)===null||t===void 0||t.removeChild(this.div))},n.prototype.updateAccessibleObjects=function(t){if(!(!t.visible||!t.accessibleChildren)){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},n.prototype.update=function(){var t=performance.now();if(!(Vr.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,!!this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=e.left,i=e.top,a=e.width,s=e.height,o=this.renderer,u=o.width,h=o.height,l=o.resolution,c=a/u*l,f=s/h*l,d=this.div;d.style.left=r+"px",d.style.top=i+"px",d.style.width=u+"px",d.style.height=h+"px";for(var p=0;p<this.children.length;p++){var v=this.children[p];if(v.renderId!==this.renderId)v._accessibleActive=!1,ba(this.children,p,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,p--;else{d=v._accessibleDiv;var m=v.hitArea,g=v.worldTransform;v.hitArea?(d.style.left=(g.tx+m.x*g.a)*c+"px",d.style.top=(g.ty+m.y*g.d)*f+"px",d.style.width=m.width*g.a*c+"px",d.style.height=m.height*g.d*f+"px"):(m=v.getBounds(),this.capHitArea(m),d.style.left=m.x*c+"px",d.style.top=m.y*f+"px",d.style.width=m.width*c+"px",d.style.height=m.height*f+"px",d.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(d.title=v.accessibleTitle),d.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&d.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==d.title||v.tabIndex!==d.tabIndex)&&(d.title=v.accessibleTitle,d.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}},n.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},n.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,r=e.width,i=e.height;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)},n.prototype.addChild=function(t){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=Oo+"px",e.style.height=Oo+"px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Hv.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title="displayObject "+t.tabIndex),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},n.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"click",i),e.dispatchEvent(r,"pointertap",i),e.dispatchEvent(r,"tap",i)},n.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"mouseover",i)},n.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"mouseout",i)},n.prototype._onKeyDown=function(t){t.keyCode===RP&&this.activate()},n.prototype._onMouseMove=function(t){t.movementX===0&&t.movementY===0||this.deactivate()},n.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},n.extension={name:"accessibility",type:[Bt.RendererPlugin,Bt.CanvasRendererPlugin]},n}();/*!
 * @pixi/interaction - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var $v=function(){function n(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ut,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(n.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),n.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},n.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},n.prototype.reset=function(){this.isPrimary=!1},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yc=function(n,t){return Yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Yc(n,t)};function DP(n,t){Yc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var UP=function(){function n(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return n.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},n.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},n}(),xu=function(){function n(t){this._pointerId=t,this._flags=n.FLAGS.NONE}return n.prototype._doSet=function(t,e){e?this._flags=this._flags|t:this._flags=this._flags&~t},Object.defineProperty(n.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"none",{get:function(){return this._flags===n.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"over",{get:function(){return(this._flags&n.FLAGS.OVER)!==0},set:function(t){this._doSet(n.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rightDown",{get:function(){return(this._flags&n.FLAGS.RIGHT_DOWN)!==0},set:function(t){this._doSet(n.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leftDown",{get:function(){return(this._flags&n.FLAGS.LEFT_DOWN)!==0},set:function(t){this._doSet(n.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),n.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),n}(),VP=function(){function n(){this._tempPoint=new Ut}return n.prototype.recursiveFindHit=function(t,e,r,i,a){var s;if(!e||!e.visible)return!1;var o=t.data.global;a=e.interactive||a;var u=!1,h=a,l=!0;if(e.hitArea)i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?u=!0:(i=!1,l=!1)),h=!1;else if(e._mask&&i){var c=e._mask.isMaskData?e._mask.maskObject:e._mask;c&&!(!((s=c.containsPoint)===null||s===void 0)&&s.call(c,o))&&(i=!1)}if(l&&e.interactiveChildren&&e.children)for(var f=e.children,d=f.length-1;d>=0;d--){var p=f[d],v=this.recursiveFindHit(t,p,r,i,h);if(v){if(!p.parent)continue;h=!1,v&&(t.target&&(i=!1),u=!0)}}return a&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(u=!0),e.interactive&&(u&&!t.target&&(t.target=e),r&&r(t,e,!!u))),u},n.prototype.findHit=function(t,e,r,i){this.recursiveFindHit(t,e,r,i,!1)},n}(),XP={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(n){n?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ae.mixin(XP);var Bo=1,No={target:null,data:{global:null}},zP=function(n){DP(t,n);function t(e,r){var i=n.call(this)||this;return r=r||{},i.renderer=e,i.autoPreventDefault=r.autoPreventDefault!==void 0?r.autoPreventDefault:!0,i.interactionFrequency=r.interactionFrequency||10,i.mouse=new $v,i.mouse.identifier=Bo,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[Bo]=i.mouse,i.interactionDataPool=[],i.eventData=new UP,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new VP,i._tempDisplayObject=new Xy,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=r.useSystemTicker!==void 0?r.useSystemTicker:!0,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,r){return No.target=null,No.data.global=e,r||(r=this.lastObjectRendered),this.processInteractive(No,r,null,!0),No.target},t.prototype.setTargetElement=function(e,r){r===void 0&&(r=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=r,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Fe.system.add(this.tickerUpdate,this,mn.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(Fe.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var e in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var r=this.activeInteractionData[e];if(r.originalEvent&&r.pointerType!=="touch"){var i=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var r=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(r=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var i=this.cursorStyles[e];if(i)switch(typeof i){case"string":r&&(this.interactionDOMElement.style.cursor=i);break;case"function":i(e);break;case"object":r&&Object.assign(this.interactionDOMElement.style,i);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,r,i){(!i.stopPropagationHint||e===i.stopsPropagatingAt)&&(i.currentTarget=e,i.type=r,e.emit(r,i),e[r]&&e[r](i))},t.prototype.delayDispatchEvent=function(e,r,i){this.delayedEvents.push({displayObject:e,eventString:r,eventData:i})},t.prototype.mapPositionToPoint=function(e,r,i){var a;this.interactionDOMElement.parentElement?a=this.interactionDOMElement.getBoundingClientRect():a={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var s=1/this.resolution;e.x=(r-a.left)*(this.interactionDOMElement.width/a.width)*s,e.y=(i-a.top)*(this.interactionDOMElement.height/a.height)*s},t.prototype.processInteractive=function(e,r,i,a){var s=this.search.findHit(e,r,i,a),o=this.delayedEvents;if(!o.length)return s;e.stopPropagationHint=!1;var u=o.length;this.delayedEvents=[];for(var h=0;h<u;h++){var l=o[h],c=l.displayObject,f=l.eventString,d=l.eventData;d.stopsPropagatingAt===c&&(d.stopPropagationHint=!0),this.dispatchEvent(c,f,d)}return s},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var r=this.normalizeToPointerData(e);if(this.autoPreventDefault&&r[0].isNormalized){var i=e.cancelable||!("cancelable"in e);i&&e.preventDefault()}for(var a=r.length,s=0;s<a;s++){var o=r[s],u=this.getInteractionDataForPointerId(o),h=this.configureInteractionEventForDOMEvent(this.eventData,o,u);if(h.data.originalEvent=e,this.processInteractive(h,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",h),o.pointerType==="touch")this.emit("touchstart",h);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var l=o.button===2;this.emit(l?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,r,i){var a=e.data,s=e.data.identifier;if(i){if(r.trackedPointers[s]||(r.trackedPointers[s]=new xu(s)),this.dispatchEvent(r,"pointerdown",e),a.pointerType==="touch")this.dispatchEvent(r,"touchstart",e);else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;o?r.trackedPointers[s].rightDown=!0:r.trackedPointers[s].leftDown=!0,this.dispatchEvent(r,o?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,r,i){var a=this.normalizeToPointerData(e),s=a.length,o=e.target;e.composedPath&&e.composedPath().length>0&&(o=e.composedPath()[0]);for(var u=o!==this.interactionDOMElement?"outside":"",h=0;h<s;h++){var l=a[h],c=this.getInteractionDataForPointerId(l),f=this.configureInteractionEventForDOMEvent(this.eventData,l,c);if(f.data.originalEvent=e,this.processInteractive(f,this.lastObjectRendered,i,r||!u),this.emit(r?"pointercancel":"pointerup"+u,f),l.pointerType==="mouse"||l.pointerType==="pen"){var d=l.button===2;this.emit(d?"rightup"+u:"mouseup"+u,f)}else l.pointerType==="touch"&&(this.emit(r?"touchcancel":"touchend"+u,f),this.releaseInteractionDataForPointerId(l.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,r){var i=e.data,a=e.data.identifier;r.trackedPointers[a]!==void 0&&(delete r.trackedPointers[a],this.dispatchEvent(r,"pointercancel",e),i.pointerType==="touch"&&this.dispatchEvent(r,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,r,i){var a=e.data,s=e.data.identifier,o=r.trackedPointers[s],u=a.pointerType==="touch",h=a.pointerType==="mouse"||a.pointerType==="pen",l=!1;if(h){var c=a.button===2,f=xu.FLAGS,d=c?f.RIGHT_DOWN:f.LEFT_DOWN,p=o!==void 0&&o.flags&d;i?(this.dispatchEvent(r,c?"rightup":"mouseup",e),p&&(this.dispatchEvent(r,c?"rightclick":"click",e),l=!0)):p&&this.dispatchEvent(r,c?"rightupoutside":"mouseupoutside",e),o&&(c?o.rightDown=!1:o.leftDown=!1)}i?(this.dispatchEvent(r,"pointerup",e),u&&this.dispatchEvent(r,"touchend",e),o&&((!h||l)&&this.dispatchEvent(r,"pointertap",e),u&&(this.dispatchEvent(r,"tap",e),o.over=!1))):o&&(this.dispatchEvent(r,"pointerupoutside",e),u&&this.dispatchEvent(r,"touchendoutside",e)),o&&o.none&&delete r.trackedPointers[s]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var r=this.normalizeToPointerData(e);(r[0].pointerType==="mouse"||r[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var i=r.length,a=0;a<i;a++){var s=r[a],o=this.getInteractionDataForPointerId(s),u=this.configureInteractionEventForDOMEvent(this.eventData,s,o);u.data.originalEvent=e,this.processInteractive(u,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",u),s.pointerType==="touch"&&this.emit("touchmove",u),(s.pointerType==="mouse"||s.pointerType==="pen")&&this.emit("mousemove",u)}r[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,r,i){var a=e.data,s=a.pointerType==="touch",o=a.pointerType==="mouse"||a.pointerType==="pen";o&&this.processPointerOverOut(e,r,i),(!this.moveWhenInside||i)&&(this.dispatchEvent(r,"pointermove",e),s&&this.dispatchEvent(r,"touchmove",e),o&&this.dispatchEvent(r,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var r=this.normalizeToPointerData(e),i=r[0];i.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var a=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,a);s.data.originalEvent=i,this.processInteractive(s,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",s),i.pointerType==="mouse"||i.pointerType==="pen"?this.emit("mouseout",s):this.releaseInteractionDataForPointerId(a.identifier)}},t.prototype.processPointerOverOut=function(e,r,i){var a=e.data,s=e.data.identifier,o=a.pointerType==="mouse"||a.pointerType==="pen",u=r.trackedPointers[s];i&&!u&&(u=r.trackedPointers[s]=new xu(s)),u!==void 0&&(i&&this.mouseOverRenderer?(u.over||(u.over=!0,this.delayDispatchEvent(r,"pointerover",e),o&&this.delayDispatchEvent(r,"mouseover",e)),o&&this.cursor===null&&(this.cursor=r.cursor)):u.over&&(u.over=!1,this.dispatchEvent(r,"pointerout",this.eventData),o&&this.dispatchEvent(r,"mouseout",e),u.none&&delete r.trackedPointers[s]))},t.prototype.onPointerOver=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var r=this.normalizeToPointerData(e),i=r[0],a=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,a);s.data.originalEvent=i,i.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",s),(i.pointerType==="mouse"||i.pointerType==="pen")&&this.emit("mouseover",s)}},t.prototype.getInteractionDataForPointerId=function(e){var r=e.pointerId,i;return r===Bo||e.pointerType==="mouse"?i=this.mouse:this.activeInteractionData[r]?i=this.activeInteractionData[r]:(i=this.interactionDataPool.pop()||new $v,i.identifier=r,this.activeInteractionData[r]=i),i.copyEvent(e),i},t.prototype.releaseInteractionDataForPointerId=function(e){var r=this.activeInteractionData[e];r&&(delete this.activeInteractionData[e],r.reset(),this.interactionDataPool.push(r))},t.prototype.configureInteractionEventForDOMEvent=function(e,r,i){return e.data=i,this.mapPositionToPoint(i.global,r.clientX,r.clientY),r.pointerType==="touch"&&(r.globalX=i.global.x,r.globalY=i.global.y),i.originalEvent=r,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var i=0,a=e.changedTouches.length;i<a;i++){var s=e.changedTouches[i];typeof s.button>"u"&&(s.button=e.touches.length?1:0),typeof s.buttons>"u"&&(s.buttons=e.touches.length?1:0),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,r.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){var o=e;typeof o.isPrimary>"u"&&(o.isPrimary=!0),typeof o.width>"u"&&(o.width=1),typeof o.height>"u"&&(o.height=1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="mouse"),typeof o.pointerId>"u"&&(o.pointerId=Bo),typeof o.pressure>"u"&&(o.pressure=.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t.extension={name:"interaction",type:[Bt.RendererPlugin,Bt.CanvasRendererPlugin]},t}(ao);/*!
 * @pixi/extract - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var GP=new St,YP=4,WP=function(){function n(t){this.renderer=t}return n.prototype.image=function(t,e,r){var i=new Image;return i.src=this.base64(t,e,r),i},n.prototype.base64=function(t,e,r){return this.canvas(t).toDataURL(e,r)},n.prototype.canvas=function(t,e){var r=this._rawPixels(t,e),i=r.pixels,a=r.width,s=r.height,o=r.flipY,u=new Rv(a,s,1),h=u.context.getImageData(0,0,a,s);if(n.arrayPostDivide(i,h.data),u.context.putImageData(h,0,0),o){var l=new Rv(u.width,u.height,1);l.context.scale(1,-1),l.context.drawImage(u.canvas,0,-s),u.destroy(),u=l}return u.canvas},n.prototype.pixels=function(t,e){var r=this._rawPixels(t,e).pixels;return n.arrayPostDivide(r,r),r},n.prototype._rawPixels=function(t,e){var r=this.renderer,i,a=!1,s,o=!1;if(t)if(t instanceof Ti)s=t;else{var u=r.context.webGLVersion>=2?r.multisample:Xt.NONE;if(s=this.renderer.generateTexture(t,{multisample:u}),u!==Xt.NONE){var h=Ti.create({width:s.width,height:s.height});r.framebuffer.bind(s.framebuffer),r.framebuffer.blit(h.framebuffer),r.framebuffer.bind(null),s.destroy(!0),s=h}o=!0}s?(i=s.baseTexture.resolution,e=e??s.frame,a=!1,r.renderTexture.bind(s)):(i=r.resolution,e||(e=GP,e.width=r.width,e.height=r.height),a=!0,r.renderTexture.bind(null));var l=Math.round(e.width*i),c=Math.round(e.height*i),f=new Uint8Array(YP*l*c),d=r.gl;return d.readPixels(Math.round(e.x*i),Math.round(e.y*i),l,c,d.RGBA,d.UNSIGNED_BYTE,f),o&&s.destroy(!0),{pixels:f,width:l,height:c,flipY:a}},n.prototype.destroy=function(){this.renderer=null},n.arrayPostDivide=function(t,e){for(var r=0;r<t.length;r+=4){var i=e[r+3]=t[r+3];i!==0?(e[r]=Math.round(Math.min(t[r]*255/i,255)),e[r+1]=Math.round(Math.min(t[r+1]*255/i,255)),e[r+2]=Math.round(Math.min(t[r+2]*255/i,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}},n.extension={name:"extract",type:Bt.RendererPlugin},n}();/*!
 * @pixi/loaders - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ko=function(){function n(t,e,r){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=r,this._next=this._prev=this._owner=null}return n.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},n}();function qv(n,t){return n._head?(n._tail._next=t,t._prev=n._tail,n._tail=t):(n._head=t,n._tail=t),t._owner=n,t}var un=function(){function n(){this._head=this._tail=void 0}return n.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r},n.prototype.has=function(t){if(!(t instanceof ko))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},n.prototype.dispatch=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0},n.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return qv(this,new ko(t,!1,e))},n.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return qv(this,new ko(t,!0,e))},n.prototype.detach=function(t){if(!(t instanceof ko))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)},n.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},n}();function i0(n,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=e.parser[t.strictMode?"strict":"loose"].exec(n),i={},a=14;a--;)i[e.key[a]]=r[a]||"";return i[e.q.name]={},i[e.key[12]].replace(e.q.parser,function(s,o,u){o&&(i[e.q.name][o]=u)}),i}var bu,Lo=null,HP=0,Zv=200,jP=204,$P=1223,qP=2;function Kv(){}function Jv(n,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(n[t]=e)}function _u(n){return n.toString().replace("object ","")}var Ft=function(){function n(t,e,r){if(this._dequeue=Kv,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(n.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=r.crossOrigin===!0?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=n.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Kv,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new un,this.onProgress=new un,this.onComplete=new un,this.onAfterMiddleware=new un}return n.setExtensionLoadType=function(t,e){Jv(n._loadTypeMap,t,e)},n.setExtensionXhrType=function(t,e){Jv(n._xhrTypeMap,t,e)},Object.defineProperty(n.prototype,"isDataUrl",{get:function(){return this._hasFlag(n.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isComplete",{get:function(){return this._hasFlag(n.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._hasFlag(n.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),n.prototype.complete=function(){this._clearEvents(),this._finish()},n.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=n.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},n.prototype.load=function(t){var e=this;if(!this.isLoading){if(this.isComplete){t&&setTimeout(function(){return t(e)},1);return}else t&&this.onComplete.once(t);switch(this._setFlag(n.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case n.LOAD_TYPE.IMAGE:this.type=n.TYPE.IMAGE,this._loadElement("image");break;case n.LOAD_TYPE.AUDIO:this.type=n.TYPE.AUDIO,this._loadSourceElement("audio");break;case n.LOAD_TYPE.VIDEO:this.type=n.TYPE.VIDEO,this._loadSourceElement("video");break;case n.LOAD_TYPE.XHR:default:typeof bu>"u"&&(bu=!!(globalThis.XDomainRequest&&!("withCredentials"in new XMLHttpRequest))),bu&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},n.prototype._hasFlag=function(t){return(this._flags&t)!==0},n.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},n.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},n.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(n.STATUS_FLAGS.COMPLETE,!0),this._setFlag(n.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},n.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&typeof globalThis.Image<"u"?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&typeof globalThis.Audio<"u"?this.data=new Audio:this.data=document.createElement(t),this.data===null){this.abort("Unsupported element: "+t);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(t.withCredentials=!0),t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===n.XHR_RESPONSE_TYPE.JSON||this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=n.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},n.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},n.prototype._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=r,i},n.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},n.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},n.prototype._onTimeout=function(){this.abort("Load timed out.")},n.prototype._xhrOnError=function(){var t=this.xhr;this.abort(_u(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},n.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(_u(t)+" Request timed out.")},n.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(_u(t)+" Request was aborted by the user.")},n.prototype._xhrOnLoad=function(){var t=this.xhr,e="",r=typeof t.status>"u"?Zv:t.status;(t.responseType===""||t.responseType==="text"||typeof t.responseType>"u")&&(e=t.responseText),r===HP&&(e.length>0||t.responseType===n.XHR_RESPONSE_TYPE.BUFFER)?r=Zv:r===$P&&(r=jP);var i=r/100|0;if(i===qP)if(this.xhrType===n.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=n.TYPE.TEXT;else if(this.xhrType===n.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=n.TYPE.JSON}catch(o){this.abort("Error trying to parse loaded json: "+o);return}else if(this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var a=new DOMParser;this.data=a.parseFromString(e,"text/xml")}else{var s=document.createElement("div");s.innerHTML=e,this.data=s}this.type=n.TYPE.XML}catch(o){this.abort("Error trying to parse loaded xml: "+o);return}else this.data=t.response||e;else{this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL);return}this.complete()},n.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Lo||(Lo=document.createElement("a")),Lo.href=t;var r=i0(Lo.href,{strictMode:!0}),i=!r.port&&e.port===""||r.port===e.port,a=r.protocol?r.protocol+":":"";return r.host!==e.hostname||!i||a!==e.protocol?"anonymous":""},n.prototype._determineXhrType=function(){return n._xhrTypeMap[this.extension]||n.XHR_RESPONSE_TYPE.TEXT},n.prototype._determineLoadType=function(){return n._loadTypeMap[this.extension]||n.LOAD_TYPE.XHR},n.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),a=t.indexOf("#"),s=Math.min(i>-1?i:t.length,a>-1?a:t.length);t=t.substring(0,s),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},n.prototype._getMimeFromXhrType=function(t){switch(t){case n.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case n.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case n.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case n.XHR_RESPONSE_TYPE.JSON:return"application/json";case n.XHR_RESPONSE_TYPE.DEFAULT:case n.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n}();(function(n){(function(t){t[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING"})(n.STATUS_FLAGS||(n.STATUS_FLAGS={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JSON=1]="JSON",t[t.XML=2]="XML",t[t.IMAGE=3]="IMAGE",t[t.AUDIO=4]="AUDIO",t[t.VIDEO=5]="VIDEO",t[t.TEXT=6]="TEXT"}(n.TYPE||(n.TYPE={})),function(t){t[t.XHR=1]="XHR",t[t.IMAGE=2]="IMAGE",t[t.AUDIO=3]="AUDIO",t[t.VIDEO=4]="VIDEO"}(n.LOAD_TYPE||(n.LOAD_TYPE={})),function(t){t.DEFAULT="text",t.BUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(n.XHR_RESPONSE_TYPE||(n.XHR_RESPONSE_TYPE={})),n._loadTypeMap={gif:n.LOAD_TYPE.IMAGE,png:n.LOAD_TYPE.IMAGE,bmp:n.LOAD_TYPE.IMAGE,jpg:n.LOAD_TYPE.IMAGE,jpeg:n.LOAD_TYPE.IMAGE,tif:n.LOAD_TYPE.IMAGE,tiff:n.LOAD_TYPE.IMAGE,webp:n.LOAD_TYPE.IMAGE,tga:n.LOAD_TYPE.IMAGE,avif:n.LOAD_TYPE.IMAGE,svg:n.LOAD_TYPE.IMAGE,"svg+xml":n.LOAD_TYPE.IMAGE,mp3:n.LOAD_TYPE.AUDIO,ogg:n.LOAD_TYPE.AUDIO,wav:n.LOAD_TYPE.AUDIO,mp4:n.LOAD_TYPE.VIDEO,webm:n.LOAD_TYPE.VIDEO},n._xhrTypeMap={xhtml:n.XHR_RESPONSE_TYPE.DOCUMENT,html:n.XHR_RESPONSE_TYPE.DOCUMENT,htm:n.XHR_RESPONSE_TYPE.DOCUMENT,xml:n.XHR_RESPONSE_TYPE.DOCUMENT,tmx:n.XHR_RESPONSE_TYPE.DOCUMENT,svg:n.XHR_RESPONSE_TYPE.DOCUMENT,tsx:n.XHR_RESPONSE_TYPE.DOCUMENT,gif:n.XHR_RESPONSE_TYPE.BLOB,png:n.XHR_RESPONSE_TYPE.BLOB,bmp:n.XHR_RESPONSE_TYPE.BLOB,jpg:n.XHR_RESPONSE_TYPE.BLOB,jpeg:n.XHR_RESPONSE_TYPE.BLOB,tif:n.XHR_RESPONSE_TYPE.BLOB,tiff:n.XHR_RESPONSE_TYPE.BLOB,webp:n.XHR_RESPONSE_TYPE.BLOB,tga:n.XHR_RESPONSE_TYPE.BLOB,avif:n.XHR_RESPONSE_TYPE.BLOB,json:n.XHR_RESPONSE_TYPE.JSON,text:n.XHR_RESPONSE_TYPE.TEXT,txt:n.XHR_RESPONSE_TYPE.TEXT,ttf:n.XHR_RESPONSE_TYPE.BUFFER,otf:n.XHR_RESPONSE_TYPE.BUFFER},n.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(Ft||(Ft={}));function Kn(){}function ZP(n){return function(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];if(n===null)throw new Error("Callback was already called.");var a=n;n=null,a.apply(this,r)}}var KP=function(){function n(t,e){this.data=t,this.callback=e}return n}(),wu=function(){function n(t,e){var r=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=Kn,this.unsaturated=Kn,this.empty=Kn,this.drain=Kn,this.error=Kn,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(i,a,s){if(s&&typeof s!="function")throw new Error("task callback must be a function");if(r.started=!0,i==null&&r.idle()){setTimeout(function(){return r.drain()},1);return}var o=new KP(i,typeof s=="function"?s:Kn);a?r._tasks.unshift(o):r._tasks.push(o),setTimeout(r.process,1)},this.process=function(){for(;!r.paused&&r.workers<r.concurrency&&r._tasks.length;){var i=r._tasks.shift();r._tasks.length===0&&r.empty(),r.workers+=1,r.workers===r.concurrency&&r.saturated(),r._worker(i.data,ZP(r._next(i)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return n.prototype._next=function(t){var e=this;return function(){for(var r=arguments,i=[],a=0;a<arguments.length;a++)i[a]=r[a];e.workers-=1,t.callback.apply(t,i),i[0]!=null&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},n.prototype.push=function(t,e){this._insert(t,!1,e)},n.prototype.kill=function(){this.workers=0,this.drain=Kn,this.started=!1,this._tasks=[]},n.prototype.unshift=function(t,e){this._insert(t,!0,e)},n.prototype.length=function(){return this._tasks.length},n.prototype.running=function(){return this.workers},n.prototype.idle=function(){return this._tasks.length+this.workers===0},n.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},n.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},n.eachSeries=function(t,e,r,i){var a=0,s=t.length;function o(u){if(u||a===s){r&&r(u);return}i?setTimeout(function(){e(t[a++],o)},1):e(t[a++],o)}o()},n.queue=function(t,e){return new n(t,e)},n}(),Su=100,JP=/(#[\w-]+)?$/,Ai=function(){function n(t,e){var r=this;t===void 0&&(t=""),e===void 0&&(e=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(u,h){return r._loadResource(u,h)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(u,h){return r._loadResource(u,h)},this._queue=wu.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new un,this.onError=new un,this.onLoad=new un,this.onStart=new un,this.onComplete=new un;for(var i=0;i<n._plugins.length;++i){var a=n._plugins[i],s=a.pre,o=a.use;s&&this.pre(s),o&&this.use(o)}this._protected=!1}return n.prototype._add=function(t,e,r,i){if(this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Ft(t,e,r),typeof i=="function"&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var a=r.parentResource,s=[],o=0;o<a.children.length;++o)a.children[o].isComplete||s.push(a.children[o]);var u=a.progressChunk*(s.length+1),h=u/(s.length+2);a.children.push(this.resources[t]),a.progressChunk=h;for(var o=0;o<s.length;++o)s[o].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},n.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},n.prototype.use=function(t){return this._afterMiddleware.push(t),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},n.prototype.load=function(t){if(Mr("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=this._queue._tasks.length,r=Su/e,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},Object.defineProperty(n.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),n.prototype._prepareUrl=function(t){var e=i0(t,{strictMode:!0}),r;if(e.protocol||!e.path||t.indexOf("//")===0?r=t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?r=this.baseUrl+"/"+t:r=this.baseUrl+t,this.defaultQueryString){var i=JP.exec(r)[0];r=r.slice(0,r.length-i.length),r.indexOf("?")!==-1?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=i}return r},n.prototype._loadResource=function(t,e){var r=this;t._dequeue=e,wu.eachSeries(this._beforeMiddleware,function(i,a){i.call(r,t,function(){a(t.isComplete?{}:null)})},function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())},!0)},n.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},n.prototype._onComplete=function(){this.progress=Su,this.loading=!1,this.onComplete.dispatch(this,this.resources)},n.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),wu.eachSeries(this._afterMiddleware,function(r,i){r.call(e,t,i)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(Su,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},n.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(n,"shared",{get:function(){var t=n._shared;return t||(t=new n,t._protected=!0,n._shared=t),t},enumerable:!1,configurable:!0}),n.registerPlugin=function(t){return Mr("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),gn.add({type:Bt.Loader,ref:t}),n},n._plugins=[],n}();gn.handleByList(Bt.Loader,Ai._plugins);Ai.prototype.add=function(t,e,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;++a)this.add(t[a]);return this}if(typeof t=="object"&&(r=t,i=e||r.callback||r.onComplete,e=r.url,t=r.name||r.key||r.url),typeof e!="string"&&(i=r,r=e,e=t),typeof e!="string")throw new Error("No url passed to add resource to loader.");return typeof r=="function"&&(i=r,r=null),this._add(t,e,r,i)};var QP=function(){function n(){}return n.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Ai.shared:new Ai},n.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},n.extension=Bt.Application,n}(),tI=function(){function n(){}return n.add=function(){Ft.setExtensionLoadType("svg",Ft.LOAD_TYPE.XHR),Ft.setExtensionXhrType("svg",Ft.XHR_RESPONSE_TYPE.TEXT)},n.use=function(t,e){if(t.data&&(t.type===Ft.TYPE.IMAGE||t.extension==="svg")){var r=t.data,i=t.url,a=t.name,s=t.metadata;vt.fromLoader(r,i,a,s).then(function(o){t.texture=o,e()}).catch(e)}else e()},n.extension=Bt.Loader,n}(),eI="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rI(n){for(var t="",e=0;e<n.length;){for(var r=[0,0,0],i=[0,0,0,0],a=0;a<r.length;++a)e<n.length?r[a]=n.charCodeAt(e++)&255:r[a]=0;i[0]=r[0]>>2,i[1]=(r[0]&3)<<4|r[1]>>4,i[2]=(r[1]&15)<<2|r[2]>>6,i[3]=r[2]&63;var s=e-(n.length-1);switch(s){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64;break}for(var a=0;a<i.length;++a)t+=eI.charAt(i[a])}return t}function nI(n,t){if(!n.data){t();return}if(n.xhr&&n.xhrType===Ft.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof n.data=="string"){var e=n.xhr.getResponseHeader("content-type");if(e&&e.indexOf("image")===0){n.data=new Image,n.data.src="data:"+e+";base64,"+rI(n.xhr.responseText),n.type=Ft.TYPE.IMAGE,n.data.onload=function(){n.data.onload=null,t()};return}}else if(n.data.type.indexOf("image")===0){var r=globalThis.URL||globalThis.webkitURL,i=r.createObjectURL(n.data);n.blob=n.data,n.data=new Image,n.data.src=i,n.type=Ft.TYPE.IMAGE,n.data.onload=function(){r.revokeObjectURL(i),n.data.onload=null,t()};return}}t()}var iI=function(){function n(){}return n.extension=Bt.Loader,n.use=nI,n}();gn.add(tI,iI);/*!
 * @pixi/compressed-textures - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Rt,gt;(function(n){n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR"})(gt||(gt={}));var Yh=(Rt={},Rt[gt.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Rt[gt.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Rt[gt.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Rt[gt.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Rt[gt.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Rt[gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Rt[gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Rt[gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Rt[gt.COMPRESSED_R11_EAC]=.5,Rt[gt.COMPRESSED_SIGNED_R11_EAC]=.5,Rt[gt.COMPRESSED_RG11_EAC]=1,Rt[gt.COMPRESSED_SIGNED_RG11_EAC]=1,Rt[gt.COMPRESSED_RGB8_ETC2]=.5,Rt[gt.COMPRESSED_RGBA8_ETC2_EAC]=1,Rt[gt.COMPRESSED_SRGB8_ETC2]=.5,Rt[gt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Rt[gt.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Rt[gt.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Rt[gt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Rt[gt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Rt[gt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Rt[gt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Rt[gt.COMPRESSED_RGB_ETC1_WEBGL]=.5,Rt[gt.COMPRESSED_RGB_ATC_WEBGL]=.5,Rt[gt.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Rt[gt.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Rt[gt.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,Rt);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wc=function(n,t){return Wc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Wc(n,t)};function a0(n,t){Wc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function aI(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(l){try{h(r.next(l))}catch(c){s(c)}}function u(l){try{h(r.throw(l))}catch(c){s(c)}}function h(l){l.done?a(l.value):i(l.value).then(o,u)}h((r=r.apply(n,[])).next())})}function sI(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(h){return function(l){return u([h,l])}}function u(h){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=h[0]&2?i.return:h[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,h[1])).done)return a;switch(i=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,i=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){e.label=h[1];break}if(h[0]===6&&e.label<a[1]){e.label=a[1],a=h;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(h);break}a[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(n,e)}catch(l){h=[6,l],i=0}finally{r=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var oI=function(n){a0(t,n);function t(e,r){r===void 0&&(r={width:1,height:1,autoLoad:!0});var i=this,a,s;return typeof e=="string"?(a=e,s=new Uint8Array):(a=null,s=e),i=n.call(this,s,r)||this,i.origin=a,i.buffer=s?new Gc(s):null,i.origin&&r.autoLoad!==!1&&i.load(),s&&s.length&&(i.loaded=!0,i.onBlobLoaded(i.buffer.rawBinaryData)),i}return t.prototype.onBlobLoaded=function(e){},t.prototype.load=function(){return aI(this,void 0,Promise,function(){var e,r,i;return sI(this,function(a){switch(a.label){case 0:return[4,fetch(this.origin)];case 1:return e=a.sent(),[4,e.blob()];case 2:return r=a.sent(),[4,r.arrayBuffer()];case 3:return i=a.sent(),this.data=new Uint32Array(i),this.buffer=new Gc(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),[2,this]}})})},t}(lo),Hc=function(n){a0(t,n);function t(e,r){var i=n.call(this,e,r)||this;return i.format=r.format,i.levels=r.levels||1,i._width=r.width,i._height=r.height,i._extension=t._formatToExtension(i.format),(r.levelBuffers||i.buffer)&&(i._levelBuffers=r.levelBuffers||t._createLevelBuffers(e instanceof Uint8Array?e:i.buffer.uint8View,i.format,i.levels,4,4,i.width,i.height)),i}return t.prototype.upload=function(e,r,i){var a=e.gl,s=e.context.extensions[this._extension];if(!s)throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var o=0,u=this.levels;o<u;o++){var h=this._levelBuffers[o],l=h.levelID,c=h.levelWidth,f=h.levelHeight,d=h.levelBuffer;a.compressedTexImage2D(a.TEXTURE_2D,l,this.format,c,f,0,d)}return!0},t.prototype.onBlobLoaded=function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},t._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},t._createLevelBuffers=function(e,r,i,a,s,o,u){for(var h=new Array(i),l=e.byteOffset,c=o,f=u,d=c+a-1&~(a-1),p=f+s-1&~(s-1),v=d*p*Yh[r],m=0;m<i;m++)h[m]={levelID:m,levelWidth:i>1?c:d,levelHeight:i>1?f:p,levelBuffer:new Uint8Array(e.buffer,l,v)},l+=v,c=c>>1||1,f=f>>1||1,d=c+a-1&~(a-1),p=f+s-1&~(s-1),v=d*p*Yh[r];return h},t}(oI),hI=function(){function n(){}return n.use=function(t,e){var r=t.data,i=this;if(t.type===Ft.TYPE.JSON&&r&&r.cacheID&&r.textures){for(var a=r.textures,s=void 0,o=void 0,u=0,h=a.length;u<h;u++){var l=a[u],c=l.src,f=l.format;if(f||(o=c),n.textureFormats[f]){s=c;break}}if(s=s||o,!s){e(new Error("Cannot load compressed-textures in "+t.url+", make sure you provide a fallback"));return}if(s===t.url){e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));return}var d={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},p=ca.resolve(t.url.replace(i.baseUrl,""),s),v=r.cacheID;i.add(v,p,d,function(m){if(m.error){e(m.error);return}var g=m.texture,y=g===void 0?null:g,x=m.textures,b=x===void 0?{}:x;Object.assign(t,{texture:y,textures:b}),e()})}else e()},Object.defineProperty(n,"textureExtensions",{get:function(){if(!n._textureExtensions){var t=ht.ADAPTER.createCanvas(),e=t.getContext("webgl");if(!e)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var r={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};n._textureExtensions=r}return n._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(n,"textureFormats",{get:function(){if(!n._textureFormats){var t=n.textureExtensions;n._textureFormats={};for(var e in t){var r=t[e];r&&Object.assign(n._textureFormats,Object.getPrototypeOf(r))}}return n._textureFormats},enumerable:!1,configurable:!0}),n.extension=Bt.Loader,n}();function s0(n,t,e){var r={textures:{},texture:null};if(!t)return r;var i=t.map(function(a){return new vt(new Mt(a,Object.assign({mipmap:qe.OFF,alphaMode:sr.NO_PREMULTIPLIED_ALPHA},e)))});return i.forEach(function(a,s){var o=a.baseTexture,u=n+"-"+(s+1);Mt.addToCache(o,u),vt.addToCache(a,u),s===0&&(Mt.addToCache(o,n),vt.addToCache(a,n),r.texture=a),r.textures[u]=a}),r}var Qa,fr,Eu=4,Do=124,lI=32,Qv=20,uI=542327876,Uo={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},cI={FOURCC:2},Vo={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},yr;(function(n){n[n.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",n[n.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",n[n.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",n[n.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",n[n.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",n[n.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",n[n.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",n[n.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",n[n.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",n[n.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",n[n.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",n[n.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",n[n.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",n[n.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",n[n.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",n[n.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",n[n.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",n[n.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",n[n.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",n[n.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",n[n.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",n[n.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",n[n.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",n[n.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",n[n.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",n[n.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",n[n.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",n[n.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",n[n.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",n[n.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",n[n.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",n[n.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",n[n.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",n[n.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",n[n.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",n[n.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",n[n.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",n[n.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",n[n.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",n[n.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",n[n.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",n[n.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",n[n.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",n[n.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",n[n.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",n[n.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",n[n.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",n[n.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",n[n.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",n[n.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",n[n.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",n[n.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",n[n.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",n[n.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",n[n.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",n[n.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",n[n.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",n[n.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",n[n.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",n[n.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",n[n.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",n[n.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",n[n.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",n[n.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",n[n.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",n[n.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",n[n.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",n[n.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",n[n.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",n[n.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",n[n.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",n[n.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",n[n.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",n[n.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",n[n.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",n[n.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",n[n.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",n[n.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",n[n.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",n[n.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",n[n.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",n[n.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",n[n.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",n[n.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",n[n.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",n[n.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",n[n.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",n[n.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",n[n.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",n[n.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",n[n.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",n[n.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",n[n.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",n[n.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",n[n.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",n[n.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",n[n.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",n[n.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",n[n.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",n[n.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",n[n.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",n[n.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",n[n.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",n[n.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",n[n.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",n[n.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",n[n.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",n[n.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",n[n.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",n[n.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",n[n.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",n[n.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(yr||(yr={}));var jc;(function(n){n[n.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",n[n.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",n[n.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"})(jc||(jc={}));var fI=1,dI=2,pI=4,vI=64,mI=512,gI=131072,yI=827611204,xI=861165636,bI=894720068,_I=808540228,wI=4,SI=(Qa={},Qa[yI]=gt.COMPRESSED_RGBA_S3TC_DXT1_EXT,Qa[xI]=gt.COMPRESSED_RGBA_S3TC_DXT3_EXT,Qa[bI]=gt.COMPRESSED_RGBA_S3TC_DXT5_EXT,Qa),EI=(fr={},fr[yr.DXGI_FORMAT_BC1_TYPELESS]=gt.COMPRESSED_RGBA_S3TC_DXT1_EXT,fr[yr.DXGI_FORMAT_BC1_UNORM]=gt.COMPRESSED_RGBA_S3TC_DXT1_EXT,fr[yr.DXGI_FORMAT_BC2_TYPELESS]=gt.COMPRESSED_RGBA_S3TC_DXT3_EXT,fr[yr.DXGI_FORMAT_BC2_UNORM]=gt.COMPRESSED_RGBA_S3TC_DXT3_EXT,fr[yr.DXGI_FORMAT_BC3_TYPELESS]=gt.COMPRESSED_RGBA_S3TC_DXT5_EXT,fr[yr.DXGI_FORMAT_BC3_UNORM]=gt.COMPRESSED_RGBA_S3TC_DXT5_EXT,fr[yr.DXGI_FORMAT_BC1_UNORM_SRGB]=gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,fr[yr.DXGI_FORMAT_BC2_UNORM_SRGB]=gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,fr[yr.DXGI_FORMAT_BC3_UNORM_SRGB]=gt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,fr);function TI(n){var t=new Uint32Array(n),e=t[0];if(e!==uI)throw new Error("Invalid DDS file magic word");var r=new Uint32Array(n,0,Do/Uint32Array.BYTES_PER_ELEMENT),i=r[Uo.HEIGHT],a=r[Uo.WIDTH],s=r[Uo.MIPMAP_COUNT],o=new Uint32Array(n,Uo.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,lI/Uint32Array.BYTES_PER_ELEMENT),u=o[fI];if(u&pI){var h=o[cI.FOURCC];if(h!==_I){var l=SI[h],c=Eu+Do,f=new Uint8Array(n,c),d=new Hc(f,{format:l,width:a,height:i,levels:s});return[d]}var p=Eu+Do,v=new Uint32Array(t.buffer,p,Qv/Uint32Array.BYTES_PER_ELEMENT),m=v[Vo.DXGI_FORMAT],g=v[Vo.RESOURCE_DIMENSION],y=v[Vo.MISC_FLAG],x=v[Vo.ARRAY_SIZE],b=EI[m];if(b===void 0)throw new Error("DDSParser cannot parse texture data with DXGI format "+m);if(y===wI)throw new Error("DDSParser does not support cubemap textures");if(g===jc.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var _=new Array,w=Eu+Do+Qv;if(x===1)_.push(new Uint8Array(n,w));else{for(var S=Yh[b],E=0,T=a,A=i,P=0;P<s;P++){var M=Math.max(1,T+3&-4),R=Math.max(1,A+3&-4),F=M*R*S;E+=F,T=T>>>1,A=A>>>1}for(var N=w,P=0;P<x;P++)_.push(new Uint8Array(n,N,E)),N+=E}return _.map(function(D){return new Hc(D,{format:b,width:a,height:i,levels:s})})}throw u&vI?new Error("DDSParser does not support uncompressed texture data."):u&mI?new Error("DDSParser does not supported YUV uncompressed texture data."):u&gI?new Error("DDSParser does not support single-channel (lumninance) texture data!"):u&dI?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var En,Jr,ts,tm=[171,75,84,88,32,49,49,187,13,10,26,10],AI=67305985,dr={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},$c=64,em=(En={},En[ut.UNSIGNED_BYTE]=1,En[ut.UNSIGNED_SHORT]=2,En[ut.INT]=4,En[ut.UNSIGNED_INT]=4,En[ut.FLOAT]=4,En[ut.HALF_FLOAT]=8,En),MI=(Jr={},Jr[et.RGBA]=4,Jr[et.RGB]=3,Jr[et.RG]=2,Jr[et.RED]=1,Jr[et.LUMINANCE]=1,Jr[et.LUMINANCE_ALPHA]=2,Jr[et.ALPHA]=1,Jr),PI=(ts={},ts[ut.UNSIGNED_SHORT_4_4_4_4]=2,ts[ut.UNSIGNED_SHORT_5_5_5_1]=2,ts[ut.UNSIGNED_SHORT_5_6_5]=2,ts);function II(n,t,e){e===void 0&&(e=!1);var r=new DataView(t);if(!CI(n,r))return null;var i=r.getUint32(dr.ENDIANNESS,!0)===AI,a=r.getUint32(dr.GL_TYPE,i),s=r.getUint32(dr.GL_FORMAT,i),o=r.getUint32(dr.GL_INTERNAL_FORMAT,i),u=r.getUint32(dr.PIXEL_WIDTH,i),h=r.getUint32(dr.PIXEL_HEIGHT,i)||1,l=r.getUint32(dr.PIXEL_DEPTH,i)||1,c=r.getUint32(dr.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=r.getUint32(dr.NUMBER_OF_FACES,i),d=r.getUint32(dr.NUMBER_OF_MIPMAP_LEVELS,i),p=r.getUint32(dr.BYTES_OF_KEY_VALUE_DATA,i);if(h===0||l!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");var v=4,m=4,g=u+3&-4,y=h+3&-4,x=new Array(c),b=u*h;a===0&&(b=g*y);var _;if(a!==0?em[a]?_=em[a]*MI[s]:_=PI[a]:_=Yh[o],_===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var w=e?FI(r,p,i):null,S=b*_,E=S,T=u,A=h,P=g,M=y,R=$c+p,F=0;F<d;F++){for(var N=r.getUint32(R,i),D=R+4,X=0;X<c;X++){var q=x[X];q||(q=x[X]=new Array(d)),q[F]={levelID:F,levelWidth:d>1||a!==0?T:P,levelHeight:d>1||a!==0?A:M,levelBuffer:new Uint8Array(t,D,E)},D+=E}R+=N+4,R=R%4!==0?R+4-R%4:R,T=T>>1||1,A=A>>1||1,P=T+v-1&-4,M=A+m-1&-4,E=P*M*_}return a!==0?{uncompressed:x.map(function(W){var L=W[0].levelBuffer,U=!1;return a===ut.FLOAT?L=new Float32Array(W[0].levelBuffer.buffer,W[0].levelBuffer.byteOffset,W[0].levelBuffer.byteLength/4):a===ut.UNSIGNED_INT?(U=!0,L=new Uint32Array(W[0].levelBuffer.buffer,W[0].levelBuffer.byteOffset,W[0].levelBuffer.byteLength/4)):a===ut.INT&&(U=!0,L=new Int32Array(W[0].levelBuffer.buffer,W[0].levelBuffer.byteOffset,W[0].levelBuffer.byteLength/4)),{resource:new lo(L,{width:W[0].levelWidth,height:W[0].levelHeight}),type:a,format:U?RI(s):s}}),kvData:w}:{compressed:x.map(function(W){return new Hc(null,{format:o,width:u,height:h,levels:d,levelBuffers:W})}),kvData:w}}function CI(n,t){for(var e=0;e<tm.length;e++)if(t.getUint8(e)!==tm[e])return console.error(n+" is not a valid *.ktx file!"),!1;return!0}function RI(n){switch(n){case et.RGBA:return et.RGBA_INTEGER;case et.RGB:return et.RGB_INTEGER;case et.RG:return et.RG_INTEGER;case et.RED:return et.RED_INTEGER;default:return n}}function FI(n,t,e){for(var r=new Map,i=0;i<t;){var a=n.getUint32($c+i,e),s=$c+i+4,o=3-(a+3)%4;if(a===0||a>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var u=0;u<a&&n.getUint8(s+u)!==0;u++);if(u===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var h=new TextDecoder().decode(new Uint8Array(n.buffer,s,u)),l=new DataView(n.buffer,s+u+1,a-u-1);r.set(h,l),i+=4+a+o}return r}Ft.setExtensionXhrType("dds",Ft.XHR_RESPONSE_TYPE.BUFFER);var OI=function(){function n(){}return n.use=function(t,e){if(t.extension==="dds"&&t.data)try{Object.assign(t,s0(t.name||t.url,TI(t.data),t.metadata))}catch(r){e(r);return}e()},n.extension=Bt.Loader,n}();Ft.setExtensionXhrType("ktx",Ft.XHR_RESPONSE_TYPE.BUFFER);var BI=function(){function n(){}return n.use=function(t,e){if(t.extension==="ktx"&&t.data)try{var r=t.name||t.url,i=II(r,t.data,this.loadKeyValueData),a=i.compressed,s=i.uncompressed,o=i.kvData;if(a){var u=s0(r,a,t.metadata);if(o&&u.textures)for(var h in u.textures)u.textures[h].baseTexture.ktxKeyValueData=o;Object.assign(t,u)}else if(s){var l={};s.forEach(function(c,f){var d=new vt(new Mt(c.resource,{mipmap:qe.OFF,alphaMode:sr.NO_PREMULTIPLIED_ALPHA,type:c.type,format:c.format})),p=r+"-"+(f+1);o&&(d.baseTexture.ktxKeyValueData=o),Mt.addToCache(d.baseTexture,p),vt.addToCache(d,p),f===0&&(l[r]=d,Mt.addToCache(d.baseTexture,r),vt.addToCache(d,r)),l[p]=d}),Object.assign(t,{textures:l})}}catch(c){e(c);return}e()},n.extension=Bt.Loader,n.loadKeyValueData=!1,n}();/*!
 * @pixi/particle-container - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/particle-container is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qc=function(n,t){return qc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},qc(n,t)};function o0(n,t){qc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}(function(n){o0(t,n);function t(e,r,i,a){e===void 0&&(e=1500),i===void 0&&(i=16384),a===void 0&&(a=!1);var s=n.call(this)||this,o=16384;return i>o&&(i=o),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=i,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=at.NORMAL,s.autoResize=a,s.roundPixels=!0,s.baseTexture=null,s.setProperties(r),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Si(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var r=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return r.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var r=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(e){n.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},t})($e);var rm=function(){function n(t,e,r){this.geometry=new uo,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var a=t[i];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||ut.FLOAT,offset:a.offset},e[i]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return n.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new xe(YA(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var i=this.dynamicProperties[r];i.offset=e,e+=i.size,this.dynamicStride+=i.size}var a=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(a),this.dynamicDataUint32=new Uint32Array(a),this.dynamicBuffer=new xe(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var r=0;r<this.staticProperties.length;++r){var i=this.staticProperties[r];i.offset=s,s+=i.size,this.staticStride+=i.size}var o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new xe(this.staticData,!0,!1);for(var r=0;r<this.dynamicProperties.length;++r){var i=this.dynamicProperties[r];t.addAttribute(i.attributeName,this.dynamicBuffer,0,i.type===ut.UNSIGNED_BYTE,i.type,this.dynamicStride*4,i.offset*4)}for(var r=0;r<this.staticProperties.length;++r){var i=this.staticProperties[r];t.addAttribute(i.attributeName,this.staticBuffer,0,i.type===ut.UNSIGNED_BYTE,i.type,this.staticStride*4,i.offset*4)}},n.prototype.uploadDynamic=function(t,e,r){for(var i=0;i<this.dynamicProperties.length;i++){var a=this.dynamicProperties[i];a.uploadFunction(t,e,r,a.type===ut.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++},n.prototype.uploadStatic=function(t,e,r){for(var i=0;i<this.staticProperties.length;i++){var a=this.staticProperties[i];a.uploadFunction(t,e,r,a.type===ut.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++},n.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},n}(),NI=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,kI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,LI=function(n){o0(t,n);function t(e){var r=n.call(this,e)||this;return r.shader=null,r.properties=null,r.tempMatrix=new te,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:ut.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=Un.from(kI,NI,{}),r.state=Bi.for2d(),r}return t.prototype.render=function(e){var r=e.children,i=e._maxSize,a=e._batchSize,s=this.renderer,o=r.length;if(o!==0){o>i&&!e.autoResize&&(o=i);var u=e._buffers;u||(u=e._buffers=this.generateBuffers(e));var h=r[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=Ly(e.blendMode,l),s.state.set(this.state);var c=s.gl,f=e.worldTransform.copyTo(this.tempMatrix);f.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=GA(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,l),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);for(var d=!1,p=0,v=0;p<o;p+=a,v+=1){var m=o-p;m>a&&(m=a),v>=u.length&&u.push(this._generateOneMoreBuffer(e));var g=u[v];g.uploadDynamic(r,p,m);var y=e._bufferUpdateIDs[v]||0;d=d||g._updateID<y,d&&(g._updateID=e._updateID,g.uploadStatic(r,p,m)),s.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var r=[],i=e._maxSize,a=e._batchSize,s=e._properties,o=0;o<i;o+=a)r.push(new rm(this.properties,s,a));return r},t.prototype._generateOneMoreBuffer=function(e){var r=e._batchSize,i=e._properties;return new rm(this.properties,i,r)},t.prototype.uploadVertices=function(e,r,i,a,s,o){for(var u=0,h=0,l=0,c=0,f=0;f<i;++f){var d=e[r+f],p=d._texture,v=d.scale.x,m=d.scale.y,g=p.trim,y=p.orig;g?(h=g.x-d.anchor.x*y.width,u=h+g.width,c=g.y-d.anchor.y*y.height,l=c+g.height):(u=y.width*(1-d.anchor.x),h=y.width*-d.anchor.x,l=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),a[o]=h*v,a[o+1]=c*m,a[o+s]=u*v,a[o+s+1]=c*m,a[o+s*2]=u*v,a[o+s*2+1]=l*m,a[o+s*3]=h*v,a[o+s*3+1]=l*m,o+=s*4}},t.prototype.uploadPosition=function(e,r,i,a,s,o){for(var u=0;u<i;u++){var h=e[r+u].position;a[o]=h.x,a[o+1]=h.y,a[o+s]=h.x,a[o+s+1]=h.y,a[o+s*2]=h.x,a[o+s*2+1]=h.y,a[o+s*3]=h.x,a[o+s*3+1]=h.y,o+=s*4}},t.prototype.uploadRotation=function(e,r,i,a,s,o){for(var u=0;u<i;u++){var h=e[r+u].rotation;a[o]=h,a[o+s]=h,a[o+s*2]=h,a[o+s*3]=h,o+=s*4}},t.prototype.uploadUvs=function(e,r,i,a,s,o){for(var u=0;u<i;++u){var h=e[r+u]._texture._uvs;h?(a[o]=h.x0,a[o+1]=h.y0,a[o+s]=h.x1,a[o+s+1]=h.y1,a[o+s*2]=h.x2,a[o+s*2+1]=h.y2,a[o+s*3]=h.x3,a[o+s*3+1]=h.y3,o+=s*4):(a[o]=0,a[o+1]=0,a[o+s]=0,a[o+s+1]=0,a[o+s*2]=0,a[o+s*2+1]=0,a[o+s*3]=0,a[o+s*3+1]=0,o+=s*4)}},t.prototype.uploadTint=function(e,r,i,a,s,o){for(var u=0;u<i;++u){var h=e[r+u],l=h._texture.baseTexture.alphaMode>0,c=h.alpha,f=c<1&&l?rd(h._tintRGB,c):h._tintRGB+(c*255<<24);a[o]=f,a[o+s]=f,a[o+s*2]=f,a[o+s*3]=f,o+=s*4}},t.prototype.destroy=function(){n.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t.extension={name:"particle",type:Bt.RendererPlugin},t}(xl);/*!
 * @pixi/graphics - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var cn;(function(n){n.MITER="miter",n.BEVEL="bevel",n.ROUND="round"})(cn||(cn={}));var Ln;(function(n){n.BUTT="butt",n.ROUND="round",n.SQUARE="square"})(Ln||(Ln={}));var Bs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(n,t){if(t===void 0&&(t=20),!this.adaptive||!n||isNaN(n))return t;var e=Math.ceil(n/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},h0=function(){function n(){this.color=16777215,this.alpha=1,this.texture=vt.WHITE,this.matrix=null,this.visible=!1,this.reset()}return n.prototype.clone=function(){var t=new n;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},n.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=vt.WHITE,this.matrix=null,this.visible=!1},n.prototype.destroy=function(){this.texture=null,this.matrix=null},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Zc=function(n,t){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Zc(n,t)};function sd(n,t){Zc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function nm(n,t){var e,r;t===void 0&&(t=!1);var i=n.length;if(!(i<6)){for(var a=0,s=0,o=n[i-2],u=n[i-1];s<i;s+=2){var h=n[s],l=n[s+1];a+=(h-o)*(l+u),o=h,u=l}if(!t&&a>0||t&&a<=0)for(var c=i/2,s=c+c%2;s<i;s+=2){var f=i-s-2,d=i-s-1,p=s,v=s+1;e=[n[p],n[f]],n[f]=e[0],n[p]=e[1],r=[n[v],n[d]],n[d]=r[0],n[v]=r[1]}}}var l0={build:function(n){n.points=n.shape.points.slice()},triangulate:function(n,t){var e=n.points,r=n.holes,i=t.points,a=t.indices;if(e.length>=6){nm(e,!1);for(var s=[],o=0;o<r.length;o++){var u=r[o];nm(u.points,!0),s.push(e.length/2),e=e.concat(u.points)}var h=sy(e,s,2);if(!h)return;for(var l=i.length/2,o=0;o<h.length;o+=3)a.push(h[o]+l),a.push(h[o+1]+l),a.push(h[o+2]+l);for(var o=0;o<e.length;o++)i.push(e[o])}}},Wh={build:function(n){var t=n.points,e,r,i,a,s,o;if(n.type===Me.CIRC){var u=n.shape;e=u.x,r=u.y,s=o=u.radius,i=a=0}else if(n.type===Me.ELIP){var h=n.shape;e=h.x,r=h.y,s=h.width,o=h.height,i=a=0}else{var l=n.shape,c=l.width/2,f=l.height/2;e=l.x+c,r=l.y+f,s=o=Math.max(0,Math.min(l.radius,Math.min(c,f))),i=c-s,a=f-o}if(!(s>=0&&o>=0&&i>=0&&a>=0)){t.length=0;return}var d=Math.ceil(2.3*Math.sqrt(s+o)),p=d*8+(i?4:0)+(a?4:0);if(t.length=p,p!==0){if(d===0){t.length=8,t[0]=t[6]=e+i,t[1]=t[3]=r+a,t[2]=t[4]=e-i,t[5]=t[7]=r-a;return}var v=0,m=d*4+(i?2:0)+2,g=m,y=p;{var x=i+s,b=a,_=e+x,w=e-x,S=r+b;if(t[v++]=_,t[v++]=S,t[--m]=S,t[--m]=w,a){var E=r-b;t[g++]=w,t[g++]=E,t[--y]=E,t[--y]=_}}for(var T=1;T<d;T++){var A=Math.PI/2*(T/d),x=i+Math.cos(A)*s,b=a+Math.sin(A)*o,_=e+x,w=e-x,S=r+b,E=r-b;t[v++]=_,t[v++]=S,t[--m]=S,t[--m]=w,t[g++]=w,t[g++]=E,t[--y]=E,t[--y]=_}{var x=i,b=a+o,_=e+x,w=e-x,S=r+b,E=r-b;t[v++]=_,t[v++]=S,t[--y]=E,t[--y]=_,i&&(t[v++]=w,t[v++]=S,t[--y]=E,t[--y]=w)}}},triangulate:function(n,t){var e=n.points,r=t.points,i=t.indices;if(e.length!==0){var a=r.length/2,s=a,o,u;if(n.type!==Me.RREC){var h=n.shape;o=h.x,u=h.y}else{var l=n.shape;o=l.x+l.width/2,u=l.y+l.height/2}var c=n.matrix;r.push(n.matrix?c.a*o+c.c*u+c.tx:o,n.matrix?c.b*o+c.d*u+c.ty:u),a++,r.push(e[0],e[1]);for(var f=2;f<e.length;f+=2)r.push(e[f],e[f+1]),i.push(a++,s,a);i.push(s+1,s,a)}}},DI={build:function(n){var t=n.shape,e=t.x,r=t.y,i=t.width,a=t.height,s=n.points;s.length=0,s.push(e,r,e+i,r,e+i,r+a,e,r+a)},triangulate:function(n,t){var e=n.points,r=t.points,i=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function Yi(n,t,e){var r=t-n;return n+r*e}function Xo(n,t,e,r,i,a,s){s===void 0&&(s=[]);for(var o=20,u=s,h=0,l=0,c=0,f=0,d=0,p=0,v=0,m=0;v<=o;++v)m=v/o,h=Yi(n,e,m),l=Yi(t,r,m),c=Yi(e,i,m),f=Yi(r,a,m),d=Yi(h,c,m),p=Yi(l,f,m),!(v===0&&u[u.length-2]===d&&u[u.length-1]===p)&&u.push(d,p);return u}var UI={build:function(n){if(Ia.nextRoundedRectBehavior){Wh.build(n);return}var t=n.shape,e=n.points,r=t.x,i=t.y,a=t.width,s=t.height,o=Math.max(0,Math.min(t.radius,Math.min(a,s)/2));e.length=0,o?(Xo(r,i+o,r,i,r+o,i,e),Xo(r+a-o,i,r+a,i,r+a,i+o,e),Xo(r+a,i+s-o,r+a,i+s,r+a-o,i+s,e),Xo(r+o,i+s,r,i+s,r,i+s-o,e)):e.push(r,i,r+a,i,r+a,i+s,r,i+s)},triangulate:function(n,t){if(Ia.nextRoundedRectBehavior){Wh.triangulate(n,t);return}for(var e=n.points,r=t.points,i=t.indices,a=r.length/2,s=sy(e,null,2),o=0,u=s.length;o<u;o+=3)i.push(s[o]+a),i.push(s[o+1]+a),i.push(s[o+2]+a);for(var o=0,u=e.length;o<u;o++)r.push(e[o],e[++o])}};function im(n,t,e,r,i,a,s,o){var u=n-e*i,h=t-r*i,l=n+e*a,c=t+r*a,f,d;s?(f=r,d=-e):(f=-r,d=e);var p=u+f,v=h+d,m=l+f,g=c+d;return o.push(p,v),o.push(m,g),2}function Jn(n,t,e,r,i,a,s,o){var u=e-n,h=r-t,l=Math.atan2(u,h),c=Math.atan2(i-n,a-t);o&&l<c?l+=Math.PI*2:!o&&l>c&&(c+=Math.PI*2);var f=l,d=c-l,p=Math.abs(d),v=Math.sqrt(u*u+h*h),m=(15*p*Math.sqrt(v)/Math.PI>>0)+1,g=d/m;if(f+=g,o){s.push(n,t),s.push(e,r);for(var y=1,x=f;y<m;y++,x+=g)s.push(n,t),s.push(n+Math.sin(x)*v,t+Math.cos(x)*v);s.push(n,t),s.push(i,a)}else{s.push(e,r),s.push(n,t);for(var y=1,x=f;y<m;y++,x+=g)s.push(n+Math.sin(x)*v,t+Math.cos(x)*v),s.push(n,t);s.push(i,a),s.push(n,t)}return m*2}function VI(n,t){var e=n.shape,r=n.points||e.points.slice(),i=t.closePointEps;if(r.length!==0){var a=n.lineStyle,s=new Ut(r[0],r[1]),o=new Ut(r[r.length-2],r[r.length-1]),u=e.type!==Me.POLY||e.closeStroke,h=Math.abs(s.x-o.x)<i&&Math.abs(s.y-o.y)<i;if(u){r=r.slice(),h&&(r.pop(),r.pop(),o.set(r[r.length-2],r[r.length-1]));var l=(s.x+o.x)*.5,c=(o.y+s.y)*.5;r.unshift(l,c),r.push(l,c)}var f=t.points,d=r.length/2,p=r.length,v=f.length/2,m=a.width/2,g=m*m,y=a.miterLimit*a.miterLimit,x=r[0],b=r[1],_=r[2],w=r[3],S=0,E=0,T=-(b-w),A=x-_,P=0,M=0,R=Math.sqrt(T*T+A*A);T/=R,A/=R,T*=m,A*=m;var F=a.alignment,N=(1-F)*2,D=F*2;u||(a.cap===Ln.ROUND?p+=Jn(x-T*(N-D)*.5,b-A*(N-D)*.5,x-T*N,b-A*N,x+T*D,b+A*D,f,!0)+2:a.cap===Ln.SQUARE&&(p+=im(x,b,T,A,N,D,!0,f))),f.push(x-T*N,b-A*N),f.push(x+T*D,b+A*D);for(var X=1;X<d-1;++X){x=r[(X-1)*2],b=r[(X-1)*2+1],_=r[X*2],w=r[X*2+1],S=r[(X+1)*2],E=r[(X+1)*2+1],T=-(b-w),A=x-_,R=Math.sqrt(T*T+A*A),T/=R,A/=R,T*=m,A*=m,P=-(w-E),M=_-S,R=Math.sqrt(P*P+M*M),P/=R,M/=R,P*=m,M*=m;var q=_-x,W=b-w,L=_-S,U=E-w,G=q*L+W*U,V=W*L-U*q,O=V<0;if(Math.abs(V)<.001*Math.abs(G)){f.push(_-T*N,w-A*N),f.push(_+T*D,w+A*D),G>=0&&(a.join===cn.ROUND?p+=Jn(_,w,_-T*N,w-A*N,_-P*N,w-M*N,f,!1)+4:p+=2,f.push(_-P*D,w-M*D),f.push(_+P*N,w+M*N));continue}var z=(-T+x)*(-A+w)-(-T+_)*(-A+b),j=(-P+S)*(-M+w)-(-P+_)*(-M+E),K=(q*j-L*z)/V,Z=(U*z-W*j)/V,Q=(K-_)*(K-_)+(Z-w)*(Z-w),nt=_+(K-_)*N,J=w+(Z-w)*N,it=_-(K-_)*D,st=w-(Z-w)*D,ot=Math.min(q*q+W*W,L*L+U*U),pt=O?N:D,ct=ot+pt*pt*g,lt=Q<=ct;lt?a.join===cn.BEVEL||Q/g>y?(O?(f.push(nt,J),f.push(_+T*D,w+A*D),f.push(nt,J),f.push(_+P*D,w+M*D)):(f.push(_-T*N,w-A*N),f.push(it,st),f.push(_-P*N,w-M*N),f.push(it,st)),p+=2):a.join===cn.ROUND?O?(f.push(nt,J),f.push(_+T*D,w+A*D),p+=Jn(_,w,_+T*D,w+A*D,_+P*D,w+M*D,f,!0)+4,f.push(nt,J),f.push(_+P*D,w+M*D)):(f.push(_-T*N,w-A*N),f.push(it,st),p+=Jn(_,w,_-T*N,w-A*N,_-P*N,w-M*N,f,!1)+4,f.push(_-P*N,w-M*N),f.push(it,st)):(f.push(nt,J),f.push(it,st)):(f.push(_-T*N,w-A*N),f.push(_+T*D,w+A*D),a.join===cn.ROUND?O?p+=Jn(_,w,_+T*D,w+A*D,_+P*D,w+M*D,f,!0)+2:p+=Jn(_,w,_-T*N,w-A*N,_-P*N,w-M*N,f,!1)+2:a.join===cn.MITER&&Q/g<=y&&(O?(f.push(it,st),f.push(it,st)):(f.push(nt,J),f.push(nt,J)),p+=2),f.push(_-P*N,w-M*N),f.push(_+P*D,w+M*D),p+=2)}x=r[(d-2)*2],b=r[(d-2)*2+1],_=r[(d-1)*2],w=r[(d-1)*2+1],T=-(b-w),A=x-_,R=Math.sqrt(T*T+A*A),T/=R,A/=R,T*=m,A*=m,f.push(_-T*N,w-A*N),f.push(_+T*D,w+A*D),u||(a.cap===Ln.ROUND?p+=Jn(_-T*(N-D)*.5,w-A*(N-D)*.5,_-T*N,w-A*N,_+T*D,w+A*D,f,!1)+2:a.cap===Ln.SQUARE&&(p+=im(_,w,T,A,N,D,!1,f)));for(var Pt=t.indices,Ot=Bs.epsilon*Bs.epsilon,X=v;X<p+v-2;++X)x=f[X*2],b=f[X*2+1],_=f[(X+1)*2],w=f[(X+1)*2+1],S=f[(X+2)*2],E=f[(X+2)*2+1],!(Math.abs(x*(w-E)+_*(E-b)+S*(b-w))<Ot)&&Pt.push(X,X+1,X+2)}}function XI(n,t){var e=0,r=n.shape,i=n.points||r.points,a=r.type!==Me.POLY||r.closeStroke;if(i.length!==0){var s=t.points,o=t.indices,u=i.length/2,h=s.length/2,l=h;for(s.push(i[0],i[1]),e=1;e<u;e++)s.push(i[e*2],i[e*2+1]),o.push(l,l+1),l++;a&&o.push(l,h)}}function am(n,t){n.lineStyle.native?XI(n,t):VI(n,t)}var sm=function(){function n(){}return n.curveTo=function(t,e,r,i,a,s){var o=s[s.length-2],u=s[s.length-1],h=u-e,l=o-t,c=i-e,f=r-t,d=Math.abs(h*f-l*c);if(d<1e-8||a===0)return(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e),null;var p=h*h+l*l,v=c*c+f*f,m=h*c+l*f,g=a*Math.sqrt(p)/d,y=a*Math.sqrt(v)/d,x=g*m/p,b=y*m/v,_=g*f+y*l,w=g*c+y*h,S=l*(y+x),E=h*(y+x),T=f*(g+b),A=c*(g+b),P=Math.atan2(E-w,S-_),M=Math.atan2(A-w,T-_);return{cx:_+t,cy:w+e,radius:a,startAngle:P,endAngle:M,anticlockwise:l*c>f*h}},n.arc=function(t,e,r,i,a,s,o,u,h){for(var l=o-s,c=Bs._segmentsCount(Math.abs(l)*a,Math.ceil(Math.abs(l)/zh)*40),f=l/(c*2),d=f*2,p=Math.cos(f),v=Math.sin(f),m=c-1,g=m%1/m,y=0;y<=m;++y){var x=y+g*y,b=f+s+d*x,_=Math.cos(b),w=-Math.sin(b);h.push((p*_+v*w)*a+r,(p*-w+v*_)*a+i)}},n}(),zI=function(){function n(){}return n.curveLength=function(t,e,r,i,a,s,o,u){for(var h=10,l=0,c=0,f=0,d=0,p=0,v=0,m=0,g=0,y=0,x=0,b=0,_=t,w=e,S=1;S<=h;++S)c=S/h,f=c*c,d=f*c,p=1-c,v=p*p,m=v*p,g=m*t+3*v*c*r+3*p*f*a+d*o,y=m*e+3*v*c*i+3*p*f*s+d*u,x=_-g,b=w-y,_=g,w=y,l+=Math.sqrt(x*x+b*b);return l},n.curveTo=function(t,e,r,i,a,s,o){var u=o[o.length-2],h=o[o.length-1];o.length-=2;var l=Bs._segmentsCount(n.curveLength(u,h,t,e,r,i,a,s)),c=0,f=0,d=0,p=0,v=0;o.push(u,h);for(var m=1,g=0;m<=l;++m)g=m/l,c=1-g,f=c*c,d=f*c,p=g*g,v=p*g,o.push(d*u+3*f*g*t+3*c*p*r+v*a,d*h+3*f*g*e+3*c*p*i+v*s)},n}(),GI=function(){function n(){}return n.curveLength=function(t,e,r,i,a,s){var o=t-2*r+a,u=e-2*i+s,h=2*r-2*t,l=2*i-2*e,c=4*(o*o+u*u),f=4*(o*h+u*l),d=h*h+l*l,p=2*Math.sqrt(c+f+d),v=Math.sqrt(c),m=2*c*v,g=2*Math.sqrt(d),y=f/v;return(m*p+v*f*(p-g)+(4*d*c-f*f)*Math.log((2*v+y+p)/(y+g)))/(4*m)},n.curveTo=function(t,e,r,i,a){for(var s=a[a.length-2],o=a[a.length-1],u=Bs._segmentsCount(n.curveLength(s,o,t,e,r,i)),h=0,l=0,c=1;c<=u;++c){var f=c/u;h=s+(t-s)*f,l=o+(e-o)*f,a.push(h+(t+(r-t)*f-h)*f,l+(e+(i-e)*f-l)*f)}},n}(),YI=function(){function n(){this.reset()}return n.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},n.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},n.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},n}(),Qn,Tu=(Qn={},Qn[Me.POLY]=l0,Qn[Me.CIRC]=Wh,Qn[Me.ELIP]=Wh,Qn[Me.RECT]=DI,Qn[Me.RREC]=UI,Qn),om=[],zo=[],hm=function(){function n(t,e,r,i){e===void 0&&(e=null),r===void 0&&(r=null),i===void 0&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type}return n.prototype.clone=function(){return new n(this.shape,this.fillStyle,this.lineStyle,this.matrix)},n.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},n}(),Wi=new Ut,WI=function(n){sd(t,n);function t(){var e=n.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Gh,e.boundsDirty=-1,e}return Object.defineProperty(t.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),zo.push(this.drawCalls[e]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),om.push(r)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,r,i,a){r===void 0&&(r=null),i===void 0&&(i=null),a===void 0&&(a=null);var s=new hm(e,r,i,a);return this.graphicsData.push(s),this.dirty++,this},t.prototype.drawHole=function(e,r){if(r===void 0&&(r=null),!this.graphicsData.length)return null;var i=new hm(e,null,null,r),a=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=a.lineStyle,a.holes.push(i),this.dirty++,this},t.prototype.destroy=function(){n.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var r=this.graphicsData,i=0;i<r.length;++i){var a=r[i];if(a.fillStyle.visible&&a.shape&&(a.matrix?a.matrix.applyInverse(e,Wi):Wi.copyFrom(e),a.shape.contains(Wi.x,Wi.y))){var s=!1;if(a.holes)for(var o=0;o<a.holes.length;o++){var u=a.holes[o];if(u.shape.contains(Wi.x,Wi.y)){s=!0;break}}if(!s)return!0}}return!1},t.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,r=this.graphicsData,i=null,a=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],a=i.style);for(var s=this.shapeIndex;s<r.length;s++){this.shapeIndex++;var o=r[s],u=o.fillStyle,h=o.lineStyle,l=Tu[o.type];l.build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(u.visible||h.visible)&&this.processHoles(o.holes);for(var c=0;c<2;c++){var f=c===0?u:h;if(f.visible){var d=f.texture.baseTexture,p=this.indices.length,v=this.points.length/2;d.wrapMode=zr.REPEAT,c===0?this.processFill(o):this.processLine(o);var m=this.points.length/2-v;m!==0&&(i&&!this._compareStyles(a,f)&&(i.end(p,v),i=null),i||(i=om.pop()||new YI,i.begin(f,p,v),this.batches.push(i),a=f),this.addUvs(this.points,e,f.texture,v,m,f.matrix))}}}var g=this.indices.length,y=this.points.length/2;if(i&&i.end(g,y),this.batches.length===0){this.batchable=!0;return}var x=y>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&x===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=x?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},t.prototype._compareStyles=function(e,r){return!(!e||!r||e.texture.baseTexture!==r.texture.baseTexture||e.color+e.alpha!==r.color+r.alpha||!!e.native!=!!r.native)},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,r=this.graphicsData.length;e<r;e++){var i=this.graphicsData[e],a=i.fillStyle,s=i.lineStyle;if(a&&!a.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,r=0,i=e.length;r<i;r++)for(var a=e[r],s=0;s<a.size;s++){var o=a.start+s;this.indicesUint16[o]=this.indicesUint16[o]-a.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var e=this.batches,r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<t.BATCHABLE_SIZE*2},t.prototype.buildDrawCalls=function(){for(var e=++Mt._globalBatch,r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),zo.push(this.drawCalls[r]);this.drawCalls.length=0;var i=this.colors,a=this.textureIds,s=zo.pop();s||(s=new Xc,s.texArray=new zc),s.texArray.count=0,s.start=0,s.size=0,s.type=cr.TRIANGLES;var o=0,u=null,h=0,l=!1,c=cr.TRIANGLES,f=0;this.drawCalls.push(s);for(var r=0;r<this.batches.length;r++){var d=this.batches[r],p=8,v=d.style,m=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,c=l?cr.LINES:cr.TRIANGLES,u=null,o=p,e++),u!==m&&(u=m,m._batchEnabled!==e&&(o===p&&(e++,o=0,s.size>0&&(s=zo.pop(),s||(s=new Xc,s.texArray=new zc),this.drawCalls.push(s)),s.start=f,s.size=0,s.texArray.count=0,s.type=c),m.touched=1,m._batchEnabled=e,m._batchLocation=o,m.wrapMode=zr.REPEAT,s.texArray.elements[s.texArray.count++]=m,o++)),s.size+=d.size,f+=d.size,h=m._batchLocation,this.addColors(i,v.color,v.alpha,d.attribSize,d.attribStart),this.addTextureIds(a,h,d.attribSize,d.attribStart)}Mt._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,r=this.uvs,i=this.colors,a=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),u=new Uint32Array(s),h=0,l=0;l<e.length/2;l++)o[h++]=e[l*2],o[h++]=e[l*2+1],o[h++]=r[l*2],o[h++]=r[l*2+1],u[h++]=i[l],o[h++]=a[l];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){if(e.holes.length)l0.triangulate(e,this);else{var r=Tu[e.type];r.triangulate(e,this)}},t.prototype.processLine=function(e){am(e,this);for(var r=0;r<e.holes.length;r++)am(e.holes[r],this)},t.prototype.processHoles=function(e){for(var r=0;r<e.length;r++){var i=e[r],a=Tu[i.type];a.build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,r){for(var i=0;i<e.length/2;i++){var a=e[i*2],s=e[i*2+1];e[i*2]=r.a*a+r.c*s+r.tx,e[i*2+1]=r.b*a+r.d*s+r.ty}},t.prototype.addColors=function(e,r,i,a,s){s===void 0&&(s=0);var o=(r>>16)+(r&65280)+((r&255)<<16),u=rd(o,i);e.length=Math.max(e.length,s+a);for(var h=0;h<a;h++)e[s+h]=u},t.prototype.addTextureIds=function(e,r,i,a){a===void 0&&(a=0),e.length=Math.max(e.length,a+i);for(var s=0;s<i;s++)e[a+s]=r},t.prototype.addUvs=function(e,r,i,a,s,o){o===void 0&&(o=null);for(var u=0,h=r.length,l=i.frame;u<s;){var c=e[(a+u)*2],f=e[(a+u)*2+1];if(o){var d=o.a*c+o.c*f+o.tx;f=o.b*c+o.d*f+o.ty,c=d}u++,r.push(c/l.width,f/l.height)}var p=i.baseTexture;(l.width<p.width||l.height<p.height)&&this.adjustUvs(r,i,h,s)},t.prototype.adjustUvs=function(e,r,i,a){for(var s=r.baseTexture,o=1e-6,u=i+a*2,h=r.frame,l=h.width/s.width,c=h.height/s.height,f=h.x/h.width,d=h.y/h.height,p=Math.floor(e[i]+o),v=Math.floor(e[i+1]+o),m=i+2;m<u;m+=2)p=Math.min(p,Math.floor(e[m]+o)),v=Math.min(v,Math.floor(e[m+1]+o));f-=p,d-=v;for(var m=i;m<u;m+=2)e[m]=(e[m]+f)*l,e[m+1]=(e[m+1]+d)*c},t.BATCHABLE_SIZE=100,t}(r0),HI=function(n){sd(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Ln.BUTT,e.join=cn.MITER,e.miterLimit=10,e}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){n.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(h0),jI=new Float32Array(3),Au={},Ia=function(n){sd(t,n);function t(e){e===void 0&&(e=null);var r=n.call(this)||this;return r.shader=null,r.pluginName="batch",r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r._fillStyle=new h0,r._lineStyle=new HI,r._matrix=null,r._holeMode=!1,r.state=Bi.for2d(),r._geometry=e||new WI,r._geometry.refCount++,r._transformID=-1,r.tint=16777215,r.blendMode=at.NORMAL,r}return Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,r,i,a,s){return e===void 0&&(e=null),r===void 0&&(r=0),i===void 0&&(i=1),a===void 0&&(a=.5),s===void 0&&(s=!1),typeof e=="number"&&(e={width:e,color:r,alpha:i,alignment:a,native:s}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:vt.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ln.BUTT,join:cn.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new gs,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new gs,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this},t.prototype.lineTo=function(e,r){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,a=i[i.length-2],s=i[i.length-1];return(a!==e||s!==r)&&i.push(e,r),this},t.prototype._initCurve=function(e,r){e===void 0&&(e=0),r===void 0&&(r=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)},t.prototype.quadraticCurveTo=function(e,r,i,a){this._initCurve();var s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),GI.curveTo(e,r,i,a,s),this},t.prototype.bezierCurveTo=function(e,r,i,a,s,o){return this._initCurve(),zI.curveTo(e,r,i,a,s,o,this.currentPath.points),this},t.prototype.arcTo=function(e,r,i,a,s){this._initCurve(e,r);var o=this.currentPath.points,u=sm.curveTo(e,r,i,a,s,o);if(u){var h=u.cx,l=u.cy,c=u.radius,f=u.startAngle,d=u.endAngle,p=u.anticlockwise;this.arc(h,l,c,f,d,p)}return this},t.prototype.arc=function(e,r,i,a,s,o){if(o===void 0&&(o=!1),a===s)return this;!o&&s<=a?s+=zh:o&&a<=s&&(a+=zh);var u=s-a;if(u===0)return this;var h=e+Math.cos(a)*i,l=r+Math.sin(a)*i,c=this._geometry.closePointEps,f=this.currentPath?this.currentPath.points:null;if(f){var d=Math.abs(f[f.length-2]-h),p=Math.abs(f[f.length-1]-l);d<c&&p<c||f.push(h,l)}else this.moveTo(h,l),f=this.currentPath.points;return sm.arc(h,l,e,r,i,a,s,o,f),this},t.prototype.beginFill=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=1),this.beginTextureFill({texture:vt.WHITE,color:e,alpha:r})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:vt.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,r,i,a){return this.drawShape(new St(e,r,i,a))},t.prototype.drawRoundedRect=function(e,r,i,a,s){return this.drawShape(new JA(e,r,i,a,s))},t.prototype.drawCircle=function(e,r,i){return this.drawShape(new ZA(e,r,i))},t.prototype.drawEllipse=function(e,r,i,a){return this.drawShape(new KA(e,r,i,a))},t.prototype.drawPolygon=function(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var a,s=!0,o=r[0];o.points?(s=o.closeStroke,a=o.points):Array.isArray(r[0])?a=r[0]:a=r;var u=new gs(a);return u.closeStroke=s,this.drawShape(u),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Me.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,r=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(var a=0;a<i;a++){var s=e.batches[a],o=s.style.color,u=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),h=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),l=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),c={vertexData:u,blendMode:r,indices:l,uvs:h,_batchRGB:Si(o),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[a]=c}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var r=0,i=this.batches.length;r<i;r++){var a=this.batches[r];a.worldAlpha=this.worldAlpha*a.alpha,e.plugins[this.pluginName].render(a)}}},t.prototype._renderDirect=function(e){var r=this._resolveDirectShader(e),i=this._geometry,a=this.tint,s=this.worldAlpha,o=r.uniforms,u=i.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(a>>16&255)/255*s,o.tint[1]=(a>>8&255)/255*s,o.tint[2]=(a&255)/255*s,o.tint[3]=s,e.shader.bind(r),e.geometry.bind(i,r),e.state.set(this.state);for(var h=0,l=u.length;h<l;h++)this._renderDrawCallDirect(e,i.drawCalls[h])},t.prototype._renderDrawCallDirect=function(e,r){for(var i=r.texArray,a=r.type,s=r.size,o=r.start,u=i.count,h=0;h<u;h++)e.texture.bind(i.elements[h],h);e.geometry.draw(a,s,o)},t.prototype._resolveDirectShader=function(e){var r=this.shader,i=this.pluginName;if(!r){if(!Au[i]){for(var a=e.plugins[i].MAX_TEXTURES,s=new Int32Array(a),o=0;o<a;o++)s[o]=o;var u={tint:new Float32Array([1,1,1,1]),translationMatrix:new te,default:xi.from({uSamplers:s},!0)},h=e.plugins[i]._shader.program;Au[i]=new Un(h,u)}r=Au[i]}return r},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var r=e.bounds,i=r.minX,a=r.minY,s=r.maxX,o=r.maxY;this._bounds.addFrame(this.transform,i,a,s,o)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Si(this.tint,jI),r=0;r<this.batches.length;r++){var i=this.batches[r],a=i._batchRGB,s=e[0]*a[0]*255,o=e[1]*a[1]*255,u=e[2]*a[2]*255,h=(s<<16)+(o<<8)+(u|0);i._tintRGB=(h>>16)+(h&65280)+((h&255)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var r=this.transform.worldTransform,i=r.a,a=r.b,s=r.c,o=r.d,u=r.tx,h=r.ty,l=this._geometry.points,c=this.vertexData,f=0,d=0;d<l.length;d+=2){var p=l[d],v=l[d+1];c[f++]=i*p+s*v+u,c[f++]=o*v+a*p+h}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,n.prototype.destroy.call(this,e)},t.nextRoundedRectBehavior=!1,t._TEMP_POINT=new Ut,t}($e);/*!
 * @pixi/sprite - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kc=function(n,t){return Kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Kc(n,t)};function $I(n,t){Kc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var es=new Ut,qI=new Uint16Array([0,1,2,0,2,3]),La=function(n){$I(t,n);function t(e){var r=n.call(this)||this;return r._anchor=new da(r._onAnchorUpdate,r,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=at.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=e||vt.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=qI,r.pluginName="batch",r.isSprite=!0,r._roundPixels=ht.ROUND_PIXELS,r}return t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=fa(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=fa(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===e._updateID)){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var r=this.transform.worldTransform,i=r.a,a=r.b,s=r.c,o=r.d,u=r.tx,h=r.ty,l=this.vertexData,c=e.trim,f=e.orig,d=this._anchor,p=0,v=0,m=0,g=0;if(c?(v=c.x-d._x*f.width,p=v+c.width,g=c.y-d._y*f.height,m=g+c.height):(v=-d._x*f.width,p=v+f.width,g=-d._y*f.height,m=g+f.height),l[0]=i*v+s*g+u,l[1]=o*g+a*v+h,l[2]=i*p+s*g+u,l[3]=o*g+a*p+h,l[4]=i*p+s*m+u,l[5]=o*m+a*p+h,l[6]=i*v+s*m+u,l[7]=o*m+a*v+h,this._roundPixels)for(var y=ht.RESOLUTION,x=0;x<l.length;++x)l[x]=Math.round((l[x]*y|0)/y)}},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,r=this.vertexTrimmedData,i=e.orig,a=this._anchor,s=this.transform.worldTransform,o=s.a,u=s.b,h=s.c,l=s.d,c=s.tx,f=s.ty,d=-a._x*i.width,p=d+i.width,v=-a._y*i.height,m=v+i.height;r[0]=o*d+h*v+c,r[1]=l*v+u*d+f,r[2]=o*p+h*v+c,r[3]=l*v+u*p+f,r[4]=o*p+h*m+c,r[5]=l*m+u*p+f,r[6]=o*d+h*m+c,r[7]=l*m+u*d+f},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Gh),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new St),e=this._localBoundsRect),this._localBounds.getRectangle(e)):n.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,es);var r=this._texture.orig.width,i=this._texture.orig.height,a=-r*this.anchor.x,s=0;return es.x>=a&&es.x<a+r&&(s=-i*this.anchor.y,es.y>=s&&es.y<s+i)},t.prototype.destroy=function(e){n.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var r=typeof e=="boolean"?e:e&&e.texture;if(r){var i=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null},t.from=function(e,r){var i=e instanceof vt?e:vt.from(e,r);return new t(i)},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var r=fa(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var r=fa(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||vt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}($e);/*!
 * @pixi/text - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jc=function(n,t){return Jc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Jc(n,t)};function ZI(n,t){Jc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Ns;(function(n){n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Ns||(Ns={}));var Mu={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ns.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},KI=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ca=function(){function n(t){this.styleID=0,this.reset(),Iu(this,t,t)}return n.prototype.clone=function(){var t={};return Iu(t,this,Mu),new n(t)},n.prototype.reset=function(){Iu(this,Mu,Mu)},Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Pu(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Pu(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){JI(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Pu(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),n.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&KI.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},n}();function lm(n){return typeof n=="number"?By(n):(typeof n=="string"&&n.indexOf("0x")===0&&(n=n.replace("0x","#")),n)}function Pu(n){if(Array.isArray(n)){for(var t=0;t<n.length;++t)n[t]=lm(n[t]);return n}else return lm(n)}function JI(n,t){if(!Array.isArray(n)||!Array.isArray(t)||n.length!==t.length)return!1;for(var e=0;e<n.length;++e)if(n[e]!==t[e])return!1;return!0}function Iu(n,t,e){for(var r in e)Array.isArray(t[r])?n[r]=t[r].slice():n[r]=t[r]}var Go={willReadFrequently:!0},Hr=function(){function n(t,e,r,i,a,s,o,u,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=a,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=u,this.fontProperties=h}return n.measureText=function(t,e,r,i){i===void 0&&(i=n._canvas),r=r??e.wordWrap;var a=e.toFontString(),s=n.measureFont(a);s.fontSize===0&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=i.getContext("2d",Go);o.font=a;for(var u=r?n.wordWrap(t,e,i):t,h=u.split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0,f=0;f<h.length;f++){var d=o.measureText(h[f]).width+(h[f].length-1)*e.letterSpacing;l[f]=d,c=Math.max(c,d)}var p=c+e.strokeThickness;e.dropShadow&&(p+=e.dropShadowDistance);var v=e.lineHeight||s.fontSize+e.strokeThickness,m=Math.max(v,s.fontSize+e.strokeThickness)+(h.length-1)*(v+e.leading);return e.dropShadow&&(m+=e.dropShadowDistance),new n(t,e,p,m,h,l,v+e.leading,c,s)},n.wordWrap=function(t,e,r){r===void 0&&(r=n._canvas);for(var i=r.getContext("2d",Go),a=0,s="",o="",u=Object.create(null),h=e.letterSpacing,l=e.whiteSpace,c=n.collapseSpaces(l),f=n.collapseNewlines(l),d=!c,p=e.wordWrapWidth+h,v=n.tokenize(t),m=0;m<v.length;m++){var g=v[m];if(n.isNewline(g)){if(!f){o+=n.addLine(s),d=!c,s="",a=0;continue}g=" "}if(c){var y=n.isBreakingSpace(g),x=n.isBreakingSpace(s[s.length-1]);if(y&&x)continue}var b=n.getFromCache(g,h,u,i);if(b>p)if(s!==""&&(o+=n.addLine(s),s="",a=0),n.canBreakWords(g,e.breakWords))for(var _=n.wordWrapSplit(g),w=0;w<_.length;w++){for(var S=_[w],E=1;_[w+E];){var T=_[w+E],A=S[S.length-1];if(!n.canBreakChars(A,T,g,w,e.breakWords))S+=T;else break;E++}w+=S.length-1;var P=n.getFromCache(S,h,u,i);P+a>p&&(o+=n.addLine(s),d=!1,s="",a=0),s+=S,a+=P}else{s.length>0&&(o+=n.addLine(s),s="",a=0);var M=m===v.length-1;o+=n.addLine(g,!M),d=!1,s="",a=0}else b+a>p&&(d=!1,o+=n.addLine(s),s="",a=0),(s.length>0||!n.isBreakingSpace(g)||d)&&(s+=g,a+=b)}return o+=n.addLine(s,!1),o},n.addLine=function(t,e){return e===void 0&&(e=!0),t=n.trimRight(t),t=e?t+`
`:t,t},n.getFromCache=function(t,e,r,i){var a=r[t];if(typeof a!="number"){var s=t.length*e;a=i.measureText(t).width+s,r[t]=a}return a},n.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},n.collapseNewlines=function(t){return t==="normal"},n.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var r=t[e];if(!n.isBreakingSpace(r))break;t=t.slice(0,-1)}return t},n.isNewline=function(t){return typeof t!="string"?!1:n._newlines.indexOf(t.charCodeAt(0))>=0},n.isBreakingSpace=function(t,e){return typeof t!="string"?!1:n._breakingSpaces.indexOf(t.charCodeAt(0))>=0},n.tokenize=function(t){var e=[],r="";if(typeof t!="string")return e;for(var i=0;i<t.length;i++){var a=t[i],s=t[i+1];if(n.isBreakingSpace(a,s)||n.isNewline(a)){r!==""&&(e.push(r),r=""),e.push(a);continue}r+=a}return r!==""&&e.push(r),e},n.canBreakWords=function(t,e){return e},n.canBreakChars=function(t,e,r,i,a){return!0},n.wordWrapSplit=function(t){return t.split("")},n.measureFont=function(t){if(n._fonts[t])return n._fonts[t];var e={ascent:0,descent:0,fontSize:0},r=n._canvas,i=n._context;i.font=t;var a=n.METRICS_STRING+n.BASELINE_SYMBOL,s=Math.ceil(i.measureText(a).width),o=Math.ceil(i.measureText(n.BASELINE_SYMBOL).width),u=Math.ceil(n.HEIGHT_MULTIPLIER*o);o=o*n.BASELINE_MULTIPLIER|0,r.width=s,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,s,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,o);var h=i.getImageData(0,0,s,u).data,l=h.length,c=s*4,f=0,d=0,p=!1;for(f=0;f<o;++f){for(var v=0;v<c;v+=4)if(h[d+v]!==255){p=!0;break}if(!p)d+=c;else break}for(e.ascent=o-f,d=l-c,p=!1,f=u;f>o;--f){for(var v=0;v<c;v+=4)if(h[d+v]!==255){p=!0;break}if(!p)d-=c;else break}return e.descent=f-o,e.fontSize=e.ascent+e.descent,n._fonts[t]=e,e},n.clearMetrics=function(t){t===void 0&&(t=""),t?delete n._fonts[t]:n._fonts={}},Object.defineProperty(n,"_canvas",{get:function(){if(!n.__canvas){var t=void 0;try{var e=new OffscreenCanvas(0,0),r=e.getContext("2d",Go);if(r&&r.measureText)return n.__canvas=e,e;t=ht.ADAPTER.createCanvas()}catch{t=ht.ADAPTER.createCanvas()}t.width=t.height=10,n.__canvas=t}return n.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(n,"_context",{get:function(){return n.__context||(n.__context=n._canvas.getContext("2d",Go)),n.__context},enumerable:!1,configurable:!0}),n}();Hr._fonts={};Hr.METRICS_STRING="|q";Hr.BASELINE_SYMBOL="M";Hr.BASELINE_MULTIPLIER=1.4;Hr.HEIGHT_MULTIPLIER=2;Hr._newlines=[10,13];Hr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var QI={texture:!0,children:!1,baseTexture:!0},u0=function(n){ZI(t,n);function t(e,r,i){var a=this,s=!1;i||(i=ht.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;var o=vt.from(i);return o.orig=new St,o.trim=new St,a=n.call(this,o)||this,a._ownCanvas=s,a.canvas=i,a.context=i.getContext("2d",{willReadFrequently:!0}),a._resolution=ht.RESOLUTION,a._autoResolution=!0,a._text=null,a._style=null,a._styleListener=null,a._font="",a.text=e,a.style=r,a.localStyleID=-1,a}return t.prototype.updateText=function(e){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!(!this.dirty&&e)){this._font=this._style.toFontString();var i=this.context,a=Hr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=a.width,o=a.height,u=a.lines,h=a.lineHeight,l=a.lineWidths,c=a.maxLineWidth,f=a.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+r.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=r.strokeThickness,i.textBaseline=r.textBaseline,i.lineJoin=r.lineJoin,i.miterLimit=r.miterLimit;for(var d,p,v=r.dropShadow?2:1,m=0;m<v;++m){var g=r.dropShadow&&m===0,y=g?Math.ceil(Math.max(1,o)+r.padding*2):0,x=y*this._resolution;if(g){i.fillStyle="black",i.strokeStyle="black";var b=r.dropShadowColor,_=Si(typeof b=="number"?b:Ny(b)),w=r.dropShadowBlur*this._resolution,S=r.dropShadowDistance*this._resolution;i.shadowColor="rgba("+_[0]*255+","+_[1]*255+","+_[2]*255+","+r.dropShadowAlpha+")",i.shadowBlur=w,i.shadowOffsetX=Math.cos(r.dropShadowAngle)*S,i.shadowOffsetY=Math.sin(r.dropShadowAngle)*S+x}else i.fillStyle=this._generateFillStyle(r,u,a),i.strokeStyle=r.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var E=(h-f.fontSize)/2;(!t.nextLineHeightBehavior||h-f.fontSize<0)&&(E=0);for(var T=0;T<u.length;T++)d=r.strokeThickness/2,p=r.strokeThickness/2+T*h+f.ascent+E,r.align==="right"?d+=c-l[T]:r.align==="center"&&(d+=(c-l[T])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(u[T],d+r.padding,p+r.padding-y,!0),r.fill&&this.drawLetterSpacing(u[T],d+r.padding,p+r.padding-y)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,r,i,a){a===void 0&&(a=!1);var s=this._style,o=s.letterSpacing,u=t.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(o===0||u){u&&(this.context.letterSpacing=o,this.context.textLetterSpacing=o),a?this.context.strokeText(e,r,i):this.context.fillText(e,r,i);return}for(var h=r,l=Array.from?Array.from(e):e.split(""),c=this.context.measureText(e).width,f=0,d=0;d<l.length;++d){var p=l[d];a?this.context.strokeText(p,h,i):this.context.fillText(p,h,i);for(var v="",m=d+1;m<l.length;++m)v+=l[m];f=this.context.measureText(v).width,h+=c-f+o,c=f}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var r=HA(e);r.data&&(e.width=r.width,e.height=r.height,this.context.putImageData(r.data,0,0))}var i=this._texture,a=this._style,s=a.trim?0:a.padding,o=i.baseTexture;i.trim.width=i._frame.width=e.width/this._resolution,i.trim.height=i._frame.height=e.height/this._resolution,i.trim.x=-s,i.trim.y=-s,i.orig.width=i._frame.width-s*2,i.orig.height=i._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),i.updateUvs(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),n.prototype._render.call(this,e)},t.prototype.updateTransform=function(){this.updateText(!0),n.prototype.updateTransform.call(this)},t.prototype.getBounds=function(e,r){return this.updateText(!0),this._textureID===-1&&(e=!1),n.prototype.getBounds.call(this,e,r)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),n.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,r,i){var a=e.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;var s,o=e.dropShadow?e.dropShadowDistance:0,u=e.padding||0,h=this.canvas.width/this._resolution-o-u*2,l=this.canvas.height/this._resolution-o-u*2,c=a.slice(),f=e.fillGradientStops.slice();if(!f.length)for(var d=c.length+1,p=1;p<d;++p)f.push(p/d);if(c.unshift(a[0]),f.unshift(0),c.push(a[a.length-1]),f.push(1),e.fillGradientType===Ns.LINEAR_VERTICAL){s=this.context.createLinearGradient(h/2,u,h/2,l+u);for(var v=i.fontProperties.fontSize+e.strokeThickness,p=0;p<r.length;p++){var m=i.lineHeight*(p-1)+v,g=i.lineHeight*p,y=g;p>0&&m>g&&(y=(g+m)/2);var x=g+v,b=i.lineHeight*(p+1),_=x;p+1<r.length&&b<x&&(_=(x+b)/2);for(var w=(_-y)/l,S=0;S<c.length;S++){var E=0;typeof f[S]=="number"?E=f[S]:E=S/c.length;var T=Math.min(1,Math.max(0,y/l+E*w));T=Number(T.toFixed(5)),s.addColorStop(T,c[S])}}}else{s=this.context.createLinearGradient(u,l/2,h+u,l/2);for(var A=c.length+1,P=1,p=0;p<c.length;p++){var M=void 0;typeof f[p]=="number"?M=f[p]:M=P/A,s.addColorStop(M,c[p]),P++}}return s},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},QI,e),n.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var r=fa(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var r=fa(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},e instanceof Ca?this._style=e:this._style=new Ca(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t.experimentalLetterSpacing=!1,t}(La);/*!
 * @pixi/prepare - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ht.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qc=function(n,t){return Qc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Qc(n,t)};function tC(n,t){Qc(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var eC=function(){function n(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return n.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},n.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},n}();function rC(n,t){var e=!1;if(n&&n._textures&&n._textures.length){for(var r=0;r<n._textures.length;r++)if(n._textures[r]instanceof vt){var i=n._textures[r].baseTexture;t.indexOf(i)===-1&&(t.push(i),e=!0)}}return e}function nC(n,t){if(n.baseTexture instanceof Mt){var e=n.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function iC(n,t){if(n._texture&&n._texture instanceof vt){var e=n._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function aC(n,t){return t instanceof u0?(t.updateText(!0),!0):!1}function sC(n,t){if(t instanceof Ca){var e=t.toFontString();return Hr.measureFont(e),!0}return!1}function oC(n,t){if(n instanceof u0){t.indexOf(n.style)===-1&&t.push(n.style),t.indexOf(n)===-1&&t.push(n);var e=n._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function hC(n,t){return n instanceof Ca?(t.indexOf(n)===-1&&t.push(n),!0):!1}var lC=function(){function n(t){var e=this;this.limiter=new eC(ht.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(oC),this.registerFindHook(hC),this.registerFindHook(rC),this.registerFindHook(nC),this.registerFindHook(iC),this.registerUploadHook(aC),this.registerUploadHook(sC)}return n.prototype.upload=function(t,e){var r=this;return typeof t=="function"&&(e=t,t=null),e&&Mr("6.5.0","BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise(function(i){t&&r.add(t);var a=function(){e==null||e(),i()};r.queue.length?(r.completes.push(a),r.ticking||(r.ticking=!0,Fe.system.addOnce(r.tick,r,mn.UTILITY))):a()})},n.prototype.tick=function(){setTimeout(this.delayedTick,0)},n.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed){for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)Fe.system.addOnce(this.tick,this,mn.UTILITY);else{this.ticking=!1;var a=this.completes.slice(0);this.completes.length=0;for(var r=0,i=a.length;r<i;r++)a[r]()}},n.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},n.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},n.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof $e)for(var e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},n.prototype.destroy=function(){this.ticking&&Fe.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},n}();function c0(n,t){return t instanceof Mt?(t._glTextures[n.CONTEXT_UID]||n.texture.bind(t),!0):!1}function uC(n,t){if(!(t instanceof Ia))return!1;var e=t.geometry;t.finishPoly(),e.updateBatches();for(var r=e.batches,i=0;i<r.length;i++){var a=r[i].style.texture;a&&c0(n,a.baseTexture)}return e.batchable||n.geometry.bind(e,t._resolveDirectShader(n)),!0}function cC(n,t){return n instanceof Ia?(t.push(n),!0):!1}var fC=function(n){tC(t,n);function t(e){var r=n.call(this,e)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(cC),r.registerUploadHook(c0),r.registerUploadHook(uC),r}return t.extension={name:"prepare",type:Bt.RendererPlugin},t}(lC);/*!
 * @pixi/spritesheet - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var dC=function(){function n(t,e,r){r===void 0&&(r=null),this.linkedSheets=[],this._texture=t instanceof vt?t:null,this.baseTexture=t instanceof Mt?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n.prototype._updateResolution=function(t){t===void 0&&(t=null);var e=this.data.meta.scale,r=Xh(t,null);return r===null&&(r=e!==void 0?parseFloat(e):1),r!==1&&this.baseTexture.setResolution(r),r},n.prototype.parse=function(t){var e=this;return t&&Mr("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise(function(r){e._callback=function(i){t==null||t(i),r(i)},e._batchIndex=0,e._frameKeys.length<=n.BATCH_SIZE?(e._processFrames(0),e._processAnimations(),e._parseComplete()):e._nextBatch()})},n.prototype._processFrames=function(t){for(var e=t,r=n.BATCH_SIZE;e-t<r&&e<this._frameKeys.length;){var i=this._frameKeys[e],a=this._frames[i],s=a.frame;if(s){var o=null,u=null,h=a.trimmed!==!1&&a.sourceSize?a.sourceSize:a.frame,l=new St(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a.rotated?o=new St(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):o=new St(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),a.trimmed!==!1&&a.spriteSourceSize&&(u=new St(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new vt(this.baseTexture,o,l,u,a.rotated?2:0,a.anchor),vt.addToCache(this.textures[i],i)}e++}},n.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var r=0;r<t[e].length;r++){var i=t[e][r];this.animations[e].push(this.textures[i])}}},n.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},n.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*n.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*n.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},n.prototype.destroy=function(t){var e;t===void 0&&(t=!1);for(var r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},n.BATCH_SIZE=1e3,n}(),pC=function(){function n(){}return n.use=function(t,e){var r,i,a=this,s=t.name+"_image";if(!t.data||t.type!==Ft.TYPE.JSON||!t.data.frames||a.resources[s]){e();return}var o=(i=(r=t.data)===null||r===void 0?void 0:r.meta)===null||i===void 0?void 0:i.related_multi_packs;if(Array.isArray(o))for(var u=function(p){if(typeof p!="string")return"continue";var v=p.replace(".json",""),m=ca.resolve(t.url.replace(a.baseUrl,""),p);if(a.resources[v]||Object.values(a.resources).some(function(y){return ca.format(ca.parse(y.url))===m}))return"continue";var g={crossOrigin:t.crossOrigin,loadType:Ft.LOAD_TYPE.XHR,xhrType:Ft.XHR_RESPONSE_TYPE.JSON,parentResource:t,metadata:t.metadata};a.add(v,m,g)},h=0,l=o;h<l.length;h++){var c=l[h];u(c)}var f={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},d=n.getResourcePath(t,a.baseUrl);a.add(s,d,f,function(v){if(v.error){e(v.error);return}var m=new dC(v.texture,t.data,t.url);m.parse().then(function(){t.spritesheet=m,t.textures=m.textures,e()})})},n.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:ca.resolve(t.url.replace(e,""),t.data.meta.image)},n.extension=Bt.Loader,n}();/*!
 * @pixi/sprite-tiling - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var tf=function(n,t){return tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},tf(n,t)};function f0(n,t){tf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var rs=new Ut;(function(n){f0(t,n);function t(e,r,i){r===void 0&&(r=100),i===void 0&&(i=100);var a=n.call(this,e)||this;return a.tileTransform=new nd,a._width=r,a._height=i,a.uvMatrix=a.texture.uvMatrix||new ad(e),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var r=this._texture;!r||!r.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,r=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),a=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,r,i,a)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new St),e=this._localBoundsRect),this._bounds.getRectangle(e)):n.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,rs);var r=this._width,i=this._height,a=-r*this.anchor._x;if(rs.x>=a&&rs.x<a+r){var s=-i*this.anchor._y;if(rs.y>=s&&rs.y<s+i)return!0}return!1},t.prototype.destroy=function(e){n.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,r){var i=e instanceof vt?e:vt.from(e,r);return new t(i,r.width,r.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t})(La);var vC=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,um=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,mC=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gC=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,yC=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Yo=new te,xC=function(n){f0(t,n);function t(e){var r=n.call(this,e)||this;return e.runners.contextChange.add(r),r.quad=new jy,r.state=Bi.for2d(),r}return t.prototype.contextChange=function(){var e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=Un.from(um,vC,r),this.shader=e.context.webGLVersion>1?Un.from(gC,yC,r):Un.from(um,mC,r)},t.prototype.render=function(e){var r=this.renderer,i=this.quad,a=i.vertices;a[0]=a[6]=e._width*-e.anchor.x,a[1]=a[3]=e._height*-e.anchor.y,a[2]=a[4]=e._width*(1-e.anchor.x),a[5]=a[7]=e._height*(1-e.anchor.y);var s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;a=i.uvs,a[0]=a[6]=-s,a[1]=a[3]=-o,a[2]=a[4]=1-s,a[5]=a[7]=1-o,i.invalidate();var u=e._texture,h=u.baseTexture,l=h.alphaMode>0,c=e.tileTransform.localTransform,f=e.uvMatrix,d=h.isPowerOfTwo&&u.frame.width===h.width&&u.frame.height===h.height;d&&(h._glTextures[r.CONTEXT_UID]?d=h.wrapMode!==zr.CLAMP:h.wrapMode===zr.CLAMP&&(h.wrapMode=zr.REPEAT));var p=d?this.simpleShader:this.shader,v=u.width,m=u.height,g=e._width,y=e._height;Yo.set(c.a*v/g,c.b*v/y,c.c*m/g,c.d*m/y,c.tx/g,c.ty/y),Yo.invert(),d?Yo.prepend(f.mapCoord):(p.uniforms.uMapCoord=f.mapCoord.toArray(!0),p.uniforms.uClampFrame=f.uClampFrame,p.uniforms.uClampOffset=f.uClampOffset),p.uniforms.uTransform=Yo.toArray(!0),p.uniforms.uColor=Dy(e.tint,e.worldAlpha,p.uniforms.uColor,l),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=u,r.shader.bind(p),r.geometry.bind(i),this.state.blendMode=Ly(e.blendMode,l),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t.extension={name:"tilingSprite",type:Bt.RendererPlugin},t}(xl);/*!
 * @pixi/mesh - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ef=function(n,t){return ef=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},ef(n,t)};function od(n,t){ef(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var bC=function(){function n(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return n.prototype.update=function(t){if(!(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},n}(),Cu=new Ut,cm=new gs,ks=function(n){od(t,n);function t(e,r,i,a){a===void 0&&(a=cr.TRIANGLES);var s=n.call(this)||this;return s.geometry=e,s.shader=r,s.state=i||Bi.for2d(),s.drawMode=a,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=ht.ROUND_PIXELS,s.batchUvs=null,s}return Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),t.prototype._render=function(e){var r=this.geometry.buffers[0].data,i=this.shader;i.batchable&&this.drawMode===cr.TRIANGLES&&r.length<t.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)},t.prototype._renderDefault=function(e){var r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},t.prototype._renderToBatch=function(e){var r=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;var a=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[a]),e.plugins[a].render(this)},t.prototype.calculateVertices=function(){var e=this.geometry,r=e.buffers[0],i=r.data,a=r._updateID;if(!(a===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==i.length&&(this.vertexData=new Float32Array(i.length));for(var s=this.transform.worldTransform,o=s.a,u=s.b,h=s.c,l=s.d,c=s.tx,f=s.ty,d=this.vertexData,p=0;p<d.length/2;p++){var v=i[p*2],m=i[p*2+1];d[p*2]=o*v+h*m+c,d[p*2+1]=u*v+l*m+f}if(this._roundPixels)for(var g=ht.RESOLUTION,p=0;p<d.length;++p)d[p]=Math.round((d[p]*g|0)/g);this.vertexDirty=a}},t.prototype.calculateUvs=function(){var e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new bC(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Cu);for(var r=this.geometry.getBuffer("aVertexPosition").data,i=cm.points,a=this.geometry.getIndex().data,s=a.length,o=this.drawMode===4?3:1,u=0;u+2<s;u+=o){var h=a[u]*2,l=a[u+1]*2,c=a[u+2]*2;if(i[0]=r[h],i[1]=r[h+1],i[2]=r[l],i[3]=r[l+1],i[4]=r[c],i[5]=r[c+1],cm.contains(Cu.x,Cu.y))return!0}return!1},t.prototype.destroy=function(e){n.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},t.BATCHABLE_SIZE=100,t}($e),_C=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,wC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,Ls=function(n){od(t,n);function t(e,r){var i=this,a={uSampler:e,alpha:1,uTextureMatrix:te.IDENTITY,uColor:new Float32Array([1,1,1,1])};return r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(a,r.uniforms),i=n.call(this,r.program||co.from(wC,_C),a)||this,i._colorDirty=!1,i.uvMatrix=new ad(e),i.batchable=r.program===void 0,i.pluginName=r.pluginName,i.tint=r.tint,i.alpha=r.alpha,i}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;Dy(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},t}(Un),bl=function(n){od(t,n);function t(e,r,i){var a=n.call(this)||this,s=new xe(e),o=new xe(r,!0),u=new xe(i,!0,!0);return a.addAttribute("aVertexPosition",s,2,!1,ut.FLOAT).addAttribute("aTextureCoord",o,2,!1,ut.FLOAT).addIndex(u),a._updateId=-1,a}return Object.defineProperty(t.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),t}(uo);/*!
 * @pixi/text-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var rf=function(n,t){return rf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},rf(n,t)};function SC(n,t){rf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Hh=function(){function n(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}return n}(),EC=function(){function n(){}return n.test=function(t){return typeof t=="string"&&t.indexOf("info face=")===0},n.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in e){var a=e[i].match(/^[a-z]+/gm)[0],s=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var u in s){var h=s[u].split("="),l=h[0],c=h[1].replace(/"/gm,""),f=parseFloat(c),d=isNaN(f)?c:f;o[l]=d}r[a].push(o)}var p=new Hh;return r.info.forEach(function(v){return p.info.push({face:v.face,size:parseInt(v.size,10)})}),r.common.forEach(function(v){return p.common.push({lineHeight:parseInt(v.lineHeight,10)})}),r.page.forEach(function(v){return p.page.push({id:parseInt(v.id,10),file:v.file})}),r.char.forEach(function(v){return p.char.push({id:parseInt(v.id,10),page:parseInt(v.page,10),x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xoffset:parseInt(v.xoffset,10),yoffset:parseInt(v.yoffset,10),xadvance:parseInt(v.xadvance,10)})}),r.kerning.forEach(function(v){return p.kerning.push({first:parseInt(v.first,10),second:parseInt(v.second,10),amount:parseInt(v.amount,10)})}),r.distanceField.forEach(function(v){return p.distanceField.push({distanceRange:parseInt(v.distanceRange,10),fieldType:v.fieldType})}),p},n}(),nf=function(){function n(){}return n.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},n.parse=function(t){for(var e=new Hh,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),a=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),u=t.getElementsByTagName("distanceField"),h=0;h<r.length;h++)e.info.push({face:r[h].getAttribute("face"),size:parseInt(r[h].getAttribute("size"),10)});for(var h=0;h<i.length;h++)e.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(var h=0;h<a.length;h++)e.page.push({id:parseInt(a[h].getAttribute("id"),10)||0,file:a[h].getAttribute("file")});for(var h=0;h<s.length;h++){var l=s[h];e.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(var h=0;h<o.length;h++)e.kerning.push({first:parseInt(o[h].getAttribute("first"),10),second:parseInt(o[h].getAttribute("second"),10),amount:parseInt(o[h].getAttribute("amount"),10)});for(var h=0;h<u.length;h++)e.distanceField.push({fieldType:u[h].getAttribute("fieldType"),distanceRange:parseInt(u[h].getAttribute("distanceRange"),10)});return e},n}(),TC=function(){function n(){}return n.test=function(t){if(typeof t=="string"&&t.indexOf("<font>")>-1){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return nf.test(e)}return!1},n.parse=function(t){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return nf.parse(e)},n}(),Ru=[EC,nf,TC];function d0(n){for(var t=0;t<Ru.length;t++)if(Ru[t].test(n))return Ru[t];return null}function AC(n,t,e,r,i,a){var s=e.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;var o,u=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,l=n.width/r-u-h*2,c=n.height/r-u-h*2,f=s.slice(),d=e.fillGradientStops.slice();if(!d.length)for(var p=f.length+1,v=1;v<p;++v)d.push(v/p);if(f.unshift(s[0]),d.unshift(0),f.push(s[s.length-1]),d.push(1),e.fillGradientType===Ns.LINEAR_VERTICAL){o=t.createLinearGradient(l/2,h,l/2,c+h);for(var m=0,g=a.fontProperties.fontSize+e.strokeThickness,y=g/c,v=0;v<i.length;v++)for(var x=a.lineHeight*v,b=0;b<f.length;b++){var _=0;typeof d[b]=="number"?_=d[b]:_=b/f.length;var w=x/c+_*y,S=Math.max(m,w);S=Math.min(S,1),o.addColorStop(S,f[b]),m=S}}else{o=t.createLinearGradient(h,c/2,l+h,c/2);for(var E=f.length+1,T=1,v=0;v<f.length;v++){var A=void 0;typeof d[v]=="number"?A=d[v]:A=T/E,o.addColorStop(A,f[v]),T++}}return o}function MC(n,t,e,r,i,a,s){var o=e.text,u=e.fontProperties;t.translate(r,i),t.scale(a,a);var h=s.strokeThickness/2,l=-(s.strokeThickness/2);if(t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=AC(n,t,s,a,[o],e),t.strokeStyle=s.stroke,s.dropShadow){var c=s.dropShadowColor,f=Si(typeof c=="number"?c:Ny(c)),d=s.dropShadowBlur*a,p=s.dropShadowDistance*a;t.shadowColor="rgba("+f[0]*255+","+f[1]*255+","+f[2]*255+","+s.dropShadowAlpha+")",t.shadowBlur=d,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*p,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*p}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;s.stroke&&s.strokeThickness&&t.strokeText(o,h,l+e.lineHeight-u.descent),s.fill&&t.fillText(o,h,l+e.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function p0(n){return Array.from?Array.from(n):n.split("")}function PC(n){typeof n=="string"&&(n=[n]);for(var t=[],e=0,r=n.length;e<r;e++){var i=n[e];if(Array.isArray(i)){if(i.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var a=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<a)throw new Error("[BitmapFont]: Invalid character range.");for(var o=a,u=s;o<=u;o++)t.push(String.fromCharCode(o))}else t.push.apply(t,p0(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}function Ih(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}var On=function(){function n(t,e,r){var i,a,s=t.info[0],o=t.common[0],u=t.page[0],h=t.distanceField[0],l=Xh(u.file),c={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=o.lineHeight/l,this.chars={},this.pageTextures=c;for(var f=0;f<t.page.length;f++){var d=t.page[f],p=d.id,v=d.file;c[p]=e instanceof Array?e[f]:e[v],h!=null&&h.fieldType&&h.fieldType!=="none"&&(c[p].baseTexture.alphaMode=sr.NO_PREMULTIPLIED_ALPHA,c[p].baseTexture.mipmap=qe.OFF)}for(var f=0;f<t.char.length;f++){var m=t.char[f],p=m.id,g=m.page,y=t.char[f],x=y.x,b=y.y,_=y.width,w=y.height,S=y.xoffset,E=y.yoffset,T=y.xadvance;x/=l,b/=l,_/=l,w/=l,S/=l,E/=l,T/=l;var A=new St(x+c[g].frame.x/l,b+c[g].frame.y/l,_,w);this.chars[p]={xOffset:S,yOffset:E,xAdvance:T,kerning:{},texture:new vt(c[g].baseTexture,A),page:g}}for(var f=0;f<t.kerning.length;f++){var P=t.kerning[f],M=P.first,R=P.second,F=P.amount;M/=l,R/=l,F/=l,this.chars[R]&&(this.chars[R].kerning[M]=F)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=(a=(i=h==null?void 0:h.fieldType)===null||i===void 0?void 0:i.toLowerCase())!==null&&a!==void 0?a:"none"}return n.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},n.install=function(t,e,r){var i;if(t instanceof Hh)i=t;else{var a=d0(t);if(!a)throw new Error("Unrecognized data format for font.");i=a.parse(t)}e instanceof vt&&(e=[e]);var s=new n(i,e,r);return n.available[s.font]=s,s},n.uninstall=function(t){var e=n.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete n.available[t]},n.from=function(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},n.defaultOptions,r),a=i.chars,s=i.padding,o=i.resolution,u=i.textureWidth,h=i.textureHeight,l=PC(a),c=e instanceof Ca?e:new Ca(e),f=u,d=new Hh;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};for(var p=0,v=0,m,g,y,x=0,b=[],_=0;_<l.length;_++){m||(m=ht.ADAPTER.createCanvas(),m.width=u,m.height=h,g=m.getContext("2d"),y=new Mt(m,{resolution:o}),b.push(new vt(y)),d.page.push({id:b.length-1,file:""}));var w=l[_],S=Hr.measureText(w,c,!1,m),E=S.width,T=Math.ceil(S.height),A=Math.ceil((c.fontStyle==="italic"?2:1)*E);if(v>=h-T*o){if(v===0)throw new Error("[BitmapFont] textureHeight "+h+"px is too small "+("(fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+w+"')"));--_,m=null,g=null,y=null,v=0,p=0,x=0;continue}if(x=Math.max(T+S.fontProperties.descent,x),A*o+p>=f){if(p===0)throw new Error("[BitmapFont] textureWidth "+u+"px is too small "+("(fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+w+"')"));--_,v+=x*o,v=Math.ceil(v),p=0,x=0;continue}MC(m,g,S,p,v,o,c);var P=Ih(S.text);d.char.push({id:P,page:b.length-1,x:p/o,y:v/o,width:A,height:T,xoffset:0,yoffset:0,xadvance:Math.ceil(E-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),p+=(A+2*s)*o,p=Math.ceil(p)}if(!(r!=null&&r.skipKerning))for(var _=0,M=l.length;_<M;_++)for(var R=l[_],F=0;F<M;F++){var N=l[F],D=g.measureText(R).width,X=g.measureText(N).width,q=g.measureText(R+N).width,W=q-(D+X);W&&d.kerning.push({first:Ih(R),second:Ih(N),amount:W})}var L=new n(d,b,!0);return n.available[t]!==void 0&&n.uninstall(t),n.available[t]=L,L},n.ALPHA=[["a","z"],["A","Z"]," "],n.NUMERIC=[["0","9"]],n.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],n.ASCII=[[" ","~"]],n.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:n.ALPHANUMERIC},n.available={},n}(),IC=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,CC=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,fm=[],dm=[],pm=[];(function(n){SC(t,n);function t(e,r){r===void 0&&(r={});var i=n.call(this)||this;i._tint=16777215;var a=Object.assign({},t.styleDefaults,r),s=a.align,o=a.tint,u=a.maxWidth,h=a.letterSpacing,l=a.fontName,c=a.fontSize;if(!On.available[l])throw new Error('Missing BitmapFont "'+l+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=s,i._tint=o,i._font=void 0,i._fontName=l,i._fontSize=c,i.text=e,i._maxWidth=u,i._maxLineHeight=0,i._letterSpacing=h,i._anchor=new da(function(){i.dirty=!0},i,0,0),i._roundPixels=ht.ROUND_PIXELS,i.dirty=!0,i._resolution=ht.RESOLUTION,i._autoResolution=!0,i._textureCache={},i}return t.prototype.updateText=function(){for(var e,r=On.available[this._fontName],i=this.fontSize,a=i/r.size,s=new Ut,o=[],u=[],h=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=p0(l),f=this._maxWidth*r.size/i,d=r.distanceFieldType==="none"?fm:dm,p=null,v=0,m=0,g=0,y=-1,x=0,b=0,_=0,w=0,S=0;S<c.length;S++){var E=c[S],T=Ih(E);if(/(?:\s)/.test(E)&&(y=S,x=v,w++),E==="\r"||E===`
`){u.push(v),h.push(-1),m=Math.max(m,v),++g,++b,s.x=0,s.y+=r.lineHeight,p=null,w=0;continue}var A=r.chars[T];if(A){p&&A.kerning[p]&&(s.x+=A.kerning[p]);var P=pm.pop()||{texture:vt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ut};P.texture=A.texture,P.line=g,P.charCode=T,P.position.x=s.x+A.xOffset+this._letterSpacing/2,P.position.y=s.y+A.yOffset,P.prevSpaces=w,o.push(P),v=P.position.x+Math.max(A.xAdvance-A.xOffset,A.texture.orig.width),s.x+=A.xAdvance+this._letterSpacing,_=Math.max(_,A.yOffset+A.texture.height),p=T,y!==-1&&f>0&&s.x>f&&(++b,ba(o,1+y-b,1+S-y),S=y,y=-1,u.push(x),h.push(o.length>0?o[o.length-1].prevSpaces:0),m=Math.max(m,x),g++,s.x=0,s.y+=r.lineHeight,p=null,w=0)}}var M=c[c.length-1];M!=="\r"&&M!==`
`&&(/(?:\s)/.test(M)&&(v=x),u.push(v),m=Math.max(m,v),h.push(-1));for(var R=[],S=0;S<=g;S++){var F=0;this._align==="right"?F=m-u[S]:this._align==="center"?F=(m-u[S])/2:this._align==="justify"&&(F=h[S]<0?0:(m-u[S])/h[S]),R.push(F)}var N=o.length,D={},X=[],q=this._activePagesMeshData;d.push.apply(d,q);for(var S=0;S<N;S++){var W=o[S].texture,L=W.baseTexture.uid;if(!D[L]){var U=d.pop();if(!U){var G=new bl,V=void 0,O=void 0;r.distanceFieldType==="none"?(V=new Ls(vt.EMPTY),O=at.NORMAL):(V=new Ls(vt.EMPTY,{program:co.from(CC,IC),uniforms:{uFWidth:0}}),O=at.NORMAL_NPM);var z=new ks(G,V);z.blendMode=O,U={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:z,vertices:null,uvs:null,indices:null}}U.index=0,U.indexCount=0,U.vertexCount=0,U.uvsCount=0,U.total=0;var j=this._textureCache;j[L]=j[L]||new vt(W.baseTexture),U.mesh.texture=j[L],U.mesh.tint=this._tint,X.push(U),D[L]=U}D[L].total++}for(var S=0;S<q.length;S++)X.indexOf(q[S])===-1&&this.removeChild(q[S].mesh);for(var S=0;S<X.length;S++)X[S].mesh.parent!==this&&this.addChild(X[S].mesh);this._activePagesMeshData=X;for(var S in D){var U=D[S],K=U.total;if(!(((e=U.indices)===null||e===void 0?void 0:e.length)>6*K)||U.vertices.length<ks.BATCHABLE_SIZE*2)U.vertices=new Float32Array(4*2*K),U.uvs=new Float32Array(4*2*K),U.indices=new Uint16Array(6*K);else for(var Z=U.total,Q=U.vertices,nt=Z*4*2;nt<Q.length;nt++)Q[nt]=0;U.mesh.size=6*K}for(var S=0;S<N;S++){var E=o[S],J=E.position.x+R[E.line]*(this._align==="justify"?E.prevSpaces:1);this._roundPixels&&(J=Math.round(J));var it=J*a,st=E.position.y*a,W=E.texture,ot=D[W.baseTexture.uid],pt=W.frame,ct=W._uvs,lt=ot.index++;ot.indices[lt*6+0]=0+lt*4,ot.indices[lt*6+1]=1+lt*4,ot.indices[lt*6+2]=2+lt*4,ot.indices[lt*6+3]=0+lt*4,ot.indices[lt*6+4]=2+lt*4,ot.indices[lt*6+5]=3+lt*4,ot.vertices[lt*8+0]=it,ot.vertices[lt*8+1]=st,ot.vertices[lt*8+2]=it+pt.width*a,ot.vertices[lt*8+3]=st,ot.vertices[lt*8+4]=it+pt.width*a,ot.vertices[lt*8+5]=st+pt.height*a,ot.vertices[lt*8+6]=it,ot.vertices[lt*8+7]=st+pt.height*a,ot.uvs[lt*8+0]=ct.x0,ot.uvs[lt*8+1]=ct.y0,ot.uvs[lt*8+2]=ct.x1,ot.uvs[lt*8+3]=ct.y1,ot.uvs[lt*8+4]=ct.x2,ot.uvs[lt*8+5]=ct.y2,ot.uvs[lt*8+6]=ct.x3,ot.uvs[lt*8+7]=ct.y3}this._textWidth=m*a,this._textHeight=(s.y+r.lineHeight)*a;for(var S in D){var U=D[S];if(this.anchor.x!==0||this.anchor.y!==0)for(var Pt=0,Ot=this._textWidth*this.anchor.x,re=this._textHeight*this.anchor.y,we=0;we<U.total;we++)U.vertices[Pt++]-=Ot,U.vertices[Pt++]-=re,U.vertices[Pt++]-=Ot,U.vertices[Pt++]-=re,U.vertices[Pt++]-=Ot,U.vertices[Pt++]-=re,U.vertices[Pt++]-=Ot,U.vertices[Pt++]-=re;this._maxLineHeight=_*a;var Se=U.mesh.geometry.getBuffer("aVertexPosition"),Wt=U.mesh.geometry.getBuffer("aTextureCoord"),Be=U.mesh.geometry.getIndex();Se.data=U.vertices,Wt.data=U.uvs,Be.data=U.indices,Se.update(),Wt.update(),Be.update()}for(var S=0;S<o.length;S++)pm.push(o[S]);this._font=r,this.dirty=!1},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var r=On.available[this._fontName],i=r.distanceFieldRange,a=r.distanceFieldType,s=r.size;if(a!=="none")for(var o=this.worldTransform,u=o.a,h=o.b,l=o.c,c=o.d,f=Math.sqrt(u*u+h*h),d=Math.sqrt(l*l+c*c),p=(Math.abs(f)+Math.abs(d))/2,v=this.fontSize/s,m=0,g=this._activePagesMeshData;m<g.length;m++){var y=g[m];y.mesh.shader.uniforms.uFWidth=p*i*v*this._resolution}n.prototype._render.call(this,e)},t.prototype.getLocalBounds=function(){return this.validate(),n.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){var e=On.available[this._fontName];if(!e)throw new Error('Missing BitmapFont "'+this._fontName+'"');this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!On.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){var e;return(e=this._fontSize)!==null&&e!==void 0?e:On.available[this._fontName].size},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){var r=this._textureCache,i=On.available[this._fontName],a=i.distanceFieldType==="none"?fm:dm;a.push.apply(a,this._activePagesMeshData);for(var s=0,o=this._activePagesMeshData;s<o.length;s++){var u=o[s];this.removeChild(u.mesh)}this._activePagesMeshData=[],a.filter(function(c){return r[c.mesh.texture.baseTexture.uid]}).forEach(function(c){c.mesh.texture=vt.EMPTY});for(var h in r){var l=r[h];l.destroy(),delete r[h]}this._font=null,this._textureCache=null,n.prototype.destroy.call(this,e)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},t})($e);var RC=function(){function n(){}return n.add=function(){Ft.setExtensionXhrType("fnt",Ft.XHR_RESPONSE_TYPE.TEXT)},n.use=function(t,e){var r=d0(t.data);if(!r){e();return}for(var i=n.getBaseUrl(this,t),a=r.parse(t.data),s={},o=function(v){s[v.metadata.pageFile]=v.texture,Object.keys(s).length===a.page.length&&(t.bitmapFont=On.install(a,s,!0),e())},u=0;u<a.page.length;++u){var h=a.page[u].file,l=i+h,c=!1;for(var f in this.resources){var d=this.resources[f];if(d.url===l){d.metadata.pageFile=h,d.texture?o(d):d.onAfterMiddleware.add(o),c=!0;break}}if(!c){var p={crossOrigin:t.crossOrigin,loadType:Ft.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(l,p,o)}}},n.getBaseUrl=function(t,e){var r=e.isDataUrl?"":n.dirname(e.url);return e.isDataUrl&&(r==="."&&(r=""),t.baseUrl&&r&&t.baseUrl.charAt(t.baseUrl.length-1)==="/"&&(r+="/")),r=r.replace(t.baseUrl,""),r&&r.charAt(r.length-1)!=="/"&&(r+="/"),r},n.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":e===""?"/":e},n.extension=Bt.Loader,n}();/*!
 * @pixi/filter-alpha - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var af=function(n,t){return af=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},af(n,t)};function FC(n,t){af(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var OC=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;(function(n){FC(t,n);function t(e){e===void 0&&(e=1);var r=n.call(this,AP,OC,{uAlpha:1})||this;return r.alpha=e,r}return Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t})(Yn);/*!
 * @pixi/filter-blur - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sf=function(n,t){return sf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},sf(n,t)};function v0(n,t){sf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var BC=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function NC(n,t){var e=Math.ceil(n/2),r=BC,i="",a;t?a="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<n;s++){var o=a.replace("%index%",s.toString());o=o.replace("%sampleIndex%",s-(e-1)+".0"),i+=o,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",n.toString()),r}var kC={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},LC=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function DC(n){for(var t=kC[n],e=t.length,r=LC,i="",a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",s,o=0;o<n;o++){var u=a.replace("%index%",o.toString());s=o,o>=e&&(s=n-o-1),u=u.replace("%value%",t[s].toString()),i+=u,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",n.toString()),r}var vm=function(n){v0(t,n);function t(e,r,i,a,s){r===void 0&&(r=8),i===void 0&&(i=4),a===void 0&&(a=ht.FILTER_RESOLUTION),s===void 0&&(s=5);var o=this,u=NC(s,e),h=DC(s);return o=n.call(this,u,h)||this,o.horizontal=e,o.resolution=a,o._quality=0,o.quality=i,o.blur=r,o}return t.prototype.apply=function(e,r,i,a){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,i,a);else{var s=e.getFilterTexture(),o=e.renderer,u=r,h=s;this.state.blend=!1,e.applyFilter(this,u,h,Sr.CLEAR);for(var l=1;l<this.passes-1;l++){e.bindAndClear(u,Sr.BLIT),this.uniforms.uSampler=h;var c=h;h=u,u=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,i,a),e.returnFilterTexture(s)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+Math.abs(e)*2,this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(Yn);(function(n){v0(t,n);function t(e,r,i,a){e===void 0&&(e=8),r===void 0&&(r=4),i===void 0&&(i=ht.FILTER_RESOLUTION),a===void 0&&(a=5);var s=n.call(this)||this;return s.blurXFilter=new vm(!0,e,r,i,a),s.blurYFilter=new vm(!1,e,r,i,a),s.resolution=i,s.quality=r,s.blur=e,s.repeatEdgePixels=!1,s}return t.prototype.apply=function(e,r,i,a){var s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){var u=e.getFilterTexture();this.blurXFilter.apply(e,r,u,Sr.CLEAR),this.blurYFilter.apply(e,u,i,a),e.returnFilterTexture(u)}else o?this.blurYFilter.apply(e,r,i,a):this.blurXFilter.apply(e,r,i,a)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),t})(Yn);/*!
 * @pixi/filter-color-matrix - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var of=function(n,t){return of=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},of(n,t)};function UC(n,t){of(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var VC=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,mm=function(n){UC(t,n);function t(){var e=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return e=n.call(this,e0,VC,r)||this,e.alpha=1,e}return t.prototype._loadMatrix=function(e,r){r===void 0&&(r=!1);var i=e;r&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i},t.prototype._multiply=function(e,r,i){return e[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],e[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],e[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],e[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],e[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],e[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],e[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],e[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],e[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],e[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],e[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],e[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],e[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],e[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],e[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],e[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],e[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],e[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],e[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],e[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],e},t.prototype._colorMatrix=function(e){var r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},t.prototype.brightness=function(e,r){var i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,r)},t.prototype.tint=function(e,r){var i=e>>16&255,a=e>>8&255,s=e&255,o=[i/255,0,0,0,0,0,a/255,0,0,0,0,0,s/255,0,0,0,0,0,1,0];this._loadMatrix(o,r)},t.prototype.greyscale=function(e,r){var i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,r)},t.prototype.blackAndWhite=function(e){var r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.hue=function(e,r){e=(e||0)/180*Math.PI;var i=Math.cos(e),a=Math.sin(e),s=Math.sqrt,o=1/3,u=s(o),h=i+(1-i)*o,l=o*(1-i)-u*a,c=o*(1-i)+u*a,f=o*(1-i)+u*a,d=i+o*(1-i),p=o*(1-i)-u*a,v=o*(1-i)-u*a,m=o*(1-i)+u*a,g=i+o*(1-i),y=[h,l,c,0,0,f,d,p,0,0,v,m,g,0,0,0,0,0,1,0];this._loadMatrix(y,r)},t.prototype.contrast=function(e,r){var i=(e||0)+1,a=-.5*(i-1),s=[i,0,0,0,a,0,i,0,0,a,0,0,i,0,a,0,0,0,1,0];this._loadMatrix(s,r)},t.prototype.saturate=function(e,r){e===void 0&&(e=0);var i=e*2/3+1,a=(i-1)*-.5,s=[i,a,a,0,0,a,i,a,0,0,a,a,i,0,0,0,0,0,1,0];this._loadMatrix(s,r)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){var r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.sepia=function(e){var r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.technicolor=function(e){var r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.polaroid=function(e){var r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.toBGR=function(e){var r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.kodachrome=function(e){var r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.browni=function(e){var r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.vintage=function(e){var r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.colorTone=function(e,r,i,a,s){e=e||.2,r=r||.15,i=i||16770432,a=a||3375104;var o=(i>>16&255)/255,u=(i>>8&255)/255,h=(i&255)/255,l=(a>>16&255)/255,c=(a>>8&255)/255,f=(a&255)/255,d=[.3,.59,.11,0,0,o,u,h,e,0,l,c,f,r,0,o-l,u-c,h-f,0,0];this._loadMatrix(d,s)},t.prototype.night=function(e,r){e=e||.1;var i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)},t.prototype.predator=function(e,r){var i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,r)},t.prototype.lsd=function(e){var r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)},t.prototype.reset=function(){var e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Yn);mm.prototype.grayscale=mm.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hf=function(n,t){return hf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},hf(n,t)};function XC(n,t){hf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var zC=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,GC=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;(function(n){XC(t,n);function t(e,r){var i=this,a=new te;return e.renderable=!1,i=n.call(this,GC,zC,{mapSampler:e._texture,filterMatrix:a,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this,i.maskSprite=e,i.maskMatrix=a,r==null&&(r=20),i.scale=new Ut(r,r),i}return t.prototype.apply=function(e,r,i,a){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),u=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&u!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/u,this.uniforms.rotation[3]=s.d/u),e.applyFilter(this,r,i,a)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),t})(Yn);/*!
 * @pixi/filter-fxaa - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-fxaa is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lf=function(n,t){return lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},lf(n,t)};function YC(n,t){lf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var WC=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,HC=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;(function(n){YC(t,n);function t(){return n.call(this,WC,HC)||this}return t})(Yn);/*!
 * @pixi/filter-noise - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-noise is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uf=function(n,t){return uf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},uf(n,t)};function jC(n,t){uf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var $C=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;(function(n){jC(t,n);function t(e,r){e===void 0&&(e=.5),r===void 0&&(r=Math.random());var i=n.call(this,e0,$C,{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=r,i}return Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t})(Yn);/*!
 * @pixi/mixin-cache-as-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var m0=new te;ae.prototype._cacheAsBitmap=!1;ae.prototype._cacheData=null;ae.prototype._cacheAsBitmapResolution=null;ae.prototype._cacheAsBitmapMultisample=Xt.NONE;var qC=function(){function n(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return n}();Object.defineProperties(ae.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(n){if(this._cacheAsBitmap!==n){this._cacheAsBitmap=n;var t;n?(this._cacheData||(this._cacheData=new qC),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}});ae.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};ae.prototype._initCachedDisplayObject=function(t){var e;if(!(this._cacheData&&this._cacheData.sprite)){var r=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var a=this.filters[0].padding;i.pad(a)}i.ceil(ht.RESOLUTION);var s=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),u=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,l=Ti.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:(e=this.cacheAsBitmapMultisample)!==null&&e!==void 0?e:t.multisample}),c="cacheAsBitmap_"+Ei();this._cacheData.textureCacheId=c,Mt.addToCache(l.baseTexture,c),vt.addToCache(l,c);var f=this.transform.localTransform.copyTo(m0).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:f,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(s,o,u),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var d=new La(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(i.x/i.width),d.anchor.y=-(i.y/i.height),d.alpha=r,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)}};ae.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};ae.prototype._initCachedDisplayObjectCanvas=function(t){if(!(this._cacheData&&this._cacheData.sprite)){var e=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var i=t.context,a=t._projTransform;e.ceil(ht.RESOLUTION);var s=Ti.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+Ei();this._cacheData.textureCacheId=o,Mt.addToCache(s.baseTexture,o),vt.addToCache(s,o);var u=m0;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=e.x,u.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:s,clear:!0,transform:u,skipUpdateTransform:!1}),t.context=i,t._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var h=new La(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(e.x/e.width),h.anchor.y=-(e.y/e.height),h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}};ae.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};ae.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};ae.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Mt.removeFromCache(this._cacheData.textureCacheId),vt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};ae.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};/*!
 * @pixi/mixin-get-child-by-name - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ae.prototype.name=null;$e.prototype.getChildByName=function(t,e){for(var r=0,i=this.children.length;r<i;r++)if(this.children[r].name===t)return this.children[r];if(e)for(var r=0,i=this.children.length;r<i;r++){var a=this.children[r];if(a.getChildByName){var s=a.getChildByName(t,!0);if(s)return s}}return null};/*!
 * @pixi/mixin-get-global-position - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ae.prototype.getGlobalPosition=function(t,e){return t===void 0&&(t=new Ut),e===void 0&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};/*!
 * @pixi/app - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ZC=function(){function n(){}return n.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){e.cancelResize();var r,i;if(e._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{var a=e._resizeTo,s=a.clientWidth,o=a.clientHeight;r=s,i=o}e.renderer.resize(r,i)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},n.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},n.extension=Bt.Application,n}(),g0=function(){function n(t){var e=this;this.stage=new $e,t=Object.assign({forceCanvas:!1},t),this.renderer=SP(t),n._plugins.forEach(function(r){r.init.call(e,t)})}return n.registerPlugin=function(t){Mr("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),gn.add({type:Bt.Application,ref:t})},n.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(n.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),n.prototype.destroy=function(t,e){var r=this,i=n._plugins.slice(0);i.reverse(),i.forEach(function(a){a.destroy.call(r)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},n._plugins=[],n}();gn.handleByList(Bt.Application,g0._plugins);gn.add(ZC);/*!
 * @pixi/mesh-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cf=function(n,t){return cf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},cf(n,t)};function Da(n,t){cf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var KC=function(n){Da(t,n);function t(e,r,i,a){e===void 0&&(e=100),r===void 0&&(r=100),i===void 0&&(i=10),a===void 0&&(a=10);var s=n.call(this)||this;return s.segWidth=i,s.segHeight=a,s.width=e,s.height=r,s.build(),s}return t.prototype.build=function(){for(var e=this.segWidth*this.segHeight,r=[],i=[],a=[],s=this.segWidth-1,o=this.segHeight-1,u=this.width/s,h=this.height/o,l=0;l<e;l++){var c=l%this.segWidth,f=l/this.segWidth|0;r.push(c*u,f*h),i.push(c/s,f/o)}for(var d=s*o,l=0;l<d;l++){var p=l%s,v=l/s|0,m=v*this.segWidth+p,g=v*this.segWidth+p+1,y=(v+1)*this.segWidth+p,x=(v+1)*this.segWidth+p+1;a.push(m,g,y,g,x,y)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(a),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},t}(bl),JC=function(n){Da(t,n);function t(e,r,i){e===void 0&&(e=200),i===void 0&&(i=0);var a=n.call(this,new Float32Array(r.length*4),new Float32Array(r.length*4),new Uint16Array((r.length-1)*6))||this;return a.points=r,a._width=e,a.textureScale=i,a.build(),a}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),t.prototype.build=function(){var e=this.points;if(e){var r=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),a=this.getIndex();if(!(e.length<1)){r.data.length/4!==e.length&&(r.data=new Float32Array(e.length*4),i.data=new Float32Array(e.length*4),a.data=new Uint16Array((e.length-1)*6));var s=i.data,o=a.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;for(var u=0,h=e[0],l=this._width*this.textureScale,c=e.length,f=0;f<c;f++){var d=f*4;if(this.textureScale>0){var p=h.x-e[f].x,v=h.y-e[f].y,m=Math.sqrt(p*p+v*v);h=e[f],u+=m/l}else u=f/(c-1);s[d]=u,s[d+1]=0,s[d+2]=u,s[d+3]=1}for(var g=0,f=0;f<c-1;f++){var d=f*2;o[g++]=d,o[g++]=d+1,o[g++]=d+2,o[g++]=d+2,o[g++]=d+1,o[g++]=d+3}i.update(),a.update(),this.updateVertices()}}},t.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var r=e[0],i,a=0,s=0,o=this.buffers[0].data,u=e.length,h=0;h<u;h++){var l=e[h],c=h*4;h<e.length-1?i=e[h+1]:i=l,s=-(i.x-r.x),a=i.y-r.y;var f=Math.sqrt(a*a+s*s),d=this.textureScale>0?this.textureScale*this._width/2:this._width/2;a/=f,s/=f,a*=d,s*=d,o[c]=l.x+a,o[c+1]=l.y+s,o[c+2]=l.x-a,o[c+3]=l.y-s,r=l}this.buffers[0].update()}},t.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},t}(bl);(function(n){Da(t,n);function t(e,r,i){i===void 0&&(i=0);var a=this,s=new JC(e.height,r,i),o=new Ls(e);return i>0&&(e.baseTexture.wrapMode=zr.REPEAT),a=n.call(this,s,o)||this,a.autoUpdate=!0,a}return t.prototype._render=function(e){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),n.prototype._render.call(this,e)},t})(ks);var QC=function(n){Da(t,n);function t(e,r,i){var a=this,s=new KC(e.width,e.height,r,i),o=new Ls(vt.WHITE);return a=n.call(this,s,o)||this,a.texture=e,a.autoResize=!0,a}return t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var e=this.geometry,r=this.shader.texture,i=r.width,a=r.height;this.autoResize&&(e.width!==i||e.height!==a)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())},Object.defineProperty(t.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),t.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),n.prototype._render.call(this,e)},t.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),n.prototype.destroy.call(this,e)},t}(ks),tR=function(n){Da(t,n);function t(e,r,i,a,s){e===void 0&&(e=vt.EMPTY);var o=this,u=new bl(r,i,a);u.getBuffer("aVertexPosition").static=!1;var h=new Ls(e);return o=n.call(this,u,h,null,s)||this,o.autoUpdate=!0,o}return Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),n.prototype._render.call(this,e)},t}(ks),Wo=10;(function(n){Da(t,n);function t(e,r,i,a,s){r===void 0&&(r=Wo),i===void 0&&(i=Wo),a===void 0&&(a=Wo),s===void 0&&(s=Wo);var o=n.call(this,vt.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=r,o._rightWidth=a,o._topHeight=i,o._bottomHeight=s,o.texture=e,o}return t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype.updateHorizontalVertices=function(){var e=this.vertices,r=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*r,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*r,e[25]=e[27]=e[29]=e[31]=this._height},t.prototype.updateVerticalVertices=function(){var e=this.vertices,r=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*r,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*r,e[6]=e[14]=e[22]=e[30]=this._width},t.prototype._getMinScale=function(){var e=this._leftWidth+this._rightWidth,r=this._width>e?1:this._width/e,i=this._topHeight+this._bottomHeight,a=this._height>i?1:this._height/i,s=Math.min(r,a);return s},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topHeight",{get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()},enumerable:!1,configurable:!0}),t.prototype._refresh=function(){var e=this.texture,r=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var i=1/this._origWidth,a=1/this._origHeight;r[0]=r[8]=r[16]=r[24]=0,r[1]=r[3]=r[5]=r[7]=0,r[6]=r[14]=r[22]=r[30]=1,r[25]=r[27]=r[29]=r[31]=1,r[2]=r[10]=r[18]=r[26]=i*this._leftWidth,r[4]=r[12]=r[20]=r[28]=1-i*this._rightWidth,r[9]=r[11]=r[13]=r[15]=a*this._topHeight,r[17]=r[19]=r[21]=r[23]=1-a*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},t})(QC);/*!
 * @pixi/sprite-animated - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-animated is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ff=function(n,t){return ff=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},ff(n,t)};function eR(n,t){ff(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}(function(n){eR(t,n);function t(e,r){r===void 0&&(r=!0);var i=n.call(this,e[0]instanceof vt?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=r,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}return t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Fe.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Fe.shared.add(this.update,this,mn.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var r=this.animationSpeed*e,i=this.currentFrame;if(this._durations!==null){var a=this._currentTime%1*this._durations[this.currentFrame];for(a+=r/60*1e3;a<0;)this._currentTime--,a+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);a>=this._durations[this.currentFrame];)a-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=a/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i?this.onLoop():this.animationSpeed<0&&this.currentFrame>i&&this.onLoop()),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(e){this.stop(),n.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var r=[],i=0;i<e.length;++i)r.push(vt.from(e[i]));return new t(r)},t.fromImages=function(e){for(var r=[],i=0;i<e.length;++i)r.push(vt.from(e[i]));return new t(r)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof vt)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Fe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Fe.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),t})(La);/*!
 * pixi.js - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */gn.add(LP,WP,zP,LI,fC,n0,xC,RC,hI,OI,BI,pC,eM,QP);var yt;(function(n){n[n.Region=0]="Region",n[n.BoundingBox=1]="BoundingBox",n[n.Mesh=2]="Mesh",n[n.LinkedMesh=3]="LinkedMesh",n[n.Path=4]="Path",n[n.Point=5]="Point",n[n.Clipping=6]="Clipping"})(yt||(yt={}));var jh=function(){function n(t,e,r,i){e===void 0&&(e=new Array),r===void 0&&(r=0),i===void 0&&(i=new DataView(t.buffer)),this.strings=e,this.index=r,this.buffer=i}return n.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},n.prototype.readUnsignedByte=function(){return this.buffer.getUint8(this.index++)},n.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},n.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},n.prototype.readInt=function(t){var e=this.readByte(),r=e&127;return e&128&&(e=this.readByte(),r|=(e&127)<<7,e&128&&(e=this.readByte(),r|=(e&127)<<14,e&128&&(e=this.readByte(),r|=(e&127)<<21,e&128&&(e=this.readByte(),r|=(e&127)<<28)))),t?r:r>>>1^-(r&1)},n.prototype.readStringRef=function(){var t=this.readInt(!0);return t==0?null:this.strings[t-1]},n.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",r=0;r<t;){var i=this.readUnsignedByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((i&31)<<6|this.readByte()&63),r+=2;break;case 14:e+=String.fromCharCode((i&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),r+=3;break;default:e+=String.fromCharCode(i),r++}}return e},n.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},n.prototype.readBoolean=function(){return this.readByte()!=0},n}(),C;(function(n){n[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add"})(C||(C={}));var mt;(function(n){n[n.mixIn=0]="mixIn",n[n.mixOut=1]="mixOut"})(mt||(mt={}));var zt;(function(n){n[n.Fixed=0]="Fixed",n[n.Percent=1]="Percent"})(zt||(zt={}));var Qt;(function(n){n[n.Tangent=0]="Tangent",n[n.Chain=1]="Chain",n[n.ChainScale=2]="ChainScale"})(Qt||(Qt={}));var dt;(function(n){n[n.Normal=0]="Normal",n[n.OnlyTranslation=1]="OnlyTranslation",n[n.NoRotationOrReflection=2]="NoRotationOrReflection",n[n.NoScale=3]="NoScale",n[n.NoScaleOrReflection=4]="NoScaleOrReflection"})(dt||(dt={}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var df=function(n,t){return df=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},df(n,t)};function Ua(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");df(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function gm(n){switch(n.toLowerCase()){case"nearest":return He.Nearest;case"linear":return He.Linear;case"mipmap":return He.MipMap;case"mipmapnearestnearest":return He.MipMapNearestNearest;case"mipmaplinearnearest":return He.MipMapLinearNearest;case"mipmapnearestlinear":return He.MipMapNearestLinear;case"mipmaplinearlinear":return He.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+n)}}var He;(function(n){n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear"})(He||(He={}));var Dn;(function(n){n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat"})(Dn||(Dn={}));var pf=function(){function n(){this.size=null,this.names=null,this.values=null,this.renderObject=null}return Object.defineProperty(n.prototype,"width",{get:function(){var t=this.texture;return t.trim?t.trim.width:t.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){var t=this.texture;return t.trim?t.trim.height:t.orig.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"u",{get:function(){return this.texture._uvs.x0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"v",{get:function(){return this.texture._uvs.y0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"u2",{get:function(){return this.texture._uvs.x2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"v2",{get:function(){return this.texture._uvs.y2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offsetX",{get:function(){var t=this.texture;return t.trim?t.trim.x:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offsetY",{get:function(){return this.spineOffsetY},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pixiOffsetY",{get:function(){var t=this.texture;return t.trim?t.trim.y:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"spineOffsetY",{get:function(){var t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"originalWidth",{get:function(){return this.texture.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"originalHeight",{get:function(){return this.texture.orig.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.texture.frame.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.texture.frame.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotate",{get:function(){return this.texture.rotate!==0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"degrees",{get:function(){return(360-this.texture.rotate*45)%360},enumerable:!1,configurable:!0}),n}(),rR=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}return n}(),nR=function(){function n(t,e,r){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,r)}return n.prototype.addTexture=function(t,e){for(var r=this.pages,i=null,a=0;a<r.length;a++)if(r[a].baseTexture===e.baseTexture){i=r[a];break}if(i===null){i=new ym,i.name="texturePage";var s=e.baseTexture;i.width=s.realWidth,i.height=s.realHeight,i.baseTexture=s,i.minFilter=i.magFilter=He.Nearest,i.uWrap=Dn.ClampToEdge,i.vWrap=Dn.ClampToEdge,r.push(i)}var o=new xm;return o.name=t,o.page=i,o.texture=e,o.index=-1,this.regions.push(o),o},n.prototype.addTextureHash=function(t,e){for(var r in t)t.hasOwnProperty(r)&&this.addTexture(e&&r.indexOf(".")!==-1?r.substr(0,r.lastIndexOf(".")):r,t[r])},n.prototype.addSpineAtlas=function(t,e,r){return this.load(t,e,r)},n.prototype.load=function(t,e,r){var i=this;if(e==null)throw new Error("textureLoader cannot be null.");var a=new iR(t),s=new Array(4),o=null,u={},h=null;u.size=function(){o.width=parseInt(s[1]),o.height=parseInt(s[2])},u.format=function(){},u.filter=function(){o.minFilter=gm(s[1]),o.magFilter=gm(s[2])},u.repeat=function(){s[1].indexOf("x")!=-1&&(o.uWrap=Dn.Repeat),s[1].indexOf("y")!=-1&&(o.vWrap=Dn.Repeat)},u.pma=function(){o.pma=s[1]=="true"};var l={};l.xy=function(){h.x=parseInt(s[1]),h.y=parseInt(s[2])},l.size=function(){h.width=parseInt(s[1]),h.height=parseInt(s[2])},l.bounds=function(){h.x=parseInt(s[1]),h.y=parseInt(s[2]),h.width=parseInt(s[3]),h.height=parseInt(s[4])},l.offset=function(){h.offsetX=parseInt(s[1]),h.offsetY=parseInt(s[2])},l.orig=function(){h.originalWidth=parseInt(s[1]),h.originalHeight=parseInt(s[2])},l.offsets=function(){h.offsetX=parseInt(s[1]),h.offsetY=parseInt(s[2]),h.originalWidth=parseInt(s[3]),h.originalHeight=parseInt(s[4])},l.rotate=function(){var d=s[1],p=0;d.toLocaleLowerCase()=="true"?p=6:d.toLocaleLowerCase()=="false"?p=0:p=(720-parseFloat(d))%360/45,h.rotate=p},l.index=function(){h.index=parseInt(s[1])};for(var c=a.readLine();c!=null&&c.trim().length==0;)c=a.readLine();for(;!(c==null||c.trim().length==0||a.readEntry(s,c)==0);)c=a.readLine();var f=function(){for(;;){if(c==null)return r&&r(i);if(c.trim().length==0)o=null,c=a.readLine();else if(o===null){for(o=new ym,o.name=c.trim();a.readEntry(s,c=a.readLine())!=0;){var d=u[s[0]];d&&d()}i.pages.push(o),e(o.name,function(T){if(T===null)return i.pages.splice(i.pages.indexOf(o),1),r&&r(null);o.baseTexture=T,o.pma&&(T.alphaMode=sr.PMA),T.valid||T.setSize(o.width,o.height),o.setFilters(),(!o.width||!o.height)&&(o.width=T.realWidth,o.height=T.realHeight,(!o.width||!o.height)&&console.log("ERROR spine atlas page "+o.name+": meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)")),f()});break}else{h=new rR;var p=new xm;p.name=c,p.page=o;for(var v=null,m=null;;){var g=a.readEntry(s,c=a.readLine());if(g==0)break;var d=l[s[0]];if(d)d();else{v==null&&(v=[],m=[]),v.push(s[0]);for(var y=[],x=0;x<g;x++)y.push(parseInt(s[x+1]));m.push(y)}}h.originalWidth==0&&h.originalHeight==0&&(h.originalWidth=h.width,h.originalHeight=h.height);var b=o.baseTexture.resolution;h.x/=b,h.y/=b,h.width/=b,h.height/=b,h.originalWidth/=b,h.originalHeight/=b,h.offsetX/=b,h.offsetY/=b;var _=h.rotate%4!==0,w=new St(h.x,h.y,_?h.height:h.width,_?h.width:h.height),S=new St(0,0,h.originalWidth,h.originalHeight),E=new St(h.offsetX,h.originalHeight-h.height-h.offsetY,h.width,h.height);p.texture=new vt(p.page.baseTexture,w,S,E,h.rotate),p.index=h.index,p.texture.updateUvs(),i.regions.push(p)}}};f()},n.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},n.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()},n}(),iR=function(){function n(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}return n.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},n.prototype.readEntry=function(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;var r=e.indexOf(":");if(r==-1)return 0;t[0]=e.substr(0,r).trim();for(var i=1,a=r+1;;i++){var s=e.indexOf(",",a);if(s==-1)return t[i]=e.substr(a).trim(),i;if(t[i]=e.substr(a,s-a).trim(),a=s+1,i==4)return 4}},n}(),ym=function(){function n(){this.minFilter=He.Nearest,this.magFilter=He.Nearest,this.uWrap=Dn.ClampToEdge,this.vWrap=Dn.ClampToEdge}return n.prototype.setFilters=function(){var t=this.baseTexture,e=this.minFilter;e==He.Linear?t.scaleMode=je.LINEAR:this.minFilter==He.Nearest?t.scaleMode=je.NEAREST:(t.mipmap=qe.POW2,e==He.MipMapNearestNearest?t.scaleMode=je.NEAREST:t.scaleMode=je.LINEAR)},n}(),xm=function(n){Ua(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(pf),aR=function(n){return function(t){return n[0]=t,n[0]}}(new Float32Array(1)),sR=Math.fround||aR,y0=function(){function n(){this.array=new Array}return n.prototype.add=function(t){var e=this.contains(t);return this.array[t|0]=t|0,!e},n.prototype.contains=function(t){return this.array[t|0]!=null},n.prototype.remove=function(t){this.array[t|0]=void 0},n.prototype.clear=function(){this.array.length=0},n}(),x0=function(){function n(){this.entries={},this.size=0}return n.prototype.add=function(t){var e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)},n.prototype.addAll=function(t){for(var e=this.size,r=0,i=t.length;r<i;r++)this.add(t[r]);return e!=this.size},n.prototype.contains=function(t){return this.entries[t]},n.prototype.clear=function(){this.entries={},this.size=0},n}(),tt=function(){function n(t,e,r,i){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),this.r=t,this.g=e,this.b=r,this.a=i}return n.prototype.set=function(t,e,r,i){return this.r=t,this.g=e,this.b=r,this.a=i,this.clamp()},n.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},n.prototype.setFromString=function(t){return t=t.charAt(0)=="#"?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=t.length!=8?1:parseInt(t.substr(6,2),16)/255,this},n.prototype.add=function(t,e,r,i){return this.r+=t,this.g+=e,this.b+=r,this.a+=i,this.clamp()},n.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},n.rgba8888ToColor=function(t,e){t.r=((e&4278190080)>>>24)/255,t.g=((e&16711680)>>>16)/255,t.b=((e&65280)>>>8)/255,t.a=(e&255)/255},n.rgb888ToColor=function(t,e){t.r=((e&16711680)>>>16)/255,t.g=((e&65280)>>>8)/255,t.b=(e&255)/255},n.fromString=function(t){return new n().setFromString(t)},n.WHITE=new n(1,1,1,1),n.RED=new n(1,0,0,1),n.GREEN=new n(0,1,0,1),n.BLUE=new n(0,0,1,1),n.MAGENTA=new n(1,0,1,1),n}(),B=function(){function n(){}return n.clamp=function(t,e,r){return t<e?e:t>r?r:t},n.cosDeg=function(t){return Math.cos(t*n.degRad)},n.sinDeg=function(t){return Math.sin(t*n.degRad)},n.signum=function(t){return t>0?1:t<0?-1:0},n.toInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},n.cbrt=function(t){var e=Math.pow(Math.abs(t),.3333333333333333);return t<0?-e:e},n.randomTriangular=function(t,e){return n.randomTriangularWith(t,e,(t+e)*.5)},n.randomTriangularWith=function(t,e,r){var i=Math.random(),a=e-t;return i<=(r-t)/a?t+Math.sqrt(i*a*(r-t)):e-Math.sqrt((1-i)*a*(e-r))},n.isPowerOfTwo=function(t){return t&&(t&t-1)===0},n.PI=3.1415927,n.PI2=n.PI*2,n.radiansToDegrees=180/n.PI,n.radDeg=n.radiansToDegrees,n.degreesToRadians=n.PI/180,n.degRad=n.degreesToRadians,n}(),oR=function(){function n(){}return n.prototype.apply=function(t,e,r){return t+(e-t)*this.applyInternal(r)},n}(),hR=function(n){Ua(t,n);function t(e){var r=n.call(this)||this;return r.power=2,r.power=e,r}return t.prototype.applyInternal=function(e){return e<=.5?Math.pow(e*2,this.power)/2:Math.pow((e-1)*2,this.power)/(this.power%2==0?-2:2)+1},t}(oR),b0=function(n){Ua(t,n);function t(e){return n.call(this,e)||this}return t.prototype.applyInternal=function(e){return Math.pow(e-1,this.power)*(this.power%2==0?-1:1)+1},t}(hR),Y=function(){function n(){}return n.arrayCopy=function(t,e,r,i,a){for(var s=e,o=i;s<e+a;s++,o++)r[o]=t[s]},n.arrayFill=function(t,e,r,i){for(var a=e;a<r;a++)t[a]=i},n.setArraySize=function(t,e,r){r===void 0&&(r=0);var i=t.length;if(i==e)return t;if(t.length=e,i<e)for(var a=i;a<e;a++)t[a]=r;return t},n.ensureArrayCapacity=function(t,e,r){return r===void 0&&(r=0),t.length>=e?t:n.setArraySize(t,e,r)},n.newArray=function(t,e){for(var r=new Array(t),i=0;i<t;i++)r[i]=e;return r},n.newFloatArray=function(t){if(n.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var e=new Array(t),r=0;r<e.length;r++)e[r]=0;return e},n.newShortArray=function(t){if(n.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var e=new Array(t),r=0;r<e.length;r++)e[r]=0;return e},n.toFloatArray=function(t){return n.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},n.toSinglePrecision=function(t){return n.SUPPORTS_TYPED_ARRAYS?sR(t):t},n.webkit602BugfixHelper=function(t,e){},n.contains=function(t,e,r){for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},n.enumValue=function(t,e){return t[e[0].toUpperCase()+e.slice(1)]},n.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u",n}(),_l=function(){function n(t){this.items=new Array,this.instantiator=t}return n.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},n.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},n.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)this.free(t[e])},n.prototype.clear=function(){this.items.length=0},n}(),Ds=function(){function n(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=t,this.y=e}return n.prototype.set=function(t,e){return this.x=t,this.y=e,this},n.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},n.prototype.normalize=function(){var t=this.length();return t!=0&&(this.x/=t,this.y/=t),this},n}(),hd=function(){function n(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new _l(function(){return Y.newFloatArray(16)})}return n.prototype.update=function(t,e){if(!t)throw new Error("skeleton cannot be null.");var r=this.boundingBoxes,i=this.polygons,a=this.polygonPool,s=t.slots,o=s.length;r.length=0,a.freeAll(i),i.length=0;for(var u=0;u<o;u++){var h=s[u];if(h.bone.active){var l=h.getAttachment();if(l!=null&&l.type===yt.BoundingBox){var c=l;r.push(c);var f=a.obtain();f.length!=c.worldVerticesLength&&(f=Y.newFloatArray(c.worldVerticesLength)),i.push(f),c.computeWorldVertices(h,0,c.worldVerticesLength,f,0,2)}}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},n.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.polygons,s=0,o=a.length;s<o;s++)for(var u=a[s],h=u,l=0,c=u.length;l<c;l+=2){var f=h[l],d=h[l+1];t=Math.min(t,f),e=Math.min(e,d),r=Math.max(r,f),i=Math.max(i,d)}this.minX=t,this.minY=e,this.maxX=r,this.maxY=i},n.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},n.prototype.aabbIntersectsSegment=function(t,e,r,i){var a=this.minX,s=this.minY,o=this.maxX,u=this.maxY;if(t<=a&&r<=a||e<=s&&i<=s||t>=o&&r>=o||e>=u&&i>=u)return!1;var h=(i-e)/(r-t),l=h*(a-t)+e;if(l>s&&l<u||(l=h*(o-t)+e,l>s&&l<u))return!0;var c=(s-e)/h+t;return c>a&&c<o||(c=(u-e)/h+t,c>a&&c<o)},n.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},n.prototype.containsPoint=function(t,e){for(var r=this.polygons,i=0,a=r.length;i<a;i++)if(this.containsPointPolygon(r[i],t,e))return this.boundingBoxes[i];return null},n.prototype.containsPointPolygon=function(t,e,r){for(var i=t,a=t.length,s=a-2,o=!1,u=0;u<a;u+=2){var h=i[u+1],l=i[s+1];if(h<r&&l>=r||l<r&&h>=r){var c=i[u];c+(r-h)/(l-h)*(i[s]-c)<e&&(o=!o)}s=u}return o},n.prototype.intersectsSegment=function(t,e,r,i){for(var a=this.polygons,s=0,o=a.length;s<o;s++)if(this.intersectsSegmentPolygon(a[s],t,e,r,i))return this.boundingBoxes[s];return null},n.prototype.intersectsSegmentPolygon=function(t,e,r,i,a){for(var s=t,o=t.length,u=e-i,h=r-a,l=e*a-r*i,c=s[o-2],f=s[o-1],d=0;d<o;d+=2){var p=s[d],v=s[d+1],m=c*v-f*p,g=c-p,y=f-v,x=u*y-h*g,b=(l*g-u*m)/x;if((b>=c&&b<=p||b>=p&&b<=c)&&(b>=e&&b<=i||b>=i&&b<=e)){var _=(l*y-h*m)/x;if((_>=f&&_<=v||_>=v&&_<=f)&&(_>=r&&_<=a||_>=a&&_<=r))return!0}c=p,f=v}return!1},n.prototype.getPolygon=function(t){if(!t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]},n.prototype.getWidth=function(){return this.maxX-this.minX},n.prototype.getHeight=function(){return this.maxY-this.minY},n}(),lR={GLOBAL_DELAY_LIMIT:0},Tn=[0,0,0],uR=function(n){Ua(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.region=null,e.attachment=null,e}return t}(La),cR=function(n){Ua(t,n);function t(e,r,i,a,s){var o=n.call(this,e,r,i,a,s)||this;return o.region=null,o.attachment=null,o}return t}(tR),fo=function(n){Ua(t,n);function t(e){var r=n.call(this)||this;if(!e)throw new Error("The spineData param is required.");if(typeof e=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');r.spineData=e,r.createSkeleton(e),r.slotContainers=[],r.tempClipContainers=[];for(var i=0,a=r.skeleton.slots.length;i<a;i++){var s=r.skeleton.slots[i],o=s.getAttachment(),u=r.newContainer();if(r.slotContainers.push(u),r.addChild(u),r.tempClipContainers.push(null),!!o)if(o.type===yt.Region){var h=o.name,l=r.createSprite(s,o,h);s.currentSprite=l,s.currentSpriteName=h,u.addChild(l)}else if(o.type===yt.Mesh){var c=r.createMesh(s,o);s.currentMesh=c,s.currentMeshId=o.id,s.currentMeshName=o.name,u.addChild(c)}else o.type===yt.Clipping&&(r.createGraphics(s,o),u.addChild(s.clippingContainer),u.addChild(s.currentGraphics))}return r.tintRgb=new Float32Array([1,1,1]),r.autoUpdate=!0,r.visible=!0,r}return Object.defineProperty(t.prototype,"debug",{get:function(){return this._debug},set:function(e){var r;e!=this._debug&&((r=this._debug)===null||r===void 0||r.unregisterSpine(this),e==null||e.registerSpine(this),this._debug=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,this.updateTransform=e?t.prototype.autoUpdateTransform:$e.prototype.updateTransform)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return su(this.tintRgb)},set:function(e){this.tintRgb=Si(e,this.tintRgb)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"delayLimit",{get:function(){var e=typeof this.localDelayLimit<"u"?this.localDelayLimit:lR.GLOBAL_DELAY_LIMIT;return e||Number.MAX_VALUE},enumerable:!1,configurable:!0}),t.prototype.update=function(e){var r,i=this.delayLimit;if(e>i&&(e=i),this.state.update(e),this.state.apply(this.skeleton),!!this.skeleton){this.skeleton.updateWorldTransform();var a=this.skeleton.slots,s=this.color,o=null,u=null;s?(o=s.light,u=s.dark):o=this.tintRgb;for(var h=0,l=a.length;h<l;h++){var c=a[h],f=c.getAttachment(),d=this.slotContainers[h];if(!f){d.visible=!1;continue}var p=null;f.sequence&&f.sequence.apply(c,f);var v=f.region,m=f.color;switch(f!=null&&f.type){case yt.Region:var g=d.transform;if(g.setFromMatrix(c.bone.matrix),v=f.region,c.currentMesh&&(c.currentMesh.visible=!1,c.currentMesh=null,c.currentMeshId=void 0,c.currentMeshName=void 0),!v){c.currentSprite&&(c.currentSprite.renderable=!1);break}if(!c.currentSpriteName||c.currentSpriteName!==f.name){var y=f.name;if(c.currentSprite&&(c.currentSprite.visible=!1),c.sprites=c.sprites||{},c.sprites[y]!==void 0)c.sprites[y].visible=!0;else{var x=this.createSprite(c,f,y);d.addChild(x)}c.currentSprite=c.sprites[y],c.currentSpriteName=y}c.currentSprite.renderable=!0,c.hackRegion||this.setSpriteRegion(f,c.currentSprite,v),c.currentSprite.color?p=c.currentSprite.color:(Tn[0]=o[0]*c.color.r*m.r,Tn[1]=o[1]*c.color.g*m.g,Tn[2]=o[2]*c.color.b*m.b,c.currentSprite.tint=su(Tn)),c.currentSprite.blendMode=c.blendMode;break;case yt.Mesh:if(c.currentSprite){c.currentSprite.visible=!1,c.currentSprite=null,c.currentSpriteName=void 0;var b=new nd;b._parentID=-1,b._worldID=d.transform._worldID,d.transform=b}if(!v){c.currentMesh&&(c.currentMesh.renderable=!1);break}var _=f.id;if(c.currentMeshId===void 0||c.currentMeshId!==_){var w=_;if(c.currentMesh&&(c.currentMesh.visible=!1),c.meshes=c.meshes||{},c.meshes[w]!==void 0)c.meshes[w].visible=!0;else{var S=this.createMesh(c,f);d.addChild(S)}c.currentMesh=c.meshes[w],c.currentMeshName=f.name,c.currentMeshId=w}c.currentMesh.renderable=!0,f.computeWorldVerticesOld(c,c.currentMesh.vertices),c.currentMesh.color?p=c.currentMesh.color:(Tn[0]=o[0]*c.color.r*m.r,Tn[1]=o[1]*c.color.g*m.g,Tn[2]=o[2]*c.color.b*m.b,c.currentMesh.tint=su(Tn)),c.currentMesh.blendMode=c.blendMode,c.hackRegion||this.setMeshRegion(f,c.currentMesh,v);break;case yt.Clipping:c.currentGraphics||(this.createGraphics(c,f),d.addChild(c.clippingContainer),d.addChild(c.currentGraphics)),this.updateGraphics(c,f),d.alpha=1,d.visible=!0;continue;default:d.visible=!1;continue}if(d.visible=!0,p){var E=c.color.r*m.r,T=c.color.g*m.g,A=c.color.b*m.b;p.setLight(o[0]*E+u[0]*(1-E),o[1]*T+u[1]*(1-T),o[2]*A+u[2]*(1-A)),c.darkColor?(E=c.darkColor.r,T=c.darkColor.g,A=c.darkColor.b):(E=0,T=0,A=0),p.setDark(o[0]*E+u[0]*(1-E),o[1]*T+u[1]*(1-T),o[2]*A+u[2]*(1-A))}d.alpha=c.color.a}for(var P=this.skeleton.drawOrder,M=null,R=null,h=0,l=P.length;h<l;h++){var c=a[P[h].data.index],d=this.slotContainers[P[h].data.index];if(R||d.parent!==null&&d.parent!==this&&(d.parent.removeChild(d),d.parent=this),c.currentGraphics&&c.getAttachment())R=c.clippingContainer,M=c.getAttachment(),R.children.length=0,this.children[h]=d,M.endSlot===c.data&&(M.endSlot=null);else if(R){var F=this.tempClipContainers[h];F||(F=this.tempClipContainers[h]=this.newContainer(),F.visible=!1),this.children[h]=F,d.parent=null,R.addChild(d),M.endSlot==c.data&&(R.renderable=!0,R=null,M=null)}else this.children[h]=d}(r=this._debug)===null||r===void 0||r.renderDebug(this)}},t.prototype.setSpriteRegion=function(e,r,i){r.attachment===e&&r.region===i||(r.region=i,r.attachment=e,r.texture=i.texture,r.rotation=e.rotation*B.degRad,r.position.x=e.x,r.position.y=e.y,r.alpha=e.color.a,i.size?(r.scale.x=i.size.width/i.originalWidth,r.scale.y=-i.size.height/i.originalHeight):(r.scale.x=e.scaleX*e.width/i.originalWidth,r.scale.y=-e.scaleY*e.height/i.originalHeight))},t.prototype.setMeshRegion=function(e,r,i){r.attachment===e&&r.region===i||(r.region=i,r.attachment=e,r.texture=i.texture,i.texture.updateUvs(),r.uvBuffer.update(e.regionUVs))},t.prototype.autoUpdateTransform=function(){{this.lastTime=this.lastTime||Date.now();var e=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(e)}$e.prototype.updateTransform.call(this)},t.prototype.createSprite=function(e,r,i){var a=r.region;e.hackAttachment===r&&(a=e.hackRegion);var s=a?a.texture:null,o=this.newSprite(s);return o.anchor.set(.5),a&&this.setSpriteRegion(r,o,r.region),e.sprites=e.sprites||{},e.sprites[i]=o,o},t.prototype.createMesh=function(e,r){var i=r.region;e.hackAttachment===r&&(i=e.hackRegion,e.hackAttachment=null,e.hackRegion=null);var a=this.newMesh(i?i.texture:null,new Float32Array(r.regionUVs.length),r.regionUVs,new Uint16Array(r.triangles),cr.TRIANGLES);return typeof a._canvasPadding<"u"&&(a._canvasPadding=1.5),a.alpha=r.color.a,a.region=r.region,i&&this.setMeshRegion(r,a,i),e.meshes=e.meshes||{},e.meshes[r.id]=a,a},t.prototype.createGraphics=function(e,r){var i=this.newGraphics(),a=new gs([]);return i.clear(),i.beginFill(16777215,1),i.drawPolygon(a),i.renderable=!1,e.currentGraphics=i,e.clippingContainer=this.newContainer(),e.clippingContainer.mask=e.currentGraphics,i},t.prototype.updateGraphics=function(e,r){var i=e.currentGraphics.geometry,a=i.graphicsData[0].shape.points,s=r.worldVerticesLength;a.length=s,r.computeWorldVertices(e,0,s,a,0,2),i.invalidate()},t.prototype.hackTextureBySlotIndex=function(e,r,i){r===void 0&&(r=null),i===void 0&&(i=null);var a=this.skeleton.slots[e];if(!a)return!1;var s=a.getAttachment(),o=s.region;return r?(o=new pf,o.texture=r,o.size=i,a.hackRegion=o,a.hackAttachment=s):(a.hackRegion=null,a.hackAttachment=null),a.currentSprite?this.setSpriteRegion(s,a.currentSprite,o):a.currentMesh&&this.setMeshRegion(s,a.currentMesh,o),!0},t.prototype.hackTextureBySlotName=function(e,r,i){r===void 0&&(r=null),i===void 0&&(i=null);var a=this.skeleton.findSlotIndex(e);return a==-1?!1:this.hackTextureBySlotIndex(a,r,i)},t.prototype.hackTextureAttachment=function(e,r,i,a){a===void 0&&(a=null);var s=this.skeleton.findSlotIndex(e),o=this.skeleton.getAttachmentByName(e,r);o.region.texture=i;var u=this.skeleton.slots[s];if(!u)return!1;var h=u.getAttachment();if(r===h.name){var l=o.region;return i?(l=new pf,l.texture=i,l.size=a,u.hackRegion=l,u.hackAttachment=h):(u.hackRegion=null,u.hackAttachment=null),u.currentSprite&&u.currentSprite.region!=l?(this.setSpriteRegion(h,u.currentSprite,l),u.currentSprite.region=l):u.currentMesh&&u.currentMesh.region!=l&&this.setMeshRegion(h,u.currentMesh,l),!0}return!1},t.prototype.newContainer=function(){return new $e},t.prototype.newSprite=function(e){return new uR(e)},t.prototype.newGraphics=function(){return new Ia},t.prototype.newMesh=function(e,r,i,a,s){return new cR(e,r,i,a,s)},t.prototype.transformHack=function(){return 1},t.prototype.hackAttachmentGroups=function(e,r,i){if(e){for(var a=[],s=[],o=0,u=this.skeleton.slots.length;o<u;o++){var h=this.skeleton.slots[o],l=h.currentSpriteName||h.currentMeshName||"",c=h.currentSprite||h.currentMesh;l.endsWith(e)?(c.parentGroup=r,s.push(c)):i&&c&&(c.parentGroup=i,a.push(c))}return[a,s]}},t.prototype.destroy=function(e){this.debug=null;for(var r=0,i=this.skeleton.slots.length;r<i;r++){var a=this.skeleton.slots[r];for(var s in a.meshes)a.meshes[s].destroy(e);a.meshes=null;for(var o in a.sprites)a.sprites[o].destroy(e);a.sprites=null}for(var r=0,i=this.slotContainers.length;r<i;r++)this.slotContainers[r].destroy(e);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,n.prototype.destroy.call(this,e)},t.clippingPolygon=[],t}($e);Object.defineProperty(fo.prototype,"visible",{get:function(){return this._visible},set:function(n){n!==this._visible&&(this._visible=n,n&&(this.lastTime=0))}});function fR(n){return n.type===Ft.TYPE.JSON}function dR(n){return n.xhrType===Ft.XHR_RESPONSE_TYPE.BUFFER}Ft.setExtensionXhrType("skel",Ft.XHR_RESPONSE_TYPE.BUFFER);var pR=function(){function n(){}return n.prototype.genMiddleware=function(){var t=this;return{use:function(e,r){if(!e.data)return r();var i=fR(e)&&e.data.bones,a=dR(e)&&(e.extension==="skel"||e.metadata&&e.metadata.spineMetadata);if(!i&&!a)return r();var s=null,o=e.data;i?s=t.createJsonParser():(s=t.createBinaryParser(),e.data instanceof ArrayBuffer&&(o=new Uint8Array(e.data)));var u=e.metadata||{},h=u?u.spineSkeletonScale:null;h&&(s.scale=h);var l=u.spineAtlas;if(l===!1)return r();if(l&&l.pages)return t.parseData(e,s,l,o),r();var c=u.spineAtlasSuffix||".atlas",f=e.url,d=f.indexOf("?");d>0&&(f=f.substr(0,d)),f=f.substr(0,f.lastIndexOf("."))+c,u.spineAtlasFile&&(f=u.spineAtlasFile),f=f.replace(this.baseUrl,"");var p={crossOrigin:e.crossOrigin,xhrType:Ft.XHR_RESPONSE_TYPE.TEXT,metadata:u.spineMetadata||null,parentResource:e},v={crossOrigin:e.crossOrigin,metadata:u.imageMetadata||null,parentResource:e},m=e.url.substr(0,e.url.lastIndexOf("/")+1);m=m.replace(this.baseUrl,"");var g=u.imageNamePrefix||e.name+"_atlas_page_",y=u.images?bm(u.images):u.image?bm({default:u.image}):u.imageLoader?u.imageLoader(this,g,m,v):vR(this,g,m,v);function x(b){new nR(b,y,function(_){_&&t.parseData(e,s,_,o),r()})}u.atlasRawData?x(u.atlasRawData):this.add(e.name+"_atlas",f,p,function(b){b.error?r():x(b.data)})}}},n}();function vR(n,t,e,r){return e&&e.lastIndexOf("/")!==e.length-1&&(e+="/"),function(i,a){var s=t+i,o=e+i,u=n.resources[s];if(u){var h=function(){a(u.texture.baseTexture)};u.texture?h():u.onAfterMiddleware.add(h)}else n.add(s,o,r,function(l){l.error?a(null):(i.indexOf("-pma.")>=0&&(l.texture.baseTexture.alphaMode=sr.PMA),a(l.texture.baseTexture))})}}function bm(n){return function(t,e){var r=n[t]||n.default;r&&r.baseTexture?e(r.baseTexture):e(r)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vf=function(n,t){return vf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},vf(n,t)};function Yt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");vf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var ld=function(){function n(t){if(t==null)throw new Error("name cannot be null.");this.name=t}return n}(),Ni=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.id=(t.nextID++&65535)<<11,r.worldVerticesLength=0,r.deformAttachment=r,r}return t.prototype.computeWorldVerticesOld=function(e,r){this.computeWorldVertices(e,0,this.worldVerticesLength,r,0,2)},t.prototype.computeWorldVertices=function(e,r,i,a,s,o){i=s+(i>>1)*o;var u=e.bone.skeleton,h=e.deform,l=this.vertices,c=this.bones;if(c==null){h.length>0&&(l=h);for(var f=e.bone.matrix,d=f.tx,p=f.ty,v=f.a,m=f.c,g=f.b,y=f.d,x=r,b=s;b<i;x+=2,b+=o){var _=l[x],w=l[x+1];a[b]=_*v+w*m+d,a[b+1]=_*g+w*y+p}return}for(var S=0,E=0,T=0;T<r;T+=2){var A=c[S];S+=A+1,E+=A}var P=u.bones;if(h.length==0)for(var b=s,m=E*3;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3){var f=P[c[S]].matrix,_=l[m],w=l[m+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}else for(var N=h,b=s,m=E*3,D=E<<1;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3,D+=2){var f=P[c[S]].matrix,_=l[m]+N[D],w=l[m+1]+N[D+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}},t.prototype.copyTo=function(e){this.bones!=null?(e.bones=new Array(this.bones.length),Y.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices!=null?(e.vertices=Y.newFloatArray(this.vertices.length),Y.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment},t.nextID=0,t}(ld),_0=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.BoundingBox,r.color=new tt(1,1,1,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e},t}(Ni),w0=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Clipping,r.color=new tt(.2275,.2275,.8078,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e},t}(Ni),wl=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Mesh,r.color=new tt(1,1,1,1),r.tempColor=new tt(0,0,0,0),r}return t.prototype.getParentMesh=function(){return this.parentMesh},t.prototype.setParentMesh=function(e){this.parentMesh=e,e!=null&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)},t.prototype.copy=function(){if(this.parentMesh!=null)return this.newLinkedMesh();var e=new t(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Float32Array(this.regionUVs.length),Y.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.triangles=new Array(this.triangles.length),Y.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,this.edges!=null&&(e.edges=new Array(this.edges.length),Y.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e},t.prototype.newLinkedMesh=function(){var e=new t(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),e.deformAttachment=this.deformAttachment,e.setParentMesh(this.parentMesh!=null?this.parentMesh:this),e},t}(Ni),Us=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Path,r.closed=!1,r.constantSpeed=!1,r.color=new tt(1,1,1,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Y.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e},t}(Ni),S0=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Point,r.color=new tt(.38,.94,0,1),r}return t.prototype.computeWorldPosition=function(e,r){var i=e.matrix;return r.x=this.x*i.a+this.y*i.c+e.worldX,r.y=this.x*i.b+this.y*i.d+e.worldY,r},t.prototype.computeWorldRotation=function(e){var r=e.matrix,i=B.cosDeg(this.rotation),a=B.sinDeg(this.rotation),s=i*r.a+a*r.c,o=i*r.b+a*r.d;return Math.atan2(o,s)*B.radDeg},t.prototype.copy=function(){var e=new t(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e},t}(Ni),ud=function(){function n(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new tt,this.darkColor=t.darkColor==null?null:new tt,this.setToSetupPose(),this.blendMode=this.data.blendMode}return n.prototype.getAttachment=function(){return this.attachment},n.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},n.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},n.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},n.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},n}(),cd=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Region,r.x=0,r.y=0,r.scaleX=1,r.scaleY=1,r.rotation=0,r.width=0,r.height=0,r.color=new tt(1,1,1,1),r.offset=Y.newFloatArray(8),r.uvs=Y.newFloatArray(8),r.tempColor=new tt(1,1,1,1),r}return t.prototype.updateOffset=function(){var e=this.width/this.region.originalWidth*this.scaleX,r=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*e,a=-this.height/2*this.scaleY+this.region.offsetY*r,s=i+this.region.width*e,o=a+this.region.height*r,u=this.rotation*Math.PI/180,h=Math.cos(u),l=Math.sin(u),c=i*h+this.x,f=i*l,d=a*h+this.y,p=a*l,v=s*h+this.x,m=s*l,g=o*h+this.y,y=o*l,x=this.offset;x[t.OX1]=c-p,x[t.OY1]=d+f,x[t.OX2]=c-y,x[t.OY2]=g+f,x[t.OX3]=v-y,x[t.OY3]=g+m,x[t.OX4]=v-p,x[t.OY4]=d+m},t.prototype.setRegion=function(e){this.region=e;var r=this.uvs;e.rotate?(r[2]=e.u,r[3]=e.v2,r[4]=e.u,r[5]=e.v,r[6]=e.u2,r[7]=e.v,r[0]=e.u2,r[1]=e.v2):(r[0]=e.u,r[1]=e.v2,r[2]=e.u,r[3]=e.v,r[4]=e.u2,r[5]=e.v,r[6]=e.u2,r[7]=e.v2)},t.prototype.computeWorldVertices=function(e,r,i,a){var s=this.offset,o=e instanceof ud?e.bone.matrix:e.matrix,u=o.tx,h=o.ty,l=o.a,c=o.c,f=o.b,d=o.d,p=0,v=0;p=s[t.OX1],v=s[t.OY1],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX2],v=s[t.OY2],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX3],v=s[t.OY3],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX4],v=s[t.OY4],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h},t.prototype.copy=function(){var e=new t(this.name);return e.region=this.region,e.rendererObject=this.rendererObject,e.path=this.path,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,Y.arrayCopy(this.uvs,0,e.uvs,0,8),Y.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e},t.OX1=0,t.OY1=1,t.OX2=2,t.OY2=3,t.OX3=4,t.OY3=5,t.OX4=6,t.OY4=7,t.X1=0,t.Y1=1,t.C1R=2,t.C1G=3,t.C1B=4,t.C1A=5,t.U1=6,t.V1=7,t.X2=8,t.Y2=9,t.C2R=10,t.C2G=11,t.C2B=12,t.C2A=13,t.U2=14,t.V2=15,t.X3=16,t.Y3=17,t.C3R=18,t.C3G=19,t.C3B=20,t.C3A=21,t.U3=22,t.V3=23,t.X4=24,t.Y4=25,t.C4R=26,t.C4G=27,t.C4B=28,t.C4A=29,t.U4=30,t.V4=31,t}(ld),mR=function(){function n(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return n.prototype.begin=function(t){},n.prototype.transform=function(t,e,r,i){t.x+=B.randomTriangular(-this.jitterX,this.jitterY),t.y+=B.randomTriangular(-this.jitterX,this.jitterY)},n.prototype.end=function(){},n}(),gR=function(){function n(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return n.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},n.prototype.transform=function(t,e,r,i){var a=this.angle*B.degreesToRadians,s=t.x-this.worldX,o=t.y-this.worldY,u=Math.sqrt(s*s+o*o);if(u<this.radius){var h=n.interpolation.apply(0,a,(this.radius-u)/this.radius),l=Math.cos(h),c=Math.sin(h);t.x=l*s-c*o+this.worldX,t.y=c*s+l*o+this.worldY}},n.prototype.end=function(){},n.interpolation=new b0(2),n}(),ie=function(){function n(t,e,r){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=r}return n.prototype.hasTimeline=function(t){return this.timelineIds[t]==!0},n.prototype.apply=function(t,e,r,i,a,s,o,u){if(t==null)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,c=h.length;l<c;l++)h[l].apply(t,e,r,a,s,o,u)},n.binarySearch=function(t,e,r){r===void 0&&(r=1);var i=0,a=t.length/r-2;if(a==0)return r;for(var s=a>>>1;;){if(t[(s+1)*r]<=e?i=s+1:a=s,i==a)return(i+1)*r;s=i+a>>>1}},n.linearSearch=function(t,e,r){for(var i=0,a=t.length-r;i<=a;i+=r)if(t[i]>e)return i;return-1},n}(),Ie;(function(n){n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor"})(Ie||(Ie={}));var jr=function(){function n(t){if(t<=0)throw new Error("frameCount must be > 0: "+t);this.curves=Y.newFloatArray((t-1)*n.BEZIER_SIZE)}return n.prototype.getFrameCount=function(){return this.curves.length/n.BEZIER_SIZE+1},n.prototype.setLinear=function(t){this.curves[t*n.BEZIER_SIZE]=n.LINEAR},n.prototype.setStepped=function(t){this.curves[t*n.BEZIER_SIZE]=n.STEPPED},n.prototype.getCurveType=function(t){var e=t*n.BEZIER_SIZE;if(e==this.curves.length)return n.LINEAR;var r=this.curves[e];return r==n.LINEAR?n.LINEAR:r==n.STEPPED?n.STEPPED:n.BEZIER},n.prototype.setCurve=function(t,e,r,i,a){var s=(-e*2+i)*.03,o=(-r*2+a)*.03,u=((e-i)*3+1)*.006,h=((r-a)*3+1)*.006,l=s*2+u,c=o*2+h,f=e*.3+s+u*.16666667,d=r*.3+o+h*.16666667,p=t*n.BEZIER_SIZE,v=this.curves;v[p++]=n.BEZIER;for(var m=f,g=d,y=p+n.BEZIER_SIZE-1;p<y;p+=2)v[p]=m,v[p+1]=g,f+=l,d+=c,l+=u,c+=h,m+=f,g+=d},n.prototype.getCurvePercent=function(t,e){e=B.clamp(e,0,1);var r=this.curves,i=t*n.BEZIER_SIZE,a=r[i];if(a==n.LINEAR)return e;if(a==n.STEPPED)return 0;i++;for(var s=0,o=i,u=i+n.BEZIER_SIZE-1;i<u;i+=2)if(s=r[i],s>=e){var h=void 0,l=void 0;return i==o?(h=0,l=0):(h=r[i-2],l=r[i-1]),l+(r[i+1]-l)*(e-h)/(s-h)}var c=r[i-1];return c+(1-c)*(e-s)/(1-s)},n.LINEAR=0,n.STEPPED=1,n.BEZIER=2,n.BEZIER_SIZE=10*2-1,n}(),nr=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e<<1),r}return t.prototype.getPropertyId=function(){return(Ie.rotate<<24)+this.boneIndex},t.prototype.setFrame=function(e,r,i){e<<=1,this.frames[e]=r,this.frames[e+t.ROTATION]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.rotation=l.data.rotation;return;case C.first:var c=l.data.rotation-l.rotation;l.rotation+=(c-(16384-(16384.499999999996-c/360|0))*360)*s}return}if(i>=h[h.length-t.ENTRIES]){var f=h[h.length+t.PREV_ROTATION];switch(o){case C.setup:l.rotation=l.data.rotation+f*s;break;case C.first:case C.replace:f+=l.data.rotation-l.rotation,f-=(16384-(16384.499999999996-f/360|0))*360;case C.add:l.rotation+=f*s}return}var d=ie.binarySearch(h,i,t.ENTRIES),p=h[d+t.PREV_ROTATION],v=h[d],m=this.getCurvePercent((d>>1)-1,1-(i-v)/(h[d+t.PREV_TIME]-v)),g=h[d+t.ROTATION]-p;switch(g=p+(g-(16384-(16384.499999999996-g/360|0))*360)*m,o){case C.setup:l.rotation=l.data.rotation+(g-(16384-(16384.499999999996-g/360|0))*360)*s;break;case C.first:case C.replace:g+=l.data.rotation-l.rotation;case C.add:l.rotation+=(g-(16384-(16384.499999999996-g/360|0))*360)*s}}},t.ENTRIES=2,t.PREV_TIME=-2,t.PREV_ROTATION=-1,t.ROTATION=1,t}(jr),Mi=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.translate<<24)+this.boneIndex},t.prototype.setFrame=function(e,r,i,a){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.X]=i,this.frames[e+t.Y]=a},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.x=l.data.x,l.y=l.data.y;return;case C.first:l.x+=(l.data.x-l.x)*s,l.y+=(l.data.y-l.y)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X],f=h[h.length+t.PREV_Y];else{var d=ie.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c+=(h[d+t.X]-c)*v,f+=(h[d+t.Y]-f)*v}switch(o){case C.setup:l.x=l.data.x+c*s,l.y=l.data.y+f*s;break;case C.first:case C.replace:l.x+=(l.data.x+c-l.x)*s,l.y+=(l.data.y+f-l.y)*s;break;case C.add:l.x+=c*s,l.y+=f*s}}},t.ENTRIES=3,t.PREV_TIME=-3,t.PREV_X=-2,t.PREV_Y=-1,t.X=1,t.Y=2,t}(jr),fd=function(n){Yt(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ie.scale<<24)+this.boneIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.scaleX=l.data.scaleX,l.scaleY=l.data.scaleY;return;case C.first:l.scaleX+=(l.data.scaleX-l.scaleX)*s,l.scaleY+=(l.data.scaleY-l.scaleY)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X]*l.data.scaleX,f=h[h.length+t.PREV_Y]*l.data.scaleY;else{var d=ie.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c=(c+(h[d+t.X]-c)*v)*l.data.scaleX,f=(f+(h[d+t.Y]-f)*v)*l.data.scaleY}if(s==1)o==C.add?(l.scaleX+=c-l.data.scaleX,l.scaleY+=f-l.data.scaleY):(l.scaleX=c,l.scaleY=f);else{var m=0,g=0;if(u==mt.mixOut)switch(o){case C.setup:m=l.data.scaleX,g=l.data.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-m)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-g)*s;break;case C.first:case C.replace:m=l.scaleX,g=l.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-m)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-g)*s;break;case C.add:m=l.scaleX,g=l.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-l.data.scaleX)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-l.data.scaleY)*s}else switch(o){case C.setup:m=Math.abs(l.data.scaleX)*B.signum(c),g=Math.abs(l.data.scaleY)*B.signum(f),l.scaleX=m+(c-m)*s,l.scaleY=g+(f-g)*s;break;case C.first:case C.replace:m=Math.abs(l.scaleX)*B.signum(c),g=Math.abs(l.scaleY)*B.signum(f),l.scaleX=m+(c-m)*s,l.scaleY=g+(f-g)*s;break;case C.add:m=B.signum(c),g=B.signum(f),l.scaleX=Math.abs(l.scaleX)*m+(c-Math.abs(l.data.scaleX)*m)*s,l.scaleY=Math.abs(l.scaleY)*g+(f-Math.abs(l.data.scaleY)*g)*s}}}},t}(Mi),dd=function(n){Yt(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ie.shear<<24)+this.boneIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.shearX=l.data.shearX,l.shearY=l.data.shearY;return;case C.first:l.shearX+=(l.data.shearX-l.shearX)*s,l.shearY+=(l.data.shearY-l.shearY)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X],f=h[h.length+t.PREV_Y];else{var d=ie.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c=c+(h[d+t.X]-c)*v,f=f+(h[d+t.Y]-f)*v}switch(o){case C.setup:l.shearX=l.data.shearX+c*s,l.shearY=l.data.shearY+f*s;break;case C.first:case C.replace:l.shearX+=(l.data.shearX+c-l.shearX)*s,l.shearY+=(l.data.shearY+f-l.shearY)*s;break;case C.add:l.shearX+=c*s,l.shearY+=f*s}}},t}(Mi),Vs=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.color<<24)+this.slotIndex},t.prototype.setFrame=function(e,r,i,a,s,o){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.R]=i,this.frames[e+t.G]=a,this.frames[e+t.B]=s,this.frames[e+t.A]=o},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.color.setFromColor(h.data.color);return;case C.first:var c=h.color,f=h.data.color;c.add((f.r-c.r)*s,(f.g-c.g)*s,(f.b-c.b)*s,(f.a-c.a)*s)}return}var d=0,p=0,v=0,m=0;if(i>=l[l.length-t.ENTRIES]){var g=l.length;d=l[g+t.PREV_R],p=l[g+t.PREV_G],v=l[g+t.PREV_B],m=l[g+t.PREV_A]}else{var y=ie.binarySearch(l,i,t.ENTRIES);d=l[y+t.PREV_R],p=l[y+t.PREV_G],v=l[y+t.PREV_B],m=l[y+t.PREV_A];var x=l[y],b=this.getCurvePercent(y/t.ENTRIES-1,1-(i-x)/(l[y+t.PREV_TIME]-x));d+=(l[y+t.R]-d)*b,p+=(l[y+t.G]-p)*b,v+=(l[y+t.B]-v)*b,m+=(l[y+t.A]-m)*b}if(s==1)h.color.set(d,p,v,m);else{var c=h.color;o==C.setup&&c.setFromColor(h.data.color),c.add((d-c.r)*s,(p-c.g)*s,(v-c.b)*s,(m-c.a)*s)}}},t.ENTRIES=5,t.PREV_TIME=-5,t.PREV_R=-4,t.PREV_G=-3,t.PREV_B=-2,t.PREV_A=-1,t.R=1,t.G=2,t.B=3,t.A=4,t}(jr),Xs=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.twoColor<<24)+this.slotIndex},t.prototype.setFrame=function(e,r,i,a,s,o,u,h,l){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.R]=i,this.frames[e+t.G]=a,this.frames[e+t.B]=s,this.frames[e+t.A]=o,this.frames[e+t.R2]=u,this.frames[e+t.G2]=h,this.frames[e+t.B2]=l},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.color.setFromColor(h.data.color),h.darkColor.setFromColor(h.data.darkColor);return;case C.first:var c=h.color,f=h.darkColor,d=h.data.color,p=h.data.darkColor;c.add((d.r-c.r)*s,(d.g-c.g)*s,(d.b-c.b)*s,(d.a-c.a)*s),f.add((p.r-f.r)*s,(p.g-f.g)*s,(p.b-f.b)*s,0)}return}var v=0,m=0,g=0,y=0,x=0,b=0,_=0;if(i>=l[l.length-t.ENTRIES]){var w=l.length;v=l[w+t.PREV_R],m=l[w+t.PREV_G],g=l[w+t.PREV_B],y=l[w+t.PREV_A],x=l[w+t.PREV_R2],b=l[w+t.PREV_G2],_=l[w+t.PREV_B2]}else{var S=ie.binarySearch(l,i,t.ENTRIES);v=l[S+t.PREV_R],m=l[S+t.PREV_G],g=l[S+t.PREV_B],y=l[S+t.PREV_A],x=l[S+t.PREV_R2],b=l[S+t.PREV_G2],_=l[S+t.PREV_B2];var E=l[S],T=this.getCurvePercent(S/t.ENTRIES-1,1-(i-E)/(l[S+t.PREV_TIME]-E));v+=(l[S+t.R]-v)*T,m+=(l[S+t.G]-m)*T,g+=(l[S+t.B]-g)*T,y+=(l[S+t.A]-y)*T,x+=(l[S+t.R2]-x)*T,b+=(l[S+t.G2]-b)*T,_+=(l[S+t.B2]-_)*T}if(s==1)h.color.set(v,m,g,y),h.darkColor.set(x,b,_,1);else{var c=h.color,f=h.darkColor;o==C.setup&&(c.setFromColor(h.data.color),f.setFromColor(h.data.darkColor)),c.add((v-c.r)*s,(m-c.g)*s,(g-c.b)*s,(y-c.a)*s),f.add((x-f.r)*s,(b-f.g)*s,(_-f.b)*s,0)}}},t.ENTRIES=8,t.PREV_TIME=-8,t.PREV_R=-7,t.PREV_G=-6,t.PREV_B=-5,t.PREV_A=-4,t.PREV_R2=-3,t.PREV_G2=-2,t.PREV_B2=-1,t.R=1,t.G=2,t.B=3,t.A=4,t.R2=5,t.G2=6,t.B2=7,t}(jr),fi=function(){function n(t){this.frames=Y.newFloatArray(t),this.attachmentNames=new Array(t)}return n.prototype.getPropertyId=function(){return(Ie.attachment<<24)+this.slotIndex},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.attachmentNames[t]=r},n.prototype.apply=function(t,e,r,i,a,s,o){var u=t.slots[this.slotIndex];if(u.bone.active){if(o==mt.mixOut){s==C.setup&&this.setAttachment(t,u,u.data.attachmentName);return}var h=this.frames;if(r<h[0]){(s==C.setup||s==C.first)&&this.setAttachment(t,u,u.data.attachmentName);return}var l=0;r>=h[h.length-1]?l=h.length-1:l=ie.binarySearch(h,r,1)-1;var c=this.attachmentNames[l];t.slots[this.slotIndex].setAttachment(c==null?null:t.getAttachment(this.slotIndex,c))}},n.prototype.setAttachment=function(t,e,r){e.setAttachment(r==null?null:t.getAttachment(this.slotIndex,r))},n}(),_m=null,pd=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e),r.frameVertices=new Array(e),_m==null&&(_m=Y.newFloatArray(64)),r}return t.prototype.getPropertyId=function(){return(Ie.deform<<27)+ +this.attachment.id+this.slotIndex},t.prototype.setFrame=function(e,r,i){this.frames[e]=r,this.frameVertices[e]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.getAttachment();if(!(!(l instanceof Ni)||l.deformAttachment!=this.attachment)){var c=h.deform;c.length==0&&(o=C.setup);var f=this.frameVertices,d=f[0].length,p=this.frames;if(i<p[0]){var v=l;switch(o){case C.setup:c.length=0;return;case C.first:if(s==1){c.length=0;break}var m=Y.setArraySize(c,d);if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++)m[y]+=(g[y]-m[y])*s;else{s=1-s;for(var y=0;y<d;y++)m[y]*=s}}return}var x=Y.setArraySize(c,d);if(i>=p[p.length-1]){var b=f[p.length-1];if(s==1)if(o==C.add){var v=l;if(v.bones==null)for(var g=v.vertices,_=0;_<d;_++)x[_]+=b[_]-g[_];else for(var w=0;w<d;w++)x[w]+=b[w]}else Y.arrayCopy(b,0,x,0,d);else switch(o){case C.setup:{var S=l;if(S.bones==null)for(var g=S.vertices,E=0;E<d;E++){var T=g[E];x[E]=T+(b[E]-T)*s}else for(var A=0;A<d;A++)x[A]=b[A]*s;break}case C.first:case C.replace:for(var P=0;P<d;P++)x[P]+=(b[P]-x[P])*s;break;case C.add:var v=l;if(v.bones==null)for(var g=v.vertices,M=0;M<d;M++)x[M]+=(b[M]-g[M])*s;else for(var R=0;R<d;R++)x[R]+=b[R]*s}return}var F=ie.binarySearch(p,i),N=f[F-1],D=f[F],X=p[F],q=this.getCurvePercent(F-1,1-(i-X)/(p[F-1]-X));if(s==1)if(o==C.add){var v=l;if(v.bones==null)for(var g=v.vertices,W=0;W<d;W++){var L=N[W];x[W]+=L+(D[W]-L)*q-g[W]}else for(var U=0;U<d;U++){var L=N[U];x[U]+=L+(D[U]-L)*q}}else for(var G=0;G<d;G++){var L=N[G];x[G]=L+(D[G]-L)*q}else switch(o){case C.setup:{var V=l;if(V.bones==null)for(var g=V.vertices,O=0;O<d;O++){var L=N[O],T=g[O];x[O]=T+(L+(D[O]-L)*q-T)*s}else for(var z=0;z<d;z++){var L=N[z];x[z]=(L+(D[z]-L)*q)*s}break}case C.first:case C.replace:for(var j=0;j<d;j++){var L=N[j];x[j]+=(L+(D[j]-L)*q-x[j])*s}break;case C.add:var v=l;if(v.bones==null)for(var g=v.vertices,K=0;K<d;K++){var L=N[K];x[K]+=(L+(D[K]-L)*q-g[K])*s}else for(var Z=0;Z<d;Z++){var L=N[Z];x[Z]+=(L+(D[Z]-L)*q)*s}}}}},t}(jr),Sl=function(){function n(t){this.frames=Y.newFloatArray(t),this.events=new Array(t)}return n.prototype.getPropertyId=function(){return Ie.event<<24},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},n.prototype.apply=function(t,e,r,i,a,s,o){if(i!=null){var u=this.frames,h=this.frames.length;if(e>r)this.apply(t,e,Number.MAX_VALUE,i,a,s,o),e=-1;else if(e>=u[h-1])return;if(!(r<u[0])){var l=0;if(e<u[0])l=0;else{l=ie.binarySearch(u,e);for(var c=u[l];l>0&&u[l-1]==c;)l--}for(;l<h&&r>=u[l];l++)i.push(this.events[l])}}},n}(),wa=function(){function n(t){this.frames=Y.newFloatArray(t),this.drawOrders=new Array(t)}return n.prototype.getPropertyId=function(){return Ie.drawOrder<<24},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.drawOrders[t]=r},n.prototype.apply=function(t,e,r,i,a,s,o){var u=t.drawOrder,h=t.slots;if(o==mt.mixOut&&s==C.setup){Y.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}var l=this.frames;if(r<l[0]){(s==C.setup||s==C.first)&&Y.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}var c=0;r>=l[l.length-1]?c=l.length-1:c=ie.binarySearch(l,r)-1;var f=this.drawOrders[c];if(f==null)Y.arrayCopy(h,0,u,0,h.length);else for(var d=0,p=f.length;d<p;d++)u[d]=h[f[d]]},n}(),zs=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.ikConstraint<<24)+this.ikConstraintIndex},t.prototype.setFrame=function(e,r,i,a,s,o,u){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.MIX]=i,this.frames[e+t.SOFTNESS]=a,this.frames[e+t.BEND_DIRECTION]=s,this.frames[e+t.COMPRESS]=o?1:0,this.frames[e+t.STRETCH]=u?1:0},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.ikConstraints[this.ikConstraintIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch;return;case C.first:l.mix+=(l.data.mix-l.mix)*s,l.softness+=(l.data.softness-l.softness)*s,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}if(i>=h[h.length-t.ENTRIES]){o==C.setup?(l.mix=l.data.mix+(h[h.length+t.PREV_MIX]-l.data.mix)*s,l.softness=l.data.softness+(h[h.length+t.PREV_SOFTNESS]-l.data.softness)*s,u==mt.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=h[h.length+t.PREV_BEND_DIRECTION],l.compress=h[h.length+t.PREV_COMPRESS]!=0,l.stretch=h[h.length+t.PREV_STRETCH]!=0)):(l.mix+=(h[h.length+t.PREV_MIX]-l.mix)*s,l.softness+=(h[h.length+t.PREV_SOFTNESS]-l.softness)*s,u==mt.mixIn&&(l.bendDirection=h[h.length+t.PREV_BEND_DIRECTION],l.compress=h[h.length+t.PREV_COMPRESS]!=0,l.stretch=h[h.length+t.PREV_STRETCH]!=0));return}var c=ie.binarySearch(h,i,t.ENTRIES),f=h[c+t.PREV_MIX],d=h[c+t.PREV_SOFTNESS],p=h[c],v=this.getCurvePercent(c/t.ENTRIES-1,1-(i-p)/(h[c+t.PREV_TIME]-p));o==C.setup?(l.mix=l.data.mix+(f+(h[c+t.MIX]-f)*v-l.data.mix)*s,l.softness=l.data.softness+(d+(h[c+t.SOFTNESS]-d)*v-l.data.softness)*s,u==mt.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=h[c+t.PREV_BEND_DIRECTION],l.compress=h[c+t.PREV_COMPRESS]!=0,l.stretch=h[c+t.PREV_STRETCH]!=0)):(l.mix+=(f+(h[c+t.MIX]-f)*v-l.mix)*s,l.softness+=(d+(h[c+t.SOFTNESS]-d)*v-l.softness)*s,u==mt.mixIn&&(l.bendDirection=h[c+t.PREV_BEND_DIRECTION],l.compress=h[c+t.PREV_COMPRESS]!=0,l.stretch=h[c+t.PREV_STRETCH]!=0))}},t.ENTRIES=6,t.PREV_TIME=-6,t.PREV_MIX=-5,t.PREV_SOFTNESS=-4,t.PREV_BEND_DIRECTION=-3,t.PREV_COMPRESS=-2,t.PREV_STRETCH=-1,t.MIX=1,t.SOFTNESS=2,t.BEND_DIRECTION=3,t.COMPRESS=4,t.STRETCH=5,t}(jr),Gs=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.transformConstraint<<24)+this.transformConstraintIndex},t.prototype.setFrame=function(e,r,i,a,s,o){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.ROTATE]=i,this.frames[e+t.TRANSLATE]=a,this.frames[e+t.SCALE]=s,this.frames[e+t.SHEAR]=o},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.transformConstraints[this.transformConstraintIndex];if(l.active){if(i<h[0]){var c=l.data;switch(o){case C.setup:l.rotateMix=c.rotateMix,l.translateMix=c.translateMix,l.scaleMix=c.scaleMix,l.shearMix=c.shearMix;return;case C.first:l.rotateMix+=(c.rotateMix-l.rotateMix)*s,l.translateMix+=(c.translateMix-l.translateMix)*s,l.scaleMix+=(c.scaleMix-l.scaleMix)*s,l.shearMix+=(c.shearMix-l.shearMix)*s}return}var f=0,d=0,p=0,v=0;if(i>=h[h.length-t.ENTRIES]){var m=h.length;f=h[m+t.PREV_ROTATE],d=h[m+t.PREV_TRANSLATE],p=h[m+t.PREV_SCALE],v=h[m+t.PREV_SHEAR]}else{var g=ie.binarySearch(h,i,t.ENTRIES);f=h[g+t.PREV_ROTATE],d=h[g+t.PREV_TRANSLATE],p=h[g+t.PREV_SCALE],v=h[g+t.PREV_SHEAR];var y=h[g],x=this.getCurvePercent(g/t.ENTRIES-1,1-(i-y)/(h[g+t.PREV_TIME]-y));f+=(h[g+t.ROTATE]-f)*x,d+=(h[g+t.TRANSLATE]-d)*x,p+=(h[g+t.SCALE]-p)*x,v+=(h[g+t.SHEAR]-v)*x}if(o==C.setup){var c=l.data;l.rotateMix=c.rotateMix+(f-c.rotateMix)*s,l.translateMix=c.translateMix+(d-c.translateMix)*s,l.scaleMix=c.scaleMix+(p-c.scaleMix)*s,l.shearMix=c.shearMix+(v-c.shearMix)*s}else l.rotateMix+=(f-l.rotateMix)*s,l.translateMix+=(d-l.translateMix)*s,l.scaleMix+=(p-l.scaleMix)*s,l.shearMix+=(v-l.shearMix)*s}},t.ENTRIES=5,t.PREV_TIME=-5,t.PREV_ROTATE=-4,t.PREV_TRANSLATE=-3,t.PREV_SCALE=-2,t.PREV_SHEAR=-1,t.ROTATE=1,t.TRANSLATE=2,t.SCALE=3,t.SHEAR=4,t}(jr),Ra=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.pathConstraintPosition<<24)+this.pathConstraintIndex},t.prototype.setFrame=function(e,r,i){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.VALUE]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.position=l.data.position;return;case C.first:l.position+=(l.data.position-l.position)*s}return}var c=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_VALUE];else{var f=ie.binarySearch(h,i,t.ENTRIES);c=h[f+t.PREV_VALUE];var d=h[f],p=this.getCurvePercent(f/t.ENTRIES-1,1-(i-d)/(h[f+t.PREV_TIME]-d));c+=(h[f+t.VALUE]-c)*p}o==C.setup?l.position=l.data.position+(c-l.data.position)*s:l.position+=(c-l.position)*s}},t.ENTRIES=2,t.PREV_TIME=-2,t.PREV_VALUE=-1,t.VALUE=1,t}(jr),vd=function(n){Yt(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ie.pathConstraintSpacing<<24)+this.pathConstraintIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.spacing=l.data.spacing;return;case C.first:l.spacing+=(l.data.spacing-l.spacing)*s}return}var c=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_VALUE];else{var f=ie.binarySearch(h,i,t.ENTRIES);c=h[f+t.PREV_VALUE];var d=h[f],p=this.getCurvePercent(f/t.ENTRIES-1,1-(i-d)/(h[f+t.PREV_TIME]-d));c+=(h[f+t.VALUE]-c)*p}o==C.setup?l.spacing=l.data.spacing+(c-l.data.spacing)*s:l.spacing+=(c-l.spacing)*s}},t}(Ra),Ys=function(n){Yt(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ie.pathConstraintMix<<24)+this.pathConstraintIndex},t.prototype.setFrame=function(e,r,i,a){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.ROTATE]=i,this.frames[e+t.TRANSLATE]=a},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(l.active){if(i<h[0]){switch(o){case C.setup:l.rotateMix=l.data.rotateMix,l.translateMix=l.data.translateMix;return;case C.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*s,l.translateMix+=(l.data.translateMix-l.translateMix)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_ROTATE],f=h[h.length+t.PREV_TRANSLATE];else{var d=ie.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_ROTATE],f=h[d+t.PREV_TRANSLATE];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c+=(h[d+t.ROTATE]-c)*v,f+=(h[d+t.TRANSLATE]-f)*v}o==C.setup?(l.rotateMix=l.data.rotateMix+(c-l.data.rotateMix)*s,l.translateMix=l.data.translateMix+(f-l.data.translateMix)*s):(l.rotateMix+=(c-l.rotateMix)*s,l.translateMix+=(f-l.translateMix)*s)}},t.ENTRIES=3,t.PREV_TIME=-3,t.PREV_ROTATE=-2,t.PREV_TRANSLATE=-1,t.ROTATE=1,t.TRANSLATE=2,t}(jr),E0=function(){function n(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new A0(this),this.propertyIDs=new y0,this.animationsChanged=!1,this.trackEntryPool=new _l(function(){return new T0}),this.data=t}return n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var a=e[r];if(a!=null){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var s=t*a.timeScale;if(a.delay>0){if(a.delay-=s,a.delay>0)continue;s=-a.delay,a.delay=0}var o=a.next;if(o!=null){var u=a.trackLast-o.delay;if(u>=0){for(o.delay=0,o.trackTime+=a.timeScale==0?0:(u/a.timeScale+t)*o.timeScale,a.trackTime+=s,this.setCurrent(r,o,!0);o.mixingFrom!=null;)o.mixTime+=t,o=o.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&a.mixingFrom==null){e[r]=null,this.queue.end(a),this.disposeNext(a);continue}if(a.mixingFrom!=null&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for(a.mixingFrom=null,h!=null&&(h.mixingTo=null);h!=null;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=s}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(r==null)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((r.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=r.mixingFrom,r.mixingFrom!=null&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var e=this.events,r=this.tracks,i=!1,a=0,s=r.length;a<s;a++){var o=r[a];if(!(o==null||o.delay>0)){i=!0;var u=a==0?C.first:o.mixBlend,h=o.alpha;o.mixingFrom!=null?h*=this.applyMixingFrom(o,t,u):o.trackTime>=o.trackEnd&&o.next==null&&(h=0);var l=o.animationLast,c=o.getAnimationTime(),f=o.animation.timelines.length,d=o.animation.timelines;if(a==0&&h==1||u==C.add)for(var p=0;p<f;p++){Y.webkit602BugfixHelper(h,u);var v=d[p];v instanceof fi?this.applyAttachmentTimeline(v,t,c,u,!0):v.apply(t,l,c,e,h,u,mt.mixIn)}else{var m=o.timelineMode,g=o.timelinesRotation.length==0;g&&Y.setArraySize(o.timelinesRotation,f<<1,null);for(var y=o.timelinesRotation,p=0;p<f;p++){var x=d[p],b=m[p]==n.SUBSEQUENT?u:C.setup;x instanceof nr?this.applyRotateTimeline(x,t,c,h,b,y,p<<1,g):x instanceof fi?this.applyAttachmentTimeline(x,t,c,u,!0):(Y.webkit602BugfixHelper(h,u),x.apply(t,l,c,e,h,b,mt.mixIn))}}this.queueEvents(o,c),e.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime}}for(var _=this.unkeyedState+n.SETUP,w=t.slots,S=0,E=t.slots.length;S<E;S++){var T=w[S];if(T.attachmentState==_){var A=T.data.attachmentName;T.setAttachment(A==null?null:t.getAttachment(T.data.index,A))}}return this.unkeyedState+=2,this.queue.drain(),i},n.prototype.applyMixingFrom=function(t,e,r){var i=t.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,e,r);var a=0;t.mixDuration==0?(a=1,r==C.first&&(r=C.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),r!=C.first&&(r=i.mixBlend));var s=a<i.eventThreshold?this.events:null,o=a<i.attachmentThreshold,u=a<i.drawOrderThreshold,h=i.animationLast,l=i.getAnimationTime(),c=i.animation.timelines.length,f=i.animation.timelines,d=i.alpha*t.interruptAlpha,p=d*(1-a);if(r==C.add)for(var v=0;v<c;v++)f[v].apply(e,h,l,s,p,r,mt.mixOut);else{var m=i.timelineMode,g=i.timelineHoldMix,y=i.timelinesRotation.length==0;y&&Y.setArraySize(i.timelinesRotation,c<<1,null);var x=i.timelinesRotation;i.totalAlpha=0;for(var v=0;v<c;v++){var b=f[v],_=mt.mixOut,w=void 0,S=0;switch(m[v]){case n.SUBSEQUENT:if(!u&&b instanceof wa)continue;w=r,S=p;break;case n.FIRST:w=C.setup,S=p;break;case n.HOLD_SUBSEQUENT:w=r,S=d;break;case n.HOLD_FIRST:w=C.setup,S=d;break;default:w=C.setup;var E=g[v];S=d*Math.max(0,1-E.mixTime/E.mixDuration);break}i.totalAlpha+=S,b instanceof nr?this.applyRotateTimeline(b,e,l,S,w,x,v<<1,y):b instanceof fi?this.applyAttachmentTimeline(b,e,l,w,o):(Y.webkit602BugfixHelper(S,r),u&&b instanceof wa&&w==C.setup&&(_=mt.mixIn),b.apply(e,h,l,s,S,w,_))}}return t.mixDuration>0&&this.queueEvents(i,l),this.events.length=0,i.nextAnimationLast=l,i.nextTrackLast=i.trackTime,a},n.prototype.applyAttachmentTimeline=function(t,e,r,i,a){var s=e.slots[t.slotIndex];if(s.bone.active){var o=t.frames;if(r<o[0])(i==C.setup||i==C.first)&&this.setAttachment(e,s,s.data.attachmentName,a);else{var u;r>=o[o.length-1]?u=o.length-1:u=ie.binarySearch(o,r)-1,this.setAttachment(e,s,t.attachmentNames[u],a)}s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+n.SETUP)}},n.prototype.setAttachment=function(t,e,r,i){e.setAttachment(r==null?null:t.getAttachment(e.data.index,r)),i&&(e.attachmentState=this.unkeyedState+n.CURRENT)},n.prototype.applyRotateTimeline=function(t,e,r,i,a,s,o,u){if(u&&(s[o]=0),i==1){t.apply(e,0,r,null,1,a,mt.mixIn);return}var h=t,l=h.frames,c=e.bones[h.boneIndex];if(c.active){var f=0,d=0;if(r<l[0])switch(a){case C.setup:c.rotation=c.data.rotation;default:return;case C.first:f=c.rotation,d=c.data.rotation}else if(f=a==C.setup?c.data.rotation:c.rotation,r>=l[l.length-nr.ENTRIES])d=c.data.rotation+l[l.length+nr.PREV_ROTATION];else{var p=ie.binarySearch(l,r,nr.ENTRIES),v=l[p+nr.PREV_ROTATION],m=l[p],g=h.getCurvePercent((p>>1)-1,1-(r-m)/(l[p+nr.PREV_TIME]-m));d=l[p+nr.ROTATION]-v,d-=(16384-(16384.499999999996-d/360|0))*360,d=v+d*g+c.data.rotation,d-=(16384-(16384.499999999996-d/360|0))*360}var y=0,x=d-f;if(x-=(16384-(16384.499999999996-x/360|0))*360,x==0)y=s[o];else{var b=0,_=0;u?(b=0,_=x):(b=s[o],_=s[o+1]);var w=x>0,S=b>=0;B.signum(_)!=B.signum(x)&&Math.abs(_)<=90&&(Math.abs(b)>180&&(b+=360*B.signum(b)),S=w),y=x+b-b%360,S!=w&&(y+=360*B.signum(b)),s[o]=y}s[o+1]=x,f+=y*i,c.rotation=f-(16384-(16384.499999999996-f/360|0))*360}},n.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,a=i-r,s=t.trackLast%a,o=this.events,u=0,h=o.length;u<h;u++){var l=o[u];if(l.time<s)break;l.time>i||this.queue.event(t,l)}var c=!1;for(t.loop?c=a==0||s>t.trackTime%a:c=e>=i&&t.animationLast<i,c&&this.queue.complete(t);u<h;u++){var f=o[u];f.time<r||this.queue.event(t,o[u])}},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(e!=null){this.queue.end(e),this.disposeNext(e);for(var r=e;;){var i=r.mixingFrom;if(i==null)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,i!=null&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,r){var i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},n.prototype.setAnimationWith=function(t,e,r){if(e==null)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);a!=null&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,i=!1):this.disposeNext(a));var s=this.trackEntry(t,e,r,a);return this.setCurrent(t,s,i),this.queue.drain(),s},n.prototype.addAnimation=function(t,e,r,i){var a=this.data.skeletonData.findAnimation(e);if(a==null)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,r,i)},n.prototype.addAnimationWith=function(t,e,r,i){if(e==null)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(a!=null)for(;a.next!=null;)a=a.next;var s=this.trackEntry(t,e,r,a);if(a==null)this.setCurrent(t,s,!0),this.queue.drain();else if(a.next=s,i<=0){var o=a.animationEnd-a.animationStart;o!=0?(a.loop?i+=o*(1+(a.trackTime/o|0)):i+=Math.max(o,a.trackTime),i-=this.data.getMix(a.animation,e)):i=a.trackTime}return s.delay=i,s},n.prototype.setEmptyAnimation=function(t,e){var r=this.setAnimationWith(t,n.emptyAnimation,!1);return r.mixDuration=e,r.trackEnd=e,r},n.prototype.addEmptyAnimation=function(t,e,r){r<=0&&(r-=e);var i=this.addAnimationWith(t,n.emptyAnimation,!1,r);return i.mixDuration=e,i.trackEnd=e,i},n.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var a=this.tracks[r];a!=null&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(Y.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)},n.prototype.trackEntry=function(t,e,r,i){var a=this.trackEntryPool.obtain();return a.trackIndex=t,a.animation=e,a.loop=r,a.holdPrevious=!1,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.interruptAlpha=1,a.mixTime=0,a.mixDuration=i==null?0:this.data.getMix(i.animation,e),a.mixBlend=C.replace,a},n.prototype.disposeNext=function(t){for(var e=t.next;e!=null;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var t=0,e=this.tracks.length;t<e;t++){var r=this.tracks[t];if(r!=null){for(;r.mixingFrom!=null;)r=r.mixingFrom;do(r.mixingFrom==null||r.mixBlend!=C.add)&&this.computeHold(r),r=r.mixingTo;while(r!=null)}}},n.prototype.computeHold=function(t){var e=t.mixingTo,r=t.animation.timelines,i=t.animation.timelines.length,a=Y.setArraySize(t.timelineMode,i);t.timelineHoldMix.length=0;var s=Y.setArraySize(t.timelineHoldMix,i),o=this.propertyIDs;if(e!=null&&e.holdPrevious){for(var u=0;u<i;u++)a[u]=o.add(r[u].getPropertyId())?n.HOLD_FIRST:n.HOLD_SUBSEQUENT;return}t:for(var u=0;u<i;u++){var h=r[u],l=h.getPropertyId();if(!o.add(l))a[u]=n.SUBSEQUENT;else if(e==null||h instanceof fi||h instanceof wa||h instanceof Sl||!e.animation.hasTimeline(l))a[u]=n.FIRST;else{for(var c=e.mixingTo;c!=null;c=c.mixingTo)if(!c.animation.hasTimeline(l)){if(t.mixDuration>0){a[u]=n.HOLD_MIX,s[u]=c;continue t}break}a[u]=n.HOLD_FIRST}}},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.prototype.setAnimationByName=function(t,e,r){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,r)},n.prototype.addAnimationByName=function(t,e,r,i){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,r,i)},n.prototype.hasAnimation=function(t){var e=this.data.skeletonData.findAnimation(t);return e!==null},n.prototype.hasAnimationByName=function(t){return n.deprecatedWarning3||(n.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},n.emptyAnimation=new ie("<empty>",[],0),n.SUBSEQUENT=0,n.FIRST=1,n.HOLD_SUBSEQUENT=2,n.HOLD_FIRST=3,n.HOLD_MIX=4,n.SETUP=1,n.CURRENT=2,n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n.deprecatedWarning3=!1,n}(),T0=function(){function n(){this.mixBlend=C.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return n.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},n.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},n.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},n.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},n.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(n.prototype,"time",{get:function(){return n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endTime",{get:function(){return n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),n.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n}(),A0=function(){function n(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return n.prototype.start=function(t){this.objects.push(ze.start),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.interrupt=function(t){this.objects.push(ze.interrupt),this.objects.push(t)},n.prototype.end=function(t){this.objects.push(ze.end),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.dispose=function(t){this.objects.push(ze.dispose),this.objects.push(t)},n.prototype.complete=function(t){this.objects.push(ze.complete),this.objects.push(t)},n.prototype.event=function(t,e){this.objects.push(ze.event),this.objects.push(t),this.objects.push(e)},n.prototype.deprecateStuff=function(){return n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},n.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],a=t[r+1];switch(i){case ze.start:a.listener!=null&&a.listener.start&&a.listener.start(a);for(var s=0;s<e.length;s++)e[s].start&&e[s].start(a);a.onStart&&this.deprecateStuff()&&a.onStart(a.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(a.trackIndex);break;case ze.interrupt:a.listener!=null&&a.listener.interrupt&&a.listener.interrupt(a);for(var s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(a);break;case ze.end:a.listener!=null&&a.listener.end&&a.listener.end(a);for(var s=0;s<e.length;s++)e[s].end&&e[s].end(a);a.onEnd&&this.deprecateStuff()&&a.onEnd(a.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(a.trackIndex);case ze.dispose:a.listener!=null&&a.listener.dispose&&a.listener.dispose(a);for(var s=0;s<e.length;s++)e[s].dispose&&e[s].dispose(a);this.animState.trackEntryPool.free(a);break;case ze.complete:a.listener!=null&&a.listener.complete&&a.listener.complete(a);for(var s=0;s<e.length;s++)e[s].complete&&e[s].complete(a);var o=B.toInt(a.loopsCount());a.onComplete&&this.deprecateStuff()&&a.onComplete(a.trackIndex,o),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(a.trackIndex,o);break;case ze.event:var u=t[r+++2];a.listener!=null&&a.listener.event&&a.listener.event(a,u);for(var s=0;s<e.length;s++)e[s].event&&e[s].event(a,u);a.onEvent&&this.deprecateStuff()&&a.onEvent(a.trackIndex,u),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(a.trackIndex,u);break}}this.clear(),this.drainDisabled=!1}},n.prototype.clear=function(){this.objects.length=0},n.deprecatedWarning1=!1,n}(),ze;(function(n){n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event"})(ze||(ze={}));var yR=function(){function n(){}return n.prototype.start=function(t){},n.prototype.interrupt=function(t){},n.prototype.end=function(t){},n.prototype.dispose=function(t){},n.prototype.complete=function(t){},n.prototype.event=function(t,e){},n}(),M0=function(){function n(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return n.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(i==null)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(a==null)throw new Error("Animation not found: "+e);this.setMixWith(i,a,r)},n.prototype.setMixByName=function(t,e,r){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,r)},n.prototype.setMixWith=function(t,e,r){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},n.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return i===void 0?this.defaultMix:i},n.deprecatedWarning1=!1,n}(),md=function(){function n(t){this.atlas=t}return n.prototype.newRegionAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(i==null)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");var a=new cd(e);return a.region=i,a},n.prototype.newMeshAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(i==null)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");var a=new wl(e);return a.region=i,a},n.prototype.newBoundingBoxAttachment=function(t,e){return new _0(e)},n.prototype.newPathAttachment=function(t,e){return new Us(e)},n.prototype.newPointAttachment=function(t,e){return new S0(e)},n.prototype.newClippingAttachment=function(t,e){return new w0(e)},n}(),mf=function(){function n(t,e,r){if(this.matrix=new te,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(n.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),n.prototype.isActive=function(){return this.active},n.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},n.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},n.prototype.updateWorldTransformWith=function(t,e,r,i,a,s,o){this.ax=t,this.ay=e,this.arotation=r,this.ascaleX=i,this.ascaleY=a,this.ashearX=s,this.ashearY=o,this.appliedValid=!0;var u=this.parent,h=this.matrix,l=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(u==null){var f=this.skeleton,d=r+90+o;h.a=B.cosDeg(r+s)*i*l,h.c=B.cosDeg(d)*a*l,h.b=B.sinDeg(r+s)*i*c,h.d=B.sinDeg(d)*a*c,h.tx=t*l+f.x,h.ty=e*c+f.y;return}var p=u.matrix.a,v=u.matrix.c,m=u.matrix.b,g=u.matrix.d;switch(h.tx=p*t+v*e+u.matrix.tx,h.ty=m*t+g*e+u.matrix.ty,this.data.transformMode){case dt.Normal:{var d=r+90+o,y=B.cosDeg(r+s)*i,x=B.cosDeg(d)*a,b=B.sinDeg(r+s)*i,_=B.sinDeg(d)*a;h.a=p*y+v*b,h.c=p*x+v*_,h.b=m*y+g*b,h.d=m*x+g*_;return}case dt.OnlyTranslation:{var d=r+90+o;h.a=B.cosDeg(r+s)*i,h.c=B.cosDeg(d)*a,h.b=B.sinDeg(r+s)*i,h.d=B.sinDeg(d)*a;break}case dt.NoRotationOrReflection:{var w=p*p+m*m,S=0;w>1e-4?(w=Math.abs(p*g-v*m)/w,p/=this.skeleton.scaleX,m/=this.skeleton.scaleY,v=m*w,g=p*w,S=Math.atan2(m,p)*B.radDeg):(p=0,m=0,S=90-Math.atan2(g,v)*B.radDeg);var E=r+s-S,T=r+o-S+90,y=B.cosDeg(E)*i,x=B.cosDeg(T)*a,b=B.sinDeg(E)*i,_=B.sinDeg(T)*a;h.a=p*y-v*b,h.c=p*x-v*_,h.b=m*y+g*b,h.d=m*x+g*_;break}case dt.NoScale:case dt.NoScaleOrReflection:{var A=B.cosDeg(r),P=B.sinDeg(r),M=(p*A+v*P)/l,R=(m*A+g*P)/c,w=Math.sqrt(M*M+R*R);w>1e-5&&(w=1/w),M*=w,R*=w,w=Math.sqrt(M*M+R*R),this.data.transformMode==dt.NoScale&&p*g-v*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(w=-w);var F=Math.PI/2+Math.atan2(R,M),N=Math.cos(F)*w,D=Math.sin(F)*w,y=B.cosDeg(s)*i,x=B.cosDeg(90+o)*a,b=B.sinDeg(s)*i,_=B.sinDeg(90+o)*a;h.a=M*y+N*b,h.c=M*x+N*_,h.b=R*y+D*b,h.d=R*x+D*_;break}}h.a*=l,h.c*=l,h.b*=c,h.d*=c},n.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},n.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},n.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},n.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)},n.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)},n.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg;return}var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),a=e.tx-r.tx,s=e.ty-r.ty;this.ax=a*r.d*i-s*r.c*i,this.ay=s*r.a*i-a*r.b*i;var o=i*r.d,u=i*r.a,h=i*r.c,l=i*r.b,c=o*e.a-h*e.b,f=o*e.c-h*e.d,d=u*e.b-l*e.a,p=u*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){var v=c*p-f*d;this.ascaleY=v/this.ascaleX,this.ashearY=Math.atan2(c*f+d*p,v)*B.radDeg,this.arotation=Math.atan2(d,c)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,f)*B.radDeg},n.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=1/(r*s-i*a),u=t.x-e.tx,h=t.y-e.ty;return t.x=u*s*o-h*i*o,t.y=h*r*o-u*a*o,t},n.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},n.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},n.prototype.localToWorldRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},n.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=B.cosDeg(t),u=B.sinDeg(t);e.a=o*r-u*a,e.c=o*i-u*s,e.b=u*r+o*a,e.d=u*i+o*s,this.appliedValid=!1},n}(),gd=function(){function n(t,e,r){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=dt.Normal,this.skinRequired=!1,this.color=new tt,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=r}return n}(),El=function(){function n(t,e,r){this.name=t,this.order=e,this.skinRequired=r}return n}(),yd=function(){function n(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}return n}(),xd=function(){function n(t){this.name=t}return n}(),P0=function(){function n(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return n.prototype.isActive=function(){return this.active},n.prototype.apply=function(){this.update()},n.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}},n.prototype.apply1=function(t,e,r,i,a,s,o){t.appliedValid||t.updateAppliedTransform();var u=t.parent.matrix,h=u.a,l=u.c,c=u.b,f=u.d,d=-t.ashearX-t.arotation,p=0,v=0;switch(t.data.transformMode){case dt.OnlyTranslation:p=e-t.worldX,v=r-t.worldY;break;case dt.NoRotationOrReflection:var m=Math.abs(h*f-l*c)/(h*h+c*c),g=h/t.skeleton.scaleX,y=c/t.skeleton.scaleY;l=-y*m*t.skeleton.scaleX,f=g*m*t.skeleton.scaleY,d+=Math.atan2(y,g)*B.radDeg;default:var x=e-u.tx,b=r-u.ty,_=h*f-l*c;p=(x*f-b*l)/_-t.ax,v=(b*h-x*c)/_-t.ay}d+=Math.atan2(v,p)*B.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var w=t.ascaleX,S=t.ascaleY;if(i||a){switch(t.data.transformMode){case dt.NoScale:case dt.NoScaleOrReflection:p=e-t.worldX,v=r-t.worldY}var E=t.data.length*w,T=Math.sqrt(p*p+v*v);if(i&&T<E||a&&T>E&&E>1e-4){var m=(T/E-1)*o+1;w*=m,s&&(S*=m)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*o,w,S,t.ashearX,t.ashearY)},n.prototype.apply2=function(t,e,r,i,a,s,o,u){if(u==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var h=t.ax,l=t.ay,c=t.ascaleX,f=c,d=t.ascaleY,p=e.ascaleX,v=t.matrix,m=0,g=0,y=0;c<0?(c=-c,m=180,y=-1):(m=0,y=1),d<0&&(d=-d,y=-y),p<0?(p=-p,g=180):g=0;var x=e.ax,b=0,_=0,w=0,S=v.a,E=v.c,T=v.b,A=v.d,P=Math.abs(c-d)<=1e-4;P?(b=e.ay,_=S*x+E*b+v.tx,w=T*x+A*b+v.ty):(b=0,_=S*x+v.tx,w=T*x+v.ty);var M=t.parent.matrix;S=M.a,E=M.c,T=M.b,A=M.d;var R=1/(S*A-E*T),F=_-M.tx,N=w-M.ty,D=(F*A-N*E)*R-h,X=(N*S-F*T)*R-l,q=Math.sqrt(D*D+X*X),W=e.data.length*p,L,U;if(q<1e-4){this.apply1(t,r,i,!1,s,!1,u),e.updateWorldTransformWith(x,b,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}F=r-M.tx,N=i-M.ty;var G=(F*A-N*E)*R-h,V=(N*S-F*T)*R-l,O=G*G+V*V;if(o!=0){o*=c*(p+1)/2;var z=Math.sqrt(O),j=z-q-W*c+o;if(j>0){var K=Math.min(1,j/(o*2))-1;K=(j-o*(1-K*K))/z,G-=K*G,V-=K*V,O=G*G+V*V}}t:if(P){W*=c;var Z=(O-q*q-W*W)/(2*q*W);Z<-1?Z=-1:Z>1&&(Z=1,s&&(f*=(Math.sqrt(O)/(q+W)-1)*u+1)),U=Math.acos(Z)*a,S=q+W*Z,E=W*Math.sin(U),L=Math.atan2(V*S-G*E,G*S+V*E)}else{S=c*W,E=d*W;var Q=S*S,nt=E*E,J=Math.atan2(V,G);T=nt*q*q+Q*O-Q*nt;var it=-2*nt*q,st=nt-Q;if(A=it*it-4*st*T,A>=0){var ot=Math.sqrt(A);it<0&&(ot=-ot),ot=-(it+ot)/2;var pt=ot/st,ct=T/ot,lt=Math.abs(pt)<Math.abs(ct)?pt:ct;if(lt*lt<=O){N=Math.sqrt(O-lt*lt)*a,L=J-Math.atan2(N,lt),U=Math.atan2(N/d,(lt-q)/c);break t}}var Pt=B.PI,Ot=q-S,re=Ot*Ot,we=0,Se=0,Wt=q+S,Be=Wt*Wt,Ke=0;T=-S*q/(Q-nt),T>=-1&&T<=1&&(T=Math.acos(T),F=S*Math.cos(T)+q,N=E*Math.sin(T),A=F*F+N*N,A<re&&(Pt=T,re=A,Ot=F,we=N),A>Be&&(Se=T,Be=A,Wt=F,Ke=N)),O<=(re+Be)/2?(L=J-Math.atan2(we*a,Ot),U=Pt*a):(L=J-Math.atan2(Ke*a,Wt),U=Se*a)}var Ne=Math.atan2(b,x)*y,De=t.arotation;L=(L-Ne)*B.radDeg+m-De,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(h,l,De+L*u,f,t.ascaleY,0,0),De=e.arotation,U=((U+Ne)*B.radDeg-e.ashearX)*y+g-De,U>180?U-=360:U<-180&&(U+=360),e.updateWorldTransformWith(x,b,De+U*u,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},n}(),bd=function(n){Yt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return t}(El),_d=function(n){Yt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r}return t}(El),be;(function(n){n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent"})(be||(be={}));var I0=function(){function n(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return n.prototype.isActive=function(){return this.active},n.prototype.apply=function(){this.update()},n.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof Us){var e=this.rotateMix,r=this.translateMix,i=r>0,a=e>0;if(!(!i&&!a)){var s=this.data,o=s.spacingMode,u=o==be.Length,h=s.rotateMode,l=h==Qt.Tangent,c=h==Qt.ChainScale,f=this.bones.length,d=l?f:f+1,p=this.bones,v=Y.setArraySize(this.spaces,d),m=null,g=this.spacing;if(c||u){c&&(m=Y.setArraySize(this.lengths,f));for(var y=0,x=d-1;y<x;){var b=p[y],_=b.data.length;if(_<n.epsilon)c&&(m[y]=0),v[++y]=0;else{var w=_*b.matrix.a,S=_*b.matrix.b,E=Math.sqrt(w*w+S*S);c&&(m[y]=E),v[++y]=(u?_+g:g)*E/_}}}else for(var y=1;y<d;y++)v[y]=g;var T=this.computeWorldPositions(t,d,l,s.positionMode==zt.Percent,o==be.Percent),A=T[0],P=T[1],M=s.offsetRotation,R=!1;if(M==0)R=h==Qt.Chain;else{R=!1;var F=this.target.bone.matrix;M*=F.a*F.d-F.b*F.c>0?B.degRad:-B.degRad}for(var y=0,F=3;y<f;y++,F+=3){var b=p[y],N=b.matrix;N.tx+=(A-N.tx)*r,N.ty+=(P-N.ty)*r;var w=T[F],S=T[F+1],D=w-A,X=S-P;if(c){var q=m[y];if(q!=0){var W=(Math.sqrt(D*D+X*X)/q-1)*e+1;N.a*=W,N.b*=W}}if(A=w,P=S,a){var L=N.a,U=N.c,G=N.b,V=N.d,O=0,z=0,j=0;if(l?O=T[F-1]:v[y+1]==0?O=T[F+2]:O=Math.atan2(X,D),O-=Math.atan2(G,L),R){z=Math.cos(O),j=Math.sin(O);var K=b.data.length;A+=(K*(z*L-j*G)-D)*e,P+=(K*(j*L+z*G)-X)*e}else O+=M;O>B.PI?O-=B.PI2:O<-B.PI&&(O+=B.PI2),O*=e,z=Math.cos(O),j=Math.sin(O),N.a=z*L-j*G,N.c=z*U-j*V,N.b=j*L+z*G,N.d=j*U+z*V}b.appliedValid=!1}}}},n.prototype.computeWorldPositions=function(t,e,r,i,a){var s=this.target,o=this.position,u=this.spaces,h=Y.setArraySize(this.positions,e*3+2),l=null,c=t.closed,f=t.worldVerticesLength,d=f/6,p=n.NONE;if(!t.constantSpeed){var v=t.lengths;d-=c?1:2;var m=v[d];if(i&&(o*=m),a)for(var g=0;g<e;g++)u[g]*=m;l=Y.setArraySize(this.world,8);for(var g=0,y=0,x=0;g<e;g++,y+=3){var b=u[g];o+=b;var _=o;if(c)_%=m,_<0&&(_+=m),x=0;else if(_<0){p!=n.BEFORE&&(p=n.BEFORE,t.computeWorldVertices(s,2,4,l,0,2)),this.addBeforePosition(_,l,0,h,y);continue}else if(_>m){p!=n.AFTER&&(p=n.AFTER,t.computeWorldVertices(s,f-6,4,l,0,2)),this.addAfterPosition(_-m,l,0,h,y);continue}for(;;x++){var w=v[x];if(!(_>w)){if(x==0)_/=w;else{var S=v[x-1];_=(_-S)/(w-S)}break}}x!=p&&(p=x,c&&x==d?(t.computeWorldVertices(s,f-4,4,l,0,2),t.computeWorldVertices(s,0,4,l,4,2)):t.computeWorldVertices(s,x*6+2,8,l,0,2)),this.addCurvePosition(_,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],h,y,r||g>0&&b==0)}return h}c?(f+=2,l=Y.setArraySize(this.world,f),t.computeWorldVertices(s,2,f-4,l,0,2),t.computeWorldVertices(s,0,2,l,f-4,2),l[f-2]=l[0],l[f-1]=l[1]):(d--,f-=4,l=Y.setArraySize(this.world,f),t.computeWorldVertices(s,2,f,l,0,2));for(var E=Y.setArraySize(this.curves,d),T=0,A=l[0],P=l[1],M=0,R=0,F=0,N=0,D=0,X=0,q=0,W=0,L=0,U=0,G=0,V=0,O=0,z=0,g=0,j=2;g<d;g++,j+=6)M=l[j],R=l[j+1],F=l[j+2],N=l[j+3],D=l[j+4],X=l[j+5],q=(A-M*2+F)*.1875,W=(P-R*2+N)*.1875,L=((M-F)*3-A+D)*.09375,U=((R-N)*3-P+X)*.09375,G=q*2+L,V=W*2+U,O=(M-A)*.75+q+L*.16666667,z=(R-P)*.75+W+U*.16666667,T+=Math.sqrt(O*O+z*z),O+=G,z+=V,G+=L,V+=U,T+=Math.sqrt(O*O+z*z),O+=G,z+=V,T+=Math.sqrt(O*O+z*z),O+=G+L,z+=V+U,T+=Math.sqrt(O*O+z*z),E[g]=T,A=D,P=X;if(i&&(o*=T),a)for(var g=0;g<e;g++)u[g]*=T;for(var K=this.segments,Z=0,g=0,y=0,x=0,Q=0;g<e;g++,y+=3){var b=u[g];o+=b;var _=o;if(c)_%=T,_<0&&(_+=T),x=0;else if(_<0){this.addBeforePosition(_,l,0,h,y);continue}else if(_>T){this.addAfterPosition(_-T,l,f-4,h,y);continue}for(;;x++){var nt=E[x];if(!(_>nt)){if(x==0)_/=nt;else{var S=E[x-1];_=(_-S)/(nt-S)}break}}if(x!=p){p=x;var J=x*6;for(A=l[J],P=l[J+1],M=l[J+2],R=l[J+3],F=l[J+4],N=l[J+5],D=l[J+6],X=l[J+7],q=(A-M*2+F)*.03,W=(P-R*2+N)*.03,L=((M-F)*3-A+D)*.006,U=((R-N)*3-P+X)*.006,G=q*2+L,V=W*2+U,O=(M-A)*.3+q+L*.16666667,z=(R-P)*.3+W+U*.16666667,Z=Math.sqrt(O*O+z*z),K[0]=Z,J=1;J<8;J++)O+=G,z+=V,G+=L,V+=U,Z+=Math.sqrt(O*O+z*z),K[J]=Z;O+=G,z+=V,Z+=Math.sqrt(O*O+z*z),K[8]=Z,O+=G+L,z+=V+U,Z+=Math.sqrt(O*O+z*z),K[9]=Z,Q=0}for(_*=Z;;Q++){var it=K[Q];if(!(_>it)){if(Q==0)_/=it;else{var S=K[Q-1];_=Q+(_-S)/(it-S)}break}}this.addCurvePosition(_*.1,A,P,M,R,F,N,D,X,h,y,r||g>0&&b==0)}return h},n.prototype.addBeforePosition=function(t,e,r,i,a){var s=e[r],o=e[r+1],u=e[r+2]-s,h=e[r+3]-o,l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addAfterPosition=function(t,e,r,i,a){var s=e[r+2],o=e[r+3],u=s-e[r],h=o-e[r+1],l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addCurvePosition=function(t,e,r,i,a,s,o,u,h,l,c,f){(t==0||isNaN(t))&&(t=1e-4);var d=t*t,p=d*t,v=1-t,m=v*v,g=m*v,y=v*t,x=y*3,b=v*x,_=x*t,w=e*g+i*b+s*_+u*p,S=r*g+a*b+o*_+h*p;l[c]=w,l[c+1]=S,f&&(l[c+2]=Math.atan2(S-(r*m+a*y*2+o*d),w-(e*m+i*y*2+s*d)))},n.NONE=-1,n.BEFORE=-2,n.AFTER=-3,n.epsilon=1e-5,n}(),C0=function(){function n(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Ds,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return n.prototype.isActive=function(){return this.active},n.prototype.apply=function(){this.update()},n.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},n.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target,s=a.matrix,o=s.a,u=s.c,h=s.b,l=s.d,c=o*l-u*h>0?B.degRad:-B.degRad,f=this.data.offsetRotation*c,d=this.data.offsetShearY*c,p=this.bones,v=0,m=p.length;v<m;v++){var g=p[v],y=!1,x=g.matrix;if(t!=0){var b=x.a,_=x.c,w=x.b,S=x.d,E=Math.atan2(h,o)-Math.atan2(w,b)+f;E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E*=t;var T=Math.cos(E),A=Math.sin(E);x.a=T*b-A*w,x.c=T*_-A*S,x.b=A*b+T*w,x.d=A*_+T*S,y=!0}if(e!=0){var P=this.temp;a.localToWorld(P.set(this.data.offsetX,this.data.offsetY)),x.tx+=(P.x-x.tx)*e,x.ty+=(P.y-x.ty)*e,y=!0}if(r>0){var M=Math.sqrt(x.a*x.a+x.b*x.b),R=Math.sqrt(o*o+h*h);M>1e-5&&(M=(M+(R-M+this.data.offsetScaleX)*r)/M),x.a*=M,x.b*=M,M=Math.sqrt(x.c*x.c+x.d*x.d),R=Math.sqrt(u*u+l*l),M>1e-5&&(M=(M+(R-M+this.data.offsetScaleY)*r)/M),x.c*=M,x.d*=M,y=!0}if(i>0){var _=x.c,S=x.d,F=Math.atan2(S,_),E=Math.atan2(l,u)-Math.atan2(h,o)-(F-Math.atan2(x.b,x.a));E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E=F+(E+d)*i;var M=Math.sqrt(_*_+S*S);x.c=Math.cos(E)*M,x.d=Math.sin(E)*M,y=!0}y&&(g.appliedValid=!1)}},n.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target,s=a.matrix,o=s.a,u=s.c,h=s.b,l=s.d,c=o*l-u*h>0?B.degRad:-B.degRad,f=this.data.offsetRotation*c,d=this.data.offsetShearY*c,p=this.bones,v=0,m=p.length;v<m;v++){var g=p[v],y=!1,x=g.matrix;if(t!=0){var b=x.a,_=x.c,w=x.b,S=x.d,E=Math.atan2(h,o)+f;E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E*=t;var T=Math.cos(E),A=Math.sin(E);x.a=T*b-A*w,x.c=T*_-A*S,x.b=A*b+T*w,x.d=A*_+T*S,y=!0}if(e!=0){var P=this.temp;a.localToWorld(P.set(this.data.offsetX,this.data.offsetY)),x.tx+=P.x*e,x.ty+=P.y*e,y=!0}if(r>0){var M=(Math.sqrt(o*o+h*h)-1+this.data.offsetScaleX)*r+1;x.a*=M,x.b*=M,M=(Math.sqrt(u*u+l*l)-1+this.data.offsetScaleY)*r+1,x.c*=M,x.d*=M,y=!0}if(i>0){var E=Math.atan2(l,u)-Math.atan2(h,o);E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2);var _=x.c,S=x.d;E=Math.atan2(S,_)+(E-B.PI/2+d)*i;var M=Math.sqrt(_*_+S*S);x.c=Math.cos(E)*M,x.d=Math.sin(E)*M,y=!0}y&&(g.appliedValid=!1)}},n.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,o=0,u=s.length;o<u;o++){var h=s[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;if(t!=0){var c=a.arotation-l+this.data.offsetRotation;c-=(16384-(16384.499999999996-c/360|0))*360,l+=c*t}var f=h.ax,d=h.ay;e!=0&&(f+=(a.ax-f+this.data.offsetX)*e,d+=(a.ay-d+this.data.offsetY)*e);var p=h.ascaleX,v=h.ascaleY;r>0&&(p>1e-5&&(p=(p+(a.ascaleX-p+this.data.offsetScaleX)*r)/p),v>1e-5&&(v=(v+(a.ascaleY-v+this.data.offsetScaleY)*r)/v));var m=h.ashearY;if(i>0){var c=a.ashearY-m+this.data.offsetShearY;c-=(16384-(16384.499999999996-c/360|0))*360,h.shearY+=c*i}h.updateWorldTransformWith(f,d,l,p,v,h.ashearX,m)}},n.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,o=0,u=s.length;o<u;o++){var h=s[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;t!=0&&(l+=(a.arotation+this.data.offsetRotation)*t);var c=h.ax,f=h.ay;e!=0&&(c+=(a.ax+this.data.offsetX)*e,f+=(a.ay+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;r>0&&(d>1e-5&&(d*=(a.ascaleX-1+this.data.offsetScaleX)*r+1),p>1e-5&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*r+1));var v=h.ashearY;i>0&&(v+=(a.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(c,f,l,d,p,h.ashearX,v)}},n}(),R0=function(){function n(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(r.parent==null)i=new mf(r,this,null);else{var a=this.bones[r.parent.index];i=new mf(r,this,a),a.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var e=0;e<t.slots.length;e++){var s=t.slots[e],i=this.bones[s.boneData.index],o=new ud(s,i);this.slots.push(o),this.drawOrder.push(o)}this.ikConstraints=new Array;for(var e=0;e<t.ikConstraints.length;e++){var u=t.ikConstraints[e];this.ikConstraints.push(new P0(u,this))}this.transformConstraints=new Array;for(var e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new C0(h,this))}this.pathConstraints=new Array;for(var e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new I0(l,this))}this.color=new tt(1,1,1,1),this.updateCache()}return n.prototype.updateCache=function(){var t=this._updateCache;t.length=0,this.updateCacheReset.length=0;for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];a.sorted=a.data.skinRequired,a.active=!a.sorted}if(this.skin!=null)for(var s=this.skin.bones,r=0,i=this.skin.bones.length;r<i;r++){var a=this.bones[s[r].index];do a.sorted=!1,a.active=!0,a=a.parent;while(a!=null)}var o=this.ikConstraints,u=this.transformConstraints,h=this.pathConstraints,l=o.length,c=u.length,f=h.length,d=l+c+f;t:for(var r=0;r<d;r++){for(var p=0;p<l;p++){var v=o[p];if(v.data.order==r){this.sortIkConstraint(v);continue t}}for(var p=0;p<c;p++){var v=u[p];if(v.data.order==r){this.sortTransformConstraint(v);continue t}}for(var p=0;p<f;p++){var v=h[p];if(v.data.order==r){this.sortPathConstraint(v);continue t}}}for(var r=0,i=e.length;r<i;r++)this.sortBone(e[r])},n.prototype.sortIkConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),r.length>1){var a=r[r.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(t),this.sortReset(i.children),r[r.length-1].sorted=!0}},n.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin!=null&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){var e=t.target,r=e.data.index,i=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,r,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],r,i);var o=e.getAttachment();o instanceof Us&&this.sortPathConstraintAttachmentWith(o,i);for(var u=t.bones,h=u.length,a=0;a<h;a++)this.sortBone(u[a]);this._updateCache.push(t);for(var a=0;a<h;a++)this.sortReset(u[a].children);for(var a=0;a<h;a++)u[a].sorted=!0}},n.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var a=e[i];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(var i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var s=0;s<r;s++)this.sortReset(e[s].children);for(var s=0;s<r;s++)e[s].sorted=!0}},n.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],r)},n.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof Us){var r=t.bones;if(r==null)this.sortBone(e);else for(var i=this.bones,a=0;a<r.length;)for(var s=r[a++],o=a+s;a<o;a++){var u=r[a];this.sortBone(i[u])}}},n.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},n.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},n.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}for(var a=this._updateCache,e=0,r=a.length;e<r;e++)a[e].update()},n.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},n.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();for(var i=this.ikConstraints,e=0,r=i.length;e<r;e++){var a=i[e];a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}for(var s=this.transformConstraints,e=0,r=s.length;e<r;e++){var a=s[e],o=a.data;a.rotateMix=o.rotateMix,a.translateMix=o.translateMix,a.scaleMix=o.scaleMix,a.shearMix=o.shearMix}for(var u=this.pathConstraints,e=0,r=u.length;e<r;e++){var a=u[e],o=a.data;a.position=o.position,a.spacing=o.spacing,a.rotateMix=o.rotateMix,a.translateMix=o.translateMix}},n.prototype.setSlotsToSetupPose=function(){var t=this.slots;Y.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},n.prototype.getRootBone=function(){return this.bones.length==0?null:this.bones[0]},n.prototype.findBone=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.findSlot=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(e==null)throw new Error("Skin not found: "+t);this.setSkin(e)},n.prototype.setSkin=function(t){if(t!=this.skin){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r],s=a.data.attachmentName;if(s!=null){var o=t.getAttachment(r,s);o!=null&&a.setAttachment(o)}}this.skin=t,this.updateCache()}},n.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},n.prototype.getAttachment=function(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){var r=this.skin.getAttachment(t,e);if(r!=null)return r}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null},n.prototype.setAttachment=function(t,e){if(t==null)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,a=r.length;i<a;i++){var s=r[i];if(s.data.name==t){var o=null;if(e!=null&&(o=this.getAttachment(i,e),o==null))throw new Error("Attachment not found: "+e+", for slot: "+t);s.setAttachment(o);return}}throw new Error("Slot not found: "+t)},n.prototype.findIkConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.getBounds=function(t,e,r){if(r===void 0&&(r=new Array(2)),t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var c=i[h];if(c.bone.active){var f=0,d=null,p=c.getAttachment();if(p instanceof cd)f=8,d=Y.setArraySize(r,f,0),p.computeWorldVertices(c.bone,d,0,2);else if(p instanceof wl){var v=p;f=v.worldVerticesLength,d=Y.setArraySize(r,f,0),v.computeWorldVertices(c,0,f,d,0,2)}if(d!=null)for(var m=0,g=d.length;m<g;m+=2){var y=d[m],x=d[m+1];a=Math.min(a,y),s=Math.min(s,x),o=Math.max(o,y),u=Math.max(u,x)}}}t.set(a,s),e.set(o-a,u-s)},n.prototype.update=function(t){this.time+=t},Object.defineProperty(n.prototype,"flipX",{get:function(){return this.scaleX==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flipY",{get:function(){return this.scaleY==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1},enumerable:!1,configurable:!0}),n.deprecatedWarning1=!1,n}(),wd=function(){function n(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return n.prototype.findBone=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSlot=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSkin=function(t){if(t==null)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findEvent=function(t){if(t==null)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findAnimation=function(t){if(t==null)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findIkConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraintIndex=function(t){if(t==null)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n}(),Sd=function(){function n(t,e,r){if(this.color=new tt(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(r==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r}return n}(),Ed=function(n){Yt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r.rotateMix=0,r.translateMix=0,r.scaleMix=0,r.shearMix=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return t}(El),gf=function(){function n(t,e,r){this.slotIndex=t,this.name=e,this.attachment=r}return n}(),$h=function(){function n(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}return n.prototype.setAttachment=function(t,e,r){if(r==null)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},n.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==r){i=!0;break}i||this.bones.push(r)}for(var e=0;e<t.constraints.length;e++){for(var s=t.constraints[e],i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}for(var o=t.getAttachments(),e=0;e<o.length;e++){var u=o[e];this.setAttachment(u.slotIndex,u.name,u.attachment)}},n.prototype.copySkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==r){i=!0;break}i||this.bones.push(r)}for(var e=0;e<t.constraints.length;e++){for(var s=t.constraints[e],i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}for(var o=t.getAttachments(),e=0;e<o.length;e++){var u=o[e];u.attachment!=null&&(u.attachment instanceof wl?(u.attachment=u.attachment.newLinkedMesh(),this.setAttachment(u.slotIndex,u.name,u.attachment)):(u.attachment=u.attachment.copy(),this.setAttachment(u.slotIndex,u.name,u.attachment)))}},n.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},n.prototype.removeAttachment=function(t,e){var r=this.attachments[t];r&&(r[e]=null)},n.prototype.getAttachments=function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var r=this.attachments[e];if(r)for(var i in r){var a=r[i];a&&t.push(new gf(e,i,a))}}return t},n.prototype.getAttachmentsForSlot=function(t,e){var r=this.attachments[t];if(r)for(var i in r){var a=r[i];a&&e.push(new gf(t,i,a))}},n.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},n.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var a=t.slots[i],s=a.getAttachment();if(s&&r<e.attachments.length){var o=e.attachments[r];for(var u in o){var h=o[u];if(s==h){var l=this.getAttachment(r,u);l!=null&&a.setAttachment(l);break}}}r++}},n}(),F0=function(){function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return n.prototype.readSkeletonData=function(t){var e=this.scale,r=new wd;r.name="";var i=new jh(t);if(r.hash=i.readString(),r.version=i.readString(),r.version==="3.8.75"){var a="Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.";console.error(a)}r.x=i.readFloat(),r.y=i.readFloat(),r.width=i.readFloat(),r.height=i.readFloat();var s=i.readBoolean();s&&(r.fps=i.readFloat(),r.imagesPath=i.readString(),r.audioPath=i.readString());var o=0;o=i.readInt(!0);for(var u=0;u<o;u++)i.strings.push(i.readString());o=i.readInt(!0);for(var u=0;u<o;u++){var h=i.readString(),l=u==0?null:r.bones[i.readInt(!0)],c=new gd(u,h,l);c.rotation=i.readFloat(),c.x=i.readFloat()*e,c.y=i.readFloat()*e,c.scaleX=i.readFloat(),c.scaleY=i.readFloat(),c.shearX=i.readFloat(),c.shearY=i.readFloat(),c.length=i.readFloat()*e,c.transformMode=n.TransformModeValues[i.readInt(!0)],c.skinRequired=i.readBoolean(),s&&tt.rgba8888ToColor(c.color,i.readInt32()),r.bones.push(c)}o=i.readInt(!0);for(var u=0;u<o;u++){var f=i.readString(),d=r.bones[i.readInt(!0)],c=new Sd(u,f,d);tt.rgba8888ToColor(c.color,i.readInt32());var p=i.readInt32();p!=-1&&tt.rgb888ToColor(c.darkColor=new tt,p),c.attachmentName=i.readStringRef(),c.blendMode=n.BlendModeValues[i.readInt(!0)],r.slots.push(c)}o=i.readInt(!0);for(var u=0,v=void 0;u<o;u++){var c=new bd(i.readString());c.order=i.readInt(!0),c.skinRequired=i.readBoolean(),v=i.readInt(!0);for(var m=0;m<v;m++)c.bones.push(r.bones[i.readInt(!0)]);c.target=r.bones[i.readInt(!0)],c.mix=i.readFloat(),c.softness=i.readFloat()*e,c.bendDirection=i.readByte(),c.compress=i.readBoolean(),c.stretch=i.readBoolean(),c.uniform=i.readBoolean(),r.ikConstraints.push(c)}o=i.readInt(!0);for(var u=0,v=void 0;u<o;u++){var c=new Ed(i.readString());c.order=i.readInt(!0),c.skinRequired=i.readBoolean(),v=i.readInt(!0);for(var m=0;m<v;m++)c.bones.push(r.bones[i.readInt(!0)]);c.target=r.bones[i.readInt(!0)],c.local=i.readBoolean(),c.relative=i.readBoolean(),c.offsetRotation=i.readFloat(),c.offsetX=i.readFloat()*e,c.offsetY=i.readFloat()*e,c.offsetScaleX=i.readFloat(),c.offsetScaleY=i.readFloat(),c.offsetShearY=i.readFloat(),c.rotateMix=i.readFloat(),c.translateMix=i.readFloat(),c.scaleMix=i.readFloat(),c.shearMix=i.readFloat(),r.transformConstraints.push(c)}o=i.readInt(!0);for(var u=0,v=void 0;u<o;u++){var c=new _d(i.readString());c.order=i.readInt(!0),c.skinRequired=i.readBoolean(),v=i.readInt(!0);for(var m=0;m<v;m++)c.bones.push(r.bones[i.readInt(!0)]);c.target=r.slots[i.readInt(!0)],c.positionMode=n.PositionModeValues[i.readInt(!0)],c.spacingMode=n.SpacingModeValues[i.readInt(!0)],c.rotateMode=n.RotateModeValues[i.readInt(!0)],c.offsetRotation=i.readFloat(),c.position=i.readFloat(),c.positionMode==zt.Fixed&&(c.position*=e),c.spacing=i.readFloat(),(c.spacingMode==be.Length||c.spacingMode==be.Fixed)&&(c.spacing*=e),c.rotateMix=i.readFloat(),c.translateMix=i.readFloat(),r.pathConstraints.push(c)}var g=this.readSkin(i,r,!0,s);g!=null&&(r.defaultSkin=g,r.skins.push(g));{var u=r.skins.length;for(Y.setArraySize(r.skins,o=u+i.readInt(!0));u<o;u++)r.skins[u]=this.readSkin(i,r,!1,s)}o=this.linkedMeshes.length;for(var u=0;u<o;u++){var y=this.linkedMeshes[u],x=y.skin==null?r.defaultSkin:r.findSkin(y.skin);if(x==null)throw new Error("Skin not found: "+y.skin);var b=x.getAttachment(y.slotIndex,y.parent);if(b==null)throw new Error("Parent mesh not found: "+y.parent);y.mesh.deformAttachment=y.inheritDeform?b:y.mesh,y.mesh.setParentMesh(b)}this.linkedMeshes.length=0,o=i.readInt(!0);for(var u=0;u<o;u++){var c=new xd(i.readStringRef());c.intValue=i.readInt(!1),c.floatValue=i.readFloat(),c.stringValue=i.readString(),c.audioPath=i.readString(),c.audioPath!=null&&(c.volume=i.readFloat(),c.balance=i.readFloat()),r.events.push(c)}o=i.readInt(!0);for(var u=0;u<o;u++)r.animations.push(this.readAnimation(i,i.readString(),r));return r},n.prototype.readSkin=function(t,e,r,i){var a=null,s=0;if(r){if(s=t.readInt(!0),s==0)return null;a=new $h("default")}else{a=new $h(t.readStringRef()),a.bones.length=t.readInt(!0);for(var o=0,u=a.bones.length;o<u;o++)a.bones[o]=e.bones[t.readInt(!0)];for(var o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.ikConstraints[t.readInt(!0)]);for(var o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.transformConstraints[t.readInt(!0)]);for(var o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.pathConstraints[t.readInt(!0)]);s=t.readInt(!0)}for(var o=0;o<s;o++)for(var h=t.readInt(!0),l=0,c=t.readInt(!0);l<c;l++){var f=t.readStringRef(),d=this.readAttachment(t,e,a,h,f,i);d!=null&&a.setAttachment(h,f,d)}return a},n.prototype.readAttachment=function(t,e,r,i,a,s){var o=this.scale,u=t.readStringRef();u==null&&(u=a);var h=t.readByte(),l=n.AttachmentTypeValues[h];switch(l){case yt.Region:{var c=t.readStringRef(),f=t.readFloat(),d=t.readFloat(),p=t.readFloat(),v=t.readFloat(),m=t.readFloat(),g=t.readFloat(),y=t.readFloat(),x=t.readInt32();c==null&&(c=u);var b=this.attachmentLoader.newRegionAttachment(r,u,c);return b==null?null:(b.path=c,b.x=d*o,b.y=p*o,b.scaleX=v,b.scaleY=m,b.rotation=f,b.width=g*o,b.height=y*o,tt.rgba8888ToColor(b.color,x),b)}case yt.BoundingBox:{var _=t.readInt(!0),w=this.readVertices(t,_),x=s?t.readInt32():0,S=this.attachmentLoader.newBoundingBoxAttachment(r,u);return S==null?null:(S.worldVerticesLength=_<<1,S.vertices=w.vertices,S.bones=w.bones,s&&tt.rgba8888ToColor(S.color,x),S)}case yt.Mesh:{var c=t.readStringRef(),x=t.readInt32(),_=t.readInt(!0),E=this.readFloatArray(t,_<<1,1),T=this.readShortArray(t),w=this.readVertices(t,_),A=t.readInt(!0),P=null,g=0,y=0;s&&(P=this.readShortArray(t),g=t.readFloat(),y=t.readFloat()),c==null&&(c=u);var M=this.attachmentLoader.newMeshAttachment(r,u,c);return M==null?null:(M.path=c,tt.rgba8888ToColor(M.color,x),M.bones=w.bones,M.vertices=w.vertices,M.worldVerticesLength=_<<1,M.triangles=T,M.regionUVs=new Float32Array(E),M.hullLength=A<<1,s&&(M.edges=P,M.width=g*o,M.height=y*o),M)}case yt.LinkedMesh:{var c=t.readStringRef(),x=t.readInt32(),R=t.readStringRef(),F=t.readStringRef(),N=t.readBoolean(),g=0,y=0;s&&(g=t.readFloat(),y=t.readFloat()),c==null&&(c=u);var M=this.attachmentLoader.newMeshAttachment(r,u,c);return M==null?null:(M.path=c,tt.rgba8888ToColor(M.color,x),s&&(M.width=g*o,M.height=y*o),this.linkedMeshes.push(new xR(M,R,i,F,N)),M)}case yt.Path:{for(var D=t.readBoolean(),X=t.readBoolean(),_=t.readInt(!0),w=this.readVertices(t,_),q=Y.newArray(_/3,0),W=0,L=q.length;W<L;W++)q[W]=t.readFloat()*o;var x=s?t.readInt32():0,c=this.attachmentLoader.newPathAttachment(r,u);return c==null?null:(c.closed=D,c.constantSpeed=X,c.worldVerticesLength=_<<1,c.vertices=w.vertices,c.bones=w.bones,c.lengths=q,s&&tt.rgba8888ToColor(c.color,x),c)}case yt.Point:{var f=t.readFloat(),d=t.readFloat(),p=t.readFloat(),x=s?t.readInt32():0,U=this.attachmentLoader.newPointAttachment(r,u);return U==null?null:(U.x=d*o,U.y=p*o,U.rotation=f,s&&tt.rgba8888ToColor(U.color,x),U)}case yt.Clipping:{var G=t.readInt(!0),_=t.readInt(!0),w=this.readVertices(t,_),x=s?t.readInt32():0,V=this.attachmentLoader.newClippingAttachment(r,u);return V==null?null:(V.endSlot=e.slots[G],V.worldVerticesLength=_<<1,V.vertices=w.vertices,V.bones=w.bones,s&&tt.rgba8888ToColor(V.color,x),V)}}return null},n.prototype.readVertices=function(t,e){var r=e<<1,i=new bR,a=this.scale;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,r,a),i;for(var s=new Array,o=new Array,u=0;u<e;u++){var h=t.readInt(!0);o.push(h);for(var l=0;l<h;l++)o.push(t.readInt(!0)),s.push(t.readFloat()*a),s.push(t.readFloat()*a),s.push(t.readFloat())}return i.vertices=Y.toFloatArray(s),i.bones=o,i},n.prototype.readFloatArray=function(t,e,r){var i=new Array(e);if(r==1)for(var a=0;a<e;a++)i[a]=t.readFloat();else for(var a=0;a<e;a++)i[a]=t.readFloat()*r;return i},n.prototype.readShortArray=function(t){for(var e=t.readInt(!0),r=new Array(e),i=0;i<e;i++)r[i]=t.readShort();return r},n.prototype.readAnimation=function(t,e,r){for(var i=new Array,a=this.scale,s=0,o=new tt,u=new tt,h=0,l=t.readInt(!0);h<l;h++)for(var c=t.readInt(!0),f=0,d=t.readInt(!0);f<d;f++){var p=t.readByte(),v=t.readInt(!0);switch(p){case n.SLOT_ATTACHMENT:{var m=new fi(v);m.slotIndex=c;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readStringRef());i.push(m),s=Math.max(s,m.frames[v-1]);break}case n.SLOT_COLOR:{var m=new Vs(v);m.slotIndex=c;for(var g=0;g<v;g++){var y=t.readFloat();tt.rgba8888ToColor(o,t.readInt32()),m.setFrame(g,y,o.r,o.g,o.b,o.a),g<v-1&&this.readCurve(t,g,m)}i.push(m),s=Math.max(s,m.frames[(v-1)*Vs.ENTRIES]);break}case n.SLOT_TWO_COLOR:{var m=new Xs(v);m.slotIndex=c;for(var g=0;g<v;g++){var y=t.readFloat();tt.rgba8888ToColor(o,t.readInt32()),tt.rgb888ToColor(u,t.readInt32()),m.setFrame(g,y,o.r,o.g,o.b,o.a,u.r,u.g,u.b),g<v-1&&this.readCurve(t,g,m)}i.push(m),s=Math.max(s,m.frames[(v-1)*Xs.ENTRIES]);break}}}for(var h=0,l=t.readInt(!0);h<l;h++)for(var x=t.readInt(!0),f=0,d=t.readInt(!0);f<d;f++){var p=t.readByte(),v=t.readInt(!0);switch(p){case n.BONE_ROTATE:{var m=new nr(v);m.boneIndex=x;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat()),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*nr.ENTRIES]);break}case n.BONE_TRANSLATE:case n.BONE_SCALE:case n.BONE_SHEAR:{var m=void 0,b=1;p==n.BONE_SCALE?m=new fd(v):p==n.BONE_SHEAR?m=new dd(v):(m=new Mi(v),b=a),m.boneIndex=x;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat()*b,t.readFloat()*b),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*Mi.ENTRIES]);break}}}for(var h=0,l=t.readInt(!0);h<l;h++){var _=t.readInt(!0),v=t.readInt(!0),m=new zs(v);m.ikConstraintIndex=_;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat(),t.readFloat()*a,t.readByte(),t.readBoolean(),t.readBoolean()),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*zs.ENTRIES])}for(var h=0,l=t.readInt(!0);h<l;h++){var _=t.readInt(!0),v=t.readInt(!0),m=new Gs(v);m.transformConstraintIndex=_;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*Gs.ENTRIES])}for(var h=0,l=t.readInt(!0);h<l;h++)for(var _=t.readInt(!0),w=r.pathConstraints[_],f=0,d=t.readInt(!0);f<d;f++){var p=t.readByte(),v=t.readInt(!0);switch(p){case n.PATH_POSITION:case n.PATH_SPACING:{var m=void 0,b=1;p==n.PATH_SPACING?(m=new vd(v),(w.spacingMode==be.Length||w.spacingMode==be.Fixed)&&(b=a)):(m=new Ra(v),w.positionMode==zt.Fixed&&(b=a)),m.pathConstraintIndex=_;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat()*b),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*Ra.ENTRIES]);break}case n.PATH_MIX:{var m=new Ys(v);m.pathConstraintIndex=_;for(var g=0;g<v;g++)m.setFrame(g,t.readFloat(),t.readFloat(),t.readFloat()),g<v-1&&this.readCurve(t,g,m);i.push(m),s=Math.max(s,m.frames[(v-1)*Ys.ENTRIES]);break}}}for(var h=0,l=t.readInt(!0);h<l;h++)for(var S=r.skins[t.readInt(!0)],f=0,d=t.readInt(!0);f<d;f++)for(var c=t.readInt(!0),E=0,T=t.readInt(!0);E<T;E++){var A=S.getAttachment(c,t.readStringRef()),P=A.bones!=null,M=A.vertices,R=P?M.length/3*2:M.length,v=t.readInt(!0),m=new pd(v);m.slotIndex=c,m.attachment=A;for(var g=0;g<v;g++){var y=t.readFloat(),F=void 0,N=t.readInt(!0);if(N==0)F=P?Y.newFloatArray(R):M;else{F=Y.newFloatArray(R);var D=t.readInt(!0);if(N+=D,a==1)for(var X=D;X<N;X++)F[X]=t.readFloat();else for(var X=D;X<N;X++)F[X]=t.readFloat()*a;if(!P)for(var X=0,q=F.length;X<q;X++)F[X]+=M[X]}m.setFrame(g,y,F),g<v-1&&this.readCurve(t,g,m)}i.push(m),s=Math.max(s,m.frames[v-1])}var W=t.readInt(!0);if(W>0){for(var m=new wa(W),L=r.slots.length,h=0;h<W;h++){for(var y=t.readFloat(),U=t.readInt(!0),G=Y.newArray(L,0),f=L-1;f>=0;f--)G[f]=-1;for(var V=Y.newArray(L-U,0),O=0,z=0,f=0;f<U;f++){for(var c=t.readInt(!0);O!=c;)V[z++]=O++;G[O+t.readInt(!0)]=O++}for(;O<L;)V[z++]=O++;for(var f=L-1;f>=0;f--)G[f]==-1&&(G[f]=V[--z]);m.setFrame(h,y,G)}i.push(m),s=Math.max(s,m.frames[W-1])}var j=t.readInt(!0);if(j>0){for(var m=new Sl(j),h=0;h<j;h++){var y=t.readFloat(),K=r.events[t.readInt(!0)],Z=new yd(y,K);Z.intValue=t.readInt(!1),Z.floatValue=t.readFloat(),Z.stringValue=t.readBoolean()?t.readString():K.stringValue,Z.data.audioPath!=null&&(Z.volume=t.readFloat(),Z.balance=t.readFloat()),m.setFrame(h,Z)}i.push(m),s=Math.max(s,m.frames[j-1])}return new ie(e,i,s)},n.prototype.readCurve=function(t,e,r){switch(t.readByte()){case n.CURVE_STEPPED:r.setStepped(e);break;case n.CURVE_BEZIER:this.setCurve(r,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat());break}},n.prototype.setCurve=function(t,e,r,i,a,s){t.setCurve(e,r,i,a,s)},n.AttachmentTypeValues=[0,1,2,3,4,5,6],n.TransformModeValues=[dt.Normal,dt.OnlyTranslation,dt.NoRotationOrReflection,dt.NoScale,dt.NoScaleOrReflection],n.PositionModeValues=[zt.Fixed,zt.Percent],n.SpacingModeValues=[be.Length,be.Fixed,be.Percent],n.RotateModeValues=[Qt.Tangent,Qt.Chain,Qt.ChainScale],n.BlendModeValues=[at.NORMAL,at.ADD,at.MULTIPLY,at.SCREEN],n.BONE_ROTATE=0,n.BONE_TRANSLATE=1,n.BONE_SCALE=2,n.BONE_SHEAR=3,n.SLOT_ATTACHMENT=0,n.SLOT_COLOR=1,n.SLOT_TWO_COLOR=2,n.PATH_POSITION=0,n.PATH_SPACING=1,n.PATH_MIX=2,n.CURVE_LINEAR=0,n.CURVE_STEPPED=1,n.CURVE_BEZIER=2,n}(),xR=function(){function n(t,e,r,i,a){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritDeform=a}return n}(),bR=function(){function n(t,e){t===void 0&&(t=null),e===void 0&&(e=null),this.bones=t,this.vertices=e}return n}(),_R=function(n){Yt(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(hd),O0=function(){function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return n.prototype.readSkeletonData=function(t){var e=this.scale,r=new wd,i=typeof t=="string"?JSON.parse(t):t,a=i.skeleton;if(a!=null){if(r.hash=a.hash,r.version=a.spine,r.version.substr(0,3)!=="3.8"){var s="Spine 3.8 loader cant load version "+a.spine+". Please configure your pixi-spine bundle";console.error(s)}if(r.version==="3.8.75"){var s="Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.";console.error(s)}r.x=a.x,r.y=a.y,r.width=a.width,r.height=a.height,r.fps=a.fps,r.imagesPath=a.images}if(i.bones)for(var o=0;o<i.bones.length;o++){var u=i.bones[o],h=null,l=this.getValue(u,"parent",null);if(l!=null&&(h=r.findBone(l),h==null))throw new Error("Parent bone not found: "+l);var c=new gd(r.bones.length,u.name,h);c.length=this.getValue(u,"length",0)*e,c.x=this.getValue(u,"x",0)*e,c.y=this.getValue(u,"y",0)*e,c.rotation=this.getValue(u,"rotation",0),c.scaleX=this.getValue(u,"scaleX",1),c.scaleY=this.getValue(u,"scaleY",1),c.shearX=this.getValue(u,"shearX",0),c.shearY=this.getValue(u,"shearY",0),c.transformMode=n.transformModeFromString(this.getValue(u,"transform","normal")),c.skinRequired=this.getValue(u,"skin",!1),r.bones.push(c)}if(i.slots)for(var o=0;o<i.slots.length;o++){var f=i.slots[o],d=f.name,p=f.bone,v=r.findBone(p);if(v==null)throw new Error("Slot bone not found: "+p);var c=new Sd(r.slots.length,d,v),m=this.getValue(f,"color",null);m!=null&&c.color.setFromString(m);var g=this.getValue(f,"dark",null);g!=null&&(c.darkColor=new tt(1,1,1,1),c.darkColor.setFromString(g)),c.attachmentName=this.getValue(f,"attachment",null),c.blendMode=n.blendModeFromString(this.getValue(f,"blend","normal")),r.slots.push(c)}if(i.ik)for(var o=0;o<i.ik.length;o++){var y=i.ik[o],c=new bd(y.name);c.order=this.getValue(y,"order",0),c.skinRequired=this.getValue(y,"skin",!1);for(var x=0;x<y.bones.length;x++){var p=y.bones[x],b=r.findBone(p);if(b==null)throw new Error("IK bone not found: "+p);c.bones.push(b)}var _=y.target;if(c.target=r.findBone(_),c.target==null)throw new Error("IK target bone not found: "+_);c.mix=this.getValue(y,"mix",1),c.softness=this.getValue(y,"softness",0)*e,c.bendDirection=this.getValue(y,"bendPositive",!0)?1:-1,c.compress=this.getValue(y,"compress",!1),c.stretch=this.getValue(y,"stretch",!1),c.uniform=this.getValue(y,"uniform",!1),r.ikConstraints.push(c)}if(i.transform)for(var o=0;o<i.transform.length;o++){var y=i.transform[o],c=new Ed(y.name);c.order=this.getValue(y,"order",0),c.skinRequired=this.getValue(y,"skin",!1);for(var x=0;x<y.bones.length;x++){var p=y.bones[x],b=r.findBone(p);if(b==null)throw new Error("Transform constraint bone not found: "+p);c.bones.push(b)}var _=y.target;if(c.target=r.findBone(_),c.target==null)throw new Error("Transform constraint target bone not found: "+_);c.local=this.getValue(y,"local",!1),c.relative=this.getValue(y,"relative",!1),c.offsetRotation=this.getValue(y,"rotation",0),c.offsetX=this.getValue(y,"x",0)*e,c.offsetY=this.getValue(y,"y",0)*e,c.offsetScaleX=this.getValue(y,"scaleX",0),c.offsetScaleY=this.getValue(y,"scaleY",0),c.offsetShearY=this.getValue(y,"shearY",0),c.rotateMix=this.getValue(y,"rotateMix",1),c.translateMix=this.getValue(y,"translateMix",1),c.scaleMix=this.getValue(y,"scaleMix",1),c.shearMix=this.getValue(y,"shearMix",1),r.transformConstraints.push(c)}if(i.path)for(var o=0;o<i.path.length;o++){var y=i.path[o],c=new _d(y.name);c.order=this.getValue(y,"order",0),c.skinRequired=this.getValue(y,"skin",!1);for(var x=0;x<y.bones.length;x++){var p=y.bones[x],b=r.findBone(p);if(b==null)throw new Error("Transform constraint bone not found: "+p);c.bones.push(b)}var _=y.target;if(c.target=r.findSlot(_),c.target==null)throw new Error("Path target slot not found: "+_);c.positionMode=n.positionModeFromString(this.getValue(y,"positionMode","percent")),c.spacingMode=n.spacingModeFromString(this.getValue(y,"spacingMode","length")),c.rotateMode=n.rotateModeFromString(this.getValue(y,"rotateMode","tangent")),c.offsetRotation=this.getValue(y,"rotation",0),c.position=this.getValue(y,"position",0),c.positionMode==zt.Fixed&&(c.position*=e),c.spacing=this.getValue(y,"spacing",0),(c.spacingMode==be.Length||c.spacingMode==be.Fixed)&&(c.spacing*=e),c.rotateMix=this.getValue(y,"rotateMix",1),c.translateMix=this.getValue(y,"translateMix",1),r.pathConstraints.push(c)}if(i.skins)for(var o=0;o<i.skins.length;o++){var w=i.skins[o],S=new $h(w.name);if(w.bones)for(var E=0;E<w.bones.length;E++){var b=r.findBone(w.bones[E]);if(b==null)throw new Error("Skin bone not found: "+w.bones[o]);S.bones.push(b)}if(w.ik)for(var E=0;E<w.ik.length;E++){var T=r.findIkConstraint(w.ik[E]);if(T==null)throw new Error("Skin IK constraint not found: "+w.ik[o]);S.constraints.push(T)}if(w.transform)for(var E=0;E<w.transform.length;E++){var T=r.findTransformConstraint(w.transform[E]);if(T==null)throw new Error("Skin transform constraint not found: "+w.transform[o]);S.constraints.push(T)}if(w.path)for(var E=0;E<w.path.length;E++){var T=r.findPathConstraint(w.path[E]);if(T==null)throw new Error("Skin path constraint not found: "+w.path[o]);S.constraints.push(T)}for(var d in w.attachments){var A=r.findSlot(d);if(A==null)throw new Error("Slot not found: "+d);var f=w.attachments[d];for(var P in f){var M=this.readAttachment(f[P],S,A.index,P,r);M!=null&&S.setAttachment(A.index,P,M)}}r.skins.push(S),S.name=="default"&&(r.defaultSkin=S)}for(var o=0,R=this.linkedMeshes.length;o<R;o++){var F=this.linkedMeshes[o],S=F.skin==null?r.defaultSkin:r.findSkin(F.skin);if(S==null)throw new Error("Skin not found: "+F.skin);var N=S.getAttachment(F.slotIndex,F.parent);if(N==null)throw new Error("Parent mesh not found: "+F.parent);F.mesh.deformAttachment=F.inheritDeform?N:F.mesh,F.mesh.setParentMesh(N)}if(this.linkedMeshes.length=0,i.events)for(var D in i.events){var X=i.events[D],c=new xd(D);c.intValue=this.getValue(X,"int",0),c.floatValue=this.getValue(X,"float",0),c.stringValue=this.getValue(X,"string",""),c.audioPath=this.getValue(X,"audio",null),c.audioPath!=null&&(c.volume=this.getValue(X,"volume",1),c.balance=this.getValue(X,"balance",0)),r.events.push(c)}if(i.animations)for(var q in i.animations){var W=i.animations[q];this.readAnimation(W,q,r)}return r},n.prototype.readAttachment=function(t,e,r,i,a){var s=this.scale;i=this.getValue(t,"name",i);var o=this.getValue(t,"type","region");switch(o){case"region":{var u=this.getValue(t,"path",i),h=this.attachmentLoader.newRegionAttachment(e,i,u);if(h==null)return null;h.path=u,h.x=this.getValue(t,"x",0)*s,h.y=this.getValue(t,"y",0)*s,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*s,h.height=t.height*s;var l=this.getValue(t,"color",null);return l!=null&&h.color.setFromString(l),h}case"boundingbox":{var c=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(c==null)return null;this.readVertices(t,c,t.vertexCount<<1);var l=this.getValue(t,"color",null);return l!=null&&c.color.setFromString(l),c}case"mesh":case"linkedmesh":{var u=this.getValue(t,"path",i),f=this.attachmentLoader.newMeshAttachment(e,i,u);if(f==null)return null;f.path=u;var l=this.getValue(t,"color",null);l!=null&&f.color.setFromString(l),f.width=this.getValue(t,"width",0)*s,f.height=this.getValue(t,"height",0)*s;var d=this.getValue(t,"parent",null);if(d!=null)return this.linkedMeshes.push(new wR(f,this.getValue(t,"skin",null),r,d,this.getValue(t,"deform",!0))),f;var p=t.uvs;return this.readVertices(t,f,p.length),f.triangles=t.triangles,f.regionUVs=new Float32Array(p),f.edges=this.getValue(t,"edges",null),f.hullLength=this.getValue(t,"hull",0)*2,f}case"path":{var u=this.attachmentLoader.newPathAttachment(e,i);if(u==null)return null;u.closed=this.getValue(t,"closed",!1),u.constantSpeed=this.getValue(t,"constantSpeed",!0);var v=t.vertexCount;this.readVertices(t,u,v<<1);for(var m=Y.newArray(v/3,0),g=0;g<t.lengths.length;g++)m[g]=t.lengths[g]*s;u.lengths=m;var l=this.getValue(t,"color",null);return l!=null&&u.color.setFromString(l),u}case"point":{var y=this.attachmentLoader.newPointAttachment(e,i);if(y==null)return null;y.x=this.getValue(t,"x",0)*s,y.y=this.getValue(t,"y",0)*s,y.rotation=this.getValue(t,"rotation",0);var l=this.getValue(t,"color",null);return l!=null&&y.color.setFromString(l),y}case"clipping":{var x=this.attachmentLoader.newClippingAttachment(e,i);if(x==null)return null;var b=this.getValue(t,"end",null);if(b!=null){var _=a.findSlot(b);if(_==null)throw new Error("Clipping end slot not found: "+b);x.endSlot=_}var v=t.vertexCount;this.readVertices(t,x,v<<1);var l=this.getValue(t,"color",null);return l!=null&&x.color.setFromString(l),x}}return null},n.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var a=t.vertices;if(r==a.length){var s=Y.toFloatArray(a);if(i!=1)for(var o=0,u=a.length;o<u;o++)s[o]*=i;e.vertices=s;return}for(var h=new Array,l=new Array,o=0,u=a.length;o<u;){var c=a[o++];l.push(c);for(var f=o+c*4;o<f;o+=4)l.push(a[o]),h.push(a[o+1]*i),h.push(a[o+2]*i),h.push(a[o+3])}e.bones=l,e.vertices=Y.toFloatArray(h)},n.prototype.readAnimation=function(t,e,r){var i=this.scale,a=new Array,s=0;if(t.slots)for(var o in t.slots){var u=t.slots[o],h=r.findSlotIndex(o);if(h==-1)throw new Error("Slot not found: "+o);for(var l in u){var c=u[l];if(l=="attachment"){var f=new fi(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d++,this.getValue(v,"time",0),v.name)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}else if(l=="color"){var f=new Vs(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p],m=new tt;m.setFromString(v.color||"ffffffff"),f.setFrame(d,this.getValue(v,"time",0),m.r,m.g,m.b,m.a),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Vs.ENTRIES])}else if(l=="twoColor"){var f=new Xs(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p],g=new tt,y=new tt;g.setFromString(v.light),y.setFromString(v.dark),f.setFrame(d,this.getValue(v,"time",0),g.r,g.g,g.b,g.a,y.r,y.g,y.b),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Xs.ENTRIES])}else throw new Error("Invalid timeline type for a slot: "+l+" ("+o+")")}}if(t.bones)for(var x in t.bones){var b=t.bones[x],_=r.findBoneIndex(x);if(_==-1)throw new Error("Bone not found: "+x);for(var l in b){var c=b[l];if(l==="rotate"){var f=new nr(c.length);f.boneIndex=_;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,this.getValue(v,"time",0),this.getValue(v,"angle",0)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*nr.ENTRIES])}else if(l==="translate"||l==="scale"||l==="shear"){var f=null,w=1,S=0;l==="scale"?(f=new fd(c.length),S=1):l==="shear"?f=new dd(c.length):(f=new Mi(c.length),w=i),f.boneIndex=_;for(var d=0,p=0;p<c.length;p++){var v=c[p],E=this.getValue(v,"x",S),T=this.getValue(v,"y",S);f.setFrame(d,this.getValue(v,"time",0),E*w,T*w),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Mi.ENTRIES])}else throw new Error("Invalid timeline type for a bone: "+l+" ("+x+")")}}if(t.ik)for(var A in t.ik){var P=t.ik[A],M=r.findIkConstraint(A),f=new zs(P.length);f.ikConstraintIndex=r.ikConstraints.indexOf(M);for(var d=0,p=0;p<P.length;p++){var v=P[p];f.setFrame(d,this.getValue(v,"time",0),this.getValue(v,"mix",1),this.getValue(v,"softness",0)*i,this.getValue(v,"bendPositive",!0)?1:-1,this.getValue(v,"compress",!1),this.getValue(v,"stretch",!1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*zs.ENTRIES])}if(t.transform)for(var A in t.transform){var P=t.transform[A],M=r.findTransformConstraint(A),f=new Gs(P.length);f.transformConstraintIndex=r.transformConstraints.indexOf(M);for(var d=0,p=0;p<P.length;p++){var v=P[p];f.setFrame(d,this.getValue(v,"time",0),this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1),this.getValue(v,"scaleMix",1),this.getValue(v,"shearMix",1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Gs.ENTRIES])}if(t.path)for(var A in t.path){var P=t.path[A],R=r.findPathConstraintIndex(A);if(R==-1)throw new Error("Path constraint not found: "+A);var F=r.pathConstraints[R];for(var l in P){var c=P[l];if(l==="position"||l==="spacing"){var f=null,w=1;l==="spacing"?(f=new vd(c.length),(F.spacingMode==be.Length||F.spacingMode==be.Fixed)&&(w=i)):(f=new Ra(c.length),F.positionMode==zt.Fixed&&(w=i)),f.pathConstraintIndex=R;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,this.getValue(v,"time",0),this.getValue(v,l,0)*w),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Ra.ENTRIES])}else if(l==="mix"){var f=new Ys(c.length);f.pathConstraintIndex=R;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,this.getValue(v,"time",0),this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Ys.ENTRIES])}}}if(t.deform)for(var N in t.deform){var D=t.deform[N],X=r.findSkin(N);if(X!=null)for(var o in D){var u=D[o],h=r.findSlotIndex(o);if(h==-1)throw new Error("Slot not found: "+u.name);for(var l in u){var c=u[l],q=X.getAttachment(h,l);if(q==null)throw new Error("Deform attachment not found: "+c.name);var W=q.bones!=null,L=q.vertices,U=W?L.length/3*2:L.length,f=new pd(c.length);f.slotIndex=h,f.attachment=q;for(var d=0,G=0;G<c.length;G++){var v=c[G],V=void 0,O=this.getValue(v,"vertices",null);if(O==null)V=W?Y.newFloatArray(U):L;else{V=Y.newFloatArray(U);var z=this.getValue(v,"offset",0);if(Y.arrayCopy(O,0,V,z,O.length),i!=1)for(var p=z,j=p+O.length;p<j;p++)V[p]*=i;if(!W)for(var p=0;p<U;p++)V[p]+=L[p]}f.setFrame(d,this.getValue(v,"time",0),V),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}}}var K=t.drawOrder;if(K==null&&(K=t.draworder),K!=null){for(var f=new wa(K.length),Z=r.slots.length,d=0,G=0;G<K.length;G++){var Q=K[G],nt=null,J=this.getValue(Q,"offsets",null);if(J!=null){nt=Y.newArray(Z,-1);for(var it=Y.newArray(Z-J.length,0),st=0,ot=0,p=0;p<J.length;p++){var pt=J[p],h=r.findSlotIndex(pt.slot);if(h==-1)throw new Error("Slot not found: "+pt.slot);for(;st!=h;)it[ot++]=st++;nt[st+pt.offset]=st++}for(;st<Z;)it[ot++]=st++;for(var p=Z-1;p>=0;p--)nt[p]==-1&&(nt[p]=it[--ot])}f.setFrame(d++,this.getValue(Q,"time",0),nt)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}if(t.events){for(var f=new Sl(t.events.length),d=0,p=0;p<t.events.length;p++){var ct=t.events[p],lt=r.findEvent(ct.name);if(lt==null)throw new Error("Event not found: "+ct.name);var Pt=new yd(Y.toSinglePrecision(this.getValue(ct,"time",0)),lt);Pt.intValue=this.getValue(ct,"int",lt.intValue),Pt.floatValue=this.getValue(ct,"float",lt.floatValue),Pt.stringValue=this.getValue(ct,"string",lt.stringValue),Pt.data.audioPath!=null&&(Pt.volume=this.getValue(ct,"volume",1),Pt.balance=this.getValue(ct,"balance",0)),f.setFrame(d++,Pt)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");r.animations.push(new ie(e,a,s))},n.prototype.readCurve=function(t,e,r){if(t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(r);else{var i=t.curve;e.setCurve(r,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}},n.prototype.getValue=function(t,e,r){return t[e]!==void 0?t[e]:r},n.blendModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return at.NORMAL;if(t=="additive")return at.ADD;if(t=="multiply")return at.MULTIPLY;if(t=="screen")return at.SCREEN;throw new Error("Unknown blend mode: "+t)},n.positionModeFromString=function(t){if(t=t.toLowerCase(),t=="fixed")return zt.Fixed;if(t=="percent")return zt.Percent;throw new Error("Unknown position mode: "+t)},n.spacingModeFromString=function(t){if(t=t.toLowerCase(),t=="length")return be.Length;if(t=="fixed")return be.Fixed;if(t=="percent")return be.Percent;throw new Error("Unknown position mode: "+t)},n.rotateModeFromString=function(t){if(t=t.toLowerCase(),t=="tangent")return Qt.Tangent;if(t=="chain")return Qt.Chain;if(t=="chainscale")return Qt.ChainScale;throw new Error("Unknown rotate mode: "+t)},n.transformModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return dt.Normal;if(t=="onlytranslation")return dt.OnlyTranslation;if(t=="norotationorreflection")return dt.NoRotationOrReflection;if(t=="noscale")return dt.NoScale;if(t=="noscaleorreflection")return dt.NoScaleOrReflection;throw new Error("Unknown transform mode: "+t)},n}(),wR=function(){function n(t,e,r,i,a){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritDeform=a}return n}(),SR=function(n){Yt(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createSkeleton=function(e){this.skeleton=new R0(e),this.skeleton.updateWorldTransform(),this.stateData=new M0(e),this.state=new E0(this.stateData)},t}(fo);const ER=Object.freeze(Object.defineProperty({__proto__:null,Animation:ie,AnimationState:E0,AnimationStateAdapter:yR,AnimationStateData:M0,AtlasAttachmentLoader:md,Attachment:ld,AttachmentTimeline:fi,Bone:mf,BoneData:gd,BoundingBoxAttachment:_0,ClippingAttachment:w0,ColorTimeline:Vs,ConstraintData:El,CurveTimeline:jr,DeformTimeline:pd,DrawOrderTimeline:wa,Event:yd,EventData:xd,EventQueue:A0,EventTimeline:Sl,get EventType(){return ze},IkConstraint:P0,IkConstraintData:bd,IkConstraintTimeline:zs,JitterEffect:mR,MeshAttachment:wl,PathAttachment:Us,PathConstraint:I0,PathConstraintData:_d,PathConstraintMixTimeline:Ys,PathConstraintPositionTimeline:Ra,PathConstraintSpacingTimeline:vd,PointAttachment:S0,RegionAttachment:cd,RotateTimeline:nr,ScaleTimeline:fd,ShearTimeline:dd,Skeleton:R0,SkeletonBinary:F0,SkeletonBounds:_R,SkeletonData:wd,SkeletonJson:O0,Skin:$h,SkinEntry:gf,Slot:ud,SlotData:Sd,get SpacingMode(){return be},Spine:SR,SwirlEffect:gR,get TimelineType(){return Ie},TrackEntry:T0,TransformConstraint:C0,TransformConstraintData:Ed,TransformConstraintTimeline:Gs,TranslateTimeline:Mi,TwoColorTimeline:Xs,VertexAttachment:Ni},Symbol.toStringTag,{value:"Module"}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yf=function(n,t){return yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},yf(n,t)};function se(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");yf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Td=function(){function n(t){if(t==null)throw new Error("name cannot be null.");this.name=t}return n}(),ki=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.id=(t.nextID++&65535)<<11,r.worldVerticesLength=0,r}return t.prototype.computeWorldVerticesOld=function(e,r){this.computeWorldVertices(e,0,this.worldVerticesLength,r,0,2)},t.prototype.computeWorldVertices=function(e,r,i,a,s,o){i=s+(i>>1)*o;var u=e.bone.skeleton,h=e.attachmentVertices,l=this.vertices,c=this.bones;if(c==null){h.length>0&&(l=h);for(var f=e.bone.matrix,d=f.tx,p=f.ty,v=f.a,m=f.c,g=f.b,y=f.d,x=r,b=s;b<i;x+=2,b+=o){var _=l[x],w=l[x+1];a[b]=_*v+w*m+d,a[b+1]=_*g+w*y+p}return}for(var S=0,E=0,T=0;T<r;T+=2){var A=c[S];S+=A+1,E+=A}var P=u.bones;if(h.length==0)for(var b=s,m=E*3;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3){var f=P[c[S]].matrix,_=l[m],w=l[m+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}else for(var N=h,b=s,m=E*3,D=E<<1;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3,D+=2){var f=P[c[S]].matrix,_=l[m]+N[D],w=l[m+1]+N[D+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}},t.prototype.applyDeform=function(e){return this==e},t.nextID=0,t}(Td),B0=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.BoundingBox,r.color=new tt(1,1,1,1),r}return t}(ki),N0=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Clipping,r.color=new tt(.2275,.2275,.8078,1),r}return t}(ki),Ad=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Mesh,r.color=new tt(1,1,1,1),r.inheritDeform=!1,r.tempColor=new tt(0,0,0,0),r}return t.prototype.applyDeform=function(e){return this==e||this.inheritDeform&&this.parentMesh==e},t.prototype.getParentMesh=function(){return this.parentMesh},t.prototype.setParentMesh=function(e){this.parentMesh=e,e!=null&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)},t}(ki),Ws=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Path,r.closed=!1,r.constantSpeed=!1,r.color=new tt(1,1,1,1),r}return t}(ki),k0=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Point,r.color=new tt(.38,.94,0,1),r}return t.prototype.computeWorldPosition=function(e,r){var i=e.matrix;return r.x=this.x*i.a+this.y*i.c+e.worldX,r.y=this.x*i.b+this.y*i.d+e.worldY,r},t.prototype.computeWorldRotation=function(e){var r=e.matrix,i=B.cosDeg(this.rotation),a=B.sinDeg(this.rotation),s=i*r.a+a*r.c,o=i*r.b+a*r.d;return Math.atan2(o,s)*B.radDeg},t}(ki),Md=function(){function n(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new tt,this.darkColor=t.darkColor==null?null:new tt,this.setToSetupPose(),this.blendMode=this.data.blendMode}return n.prototype.getAttachment=function(){return this.attachment},n.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},n.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},n.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},n.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},n}(),Pd=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Region,r.x=0,r.y=0,r.scaleX=1,r.scaleY=1,r.rotation=0,r.width=0,r.height=0,r.color=new tt(1,1,1,1),r.offset=Y.newFloatArray(8),r.uvs=Y.newFloatArray(8),r.tempColor=new tt(1,1,1,1),r}return t.prototype.updateOffset=function(){var e=this.width/this.region.originalWidth*this.scaleX,r=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*e,a=-this.height/2*this.scaleY+this.region.offsetY*r,s=i+this.region.width*e,o=a+this.region.height*r,u=this.rotation*Math.PI/180,h=Math.cos(u),l=Math.sin(u),c=i*h+this.x,f=i*l,d=a*h+this.y,p=a*l,v=s*h+this.x,m=s*l,g=o*h+this.y,y=o*l,x=this.offset;x[t.OX1]=c-p,x[t.OY1]=d+f,x[t.OX2]=c-y,x[t.OY2]=g+f,x[t.OX3]=v-y,x[t.OY3]=g+m,x[t.OX4]=v-p,x[t.OY4]=d+m},t.prototype.setRegion=function(e){this.region=e;var r=this.uvs;e.rotate?(r[2]=e.u,r[3]=e.v2,r[4]=e.u,r[5]=e.v,r[6]=e.u2,r[7]=e.v,r[0]=e.u2,r[1]=e.v2):(r[0]=e.u,r[1]=e.v2,r[2]=e.u,r[3]=e.v,r[4]=e.u2,r[5]=e.v,r[6]=e.u2,r[7]=e.v2)},t.prototype.computeWorldVertices=function(e,r,i,a){var s=this.offset,o=e instanceof Md?e.bone.matrix:e.matrix,u=o.tx,h=o.ty,l=o.a,c=o.c,f=o.b,d=o.d,p=0,v=0;p=s[t.OX1],v=s[t.OY1],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX2],v=s[t.OY2],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX3],v=s[t.OY3],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h,i+=a,p=s[t.OX4],v=s[t.OY4],r[i]=p*l+v*c+u,r[i+1]=p*f+v*d+h},t.OX1=0,t.OY1=1,t.OX2=2,t.OY2=3,t.OX3=4,t.OY3=5,t.OX4=6,t.OY4=7,t.X1=0,t.Y1=1,t.C1R=2,t.C1G=3,t.C1B=4,t.C1A=5,t.U1=6,t.V1=7,t.X2=8,t.Y2=9,t.C2R=10,t.C2G=11,t.C2B=12,t.C2A=13,t.U2=14,t.V2=15,t.X3=16,t.Y3=17,t.C3R=18,t.C3G=19,t.C3B=20,t.C3A=21,t.U3=22,t.V3=23,t.X4=24,t.Y4=25,t.C4R=26,t.C4G=27,t.C4B=28,t.C4A=29,t.U4=30,t.V4=31,t}(Td),TR=function(){function n(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return n.prototype.begin=function(t){},n.prototype.transform=function(t,e,r,i){t.x+=B.randomTriangular(-this.jitterX,this.jitterY),t.y+=B.randomTriangular(-this.jitterX,this.jitterY)},n.prototype.end=function(){},n}(),AR=function(){function n(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return n.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},n.prototype.transform=function(t,e,r,i){var a=this.angle*B.degreesToRadians,s=t.x-this.worldX,o=t.y-this.worldY,u=Math.sqrt(s*s+o*o);if(u<this.radius){var h=n.interpolation.apply(0,a,(this.radius-u)/this.radius),l=Math.cos(h),c=Math.sin(h);t.x=l*s-c*o+this.worldX,t.y=c*s+l*o+this.worldY}},n.prototype.end=function(){},n.interpolation=new b0(2),n}(),_e=function(){function n(t,e,r){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=r}return n.prototype.apply=function(t,e,r,i,a,s,o,u){if(t==null)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,c=h.length;l<c;l++)h[l].apply(t,e,r,a,s,o,u)},n.binarySearch=function(t,e,r){r===void 0&&(r=1);var i=0,a=t.length/r-2;if(a==0)return r;for(var s=a>>>1;;){if(t[(s+1)*r]<=e?i=s+1:a=s,i==a)return(i+1)*r;s=i+a>>>1}},n.linearSearch=function(t,e,r){for(var i=0,a=t.length-r;i<=a;i+=r)if(t[i]>e)return i;return-1},n}(),Ce;(function(n){n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor"})(Ce||(Ce={}));var $r=function(){function n(t){if(t<=0)throw new Error("frameCount must be > 0: "+t);this.curves=Y.newFloatArray((t-1)*n.BEZIER_SIZE)}return n.prototype.getFrameCount=function(){return this.curves.length/n.BEZIER_SIZE+1},n.prototype.setLinear=function(t){this.curves[t*n.BEZIER_SIZE]=n.LINEAR},n.prototype.setStepped=function(t){this.curves[t*n.BEZIER_SIZE]=n.STEPPED},n.prototype.getCurveType=function(t){var e=t*n.BEZIER_SIZE;if(e==this.curves.length)return n.LINEAR;var r=this.curves[e];return r==n.LINEAR?n.LINEAR:r==n.STEPPED?n.STEPPED:n.BEZIER},n.prototype.setCurve=function(t,e,r,i,a){var s=(-e*2+i)*.03,o=(-r*2+a)*.03,u=((e-i)*3+1)*.006,h=((r-a)*3+1)*.006,l=s*2+u,c=o*2+h,f=e*.3+s+u*.16666667,d=r*.3+o+h*.16666667,p=t*n.BEZIER_SIZE,v=this.curves;v[p++]=n.BEZIER;for(var m=f,g=d,y=p+n.BEZIER_SIZE-1;p<y;p+=2)v[p]=m,v[p+1]=g,f+=l,d+=c,l+=u,c+=h,m+=f,g+=d},n.prototype.getCurvePercent=function(t,e){e=B.clamp(e,0,1);var r=this.curves,i=t*n.BEZIER_SIZE,a=r[i];if(a==n.LINEAR)return e;if(a==n.STEPPED)return 0;i++;for(var s=0,o=i,u=i+n.BEZIER_SIZE-1;i<u;i+=2)if(s=r[i],s>=e){var h=void 0,l=void 0;return i==o?(h=0,l=0):(h=r[i-2],l=r[i-1]),l+(r[i+1]-l)*(e-h)/(s-h)}var c=r[i-1];return c+(1-c)*(e-s)/(1-s)},n.LINEAR=0,n.STEPPED=1,n.BEZIER=2,n.BEZIER_SIZE=10*2-1,n}(),_r=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e<<1),r}return t.prototype.getPropertyId=function(){return(Ce.rotate<<24)+this.boneIndex},t.prototype.setFrame=function(e,r,i){e<<=1,this.frames[e]=r,this.frames[e+t.ROTATION]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(i<h[0]){switch(o){case C.setup:l.rotation=l.data.rotation;return;case C.first:var c=l.data.rotation-l.rotation;l.rotation+=(c-(16384-(16384.499999999996-c/360|0))*360)*s}return}if(i>=h[h.length-t.ENTRIES]){var f=h[h.length+t.PREV_ROTATION];switch(o){case C.setup:l.rotation=l.data.rotation+f*s;break;case C.first:case C.replace:f+=l.data.rotation-l.rotation,f-=(16384-(16384.499999999996-f/360|0))*360;case C.add:l.rotation+=f*s}return}var d=_e.binarySearch(h,i,t.ENTRIES),p=h[d+t.PREV_ROTATION],v=h[d],m=this.getCurvePercent((d>>1)-1,1-(i-v)/(h[d+t.PREV_TIME]-v)),g=h[d+t.ROTATION]-p;switch(g=p+(g-(16384-(16384.499999999996-g/360|0))*360)*m,o){case C.setup:l.rotation=l.data.rotation+(g-(16384-(16384.499999999996-g/360|0))*360)*s;break;case C.first:case C.replace:g+=l.data.rotation-l.rotation;case C.add:l.rotation+=(g-(16384-(16384.499999999996-g/360|0))*360)*s}},t.ENTRIES=2,t.PREV_TIME=-2,t.PREV_ROTATION=-1,t.ROTATION=1,t}($r),Hs=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.translate<<24)+this.boneIndex},t.prototype.setFrame=function(e,r,i,a){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.X]=i,this.frames[e+t.Y]=a},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(i<h[0]){switch(o){case C.setup:l.x=l.data.x,l.y=l.data.y;return;case C.first:l.x+=(l.data.x-l.x)*s,l.y+=(l.data.y-l.y)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X],f=h[h.length+t.PREV_Y];else{var d=_e.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c+=(h[d+t.X]-c)*v,f+=(h[d+t.Y]-f)*v}switch(o){case C.setup:l.x=l.data.x+c*s,l.y=l.data.y+f*s;break;case C.first:case C.replace:l.x+=(l.data.x+c-l.x)*s,l.y+=(l.data.y+f-l.y)*s;break;case C.add:l.x+=c*s,l.y+=f*s}},t.ENTRIES=3,t.PREV_TIME=-3,t.PREV_X=-2,t.PREV_Y=-1,t.X=1,t.Y=2,t}($r),L0=function(n){se(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ce.scale<<24)+this.boneIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(i<h[0]){switch(o){case C.setup:l.scaleX=l.data.scaleX,l.scaleY=l.data.scaleY;return;case C.first:l.scaleX+=(l.data.scaleX-l.scaleX)*s,l.scaleY+=(l.data.scaleY-l.scaleY)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X]*l.data.scaleX,f=h[h.length+t.PREV_Y]*l.data.scaleY;else{var d=_e.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c=(c+(h[d+t.X]-c)*v)*l.data.scaleX,f=(f+(h[d+t.Y]-f)*v)*l.data.scaleY}if(s==1)o==C.add?(l.scaleX+=c-l.data.scaleX,l.scaleY+=f-l.data.scaleY):(l.scaleX=c,l.scaleY=f);else{var m=0,g=0;if(u==mt.mixOut)switch(o){case C.setup:m=l.data.scaleX,g=l.data.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-m)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-g)*s;break;case C.first:case C.replace:m=l.scaleX,g=l.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-m)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-g)*s;break;case C.add:m=l.scaleX,g=l.scaleY,l.scaleX=m+(Math.abs(c)*B.signum(m)-l.data.scaleX)*s,l.scaleY=g+(Math.abs(f)*B.signum(g)-l.data.scaleY)*s}else switch(o){case C.setup:m=Math.abs(l.data.scaleX)*B.signum(c),g=Math.abs(l.data.scaleY)*B.signum(f),l.scaleX=m+(c-m)*s,l.scaleY=g+(f-g)*s;break;case C.first:case C.replace:m=Math.abs(l.scaleX)*B.signum(c),g=Math.abs(l.scaleY)*B.signum(f),l.scaleX=m+(c-m)*s,l.scaleY=g+(f-g)*s;break;case C.add:m=B.signum(c),g=B.signum(f),l.scaleX=Math.abs(l.scaleX)*m+(c-Math.abs(l.data.scaleX)*m)*s,l.scaleY=Math.abs(l.scaleY)*g+(f-Math.abs(l.data.scaleY)*g)*s}}},t}(Hs),D0=function(n){se(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ce.shear<<24)+this.boneIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.bones[this.boneIndex];if(i<h[0]){switch(o){case C.setup:l.shearX=l.data.shearX,l.shearY=l.data.shearY;return;case C.first:l.shearX+=(l.data.shearX-l.shearX)*s,l.shearY+=(l.data.shearY-l.shearY)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_X],f=h[h.length+t.PREV_Y];else{var d=_e.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_X],f=h[d+t.PREV_Y];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c=c+(h[d+t.X]-c)*v,f=f+(h[d+t.Y]-f)*v}switch(o){case C.setup:l.shearX=l.data.shearX+c*s,l.shearY=l.data.shearY+f*s;break;case C.first:case C.replace:l.shearX+=(l.data.shearX+c-l.shearX)*s,l.shearY+=(l.data.shearY+f-l.shearY)*s;break;case C.add:l.shearX+=c*s,l.shearY+=f*s}},t}(Hs),xf=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.color<<24)+this.slotIndex},t.prototype.setFrame=function(e,r,i,a,s,o){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.R]=i,this.frames[e+t.G]=a,this.frames[e+t.B]=s,this.frames[e+t.A]=o},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex],l=this.frames;if(i<l[0]){switch(o){case C.setup:h.color.setFromColor(h.data.color);return;case C.first:var c=h.color,f=h.data.color;c.add((f.r-c.r)*s,(f.g-c.g)*s,(f.b-c.b)*s,(f.a-c.a)*s)}return}var d=0,p=0,v=0,m=0;if(i>=l[l.length-t.ENTRIES]){var g=l.length;d=l[g+t.PREV_R],p=l[g+t.PREV_G],v=l[g+t.PREV_B],m=l[g+t.PREV_A]}else{var y=_e.binarySearch(l,i,t.ENTRIES);d=l[y+t.PREV_R],p=l[y+t.PREV_G],v=l[y+t.PREV_B],m=l[y+t.PREV_A];var x=l[y],b=this.getCurvePercent(y/t.ENTRIES-1,1-(i-x)/(l[y+t.PREV_TIME]-x));d+=(l[y+t.R]-d)*b,p+=(l[y+t.G]-p)*b,v+=(l[y+t.B]-v)*b,m+=(l[y+t.A]-m)*b}if(s==1)h.color.set(d,p,v,m);else{var c=h.color;o==C.setup&&c.setFromColor(h.data.color),c.add((d-c.r)*s,(p-c.g)*s,(v-c.b)*s,(m-c.a)*s)}},t.ENTRIES=5,t.PREV_TIME=-5,t.PREV_R=-4,t.PREV_G=-3,t.PREV_B=-2,t.PREV_A=-1,t.R=1,t.G=2,t.B=3,t.A=4,t}($r),bf=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.twoColor<<24)+this.slotIndex},t.prototype.setFrame=function(e,r,i,a,s,o,u,h,l){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.R]=i,this.frames[e+t.G]=a,this.frames[e+t.B]=s,this.frames[e+t.A]=o,this.frames[e+t.R2]=u,this.frames[e+t.G2]=h,this.frames[e+t.B2]=l},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex],l=this.frames;if(i<l[0]){switch(o){case C.setup:h.color.setFromColor(h.data.color),h.darkColor.setFromColor(h.data.darkColor);return;case C.first:var c=h.color,f=h.darkColor,d=h.data.color,p=h.data.darkColor;c.add((d.r-c.r)*s,(d.g-c.g)*s,(d.b-c.b)*s,(d.a-c.a)*s),f.add((p.r-f.r)*s,(p.g-f.g)*s,(p.b-f.b)*s,0)}return}var v=0,m=0,g=0,y=0,x=0,b=0,_=0;if(i>=l[l.length-t.ENTRIES]){var w=l.length;v=l[w+t.PREV_R],m=l[w+t.PREV_G],g=l[w+t.PREV_B],y=l[w+t.PREV_A],x=l[w+t.PREV_R2],b=l[w+t.PREV_G2],_=l[w+t.PREV_B2]}else{var S=_e.binarySearch(l,i,t.ENTRIES);v=l[S+t.PREV_R],m=l[S+t.PREV_G],g=l[S+t.PREV_B],y=l[S+t.PREV_A],x=l[S+t.PREV_R2],b=l[S+t.PREV_G2],_=l[S+t.PREV_B2];var E=l[S],T=this.getCurvePercent(S/t.ENTRIES-1,1-(i-E)/(l[S+t.PREV_TIME]-E));v+=(l[S+t.R]-v)*T,m+=(l[S+t.G]-m)*T,g+=(l[S+t.B]-g)*T,y+=(l[S+t.A]-y)*T,x+=(l[S+t.R2]-x)*T,b+=(l[S+t.G2]-b)*T,_+=(l[S+t.B2]-_)*T}if(s==1)h.color.set(v,m,g,y),h.darkColor.set(x,b,_,1);else{var c=h.color,f=h.darkColor;o==C.setup&&(c.setFromColor(h.data.color),f.setFromColor(h.data.darkColor)),c.add((v-c.r)*s,(m-c.g)*s,(g-c.b)*s,(y-c.a)*s),f.add((x-f.r)*s,(b-f.g)*s,(_-f.b)*s,0)}},t.ENTRIES=8,t.PREV_TIME=-8,t.PREV_R=-7,t.PREV_G=-6,t.PREV_B=-5,t.PREV_A=-4,t.PREV_R2=-3,t.PREV_G2=-2,t.PREV_B2=-1,t.R=1,t.G=2,t.B=3,t.A=4,t.R2=5,t.G2=6,t.B2=7,t}($r),qh=function(){function n(t){this.frames=Y.newFloatArray(t),this.attachmentNames=new Array(t)}return n.prototype.getPropertyId=function(){return(Ce.attachment<<24)+this.slotIndex},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.attachmentNames[t]=r},n.prototype.apply=function(t,e,r,i,a,s,o){var u=t.slots[this.slotIndex];if(o==mt.mixOut&&s==C.setup){var h=u.data.attachmentName;u.setAttachment(h==null?null:t.getAttachment(this.slotIndex,h));return}var l=this.frames;if(r<l[0]){if(s==C.setup||s==C.first){var c=u.data.attachmentName;u.setAttachment(c==null?null:t.getAttachment(this.slotIndex,c))}return}var f=0;r>=l[l.length-1]?f=l.length-1:f=_e.binarySearch(l,r,1)-1;var d=this.attachmentNames[f];t.slots[this.slotIndex].setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))},n}(),wm=null,U0=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e),r.frameVertices=new Array(e),wm==null&&(wm=Y.newFloatArray(64)),r}return t.prototype.getPropertyId=function(){return(Ce.deform<<27)+ +this.attachment.id+this.slotIndex},t.prototype.setFrame=function(e,r,i){this.frames[e]=r,this.frameVertices[e]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex],l=h.getAttachment();if(!(!(l instanceof ki)||!l.applyDeform(this.attachment))){var c=h.attachmentVertices;c.length==0&&(o=C.setup);var f=this.frameVertices,d=f[0].length,p=this.frames;if(i<p[0]){var v=l;switch(o){case C.setup:c.length=0;return;case C.first:if(s==1){c.length=0;break}var m=Y.setArraySize(c,d);if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++)m[y]+=(g[y]-m[y])*s;else{s=1-s;for(var y=0;y<d;y++)m[y]*=s}}return}var x=Y.setArraySize(c,d);if(i>=p[p.length-1]){var b=f[p.length-1];if(s==1)if(o==C.add){var v=l;if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++)x[y]+=b[y]-g[y];else for(var y=0;y<d;y++)x[y]+=b[y]}else Y.arrayCopy(b,0,x,0,d);else switch(o){case C.setup:{var _=l;if(_.bones==null)for(var g=_.vertices,y=0;y<d;y++){var w=g[y];x[y]=w+(b[y]-w)*s}else for(var y=0;y<d;y++)x[y]=b[y]*s;break}case C.first:case C.replace:for(var y=0;y<d;y++)x[y]+=(b[y]-x[y])*s;case C.add:var v=l;if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++)x[y]+=(b[y]-g[y])*s;else for(var y=0;y<d;y++)x[y]+=b[y]*s}return}var S=_e.binarySearch(p,i),E=f[S-1],T=f[S],A=p[S],P=this.getCurvePercent(S-1,1-(i-A)/(p[S-1]-A));if(s==1)if(o==C.add){var v=l;if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++){var M=E[y];x[y]+=M+(T[y]-M)*P-g[y]}else for(var y=0;y<d;y++){var M=E[y];x[y]+=M+(T[y]-M)*P}}else for(var y=0;y<d;y++){var M=E[y];x[y]=M+(T[y]-M)*P}else switch(o){case C.setup:{var R=l;if(R.bones==null)for(var g=R.vertices,y=0;y<d;y++){var M=E[y],w=g[y];x[y]=w+(M+(T[y]-M)*P-w)*s}else for(var y=0;y<d;y++){var M=E[y];x[y]=(M+(T[y]-M)*P)*s}break}case C.first:case C.replace:for(var y=0;y<d;y++){var M=E[y];x[y]+=(M+(T[y]-M)*P-x[y])*s}break;case C.add:var v=l;if(v.bones==null)for(var g=v.vertices,y=0;y<d;y++){var M=E[y];x[y]+=(M+(T[y]-M)*P-g[y])*s}else for(var y=0;y<d;y++){var M=E[y];x[y]+=(M+(T[y]-M)*P)*s}}}},t}($r),V0=function(){function n(t){this.frames=Y.newFloatArray(t),this.events=new Array(t)}return n.prototype.getPropertyId=function(){return Ce.event<<24},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},n.prototype.apply=function(t,e,r,i,a,s,o){if(i!=null){var u=this.frames,h=this.frames.length;if(e>r)this.apply(t,e,Number.MAX_VALUE,i,a,s,o),e=-1;else if(e>=u[h-1])return;if(!(r<u[0])){var l=0;if(e<u[0])l=0;else{l=_e.binarySearch(u,e);for(var c=u[l];l>0&&u[l-1]==c;)l--}for(;l<h&&r>=u[l];l++)i.push(this.events[l])}}},n}(),Zh=function(){function n(t){this.frames=Y.newFloatArray(t),this.drawOrders=new Array(t)}return n.prototype.getPropertyId=function(){return Ce.drawOrder<<24},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.drawOrders[t]=r},n.prototype.apply=function(t,e,r,i,a,s,o){var u=t.drawOrder,h=t.slots;if(o==mt.mixOut&&s==C.setup){Y.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}var l=this.frames;if(r<l[0]){(s==C.setup||s==C.first)&&Y.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}var c=0;r>=l[l.length-1]?c=l.length-1:c=_e.binarySearch(l,r)-1;var f=this.drawOrders[c];if(f==null)Y.arrayCopy(h,0,u,0,h.length);else for(var d=0,p=f.length;d<p;d++)u[d]=h[f[d]]},n}(),_f=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.ikConstraint<<24)+this.ikConstraintIndex},t.prototype.setFrame=function(e,r,i,a,s,o){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.MIX]=i,this.frames[e+t.BEND_DIRECTION]=a,this.frames[e+t.COMPRESS]=s?1:0,this.frames[e+t.STRETCH]=o?1:0},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.ikConstraints[this.ikConstraintIndex];if(i<h[0]){switch(o){case C.setup:l.mix=l.data.mix,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch;return;case C.first:l.mix+=(l.data.mix-l.mix)*s,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}if(i>=h[h.length-t.ENTRIES]){o==C.setup?(l.mix=l.data.mix+(h[h.length+t.PREV_MIX]-l.data.mix)*s,u==mt.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=h[h.length+t.PREV_BEND_DIRECTION],l.compress=h[h.length+t.PREV_COMPRESS]!=0,l.stretch=h[h.length+t.PREV_STRETCH]!=0)):(l.mix+=(h[h.length+t.PREV_MIX]-l.mix)*s,u==mt.mixIn&&(l.bendDirection=h[h.length+t.PREV_BEND_DIRECTION],l.compress=h[h.length+t.PREV_COMPRESS]!=0,l.stretch=h[h.length+t.PREV_STRETCH]!=0));return}var c=_e.binarySearch(h,i,t.ENTRIES),f=h[c+t.PREV_MIX],d=h[c],p=this.getCurvePercent(c/t.ENTRIES-1,1-(i-d)/(h[c+t.PREV_TIME]-d));o==C.setup?(l.mix=l.data.mix+(f+(h[c+t.MIX]-f)*p-l.data.mix)*s,u==mt.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=h[c+t.PREV_BEND_DIRECTION],l.compress=h[c+t.PREV_COMPRESS]!=0,l.stretch=h[c+t.PREV_STRETCH]!=0)):(l.mix+=(f+(h[c+t.MIX]-f)*p-l.mix)*s,u==mt.mixIn&&(l.bendDirection=h[c+t.PREV_BEND_DIRECTION],l.compress=h[c+t.PREV_COMPRESS]!=0,l.stretch=h[c+t.PREV_STRETCH]!=0))},t.ENTRIES=5,t.PREV_TIME=-5,t.PREV_MIX=-4,t.PREV_BEND_DIRECTION=-3,t.PREV_COMPRESS=-2,t.PREV_STRETCH=-1,t.MIX=1,t.BEND_DIRECTION=2,t.COMPRESS=3,t.STRETCH=4,t}($r),wf=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.transformConstraint<<24)+this.transformConstraintIndex},t.prototype.setFrame=function(e,r,i,a,s,o){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.ROTATE]=i,this.frames[e+t.TRANSLATE]=a,this.frames[e+t.SCALE]=s,this.frames[e+t.SHEAR]=o},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.transformConstraints[this.transformConstraintIndex];if(i<h[0]){var c=l.data;switch(o){case C.setup:l.rotateMix=c.rotateMix,l.translateMix=c.translateMix,l.scaleMix=c.scaleMix,l.shearMix=c.shearMix;return;case C.first:l.rotateMix+=(c.rotateMix-l.rotateMix)*s,l.translateMix+=(c.translateMix-l.translateMix)*s,l.scaleMix+=(c.scaleMix-l.scaleMix)*s,l.shearMix+=(c.shearMix-l.shearMix)*s}return}var f=0,d=0,p=0,v=0;if(i>=h[h.length-t.ENTRIES]){var m=h.length;f=h[m+t.PREV_ROTATE],d=h[m+t.PREV_TRANSLATE],p=h[m+t.PREV_SCALE],v=h[m+t.PREV_SHEAR]}else{var g=_e.binarySearch(h,i,t.ENTRIES);f=h[g+t.PREV_ROTATE],d=h[g+t.PREV_TRANSLATE],p=h[g+t.PREV_SCALE],v=h[g+t.PREV_SHEAR];var y=h[g],x=this.getCurvePercent(g/t.ENTRIES-1,1-(i-y)/(h[g+t.PREV_TIME]-y));f+=(h[g+t.ROTATE]-f)*x,d+=(h[g+t.TRANSLATE]-d)*x,p+=(h[g+t.SCALE]-p)*x,v+=(h[g+t.SHEAR]-v)*x}if(o==C.setup){var c=l.data;l.rotateMix=c.rotateMix+(f-c.rotateMix)*s,l.translateMix=c.translateMix+(d-c.translateMix)*s,l.scaleMix=c.scaleMix+(p-c.scaleMix)*s,l.shearMix=c.shearMix+(v-c.shearMix)*s}else l.rotateMix+=(f-l.rotateMix)*s,l.translateMix+=(d-l.translateMix)*s,l.scaleMix+=(p-l.scaleMix)*s,l.shearMix+=(v-l.shearMix)*s},t.ENTRIES=5,t.PREV_TIME=-5,t.PREV_ROTATE=-4,t.PREV_TRANSLATE=-3,t.PREV_SCALE=-2,t.PREV_SHEAR=-1,t.ROTATE=1,t.TRANSLATE=2,t.SCALE=3,t.SHEAR=4,t}($r),Kh=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.pathConstraintPosition<<24)+this.pathConstraintIndex},t.prototype.setFrame=function(e,r,i){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.VALUE]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(i<h[0]){switch(o){case C.setup:l.position=l.data.position;return;case C.first:l.position+=(l.data.position-l.position)*s}return}var c=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_VALUE];else{var f=_e.binarySearch(h,i,t.ENTRIES);c=h[f+t.PREV_VALUE];var d=h[f],p=this.getCurvePercent(f/t.ENTRIES-1,1-(i-d)/(h[f+t.PREV_TIME]-d));c+=(h[f+t.VALUE]-c)*p}o==C.setup?l.position=l.data.position+(c-l.data.position)*s:l.position+=(c-l.position)*s},t.ENTRIES=2,t.PREV_TIME=-2,t.PREV_VALUE=-1,t.VALUE=1,t}($r),X0=function(n){se(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getPropertyId=function(){return(Ce.pathConstraintSpacing<<24)+this.pathConstraintIndex},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(i<h[0]){switch(o){case C.setup:l.spacing=l.data.spacing;return;case C.first:l.spacing+=(l.data.spacing-l.spacing)*s}return}var c=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_VALUE];else{var f=_e.binarySearch(h,i,t.ENTRIES);c=h[f+t.PREV_VALUE];var d=h[f],p=this.getCurvePercent(f/t.ENTRIES-1,1-(i-d)/(h[f+t.PREV_TIME]-d));c+=(h[f+t.VALUE]-c)*p}o==C.setup?l.spacing=l.data.spacing+(c-l.data.spacing)*s:l.spacing+=(c-l.spacing)*s},t}(Kh),Sf=function(n){se(t,n);function t(e){var r=n.call(this,e)||this;return r.frames=Y.newFloatArray(e*t.ENTRIES),r}return t.prototype.getPropertyId=function(){return(Ce.pathConstraintMix<<24)+this.pathConstraintIndex},t.prototype.setFrame=function(e,r,i,a){e*=t.ENTRIES,this.frames[e]=r,this.frames[e+t.ROTATE]=i,this.frames[e+t.TRANSLATE]=a},t.prototype.apply=function(e,r,i,a,s,o,u){var h=this.frames,l=e.pathConstraints[this.pathConstraintIndex];if(i<h[0]){switch(o){case C.setup:l.rotateMix=l.data.rotateMix,l.translateMix=l.data.translateMix;return;case C.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*s,l.translateMix+=(l.data.translateMix-l.translateMix)*s}return}var c=0,f=0;if(i>=h[h.length-t.ENTRIES])c=h[h.length+t.PREV_ROTATE],f=h[h.length+t.PREV_TRANSLATE];else{var d=_e.binarySearch(h,i,t.ENTRIES);c=h[d+t.PREV_ROTATE],f=h[d+t.PREV_TRANSLATE];var p=h[d],v=this.getCurvePercent(d/t.ENTRIES-1,1-(i-p)/(h[d+t.PREV_TIME]-p));c+=(h[d+t.ROTATE]-c)*v,f+=(h[d+t.TRANSLATE]-f)*v}o==C.setup?(l.rotateMix=l.data.rotateMix+(c-l.data.rotateMix)*s,l.translateMix=l.data.translateMix+(f-l.data.translateMix)*s):(l.rotateMix+=(c-l.rotateMix)*s,l.translateMix+=(f-l.translateMix)*s)},t.ENTRIES=3,t.PREV_TIME=-3,t.PREV_ROTATE=-2,t.PREV_TRANSLATE=-1,t.ROTATE=1,t.TRANSLATE=2,t}($r),z0=function(){function n(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new Y0(this),this.propertyIDs=new y0,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new _l(function(){return new G0}),this.data=t}return n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var a=e[r];if(a!=null){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var s=t*a.timeScale;if(a.delay>0){if(a.delay-=s,a.delay>0)continue;s=-a.delay,a.delay=0}var o=a.next;if(o!=null){var u=a.trackLast-o.delay;if(u>=0){for(o.delay=0,o.trackTime=a.timeScale==0?0:(u/a.timeScale+t)*o.timeScale,a.trackTime+=s,this.setCurrent(r,o,!0);o.mixingFrom!=null;)o.mixTime+=t,o=o.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&a.mixingFrom==null){e[r]=null,this.queue.end(a),this.disposeNext(a);continue}if(a.mixingFrom!=null&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for(a.mixingFrom=null,h!=null&&(h.mixingTo=null);h!=null;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=s}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(r==null)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((r.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=r.mixingFrom,r.mixingFrom!=null&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var e=this.events,r=this.tracks,i=!1,a=0,s=r.length;a<s;a++){var o=r[a];if(!(o==null||o.delay>0)){i=!0;var u=a==0?C.first:o.mixBlend,h=o.alpha;o.mixingFrom!=null?h*=this.applyMixingFrom(o,t,u):o.trackTime>=o.trackEnd&&o.next==null&&(h=0);var l=o.animationLast,c=o.getAnimationTime(),f=o.animation.timelines.length,d=o.animation.timelines;if(a==0&&h==1||u==C.add)for(var p=0;p<f;p++)Y.webkit602BugfixHelper(h,u),d[p].apply(t,l,c,e,h,u,mt.mixIn);else{var v=o.timelineMode,m=o.timelinesRotation.length==0;m&&Y.setArraySize(o.timelinesRotation,f<<1,null);for(var g=o.timelinesRotation,p=0;p<f;p++){var y=d[p],x=v[p]==n.SUBSEQUENT?u:C.setup;y instanceof _r?this.applyRotateTimeline(y,t,c,h,x,g,p<<1,m):(Y.webkit602BugfixHelper(h,u),y.apply(t,l,c,e,h,x,mt.mixIn))}}this.queueEvents(o,c),e.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime}}return this.queue.drain(),i},n.prototype.applyMixingFrom=function(t,e,r){var i=t.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,e,r);var a=0;t.mixDuration==0?(a=1,r==C.first&&(r=C.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),r!=C.first&&(r=i.mixBlend));var s=a<i.eventThreshold?this.events:null,o=a<i.attachmentThreshold,u=a<i.drawOrderThreshold,h=i.animationLast,l=i.getAnimationTime(),c=i.animation.timelines.length,f=i.animation.timelines,d=i.alpha*t.interruptAlpha,p=d*(1-a);if(r==C.add)for(var v=0;v<c;v++)f[v].apply(e,h,l,s,p,r,mt.mixOut);else{var m=i.timelineMode,g=i.timelineHoldMix,y=i.timelinesRotation.length==0;y&&Y.setArraySize(i.timelinesRotation,c<<1,null);var x=i.timelinesRotation;i.totalAlpha=0;for(var v=0;v<c;v++){var b=f[v],_=mt.mixOut,w=void 0,S=0;switch(m[v]){case n.SUBSEQUENT:if(!o&&b instanceof qh||!u&&b instanceof Zh)continue;w=r,S=p;break;case n.FIRST:w=C.setup,S=p;break;case n.HOLD:w=C.setup,S=d;break;default:w=C.setup;var E=g[v];S=d*Math.max(0,1-E.mixTime/E.mixDuration);break}i.totalAlpha+=S,b instanceof _r?this.applyRotateTimeline(b,e,l,S,w,x,v<<1,y):(Y.webkit602BugfixHelper(S,r),w==C.setup&&(b instanceof qh?o&&(_=mt.mixOut):b instanceof Zh&&u&&(_=mt.mixOut)),b.apply(e,h,l,s,S,w,_))}}return t.mixDuration>0&&this.queueEvents(i,l),this.events.length=0,i.nextAnimationLast=l,i.nextTrackLast=i.trackTime,a},n.prototype.applyRotateTimeline=function(t,e,r,i,a,s,o,u){if(u&&(s[o]=0),i==1){t.apply(e,0,r,null,1,a,mt.mixIn);return}var h=t,l=h.frames,c=e.bones[h.boneIndex],f=0,d=0;if(r<l[0])switch(a){case C.setup:c.rotation=c.data.rotation;default:return;case C.first:f=c.rotation,d=c.data.rotation}else if(f=a==C.setup?c.data.rotation:c.rotation,r>=l[l.length-_r.ENTRIES])d=c.data.rotation+l[l.length+_r.PREV_ROTATION];else{var p=_e.binarySearch(l,r,_r.ENTRIES),v=l[p+_r.PREV_ROTATION],m=l[p],g=h.getCurvePercent((p>>1)-1,1-(r-m)/(l[p+_r.PREV_TIME]-m));d=l[p+_r.ROTATION]-v,d-=(16384-(16384.499999999996-d/360|0))*360,d=v+d*g+c.data.rotation,d-=(16384-(16384.499999999996-d/360|0))*360}var y=0,x=d-f;if(x-=(16384-(16384.499999999996-x/360|0))*360,x==0)y=s[o];else{var b=0,_=0;u?(b=0,_=x):(b=s[o],_=s[o+1]);var w=x>0,S=b>=0;B.signum(_)!=B.signum(x)&&Math.abs(_)<=90&&(Math.abs(b)>180&&(b+=360*B.signum(b)),S=w),y=x+b-b%360,S!=w&&(y+=360*B.signum(b)),s[o]=y}s[o+1]=x,f+=y*i,c.rotation=f-(16384-(16384.499999999996-f/360|0))*360},n.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,a=i-r,s=t.trackLast%a,o=this.events,u=0,h=o.length;u<h;u++){var l=o[u];if(l.time<s)break;l.time>i||this.queue.event(t,l)}var c=!1;for(t.loop?c=a==0||s>t.trackTime%a:c=e>=i&&t.animationLast<i,c&&this.queue.complete(t);u<h;u++){var f=o[u];f.time<r||this.queue.event(t,o[u])}},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(e!=null){this.queue.end(e),this.disposeNext(e);for(var r=e;;){var i=r.mixingFrom;if(i==null)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,i!=null&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,r){var i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},n.prototype.setAnimationWith=function(t,e,r){if(e==null)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);a!=null&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,i=!1):this.disposeNext(a));var s=this.trackEntry(t,e,r,a);return this.setCurrent(t,s,i),this.queue.drain(),s},n.prototype.addAnimation=function(t,e,r,i){var a=this.data.skeletonData.findAnimation(e);if(a==null)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,r,i)},n.prototype.addAnimationWith=function(t,e,r,i){if(e==null)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(a!=null)for(;a.next!=null;)a=a.next;var s=this.trackEntry(t,e,r,a);if(a==null)this.setCurrent(t,s,!0),this.queue.drain();else if(a.next=s,i<=0){var o=a.animationEnd-a.animationStart;o!=0?(a.loop?i+=o*(1+(a.trackTime/o|0)):i+=Math.max(o,a.trackTime),i-=this.data.getMix(a.animation,e)):i=a.trackTime}return s.delay=i,s},n.prototype.setEmptyAnimation=function(t,e){var r=this.setAnimationWith(t,n.emptyAnimation,!1);return r.mixDuration=e,r.trackEnd=e,r},n.prototype.addEmptyAnimation=function(t,e,r){r<=0&&(r-=e);var i=this.addAnimationWith(t,n.emptyAnimation,!1,r);return i.mixDuration=e,i.trackEnd=e,i},n.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var a=this.tracks[r];a!=null&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(Y.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)},n.prototype.trackEntry=function(t,e,r,i){var a=this.trackEntryPool.obtain();return a.trackIndex=t,a.animation=e,a.loop=r,a.holdPrevious=!1,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.interruptAlpha=1,a.mixTime=0,a.mixDuration=i==null?0:this.data.getMix(i.animation,e),a},n.prototype.disposeNext=function(t){for(var e=t.next;e!=null;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var t=0,e=this.tracks.length;t<e;t++){var r=this.tracks[t];if(r!=null){for(;r.mixingFrom!=null;)r=r.mixingFrom;do(r.mixingFrom==null||r.mixBlend!=C.add)&&this.setTimelineModes(r),r=r.mixingTo;while(r!=null)}}},n.prototype.setTimelineModes=function(t){var e=t.mixingTo,r=t.animation.timelines,i=t.animation.timelines.length,a=Y.setArraySize(t.timelineMode,i);t.timelineHoldMix.length=0;var s=Y.setArraySize(t.timelineHoldMix,i),o=this.propertyIDs;if(e!=null&&e.holdPrevious){for(var u=0;u<i;u++)o.add(r[u].getPropertyId()),a[u]=n.HOLD;return}t:for(var u=0;u<i;u++){var h=r[u].getPropertyId();if(!o.add(h))a[u]=n.SUBSEQUENT;else if(e==null||!this.hasTimeline(e,h))a[u]=n.FIRST;else{for(var l=e.mixingTo;l!=null;l=l.mixingTo)if(!this.hasTimeline(l,h)){if(t.mixDuration>0){a[u]=n.HOLD_MIX,s[u]=l;continue t}break}a[u]=n.HOLD}}},n.prototype.hasTimeline=function(t,e){for(var r=t.animation.timelines,i=0,a=r.length;i<a;i++)if(r[i].getPropertyId()==e)return!0;return!1},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.prototype.setAnimationByName=function(t,e,r){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,r)},n.prototype.addAnimationByName=function(t,e,r,i){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,r,i)},n.prototype.hasAnimation=function(t){var e=this.data.skeletonData.findAnimation(t);return e!==null},n.prototype.hasAnimationByName=function(t){return n.deprecatedWarning3||(n.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},n.emptyAnimation=new _e("<empty>",[],0),n.SUBSEQUENT=0,n.FIRST=1,n.HOLD=2,n.HOLD_MIX=3,n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n.deprecatedWarning3=!1,n}(),G0=function(){function n(){this.mixBlend=C.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return n.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},n.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},n.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},n.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},n.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(n.prototype,"time",{get:function(){return n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endTime",{get:function(){return n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),n.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n}(),Y0=function(){function n(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return n.prototype.start=function(t){this.objects.push(Ge.start),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.interrupt=function(t){this.objects.push(Ge.interrupt),this.objects.push(t)},n.prototype.end=function(t){this.objects.push(Ge.end),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.dispose=function(t){this.objects.push(Ge.dispose),this.objects.push(t)},n.prototype.complete=function(t){this.objects.push(Ge.complete),this.objects.push(t)},n.prototype.event=function(t,e){this.objects.push(Ge.event),this.objects.push(t),this.objects.push(e)},n.prototype.deprecateStuff=function(){return n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},n.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],a=t[r+1];switch(i){case Ge.start:a.listener!=null&&a.listener.start&&a.listener.start(a);for(var s=0;s<e.length;s++)e[s].start&&e[s].start(a);a.onStart&&this.deprecateStuff()&&a.onStart(a.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(a.trackIndex);break;case Ge.interrupt:a.listener!=null&&a.listener.interrupt&&a.listener.interrupt(a);for(var s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(a);break;case Ge.end:a.listener!=null&&a.listener.end&&a.listener.end(a);for(var s=0;s<e.length;s++)e[s].end&&e[s].end(a);a.onEnd&&this.deprecateStuff()&&a.onEnd(a.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(a.trackIndex);case Ge.dispose:a.listener!=null&&a.listener.dispose&&a.listener.dispose(a);for(var s=0;s<e.length;s++)e[s].dispose&&e[s].dispose(a);this.animState.trackEntryPool.free(a);break;case Ge.complete:a.listener!=null&&a.listener.complete&&a.listener.complete(a);for(var s=0;s<e.length;s++)e[s].complete&&e[s].complete(a);var o=B.toInt(a.loopsCount());a.onComplete&&this.deprecateStuff()&&a.onComplete(a.trackIndex,o),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(a.trackIndex,o);break;case Ge.event:var u=t[r+++2];a.listener!=null&&a.listener.event&&a.listener.event(a,u);for(var s=0;s<e.length;s++)e[s].event&&e[s].event(a,u);a.onEvent&&this.deprecateStuff()&&a.onEvent(a.trackIndex,u),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(a.trackIndex,u);break}}this.clear(),this.drainDisabled=!1}},n.prototype.clear=function(){this.objects.length=0},n.deprecatedWarning1=!1,n}(),Ge;(function(n){n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event"})(Ge||(Ge={}));var MR=function(){function n(){}return n.prototype.start=function(t){},n.prototype.interrupt=function(t){},n.prototype.end=function(t){},n.prototype.dispose=function(t){},n.prototype.complete=function(t){},n.prototype.event=function(t,e){},n}(),W0=function(){function n(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return n.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(i==null)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(a==null)throw new Error("Animation not found: "+e);this.setMixWith(i,a,r)},n.prototype.setMixByName=function(t,e,r){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,r)},n.prototype.setMixWith=function(t,e,r){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},n.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return i===void 0?this.defaultMix:i},n.deprecatedWarning1=!1,n}(),H0=function(){function n(t){this.atlas=t}return n.prototype.newRegionAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(i==null)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");var a=new Pd(e);return a.region=i,a},n.prototype.newMeshAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(i==null)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");var a=new Ad(e);return a.region=i,a},n.prototype.newBoundingBoxAttachment=function(t,e){return new B0(e)},n.prototype.newPathAttachment=function(t,e){return new Ws(e)},n.prototype.newPointAttachment=function(t,e){return new k0(e)},n.prototype.newClippingAttachment=function(t,e){return new N0(e)},n}(),Ef=function(){function n(t,e,r){if(this.matrix=new te,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(n.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},n.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},n.prototype.updateWorldTransformWith=function(t,e,r,i,a,s,o){this.ax=t,this.ay=e,this.arotation=r,this.ascaleX=i,this.ascaleY=a,this.ashearX=s,this.ashearY=o,this.appliedValid=!0;var u=this.parent,h=this.matrix,l=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(u==null){var f=this.skeleton,d=r+90+o;h.a=B.cosDeg(r+s)*i*l,h.c=B.cosDeg(d)*a*l,h.b=B.sinDeg(r+s)*i*c,h.d=B.sinDeg(d)*a*c,h.tx=t*l+f.x,h.ty=e*c+f.y;return}var p=u.matrix.a,v=u.matrix.c,m=u.matrix.b,g=u.matrix.d;switch(h.tx=p*t+v*e+u.matrix.tx,h.ty=m*t+g*e+u.matrix.ty,this.data.transformMode){case dt.Normal:{var d=r+90+o,y=B.cosDeg(r+s)*i,x=B.cosDeg(d)*a,b=B.sinDeg(r+s)*i,_=B.sinDeg(d)*a;h.a=p*y+v*b,h.c=p*x+v*_,h.b=m*y+g*b,h.d=m*x+g*_;return}case dt.OnlyTranslation:{var d=r+90+o;h.a=B.cosDeg(r+s)*i,h.c=B.cosDeg(d)*a,h.b=B.sinDeg(r+s)*i,h.d=B.sinDeg(d)*a;break}case dt.NoRotationOrReflection:{var w=p*p+m*m,S=0;w>1e-4?(w=Math.abs(p*g-v*m)/w,v=m*w,g=p*w,S=Math.atan2(m,p)*B.radDeg):(p=0,m=0,S=90-Math.atan2(g,v)*B.radDeg);var E=r+s-S,T=r+o-S+90,y=B.cosDeg(E)*i,x=B.cosDeg(T)*a,b=B.sinDeg(E)*i,_=B.sinDeg(T)*a;h.a=p*y-v*b,h.c=p*x-v*_,h.b=m*y+g*b,h.d=m*x+g*_;break}case dt.NoScale:case dt.NoScaleOrReflection:{var A=B.cosDeg(r),P=B.sinDeg(r),M=(p*A+v*P)/l,R=(m*A+g*P)/c,w=Math.sqrt(M*M+R*R);w>1e-5&&(w=1/w),M*=w,R*=w,w=Math.sqrt(M*M+R*R),this.data.transformMode==dt.NoScale&&p*g-v*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(w=-w);var F=Math.PI/2+Math.atan2(R,M),N=Math.cos(F)*w,D=Math.sin(F)*w,y=B.cosDeg(s)*i,x=B.cosDeg(90+o)*a,b=B.sinDeg(s)*i,_=B.sinDeg(90+o)*a;h.a=M*y+N*b,h.c=M*x+N*_,h.b=R*y+D*b,h.d=R*x+D*_;break}}h.a*=l,h.c*=l,h.b*=c,h.d*=c},n.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},n.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},n.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},n.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)},n.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)},n.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg;return}var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),a=e.tx-r.tx,s=e.ty-r.ty;this.ax=a*r.d*i-s*r.c*i,this.ay=s*r.a*i-a*r.b*i;var o=i*r.d,u=i*r.a,h=i*r.c,l=i*r.b,c=o*e.a-h*e.b,f=o*e.c-h*e.d,d=u*e.b-l*e.a,p=u*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){var v=c*p-f*d;this.ascaleY=v/this.ascaleX,this.ashearY=Math.atan2(c*f+d*p,v)*B.radDeg,this.arotation=Math.atan2(d,c)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,f)*B.radDeg},n.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=1/(r*s-i*a),u=t.x-e.tx,h=t.y-e.ty;return t.x=u*s*o-h*i*o,t.y=h*r*o-u*a*o,t},n.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},n.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},n.prototype.localToWorldRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},n.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=B.cosDeg(t),u=B.sinDeg(t);e.a=o*r-u*a,e.c=o*i-u*s,e.b=u*r+o*a,e.d=u*i+o*s,this.appliedValid=!1},n}(),j0=function(){function n(t,e,r){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=dt.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=r}return n}(),$0=function(){function n(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}return n}(),q0=function(){function n(t){this.name=t}return n}(),Z0=function(){function n(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return n.prototype.getOrder=function(){return this.data.order},n.prototype.apply=function(){this.update()},n.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}},n.prototype.apply1=function(t,e,r,i,a,s,o){t.appliedValid||t.updateAppliedTransform();var u=t.parent.matrix,h=1/(u.a*u.d-u.b*u.c),l=e-u.tx,c=r-u.ty,f=(l*u.d-c*u.c)*h-t.ax,d=(c*u.a-l*u.b)*h-t.ay,p=Math.atan2(d,f)*B.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(p+=180),p>180?p-=360:p<-180&&(p+=360);var v=t.ascaleX,m=t.ascaleY;if(i||a){var g=t.data.length*v,y=Math.sqrt(f*f+d*d);if(i&&y<g||a&&y>g&&g>1e-4){var x=(y/g-1)*o+1;v*=x,s&&(m*=x)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+p*o,v,m,t.ashearX,t.ashearY)},n.prototype.apply2=function(t,e,r,i,a,s,o){if(o==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var u=t.ax,h=t.ay,l=t.ascaleX,c=l,f=t.ascaleY,d=e.ascaleX,p=t.matrix,v=0,m=0,g=0;l<0?(l=-l,v=180,g=-1):(v=0,g=1),f<0&&(f=-f,g=-g),d<0?(d=-d,m=180):m=0;var y=e.ax,x=0,b=0,_=0,w=p.a,S=p.c,E=p.b,T=p.d,A=Math.abs(l-f)<=1e-4;A?(x=e.ay,b=w*y+S*x+p.tx,_=E*y+T*x+p.ty):(x=0,b=w*y+p.tx,_=E*y+p.ty);var P=t.parent.matrix;w=P.a,S=P.c,E=P.b,T=P.d;var M=1/(w*T-S*E),R=r-P.tx,F=i-P.ty,N=(R*T-F*S)*M-u,D=(F*w-R*E)*M-h,X=N*N+D*D;R=b-P.tx,F=_-P.ty;var q=(R*T-F*S)*M-u,W=(F*w-R*E)*M-h,L=Math.sqrt(q*q+W*W),U=e.data.length*d,G=0,V=0;t:if(A){U*=l;var O=(X-L*L-U*U)/(2*L*U);O<-1?O=-1:O>1&&(O=1,s&&L+U>1e-4&&(c*=(Math.sqrt(X)/(L+U)-1)*o+1)),V=Math.acos(O)*a,w=L+U*O,S=U*Math.sin(V),G=Math.atan2(D*w-N*S,N*w+D*S)}else{w=l*U,S=f*U;var z=w*w,j=S*S,K=Math.atan2(D,N);E=j*L*L+z*X-z*j;var Z=-2*j*L,Q=j-z;if(T=Z*Z-4*Q*E,T>=0){var nt=Math.sqrt(T);Z<0&&(nt=-nt),nt=-(Z+nt)/2;var J=nt/Q,it=E/nt,st=Math.abs(J)<Math.abs(it)?J:it;if(st*st<=X){F=Math.sqrt(X-st*st)*a,G=K-Math.atan2(F,st),V=Math.atan2(F/f,(st-L)/l);break t}}var ot=B.PI,pt=L-w,ct=pt*pt,lt=0,Pt=0,Ot=L+w,re=Ot*Ot,we=0;E=-w*L/(z-j),E>=-1&&E<=1&&(E=Math.acos(E),R=w*Math.cos(E)+L,F=S*Math.sin(E),T=R*R+F*F,T<ct&&(ot=E,ct=T,pt=R,lt=F),T>re&&(Pt=E,re=T,Ot=R,we=F)),X<=(ct+re)/2?(G=K-Math.atan2(lt*a,pt),V=ot*a):(G=K-Math.atan2(we*a,Ot),V=Pt*a)}var Se=Math.atan2(x,y)*g,Wt=t.arotation;G=(G-Se)*B.radDeg+v-Wt,G>180?G-=360:G<-180&&(G+=360),t.updateWorldTransformWith(u,h,Wt+G*o,c,t.ascaleY,0,0),Wt=e.arotation,V=((V+Se)*B.radDeg-e.ashearX)*g+m-Wt,V>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(y,x,Wt+V*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},n}(),K0=function(){function n(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}return n}(),J0=function(){function n(t){this.order=0,this.bones=new Array,this.name=t}return n}(),lr;(function(n){n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent"})(lr||(lr={}));var Q0=function(){function n(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return n.prototype.apply=function(){this.update()},n.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof Ws){var e=this.rotateMix,r=this.translateMix,i=r>0,a=e>0;if(!(!i&&!a)){var s=this.data,o=s.spacingMode,u=o==lr.Length,h=s.rotateMode,l=h==Qt.Tangent,c=h==Qt.ChainScale,f=this.bones.length,d=l?f:f+1,p=this.bones,v=Y.setArraySize(this.spaces,d),m=null,g=this.spacing;if(c||u){c&&(m=Y.setArraySize(this.lengths,f));for(var y=0,x=d-1;y<x;){var b=p[y],_=b.data.length;if(_<n.epsilon)c&&(m[y]=0),v[++y]=0;else{var w=_*b.matrix.a,S=_*b.matrix.b,E=Math.sqrt(w*w+S*S);c&&(m[y]=E),v[++y]=(u?_+g:g)*E/_}}}else for(var y=1;y<d;y++)v[y]=g;var T=this.computeWorldPositions(t,d,l,s.positionMode==zt.Percent,o==lr.Percent),A=T[0],P=T[1],M=s.offsetRotation,R=!1;if(M==0)R=h==Qt.Chain;else{R=!1;var F=this.target.bone.matrix;M*=F.a*F.d-F.b*F.c>0?B.degRad:-B.degRad}for(var y=0,F=3;y<f;y++,F+=3){var b=p[y],N=b.matrix;N.tx+=(A-N.tx)*r,N.ty+=(P-N.ty)*r;var w=T[F],S=T[F+1],D=w-A,X=S-P;if(c){var q=m[y];if(q!=0){var W=(Math.sqrt(D*D+X*X)/q-1)*e+1;N.a*=W,N.b*=W}}if(A=w,P=S,a){var L=N.a,U=N.c,G=N.b,V=N.d,O=0,z=0,j=0;if(l?O=T[F-1]:v[y+1]==0?O=T[F+2]:O=Math.atan2(X,D),O-=Math.atan2(G,L),R){z=Math.cos(O),j=Math.sin(O);var K=b.data.length;A+=(K*(z*L-j*G)-D)*e,P+=(K*(j*L+z*G)-X)*e}else O+=M;O>B.PI?O-=B.PI2:O<-B.PI&&(O+=B.PI2),O*=e,z=Math.cos(O),j=Math.sin(O),N.a=z*L-j*G,N.c=z*U-j*V,N.b=j*L+z*G,N.d=j*U+z*V}b.appliedValid=!1}}}},n.prototype.computeWorldPositions=function(t,e,r,i,a){var s=this.target,o=this.position,u=this.spaces,h=Y.setArraySize(this.positions,e*3+2),l=null,c=t.closed,f=t.worldVerticesLength,d=f/6,p=n.NONE;if(!t.constantSpeed){var v=t.lengths;d-=c?1:2;var m=v[d];if(i&&(o*=m),a)for(var g=0;g<e;g++)u[g]*=m;l=Y.setArraySize(this.world,8);for(var g=0,y=0,x=0;g<e;g++,y+=3){var b=u[g];o+=b;var _=o;if(c)_%=m,_<0&&(_+=m),x=0;else if(_<0){p!=n.BEFORE&&(p=n.BEFORE,t.computeWorldVertices(s,2,4,l,0,2)),this.addBeforePosition(_,l,0,h,y);continue}else if(_>m){p!=n.AFTER&&(p=n.AFTER,t.computeWorldVertices(s,f-6,4,l,0,2)),this.addAfterPosition(_-m,l,0,h,y);continue}for(;;x++){var w=v[x];if(!(_>w)){if(x==0)_/=w;else{var S=v[x-1];_=(_-S)/(w-S)}break}}x!=p&&(p=x,c&&x==d?(t.computeWorldVertices(s,f-4,4,l,0,2),t.computeWorldVertices(s,0,4,l,4,2)):t.computeWorldVertices(s,x*6+2,8,l,0,2)),this.addCurvePosition(_,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],h,y,r||g>0&&b==0)}return h}c?(f+=2,l=Y.setArraySize(this.world,f),t.computeWorldVertices(s,2,f-4,l,0,2),t.computeWorldVertices(s,0,2,l,f-4,2),l[f-2]=l[0],l[f-1]=l[1]):(d--,f-=4,l=Y.setArraySize(this.world,f),t.computeWorldVertices(s,2,f,l,0,2));for(var E=Y.setArraySize(this.curves,d),T=0,A=l[0],P=l[1],M=0,R=0,F=0,N=0,D=0,X=0,q=0,W=0,L=0,U=0,G=0,V=0,O=0,z=0,g=0,j=2;g<d;g++,j+=6)M=l[j],R=l[j+1],F=l[j+2],N=l[j+3],D=l[j+4],X=l[j+5],q=(A-M*2+F)*.1875,W=(P-R*2+N)*.1875,L=((M-F)*3-A+D)*.09375,U=((R-N)*3-P+X)*.09375,G=q*2+L,V=W*2+U,O=(M-A)*.75+q+L*.16666667,z=(R-P)*.75+W+U*.16666667,T+=Math.sqrt(O*O+z*z),O+=G,z+=V,G+=L,V+=U,T+=Math.sqrt(O*O+z*z),O+=G,z+=V,T+=Math.sqrt(O*O+z*z),O+=G+L,z+=V+U,T+=Math.sqrt(O*O+z*z),E[g]=T,A=D,P=X;if(i&&(o*=T),a)for(var g=0;g<e;g++)u[g]*=T;for(var K=this.segments,Z=0,g=0,y=0,x=0,Q=0;g<e;g++,y+=3){var b=u[g];o+=b;var _=o;if(c)_%=T,_<0&&(_+=T),x=0;else if(_<0){this.addBeforePosition(_,l,0,h,y);continue}else if(_>T){this.addAfterPosition(_-T,l,f-4,h,y);continue}for(;;x++){var nt=E[x];if(!(_>nt)){if(x==0)_/=nt;else{var S=E[x-1];_=(_-S)/(nt-S)}break}}if(x!=p){p=x;var J=x*6;for(A=l[J],P=l[J+1],M=l[J+2],R=l[J+3],F=l[J+4],N=l[J+5],D=l[J+6],X=l[J+7],q=(A-M*2+F)*.03,W=(P-R*2+N)*.03,L=((M-F)*3-A+D)*.006,U=((R-N)*3-P+X)*.006,G=q*2+L,V=W*2+U,O=(M-A)*.3+q+L*.16666667,z=(R-P)*.3+W+U*.16666667,Z=Math.sqrt(O*O+z*z),K[0]=Z,J=1;J<8;J++)O+=G,z+=V,G+=L,V+=U,Z+=Math.sqrt(O*O+z*z),K[J]=Z;O+=G,z+=V,Z+=Math.sqrt(O*O+z*z),K[8]=Z,O+=G+L,z+=V+U,Z+=Math.sqrt(O*O+z*z),K[9]=Z,Q=0}for(_*=Z;;Q++){var it=K[Q];if(!(_>it)){if(Q==0)_/=it;else{var S=K[Q-1];_=Q+(_-S)/(it-S)}break}}this.addCurvePosition(_*.1,A,P,M,R,F,N,D,X,h,y,r||g>0&&b==0)}return h},n.prototype.addBeforePosition=function(t,e,r,i,a){var s=e[r],o=e[r+1],u=e[r+2]-s,h=e[r+3]-o,l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addAfterPosition=function(t,e,r,i,a){var s=e[r+2],o=e[r+3],u=s-e[r],h=o-e[r+1],l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addCurvePosition=function(t,e,r,i,a,s,o,u,h,l,c,f){(t==0||isNaN(t))&&(t=1e-4);var d=t*t,p=d*t,v=1-t,m=v*v,g=m*v,y=v*t,x=y*3,b=v*x,_=x*t,w=e*g+i*b+s*_+u*p,S=r*g+a*b+o*_+h*p;l[c]=w,l[c+1]=S,f&&(l[c+2]=Math.atan2(S-(r*m+a*y*2+o*d),w-(e*m+i*y*2+s*d)))},n.prototype.getOrder=function(){return this.data.order},n.NONE=-1,n.BEFORE=-2,n.AFTER=-3,n.epsilon=1e-5,n}(),tx=function(){function n(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Ds,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return n.prototype.apply=function(){this.update()},n.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},n.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target,s=a.matrix,o=s.a,u=s.c,h=s.b,l=s.d,c=o*l-u*h>0?B.degRad:-B.degRad,f=this.data.offsetRotation*c,d=this.data.offsetShearY*c,p=this.bones,v=0,m=p.length;v<m;v++){var g=p[v],y=!1,x=g.matrix;if(t!=0){var b=x.a,_=x.c,w=x.b,S=x.d,E=Math.atan2(h,o)-Math.atan2(w,b)+f;E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E*=t;var T=Math.cos(E),A=Math.sin(E);x.a=T*b-A*w,x.c=T*_-A*S,x.b=A*b+T*w,x.d=A*_+T*S,y=!0}if(e!=0){var P=this.temp;a.localToWorld(P.set(this.data.offsetX,this.data.offsetY)),x.tx+=(P.x-x.tx)*e,x.ty+=(P.y-x.ty)*e,y=!0}if(r>0){var M=Math.sqrt(x.a*x.a+x.b*x.b),R=Math.sqrt(o*o+h*h);M>1e-5&&(M=(M+(R-M+this.data.offsetScaleX)*r)/M),x.a*=M,x.b*=M,M=Math.sqrt(x.c*x.c+x.d*x.d),R=Math.sqrt(u*u+l*l),M>1e-5&&(M=(M+(R-M+this.data.offsetScaleY)*r)/M),x.c*=M,x.d*=M,y=!0}if(i>0){var _=x.c,S=x.d,F=Math.atan2(S,_),E=Math.atan2(l,u)-Math.atan2(h,o)-(F-Math.atan2(x.b,x.a));E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E=F+(E+d)*i;var M=Math.sqrt(_*_+S*S);x.c=Math.cos(E)*M,x.d=Math.sin(E)*M,y=!0}y&&(g.appliedValid=!1)}},n.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target,s=a.matrix,o=s.a,u=s.c,h=s.b,l=s.d,c=o*l-u*h>0?B.degRad:-B.degRad,f=this.data.offsetRotation*c,d=this.data.offsetShearY*c,p=this.bones,v=0,m=p.length;v<m;v++){var g=p[v],y=!1,x=g.matrix;if(t!=0){var b=x.a,_=x.c,w=x.b,S=x.d,E=Math.atan2(h,o)+f;E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2),E*=t;var T=Math.cos(E),A=Math.sin(E);x.a=T*b-A*w,x.c=T*_-A*S,x.b=A*b+T*w,x.d=A*_+T*S,y=!0}if(e!=0){var P=this.temp;a.localToWorld(P.set(this.data.offsetX,this.data.offsetY)),x.tx+=P.x*e,x.ty+=P.y*e,y=!0}if(r>0){var M=(Math.sqrt(o*o+h*h)-1+this.data.offsetScaleX)*r+1;x.a*=M,x.b*=M,M=(Math.sqrt(u*u+l*l)-1+this.data.offsetScaleY)*r+1,x.c*=M,x.d*=M,y=!0}if(i>0){var E=Math.atan2(l,u)-Math.atan2(h,o);E>B.PI?E-=B.PI2:E<-B.PI&&(E+=B.PI2);var _=x.c,S=x.d;E=Math.atan2(S,_)+(E-B.PI/2+d)*i;var M=Math.sqrt(_*_+S*S);x.c=Math.cos(E)*M,x.d=Math.sin(E)*M,y=!0}y&&(g.appliedValid=!1)}},n.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,o=0,u=s.length;o<u;o++){var h=s[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;if(t!=0){var c=a.arotation-l+this.data.offsetRotation;c-=(16384-(16384.499999999996-c/360|0))*360,l+=c*t}var f=h.ax,d=h.ay;e!=0&&(f+=(a.ax-f+this.data.offsetX)*e,d+=(a.ay-d+this.data.offsetY)*e);var p=h.ascaleX,v=h.ascaleY;r>0&&(p>1e-5&&(p=(p+(a.ascaleX-p+this.data.offsetScaleX)*r)/p),v>1e-5&&(v=(v+(a.ascaleY-v+this.data.offsetScaleY)*r)/v));var m=h.ashearY;if(i>0){var c=a.ashearY-m+this.data.offsetShearY;c-=(16384-(16384.499999999996-c/360|0))*360,h.shearY+=c*i}h.updateWorldTransformWith(f,d,l,p,v,h.ashearX,m)}},n.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,o=0,u=s.length;o<u;o++){var h=s[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;t!=0&&(l+=(a.arotation+this.data.offsetRotation)*t);var c=h.ax,f=h.ay;e!=0&&(c+=(a.ax+this.data.offsetX)*e,f+=(a.ay+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;r>0&&(d>1e-5&&(d*=(a.ascaleX-1+this.data.offsetScaleX)*r+1),p>1e-5&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*r+1));var v=h.ashearY;i>0&&(v+=(a.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(c,f,l,d,p,h.ashearX,v)}},n.prototype.getOrder=function(){return this.data.order},n}(),ex=function(){function n(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(r.parent==null)i=new Ef(r,this,null);else{var a=this.bones[r.parent.index];i=new Ef(r,this,a),a.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var e=0;e<t.slots.length;e++){var s=t.slots[e],i=this.bones[s.boneData.index],o=new Md(s,i);this.slots.push(o),this.drawOrder.push(o)}this.ikConstraints=new Array;for(var e=0;e<t.ikConstraints.length;e++){var u=t.ikConstraints[e];this.ikConstraints.push(new Z0(u,this))}this.transformConstraints=new Array;for(var e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new tx(h,this))}this.pathConstraints=new Array;for(var e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new Q0(l,this))}this.color=new tt(1,1,1,1),this.updateCache()}return n.prototype.updateCache=function(){var t=this._updateCache;t.length=0,this.updateCacheReset.length=0;for(var e=this.bones,r=0,i=e.length;r<i;r++)e[r].sorted=!1;var a=this.ikConstraints,s=this.transformConstraints,o=this.pathConstraints,u=a.length,h=s.length,l=o.length,c=u+h+l;t:for(var r=0;r<c;r++){for(var f=0;f<u;f++){var d=a[f];if(d.data.order==r){this.sortIkConstraint(d);continue t}}for(var f=0;f<h;f++){var d=s[f];if(d.data.order==r){this.sortTransformConstraint(d);continue t}}for(var f=0;f<l;f++){var d=o[f];if(d.data.order==r){this.sortPathConstraint(d);continue t}}}for(var r=0,i=e.length;r<i;r++)this.sortBone(e[r])},n.prototype.sortIkConstraint=function(t){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),r.length>1){var a=r[r.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(t),this.sortReset(i.children),r[r.length-1].sorted=!0},n.prototype.sortPathConstraint=function(t){var e=t.target,r=e.data.index,i=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,r,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],r,i);var o=e.getAttachment();o instanceof Ws&&this.sortPathConstraintAttachmentWith(o,i);for(var u=t.bones,h=u.length,a=0;a<h;a++)this.sortBone(u[a]);this._updateCache.push(t);for(var a=0;a<h;a++)this.sortReset(u[a].children);for(var a=0;a<h;a++)u[a].sorted=!0},n.prototype.sortTransformConstraint=function(t){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var a=e[i];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(var i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var s=0;s<r;s++)this.sortReset(e[s].children);for(var s=0;s<r;s++)e[s].sorted=!0},n.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],r)},n.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof Ws){var r=t.bones;if(r==null)this.sortBone(e);else for(var i=this.bones,a=0;a<r.length;)for(var s=r[a++],o=a+s;a<o;a++){var u=r[a];this.sortBone(i[u])}}},n.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},n.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.sorted&&this.sortReset(i.children),i.sorted=!1}},n.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}for(var a=this._updateCache,e=0,r=a.length;e<r;e++)a[e].update()},n.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},n.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();for(var i=this.ikConstraints,e=0,r=i.length;e<r;e++){var a=i[e];a.bendDirection=a.data.bendDirection,a.mix=a.data.mix}for(var s=this.transformConstraints,e=0,r=s.length;e<r;e++){var a=s[e],o=a.data;a.rotateMix=o.rotateMix,a.translateMix=o.translateMix,a.scaleMix=o.scaleMix,a.shearMix=o.shearMix}for(var u=this.pathConstraints,e=0,r=u.length;e<r;e++){var a=u[e],o=a.data;a.position=o.position,a.spacing=o.spacing,a.rotateMix=o.rotateMix,a.translateMix=o.translateMix}},n.prototype.setSlotsToSetupPose=function(){var t=this.slots;Y.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},n.prototype.getRootBone=function(){return this.bones.length==0?null:this.bones[0]},n.prototype.findBone=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.findSlot=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(e==null)throw new Error("Skin not found: "+t);this.setSkin(e)},n.prototype.setSkin=function(t){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r],s=a.data.attachmentName;if(s!=null){var o=t.getAttachment(r,s);o!=null&&a.setAttachment(o)}}this.skin=t},n.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},n.prototype.getAttachment=function(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){var r=this.skin.getAttachment(t,e);if(r!=null)return r}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null},n.prototype.setAttachment=function(t,e){if(t==null)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,a=r.length;i<a;i++){var s=r[i];if(s.data.name==t){var o=null;if(e!=null&&(o=this.getAttachment(i,e),o==null))throw new Error("Attachment not found: "+e+", for slot: "+t);s.setAttachment(o);return}}throw new Error("Slot not found: "+t)},n.prototype.findIkConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.getBounds=function(t,e,r){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var c=i[h],f=0,d=null,p=c.getAttachment();if(p instanceof Pd)f=8,d=Y.setArraySize(r,f,0),p.computeWorldVertices(c.bone,d,0,2);else if(p instanceof Ad){var v=p;f=v.worldVerticesLength,d=Y.setArraySize(r,f,0),v.computeWorldVertices(c,0,f,d,0,2)}if(d!=null)for(var m=0,g=d.length;m<g;m+=2){var y=d[m],x=d[m+1];a=Math.min(a,y),s=Math.min(s,x),o=Math.max(o,y),u=Math.max(u,x)}}t.set(a,s),e.set(o-a,u-s)},n.prototype.update=function(t){this.time+=t},Object.defineProperty(n.prototype,"flipX",{get:function(){return this.scaleX==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flipY",{get:function(){return this.scaleY==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1},enumerable:!1,configurable:!0}),n.deprecatedWarning1=!1,n}(),PR=function(n){se(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(hd),rx=function(){function n(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return n.prototype.findBone=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(t==null)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSlot=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(t==null)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSkin=function(t){if(t==null)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findEvent=function(t){if(t==null)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findAnimation=function(t){if(t==null)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findIkConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(t==null)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraintIndex=function(t){if(t==null)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n}(),nx=function(){function n(t,e,r){if(this.color=new tt(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(r==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r}return n}(),ix=function(){function n(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}return n}(),ax=function(){function n(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}return n.prototype.addAttachment=function(t,e,r){if(r==null)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},n.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},n.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var a=t.slots[i],s=a.getAttachment();if(s&&r<e.attachments.length){var o=e.attachments[r];for(var u in o){var h=o[u];if(s==h){var l=this.getAttachment(r,u);l!=null&&a.setAttachment(l);break}}}r++}},n}(),sx=function(){function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return n.prototype.readSkeletonData=function(t){var e=this.scale,r=new rx,i=typeof t=="string"?JSON.parse(t):t,a=i.skeleton;if(a!=null&&(r.hash=a.hash,r.version=a.spine,r.width=a.width,r.height=a.height,r.fps=a.fps,r.imagesPath=a.images),i.bones)for(var s=0;s<i.bones.length;s++){var o=i.bones[s],u=null,h=this.getValue(o,"parent",null);if(h!=null&&(u=r.findBone(h),u==null))throw new Error("Parent bone not found: "+h);var l=new j0(r.bones.length,o.name,u);l.length=this.getValue(o,"length",0)*e,l.x=this.getValue(o,"x",0)*e,l.y=this.getValue(o,"y",0)*e,l.rotation=this.getValue(o,"rotation",0),l.scaleX=this.getValue(o,"scaleX",1),l.scaleY=this.getValue(o,"scaleY",1),l.shearX=this.getValue(o,"shearX",0),l.shearY=this.getValue(o,"shearY",0),l.transformMode=n.transformModeFromString(this.getValue(o,"transform","normal")),r.bones.push(l)}if(i.slots)for(var s=0;s<i.slots.length;s++){var c=i.slots[s],f=c.name,d=c.bone,p=r.findBone(d);if(p==null)throw new Error("Slot bone not found: "+d);var l=new nx(r.slots.length,f,p),v=this.getValue(c,"color",null);v!=null&&l.color.setFromString(v);var m=this.getValue(c,"dark",null);m!=null&&(l.darkColor=new tt(1,1,1,1),l.darkColor.setFromString(m)),l.attachmentName=this.getValue(c,"attachment",null),l.blendMode=n.blendModeFromString(this.getValue(c,"blend","normal")),r.slots.push(l)}if(i.ik)for(var s=0;s<i.ik.length;s++){var g=i.ik[s],l=new K0(g.name);l.order=this.getValue(g,"order",0);for(var y=0;y<g.bones.length;y++){var d=g.bones[y],x=r.findBone(d);if(x==null)throw new Error("IK bone not found: "+d);l.bones.push(x)}var b=g.target;if(l.target=r.findBone(b),l.target==null)throw new Error("IK target bone not found: "+b);l.bendDirection=this.getValue(g,"bendPositive",!0)?1:-1,l.mix=this.getValue(g,"mix",1),r.ikConstraints.push(l)}if(i.transform)for(var s=0;s<i.transform.length;s++){var g=i.transform[s],l=new ix(g.name);l.order=this.getValue(g,"order",0);for(var y=0;y<g.bones.length;y++){var d=g.bones[y],x=r.findBone(d);if(x==null)throw new Error("Transform constraint bone not found: "+d);l.bones.push(x)}var b=g.target;if(l.target=r.findBone(b),l.target==null)throw new Error("Transform constraint target bone not found: "+b);l.local=this.getValue(g,"local",!1),l.relative=this.getValue(g,"relative",!1),l.offsetRotation=this.getValue(g,"rotation",0),l.offsetX=this.getValue(g,"x",0)*e,l.offsetY=this.getValue(g,"y",0)*e,l.offsetScaleX=this.getValue(g,"scaleX",0),l.offsetScaleY=this.getValue(g,"scaleY",0),l.offsetShearY=this.getValue(g,"shearY",0),l.rotateMix=this.getValue(g,"rotateMix",1),l.translateMix=this.getValue(g,"translateMix",1),l.scaleMix=this.getValue(g,"scaleMix",1),l.shearMix=this.getValue(g,"shearMix",1),r.transformConstraints.push(l)}if(i.path)for(var s=0;s<i.path.length;s++){var g=i.path[s],l=new J0(g.name);l.order=this.getValue(g,"order",0);for(var y=0;y<g.bones.length;y++){var d=g.bones[y],x=r.findBone(d);if(x==null)throw new Error("Transform constraint bone not found: "+d);l.bones.push(x)}var b=g.target;if(l.target=r.findSlot(b),l.target==null)throw new Error("Path target slot not found: "+b);l.positionMode=n.positionModeFromString(this.getValue(g,"positionMode","percent")),l.spacingMode=n.spacingModeFromString(this.getValue(g,"spacingMode","length")),l.rotateMode=n.rotateModeFromString(this.getValue(g,"rotateMode","tangent")),l.offsetRotation=this.getValue(g,"rotation",0),l.position=this.getValue(g,"position",0),l.positionMode==zt.Fixed&&(l.position*=e),l.spacing=this.getValue(g,"spacing",0),(l.spacingMode==lr.Length||l.spacingMode==lr.Fixed)&&(l.spacing*=e),l.rotateMix=this.getValue(g,"rotateMix",1),l.translateMix=this.getValue(g,"translateMix",1),r.pathConstraints.push(l)}if(i.skins)for(var _ in i.skins){var w=i.skins[_],S=new ax(_);for(var f in w){var E=r.findSlotIndex(f);if(E==-1)throw new Error("Slot not found: "+f);var c=w[f];for(var T in c){var A=this.readAttachment(c[T],S,E,T,r);A!=null&&S.addAttachment(E,T,A)}}r.skins.push(S),S.name=="default"&&(r.defaultSkin=S)}for(var s=0,P=this.linkedMeshes.length;s<P;s++){var M=this.linkedMeshes[s],S=M.skin==null?r.defaultSkin:r.findSkin(M.skin);if(S==null)throw new Error("Skin not found: "+M.skin);var R=S.getAttachment(M.slotIndex,M.parent);if(R==null)throw new Error("Parent mesh not found: "+M.parent);M.mesh.setParentMesh(R)}if(this.linkedMeshes.length=0,i.events)for(var F in i.events){var N=i.events[F],l=new q0(F);l.intValue=this.getValue(N,"int",0),l.floatValue=this.getValue(N,"float",0),l.stringValue=this.getValue(N,"string",""),l.audioPath=this.getValue(N,"audio",null),l.audioPath!=null&&(l.volume=this.getValue(N,"volume",1),l.balance=this.getValue(N,"balance",0)),r.events.push(l)}if(i.animations)for(var D in i.animations){var X=i.animations[D];this.readAnimation(X,D,r)}return r},n.prototype.readAttachment=function(t,e,r,i,a){var s=this.scale;i=this.getValue(t,"name",i);var o=this.getValue(t,"type","region");switch(o){case"region":{var u=this.getValue(t,"path",i),h=this.attachmentLoader.newRegionAttachment(e,i,u);if(h==null)return null;h.path=u,h.x=this.getValue(t,"x",0)*s,h.y=this.getValue(t,"y",0)*s,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*s,h.height=t.height*s;var l=this.getValue(t,"color",null);return l!=null&&h.color.setFromString(l),h}case"boundingbox":{var c=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(c==null)return null;this.readVertices(t,c,t.vertexCount<<1);var l=this.getValue(t,"color",null);return l!=null&&c.color.setFromString(l),c}case"mesh":case"linkedmesh":{var u=this.getValue(t,"path",i),f=this.attachmentLoader.newMeshAttachment(e,i,u);if(f==null)return null;f.path=u;var l=this.getValue(t,"color",null);l!=null&&f.color.setFromString(l);var d=this.getValue(t,"parent",null);if(d!=null)return f.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new IR(f,this.getValue(t,"skin",null),r,d)),f;var p=t.uvs;return this.readVertices(t,f,p.length),f.triangles=t.triangles,f.regionUVs=new Float32Array(p),f.hullLength=this.getValue(t,"hull",0)*2,f}case"path":{var u=this.attachmentLoader.newPathAttachment(e,i);if(u==null)return null;u.closed=this.getValue(t,"closed",!1),u.constantSpeed=this.getValue(t,"constantSpeed",!0);var v=t.vertexCount;this.readVertices(t,u,v<<1);for(var m=Y.newArray(v/3,0),g=0;g<t.lengths.length;g++)m[g]=t.lengths[g]*s;u.lengths=m;var l=this.getValue(t,"color",null);return l!=null&&u.color.setFromString(l),u}case"point":{var y=this.attachmentLoader.newPointAttachment(e,i);if(y==null)return null;y.x=this.getValue(t,"x",0)*s,y.y=this.getValue(t,"y",0)*s,y.rotation=this.getValue(t,"rotation",0);var l=this.getValue(t,"color",null);return l!=null&&y.color.setFromString(l),y}case"clipping":{var x=this.attachmentLoader.newClippingAttachment(e,i);if(x==null)return null;var b=this.getValue(t,"end",null);if(b!=null){var _=a.findSlot(b);if(_==null)throw new Error("Clipping end slot not found: "+b);x.endSlot=_}var v=t.vertexCount;this.readVertices(t,x,v<<1);var l=this.getValue(t,"color",null);return l!=null&&x.color.setFromString(l),x}}return null},n.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var a=t.vertices;if(r==a.length){var s=Y.toFloatArray(a);if(i!=1)for(var o=0,u=a.length;o<u;o++)s[o]*=i;e.vertices=s;return}for(var h=new Array,l=new Array,o=0,u=a.length;o<u;){var c=a[o++];l.push(c);for(var f=o+c*4;o<f;o+=4)l.push(a[o]),h.push(a[o+1]*i),h.push(a[o+2]*i),h.push(a[o+3])}e.bones=l,e.vertices=Y.toFloatArray(h)},n.prototype.readAnimation=function(t,e,r){var i=this.scale,a=new Array,s=0;if(t.slots)for(var o in t.slots){var u=t.slots[o],h=r.findSlotIndex(o);if(h==-1)throw new Error("Slot not found: "+o);for(var l in u){var c=u[l];if(l=="attachment"){var f=new qh(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d++,v.time,v.name)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}else if(l=="color"){var f=new xf(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p],m=new tt;m.setFromString(v.color||"ffffffff"),f.setFrame(d,v.time,m.r,m.g,m.b,m.a),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*xf.ENTRIES])}else if(l=="twoColor"){var f=new bf(c.length);f.slotIndex=h;for(var d=0,p=0;p<c.length;p++){var v=c[p],g=new tt,y=new tt;g.setFromString(v.light),y.setFromString(v.dark),f.setFrame(d,v.time,g.r,g.g,g.b,g.a,y.r,y.g,y.b),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*bf.ENTRIES])}else throw new Error("Invalid timeline type for a slot: "+l+" ("+o+")")}}if(t.bones)for(var x in t.bones){var b=t.bones[x],_=r.findBoneIndex(x);if(_==-1)throw new Error("Bone not found: "+x);for(var l in b){var c=b[l];if(l==="rotate"){var f=new _r(c.length);f.boneIndex=_;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,v.time,v.angle),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*_r.ENTRIES])}else if(l==="translate"||l==="scale"||l==="shear"){var f=null,w=1;l==="scale"?f=new L0(c.length):l==="shear"?f=new D0(c.length):(f=new Hs(c.length),w=i),f.boneIndex=_;for(var d=0,p=0;p<c.length;p++){var v=c[p],S=this.getValue(v,"x",0),E=this.getValue(v,"y",0);f.setFrame(d,v.time,S*w,E*w),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Hs.ENTRIES])}else throw new Error("Invalid timeline type for a bone: "+l+" ("+x+")")}}if(t.ik)for(var T in t.ik){var A=t.ik[T],P=r.findIkConstraint(T),f=new _f(A.length);f.ikConstraintIndex=r.ikConstraints.indexOf(P);for(var d=0,p=0;p<A.length;p++){var v=A[p];f.setFrame(d,v.time,this.getValue(v,"mix",1),this.getValue(v,"bendPositive",!0)?1:-1,this.getValue(v,"compress",!1),this.getValue(v,"stretch",!1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*_f.ENTRIES])}if(t.transform)for(var T in t.transform){var A=t.transform[T],P=r.findTransformConstraint(T),f=new wf(A.length);f.transformConstraintIndex=r.transformConstraints.indexOf(P);for(var d=0,p=0;p<A.length;p++){var v=A[p];f.setFrame(d,v.time,this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1),this.getValue(v,"scaleMix",1),this.getValue(v,"shearMix",1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*wf.ENTRIES])}if(t.paths)for(var T in t.paths){var A=t.paths[T],M=r.findPathConstraintIndex(T);if(M==-1)throw new Error("Path constraint not found: "+T);var R=r.pathConstraints[M];for(var l in A){var c=A[l];if(l==="position"||l==="spacing"){var f=null,w=1;l==="spacing"?(f=new X0(c.length),(R.spacingMode==lr.Length||R.spacingMode==lr.Fixed)&&(w=i)):(f=new Kh(c.length),R.positionMode==zt.Fixed&&(w=i)),f.pathConstraintIndex=M;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,v.time,this.getValue(v,l,0)*w),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Kh.ENTRIES])}else if(l==="mix"){var f=new Sf(c.length);f.pathConstraintIndex=M;for(var d=0,p=0;p<c.length;p++){var v=c[p];f.setFrame(d,v.time,this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[(f.getFrameCount()-1)*Sf.ENTRIES])}}}if(t.deform)for(var F in t.deform){var N=t.deform[F],D=r.findSkin(F);if(D!=null)for(var o in N){var u=N[o],h=r.findSlotIndex(o);if(h==-1)throw new Error("Slot not found: "+u.name);for(var l in u){var c=u[l],X=D.getAttachment(h,l);if(X==null)throw new Error("Deform attachment not found: "+c.name);var q=X.bones!=null,W=X.vertices,L=q?W.length/3*2:W.length,f=new U0(c.length);f.slotIndex=h,f.attachment=X;for(var d=0,U=0;U<c.length;U++){var v=c[U],G=void 0,V=this.getValue(v,"vertices",null);if(V==null)G=q?Y.newFloatArray(L):W;else{G=Y.newFloatArray(L);var O=this.getValue(v,"offset",0);if(Y.arrayCopy(V,0,G,O,V.length),i!=1)for(var p=O,z=p+V.length;p<z;p++)G[p]*=i;if(!q)for(var p=0;p<L;p++)G[p]+=W[p]}f.setFrame(d,v.time,G),this.readCurve(v,f,d),d++}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}}}var j=t.drawOrder;if(j==null&&(j=t.draworder),j!=null){for(var f=new Zh(j.length),K=r.slots.length,d=0,U=0;U<j.length;U++){var Z=j[U],Q=null,nt=this.getValue(Z,"offsets",null);if(nt!=null){Q=Y.newArray(K,-1);for(var J=Y.newArray(K-nt.length,0),it=0,st=0,p=0;p<nt.length;p++){var ot=nt[p],h=r.findSlotIndex(ot.slot);if(h==-1)throw new Error("Slot not found: "+ot.slot);for(;it!=h;)J[st++]=it++;Q[it+ot.offset]=it++}for(;it<K;)J[st++]=it++;for(var p=K-1;p>=0;p--)Q[p]==-1&&(Q[p]=J[--st])}f.setFrame(d++,Z.time,Q)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}if(t.events){for(var f=new V0(t.events.length),d=0,p=0;p<t.events.length;p++){var pt=t.events[p],ct=r.findEvent(pt.name);if(ct==null)throw new Error("Event not found: "+pt.name);var lt=new $0(Y.toSinglePrecision(pt.time),ct);lt.intValue=this.getValue(pt,"int",ct.intValue),lt.floatValue=this.getValue(pt,"float",ct.floatValue),lt.stringValue=this.getValue(pt,"string",ct.stringValue),lt.data.audioPath!=null&&(lt.volume=this.getValue(pt,"volume",1),lt.balance=this.getValue(pt,"balance",0)),f.setFrame(d++,lt)}a.push(f),s=Math.max(s,f.frames[f.getFrameCount()-1])}if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");r.animations.push(new _e(e,a,s))},n.prototype.readCurve=function(t,e,r){if(t.curve){if(t.curve==="stepped")e.setStepped(r);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){var i=t.curve;e.setCurve(r,i[0],i[1],i[2],i[3])}}},n.prototype.getValue=function(t,e,r){return t[e]!==void 0?t[e]:r},n.blendModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return at.NORMAL;if(t=="additive")return at.ADD;if(t=="multiply")return at.MULTIPLY;if(t=="screen")return at.SCREEN;throw new Error("Unknown blend mode: "+t)},n.positionModeFromString=function(t){if(t=t.toLowerCase(),t=="fixed")return zt.Fixed;if(t=="percent")return zt.Percent;throw new Error("Unknown position mode: "+t)},n.spacingModeFromString=function(t){if(t=t.toLowerCase(),t=="length")return lr.Length;if(t=="fixed")return lr.Fixed;if(t=="percent")return lr.Percent;throw new Error("Unknown position mode: "+t)},n.rotateModeFromString=function(t){if(t=t.toLowerCase(),t=="tangent")return Qt.Tangent;if(t=="chain")return Qt.Chain;if(t=="chainscale")return Qt.ChainScale;throw new Error("Unknown rotate mode: "+t)},n.transformModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return dt.Normal;if(t=="onlytranslation")return dt.OnlyTranslation;if(t=="norotationorreflection")return dt.NoRotationOrReflection;if(t=="noscale")return dt.NoScale;if(t=="noscaleorreflection")return dt.NoScaleOrReflection;throw new Error("Unknown transform mode: "+t)},n}(),IR=function(){function n(t,e,r,i){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i}return n}(),CR=function(n){se(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createSkeleton=function(e){this.skeleton=new ex(e),this.skeleton.updateWorldTransform(),this.stateData=new W0(e),this.state=new z0(this.stateData)},t}(fo);const RR=Object.freeze(Object.defineProperty({__proto__:null,Animation:_e,AnimationState:z0,AnimationStateAdapter2:MR,AnimationStateData:W0,AtlasAttachmentLoader:H0,Attachment:Td,AttachmentTimeline:qh,Bone:Ef,BoneData:j0,BoundingBoxAttachment:B0,ClippingAttachment:N0,ColorTimeline:xf,CurveTimeline:$r,DeformTimeline:U0,DrawOrderTimeline:Zh,Event:$0,EventData:q0,EventQueue:Y0,EventTimeline:V0,get EventType(){return Ge},IkConstraint:Z0,IkConstraintData:K0,IkConstraintTimeline:_f,JitterEffect:TR,MeshAttachment:Ad,PathAttachment:Ws,PathConstraint:Q0,PathConstraintData:J0,PathConstraintMixTimeline:Sf,PathConstraintPositionTimeline:Kh,PathConstraintSpacingTimeline:X0,PointAttachment:k0,RegionAttachment:Pd,RotateTimeline:_r,ScaleTimeline:L0,ShearTimeline:D0,Skeleton:ex,SkeletonBounds:PR,SkeletonData:rx,SkeletonJson:sx,Skin:ax,Slot:Md,SlotData:nx,get SpacingMode(){return lr},Spine:CR,SwirlEffect:AR,get TimelineType(){return Ce},TrackEntry:G0,TransformConstraint:tx,TransformConstraintData:ix,TransformConstraintTimeline:wf,TranslateTimeline:Hs,TwoColorTimeline:bf,VertexAttachment:ki},Symbol.toStringTag,{value:"Module"}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Tf=function(n,t){return Tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},Tf(n,t)};function xt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Tf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Id=function(){function n(t){if(!t)throw new Error("name cannot be null.");this.name=t}return n}(),Wr=function(n){xt(t,n);function t(e){var r=n.call(this,e)||this;return r.id=t.nextID++,r.bones=null,r.vertices=[],r.worldVerticesLength=0,r.timelineAttachment=r,r}return t.prototype.computeWorldVerticesOld=function(e,r){this.computeWorldVertices(e,0,this.worldVerticesLength,r,0,2)},t.prototype.computeWorldVertices=function(e,r,i,a,s,o){i=s+(i>>1)*o;var u=e.bone.skeleton,h=e.deform,l=this.vertices,c=this.bones;if(!c){h.length>0&&(l=h);for(var f=e.bone.matrix,d=f.tx,p=f.ty,v=f.a,m=f.c,g=f.b,y=f.d,x=r,b=s;b<i;x+=2,b+=o){var _=l[x],w=l[x+1];a[b]=_*v+w*m+d,a[b+1]=_*g+w*y+p}return}for(var S=0,E=0,T=0;T<r;T+=2){var A=c[S];S+=A+1,E+=A}var P=u.bones;if(h.length==0)for(var b=s,m=E*3;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3){var f=P[c[S]].matrix,_=l[m],w=l[m+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}else for(var N=h,b=s,m=E*3,D=E<<1;b<i;b+=o){var M=0,R=0,A=c[S++];for(A+=S;S<A;S++,m+=3,D+=2){var f=P[c[S]].matrix,_=l[m]+N[D],w=l[m+1]+N[D+1],F=l[m+2];M+=(_*f.a+w*f.c+f.tx)*F,R+=(_*f.b+w*f.d+f.ty)*F}a[b]=M,a[b+1]=R}},t.prototype.copyTo=function(e){this.bones?(e.bones=new Array(this.bones.length),Y.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=Y.newFloatArray(this.vertices.length),Y.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment},t.nextID=0,t}(Id),ox=function(n){xt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.BoundingBox,r.color=new tt(1,1,1,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e},t}(Wr),hx=function(n){xt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Clipping,r.endSlot=null,r.color=new tt(.2275,.2275,.8078,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e},t}(Wr),Tl=function(n){xt(t,n);function t(e,r){var i=n.call(this,e)||this;return i.type=yt.Mesh,i.region=null,i.triangles=[],i.color=new tt(1,1,1,1),i.width=0,i.height=0,i.hullLength=0,i.edges=[],i.parentMesh=null,i.sequence=null,i.tempColor=new tt(0,0,0,0),i.path=r,i}return t.prototype.getParentMesh=function(){return this.parentMesh},t.prototype.setParentMesh=function(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)},t.prototype.copy=function(){if(this.parentMesh)return this.newLinkedMesh();var e=new t(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Float32Array(this.regionUVs.length),Y.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.triangles=new Array(this.triangles.length),Y.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),Y.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e},t.prototype.computeWorldVertices=function(e,r,i,a,s,o){this.sequence!=null&&this.sequence.apply(e,this),n.prototype.computeWorldVertices.call(this,e,r,i,a,s,o)},t.prototype.newLinkedMesh=function(){var e=new t(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),e},t}(Wr),js=function(n){xt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Path,r.lengths=[],r.closed=!1,r.constantSpeed=!1,r.color=new tt(1,1,1,1),r}return t.prototype.copy=function(){var e=new t(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Y.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e},t}(Wr),lx=function(n){xt(t,n);function t(e){var r=n.call(this,e)||this;return r.type=yt.Point,r.x=0,r.y=0,r.rotation=0,r.color=new tt(.38,.94,0,1),r}return t.prototype.computeWorldPosition=function(e,r){var i=e.matrix;return r.x=this.x*i.a+this.y*i.c+e.worldX,r.y=this.x*i.b+this.y*i.d+e.worldY,r},t.prototype.computeWorldRotation=function(e){var r=e.matrix,i=B.cosDeg(this.rotation),a=B.sinDeg(this.rotation),s=i*r.a+a*r.c,o=i*r.b+a*r.d;return Math.atan2(o,s)*B.radDeg},t.prototype.copy=function(){var e=new t(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e},t}(Wr),Cd=function(n){xt(t,n);function t(e,r){var i=n.call(this,e)||this;return i.type=yt.Region,i.x=0,i.y=0,i.scaleX=1,i.scaleY=1,i.rotation=0,i.width=0,i.height=0,i.color=new tt(1,1,1,1),i.rendererObject=null,i.region=null,i.sequence=null,i.offset=Y.newFloatArray(8),i.uvs=Y.newFloatArray(8),i.tempColor=new tt(1,1,1,1),i.path=r,i}return t.prototype.updateRegion=function(){if(!this.region)throw new Error("Region not set.");var e=this.region,r=this.width/this.region.originalWidth*this.scaleX,i=this.height/this.region.originalHeight*this.scaleY,a=-this.width/2*this.scaleX+this.region.offsetX*r,s=-this.height/2*this.scaleY+this.region.offsetY*i,o=a+this.region.width*r,u=s+this.region.height*i,h=this.rotation*Math.PI/180,l=Math.cos(h),c=Math.sin(h),f=this.x,d=this.y,p=a*l+f,v=a*c,m=s*l+d,g=s*c,y=o*l+f,x=o*c,b=u*l+d,_=u*c,w=this.offset;w[0]=p-g,w[1]=m+v,w[2]=p-_,w[3]=b+v,w[4]=y-_,w[5]=b+x,w[6]=y-g,w[7]=m+x;var S=this.uvs;e.degrees==90?(S[2]=e.u,S[3]=e.v2,S[4]=e.u,S[5]=e.v,S[6]=e.u2,S[7]=e.v,S[0]=e.u2,S[1]=e.v2):(S[0]=e.u,S[1]=e.v2,S[2]=e.u,S[3]=e.v,S[4]=e.u2,S[5]=e.v,S[6]=e.u2,S[7]=e.v2)},t.prototype.computeWorldVertices=function(e,r,i,a){this.sequence!=null&&this.sequence.apply(e,this);var s=e.bone,o=this.offset,u=s.matrix,h=u.tx,l=u.ty,c=u.a,f=u.c,d=u.b,p=u.d,v=0,m=0;v=o[0],m=o[1],r[i]=v*c+m*f+h,r[i+1]=v*d+m*p+l,i+=a,v=o[2],m=o[3],r[i]=v*c+m*f+h,r[i+1]=v*d+m*p+l,i+=a,v=o[4],m=o[5],r[i]=v*c+m*f+h,r[i+1]=v*d+m*p+l,i+=a,v=o[6],m=o[7],r[i]=v*c+m*f+h,r[i+1]=v*d+m*p+l},t.prototype.copy=function(){var e=new t(this.name,this.path);return e.region=this.region,e.rendererObject=this.rendererObject,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,Y.arrayCopy(this.uvs,0,e.uvs,0,8),Y.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=this.sequence!=null?this.sequence.copy():null,e},t.X1=0,t.Y1=1,t.C1R=2,t.C1G=3,t.C1B=4,t.C1A=5,t.U1=6,t.V1=7,t.X2=8,t.Y2=9,t.C2R=10,t.C2G=11,t.C2B=12,t.C2A=13,t.U2=14,t.V2=15,t.X3=16,t.Y3=17,t.C3R=18,t.C3G=19,t.C3B=20,t.C3A=21,t.U3=22,t.V3=23,t.X4=24,t.Y4=25,t.C4R=26,t.C4G=27,t.C4B=28,t.C4A=29,t.U4=30,t.V4=31,t}(Id),Rd=function(){function n(t){this.id=n.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}return n.prototype.copy=function(){var t=new n(this.regions.length);return Y.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t},n.prototype.apply=function(t,e){var r=t.sequenceIndex;r==-1&&(r=this.setupIndex),r>=this.regions.length&&(r=this.regions.length-1);var i=this.regions[r];e.region!=i&&(e.region=i)},n.prototype.getPath=function(t,e){for(var r=t,i=(this.start+e).toString(),a=this.digits-i.length;a>0;a--)r+="0";return r+=i,r},n.nextID=function(){return n._nextID++},n._nextID=0,n}(),Ae;(function(n){n[n.hold=0]="hold",n[n.once=1]="once",n[n.loop=2]="loop",n[n.pingpong=3]="pingpong",n[n.onceReverse=4]="onceReverse",n[n.loopReverse=5]="loopReverse",n[n.pingpongReverse=6]="pingpongReverse"})(Ae||(Ae={}));var Fd=[Ae.hold,Ae.once,Ae.loop,Ae.pingpong,Ae.onceReverse,Ae.loopReverse,Ae.pingpongReverse],Al=function(){function n(t,e,r){if(this.timelines=[],this.timelineIds=new x0,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=r}return n.prototype.setTimelines=function(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())},n.prototype.hasTimeline=function(t){for(var e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1},n.prototype.apply=function(t,e,r,i,a,s,o,u){if(!t)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,c=h.length;l<c;l++)h[l].apply(t,e,r,a,s,o,u)},n}(),Ct={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19},ee=function(){function n(t,e){this.propertyIds=e,this.frames=Y.newFloatArray(t*this.getFrameEntries())}return n.prototype.getPropertyIds=function(){return this.propertyIds},n.prototype.getFrameEntries=function(){return 1},n.prototype.getFrameCount=function(){return this.frames.length/this.getFrameEntries()},n.prototype.getDuration=function(){return this.frames[this.frames.length-this.getFrameEntries()]},n.search1=function(t,e){for(var r=t.length,i=1;i<r;i++)if(t[i]>e)return i-1;return r-1},n.search=function(t,e,r){for(var i=t.length,a=r;a<i;a+=r)if(t[a]>e)return a-r;return i-r},n}(),Ir=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,i)||this;return a.curves=Y.newFloatArray(e+r*18),a.curves[e-1]=1,a}return t.prototype.setLinear=function(e){this.curves[e]=0},t.prototype.setStepped=function(e){this.curves[e]=1},t.prototype.shrink=function(e){var r=this.getFrameCount()+e*18;if(this.curves.length>r){var i=Y.newFloatArray(r);Y.arrayCopy(this.curves,0,i,0,r),this.curves=i}},t.prototype.setBezier=function(e,r,i,a,s,o,u,h,l,c,f){var d=this.curves,p=this.getFrameCount()+e*18;i==0&&(d[r]=2+p);for(var v=(a-o*2+h)*.03,m=(s-u*2+l)*.03,g=((o-h)*3-a+c)*.006,y=((u-l)*3-s+f)*.006,x=v*2+g,b=m*2+y,_=(o-a)*.3+v+g*.16666667,w=(u-s)*.3+m+y*.16666667,S=a+_,E=s+w,T=p+18;p<T;p+=2)d[p]=S,d[p+1]=E,_+=x,w+=b,x+=g,b+=y,S+=_,E+=w},t.prototype.getBezierValue=function(e,r,i,a){var s=this.curves;if(s[a]>e){var o=this.frames[r],u=this.frames[r+i];return u+(e-o)/(s[a]-o)*(s[a+1]-u)}var h=a+18;for(a+=2;a<h;a+=2)if(s[a]>=e){var l=s[a-2],c=s[a-1];return c+(e-l)/(s[a]-l)*(s[a+1]-c)}r+=this.getFrameEntries();var f=s[h-2],d=s[h-1];return d+(e-f)/(this.frames[r]-f)*(this.frames[r+i]-d)},t}(ee),Cr=function(n){xt(t,n);function t(e,r,i){return n.call(this,e,r,[i])||this}return t.prototype.getFrameEntries=function(){return 2},t.prototype.setFrame=function(e,r,i){e<<=1,this.frames[e]=r,this.frames[e+1]=i},t.prototype.getCurveValue=function(e){for(var r=this.frames,i=r.length-2,a=2;a<=i;a+=2)if(r[a]>e){i=a-2;break}var s=this.curves[i>>1];switch(s){case 0:var o=r[i],u=r[i+1];return u+(e-o)/(r[i+2]-o)*(r[i+2+1]-u);case 1:return r[i+1]}return this.getBezierValue(e,i,1,s-2)},t}(Ir),Ml=function(n){xt(t,n);function t(e,r,i,a){return n.call(this,e,r,[i,a])||this}return t.prototype.getFrameEntries=function(){return 3},t.prototype.setFrame=function(e,r,i,a){e*=3,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a},t}(Ir),$s=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.rotate+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.rotation=h.data.rotation;return;case C.first:h.rotation+=(h.data.rotation-h.rotation)*s}return}var c=this.getCurveValue(i);switch(o){case C.setup:h.rotation=h.data.rotation+c*s;break;case C.first:case C.replace:c+=h.data.rotation-h.rotation;case C.add:h.rotation+=c*s}}},t}(Cr),Od=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.x+"|"+i,Ct.y+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.x=h.data.x,h.y=h.data.y;return;case C.first:h.x+=(h.data.x-h.x)*s,h.y+=(h.data.y-h.y)*s}return}var c=0,f=0,d=ee.search(l,i,3),p=this.curves[d/3];switch(p){case 0:var v=l[d];c=l[d+1],f=l[d+2];var m=(i-v)/(l[d+3]-v);c+=(l[d+3+1]-c)*m,f+=(l[d+3+2]-f)*m;break;case 1:c=l[d+1],f=l[d+2];break;default:c=this.getBezierValue(i,d,1,p-2),f=this.getBezierValue(i,d,2,p+18-2)}switch(o){case C.setup:h.x=h.data.x+c*s,h.y=h.data.y+f*s;break;case C.first:case C.replace:h.x+=(h.data.x+c-h.x)*s,h.y+=(h.data.y+f-h.y)*s;break;case C.add:h.x+=c*s,h.y+=f*s}}},t}(Ml),Bd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.x+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.x=h.data.x;return;case C.first:h.x+=(h.data.x-h.x)*s}return}var c=this.getCurveValue(i);switch(o){case C.setup:h.x=h.data.x+c*s;break;case C.first:case C.replace:h.x+=(h.data.x+c-h.x)*s;break;case C.add:h.x+=c*s}}},t}(Cr),Nd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.y+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.y=h.data.y;return;case C.first:h.y+=(h.data.y-h.y)*s}return}var c=this.getCurveValue(i);switch(o){case C.setup:h.y=h.data.y+c*s;break;case C.first:case C.replace:h.y+=(h.data.y+c-h.y)*s;break;case C.add:h.y+=c*s}}},t}(Cr),kd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.scaleX+"|"+i,Ct.scaleY+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case C.first:h.scaleX+=(h.data.scaleX-h.scaleX)*s,h.scaleY+=(h.data.scaleY-h.scaleY)*s}return}var c,f,d=ee.search(l,i,3),p=this.curves[d/3];switch(p){case 0:var v=l[d];c=l[d+1],f=l[d+2];var m=(i-v)/(l[d+3]-v);c+=(l[d+3+1]-c)*m,f+=(l[d+3+2]-f)*m;break;case 1:c=l[d+1],f=l[d+2];break;default:c=this.getBezierValue(i,d,1,p-2),f=this.getBezierValue(i,d,2,p+18-2)}if(c*=h.data.scaleX,f*=h.data.scaleY,s==1)o==C.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=f-h.data.scaleY):(h.scaleX=c,h.scaleY=f);else{var g=0,y=0;if(u==mt.mixOut)switch(o){case C.setup:g=h.data.scaleX,y=h.data.scaleY,h.scaleX=g+(Math.abs(c)*B.signum(g)-g)*s,h.scaleY=y+(Math.abs(f)*B.signum(y)-y)*s;break;case C.first:case C.replace:g=h.scaleX,y=h.scaleY,h.scaleX=g+(Math.abs(c)*B.signum(g)-g)*s,h.scaleY=y+(Math.abs(f)*B.signum(y)-y)*s;break;case C.add:h.scaleX+=(c-h.data.scaleX)*s,h.scaleY+=(f-h.data.scaleY)*s}else switch(o){case C.setup:g=Math.abs(h.data.scaleX)*B.signum(c),y=Math.abs(h.data.scaleY)*B.signum(f),h.scaleX=g+(c-g)*s,h.scaleY=y+(f-y)*s;break;case C.first:case C.replace:g=Math.abs(h.scaleX)*B.signum(c),y=Math.abs(h.scaleY)*B.signum(f),h.scaleX=g+(c-g)*s,h.scaleY=y+(f-y)*s;break;case C.add:h.scaleX+=(c-h.data.scaleX)*s,h.scaleY+=(f-h.data.scaleY)*s}}}},t}(Ml),Ld=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.scaleX+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.scaleX=h.data.scaleX;return;case C.first:h.scaleX+=(h.data.scaleX-h.scaleX)*s}return}var c=this.getCurveValue(i)*h.data.scaleX;if(s==1)o==C.add?h.scaleX+=c-h.data.scaleX:h.scaleX=c;else{var f=0;if(u==mt.mixOut)switch(o){case C.setup:f=h.data.scaleX,h.scaleX=f+(Math.abs(c)*B.signum(f)-f)*s;break;case C.first:case C.replace:f=h.scaleX,h.scaleX=f+(Math.abs(c)*B.signum(f)-f)*s;break;case C.add:h.scaleX+=(c-h.data.scaleX)*s}else switch(o){case C.setup:f=Math.abs(h.data.scaleX)*B.signum(c),h.scaleX=f+(c-f)*s;break;case C.first:case C.replace:f=Math.abs(h.scaleX)*B.signum(c),h.scaleX=f+(c-f)*s;break;case C.add:h.scaleX+=(c-h.data.scaleX)*s}}}},t}(Cr),Dd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.scaleY+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.scaleY=h.data.scaleY;return;case C.first:h.scaleY+=(h.data.scaleY-h.scaleY)*s}return}var c=this.getCurveValue(i)*h.data.scaleY;if(s==1)o==C.add?h.scaleY+=c-h.data.scaleY:h.scaleY=c;else{var f=0;if(u==mt.mixOut)switch(o){case C.setup:f=h.data.scaleY,h.scaleY=f+(Math.abs(c)*B.signum(f)-f)*s;break;case C.first:case C.replace:f=h.scaleY,h.scaleY=f+(Math.abs(c)*B.signum(f)-f)*s;break;case C.add:h.scaleY+=(c-h.data.scaleY)*s}else switch(o){case C.setup:f=Math.abs(h.data.scaleY)*B.signum(c),h.scaleY=f+(c-f)*s;break;case C.first:case C.replace:f=Math.abs(h.scaleY)*B.signum(c),h.scaleY=f+(c-f)*s;break;case C.add:h.scaleY+=(c-h.data.scaleY)*s}}}},t}(Cr),Ud=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.shearX+"|"+i,Ct.shearY+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case C.first:h.shearX+=(h.data.shearX-h.shearX)*s,h.shearY+=(h.data.shearY-h.shearY)*s}return}var c=0,f=0,d=ee.search(l,i,3),p=this.curves[d/3];switch(p){case 0:var v=l[d];c=l[d+1],f=l[d+2];var m=(i-v)/(l[d+3]-v);c+=(l[d+3+1]-c)*m,f+=(l[d+3+2]-f)*m;break;case 1:c=l[d+1],f=l[d+2];break;default:c=this.getBezierValue(i,d,1,p-2),f=this.getBezierValue(i,d,2,p+18-2)}switch(o){case C.setup:h.shearX=h.data.shearX+c*s,h.shearY=h.data.shearY+f*s;break;case C.first:case C.replace:h.shearX+=(h.data.shearX+c-h.shearX)*s,h.shearY+=(h.data.shearY+f-h.shearY)*s;break;case C.add:h.shearX+=c*s,h.shearY+=f*s}}},t}(Ml),Vd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.shearX+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.shearX=h.data.shearX;return;case C.first:h.shearX+=(h.data.shearX-h.shearX)*s}return}var c=this.getCurveValue(i);switch(o){case C.setup:h.shearX=h.data.shearX+c*s;break;case C.first:case C.replace:h.shearX+=(h.data.shearX+c-h.shearX)*s;break;case C.add:h.shearX+=c*s}}},t}(Cr),Xd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.shearY+"|"+i)||this;return a.boneIndex=0,a.boneIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.shearY=h.data.shearY;return;case C.first:h.shearY+=(h.data.shearY-h.shearY)*s}return}var c=this.getCurveValue(i);switch(o){case C.setup:h.shearY=h.data.shearY+c*s;break;case C.first:case C.replace:h.shearY+=(h.data.shearY+c-h.shearY)*s;break;case C.add:h.shearY+=c*s}}},t}(Cr),zd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.rgb+"|"+i,Ct.alpha+"|"+i])||this;return a.slotIndex=0,a.slotIndex=i,a}return t.prototype.getFrameEntries=function(){return 5},t.prototype.setFrame=function(e,r,i,a,s,o){e*=5,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a,this.frames[e+3]=s,this.frames[e+4]=o},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,c=h.color;if(i<l[0]){var f=h.data.color;switch(o){case C.setup:c.setFromColor(f);return;case C.first:c.add((f.r-c.r)*s,(f.g-c.g)*s,(f.b-c.b)*s,(f.a-c.a)*s)}return}var d=0,p=0,v=0,m=0,g=ee.search(l,i,5),y=this.curves[g/5];switch(y){case 0:var x=l[g];d=l[g+1],p=l[g+2],v=l[g+3],m=l[g+4];var b=(i-x)/(l[g+5]-x);d+=(l[g+5+1]-d)*b,p+=(l[g+5+2]-p)*b,v+=(l[g+5+3]-v)*b,m+=(l[g+5+4]-m)*b;break;case 1:d=l[g+1],p=l[g+2],v=l[g+3],m=l[g+4];break;default:d=this.getBezierValue(i,g,1,y-2),p=this.getBezierValue(i,g,2,y+18-2),v=this.getBezierValue(i,g,3,y+18*2-2),m=this.getBezierValue(i,g,4,y+18*3-2)}s==1?c.set(d,p,v,m):(o==C.setup&&c.setFromColor(h.data.color),c.add((d-c.r)*s,(p-c.g)*s,(v-c.b)*s,(m-c.a)*s))}},t}(Ir),Gd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.rgb+"|"+i])||this;return a.slotIndex=0,a.slotIndex=i,a}return t.prototype.getFrameEntries=function(){return 4},t.prototype.setFrame=function(e,r,i,a,s){e<<=2,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a,this.frames[e+3]=s},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,c=h.color;if(i<l[0]){var f=h.data.color;switch(o){case C.setup:c.r=f.r,c.g=f.g,c.b=f.b;return;case C.first:c.r+=(f.r-c.r)*s,c.g+=(f.g-c.g)*s,c.b+=(f.b-c.b)*s}return}var d=0,p=0,v=0,m=ee.search(l,i,4),g=this.curves[m>>2];switch(g){case 0:var y=l[m];d=l[m+1],p=l[m+2],v=l[m+3];var x=(i-y)/(l[m+4]-y);d+=(l[m+4+1]-d)*x,p+=(l[m+4+2]-p)*x,v+=(l[m+4+3]-v)*x;break;case 1:d=l[m+1],p=l[m+2],v=l[m+3];break;default:d=this.getBezierValue(i,m,1,g-2),p=this.getBezierValue(i,m,2,g+18-2),v=this.getBezierValue(i,m,3,g+18*2-2)}if(s==1)c.r=d,c.g=p,c.b=v;else{if(o==C.setup){var f=h.data.color;c.r=f.r,c.g=f.g,c.b=f.b}c.r+=(d-c.r)*s,c.g+=(p-c.g)*s,c.b+=(v-c.b)*s}}},t}(Ir),Yd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.alpha+"|"+i)||this;return a.slotIndex=0,a.slotIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.color;if(i<this.frames[0]){var c=h.data.color;switch(o){case C.setup:l.a=c.a;return;case C.first:l.a+=(c.a-l.a)*s}return}var f=this.getCurveValue(i);s==1?l.a=f:(o==C.setup&&(l.a=h.data.color.a),l.a+=(f-l.a)*s)}},t}(Cr),Wd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.rgb+"|"+i,Ct.alpha+"|"+i,Ct.rgb2+"|"+i])||this;return a.slotIndex=0,a.slotIndex=i,a}return t.prototype.getFrameEntries=function(){return 8},t.prototype.setFrame=function(e,r,i,a,s,o,u,h,l){e<<=3,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a,this.frames[e+3]=s,this.frames[e+4]=o,this.frames[e+5]=u,this.frames[e+6]=h,this.frames[e+7]=l},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,c=h.color,f=h.darkColor;if(i<l[0]){var d=h.data.color,p=h.data.darkColor;switch(o){case C.setup:c.setFromColor(d),f.r=p.r,f.g=p.g,f.b=p.b;return;case C.first:c.add((d.r-c.r)*s,(d.g-c.g)*s,(d.b-c.b)*s,(d.a-c.a)*s),f.r+=(p.r-f.r)*s,f.g+=(p.g-f.g)*s,f.b+=(p.b-f.b)*s}return}var v=0,m=0,g=0,y=0,x=0,b=0,_=0,w=ee.search(l,i,8),S=this.curves[w>>3];switch(S){case 0:var E=l[w];v=l[w+1],m=l[w+2],g=l[w+3],y=l[w+4],x=l[w+5],b=l[w+6],_=l[w+7];var T=(i-E)/(l[w+8]-E);v+=(l[w+8+1]-v)*T,m+=(l[w+8+2]-m)*T,g+=(l[w+8+3]-g)*T,y+=(l[w+8+4]-y)*T,x+=(l[w+8+5]-x)*T,b+=(l[w+8+6]-b)*T,_+=(l[w+8+7]-_)*T;break;case 1:v=l[w+1],m=l[w+2],g=l[w+3],y=l[w+4],x=l[w+5],b=l[w+6],_=l[w+7];break;default:v=this.getBezierValue(i,w,1,S-2),m=this.getBezierValue(i,w,2,S+18-2),g=this.getBezierValue(i,w,3,S+18*2-2),y=this.getBezierValue(i,w,4,S+18*3-2),x=this.getBezierValue(i,w,5,S+18*4-2),b=this.getBezierValue(i,w,6,S+18*5-2),_=this.getBezierValue(i,w,7,S+18*6-2)}if(s==1)c.set(v,m,g,y),f.r=x,f.g=b,f.b=_;else{if(o==C.setup){c.setFromColor(h.data.color);var p=h.data.darkColor;f.r=p.r,f.g=p.g,f.b=p.b}c.add((v-c.r)*s,(m-c.g)*s,(g-c.b)*s,(y-c.a)*s),f.r+=(x-f.r)*s,f.g+=(b-f.g)*s,f.b+=(_-f.b)*s}}},t}(Ir),Hd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.rgb+"|"+i,Ct.rgb2+"|"+i])||this;return a.slotIndex=0,a.slotIndex=i,a}return t.prototype.getFrameEntries=function(){return 7},t.prototype.setFrame=function(e,r,i,a,s,o,u,h){e*=7,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a,this.frames[e+3]=s,this.frames[e+4]=o,this.frames[e+5]=u,this.frames[e+6]=h},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,c=h.color,f=h.darkColor;if(i<l[0]){var d=h.data.color,p=h.data.darkColor;switch(o){case C.setup:c.r=d.r,c.g=d.g,c.b=d.b,f.r=p.r,f.g=p.g,f.b=p.b;return;case C.first:c.r+=(d.r-c.r)*s,c.g+=(d.g-c.g)*s,c.b+=(d.b-c.b)*s,f.r+=(p.r-f.r)*s,f.g+=(p.g-f.g)*s,f.b+=(p.b-f.b)*s}return}var v=0,m=0,g=0,y=0,x=0,b=0,_=ee.search(l,i,7),w=this.curves[_/7];switch(w){case 0:var S=l[_];v=l[_+1],m=l[_+2],g=l[_+3],y=l[_+4],x=l[_+5],b=l[_+6];var E=(i-S)/(l[_+7]-S);v+=(l[_+7+1]-v)*E,m+=(l[_+7+2]-m)*E,g+=(l[_+7+3]-g)*E,y+=(l[_+7+4]-y)*E,x+=(l[_+7+5]-x)*E,b+=(l[_+7+6]-b)*E;break;case 1:v=l[_+1],m=l[_+2],g=l[_+3],y=l[_+4],x=l[_+5],b=l[_+6];break;default:v=this.getBezierValue(i,_,1,w-2),m=this.getBezierValue(i,_,2,w+18-2),g=this.getBezierValue(i,_,3,w+18*2-2),y=this.getBezierValue(i,_,4,w+18*3-2),x=this.getBezierValue(i,_,5,w+18*4-2),b=this.getBezierValue(i,_,6,w+18*5-2)}if(s==1)c.r=v,c.g=m,c.b=g,f.r=y,f.g=x,f.b=b;else{if(o==C.setup){var d=h.data.color,p=h.data.darkColor;c.r=d.r,c.g=d.g,c.b=d.b,f.r=p.r,f.g=p.g,f.b=p.b}c.r+=(v-c.r)*s,c.g+=(m-c.g)*s,c.b+=(g-c.b)*s,f.r+=(y-f.r)*s,f.g+=(x-f.g)*s,f.b+=(b-f.b)*s}}},t}(Ir),di=function(n){xt(t,n);function t(e,r){var i=n.call(this,e,[Ct.attachment+"|"+r])||this;return i.slotIndex=0,i.slotIndex=r,i.attachmentNames=new Array(e),i}return t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(e,r,i){this.frames[e]=r,this.attachmentNames[e]=i},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){if(u==mt.mixOut){o==C.setup&&this.setAttachment(e,h,h.data.attachmentName);return}if(i<this.frames[0]){(o==C.setup||o==C.first)&&this.setAttachment(e,h,h.data.attachmentName);return}this.setAttachment(e,h,this.attachmentNames[ee.search1(this.frames,i)])}},t.prototype.setAttachment=function(e,r,i){r.setAttachment(i?e.getAttachment(this.slotIndex,i):null)},t}(ee),jd=function(n){xt(t,n);function t(e,r,i,a){var s=n.call(this,e,r,[Ct.deform+"|"+i+"|"+a.id])||this;return s.slotIndex=0,s.slotIndex=i,s.attachment=a,s.vertices=new Array(e),s}return t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(e,r,i){this.frames[e]=r,this.vertices[e]=i},t.prototype.setBezier=function(e,r,i,a,s,o,u,h,l,c,f){var d=this.curves,p=this.getFrameCount()+e*18;i==0&&(d[r]=2+p);for(var v=(a-o*2+h)*.03,m=l*.03-u*.06,g=((o-h)*3-a+c)*.006,y=(u-l+.33333333)*.018,x=v*2+g,b=m*2+y,_=(o-a)*.3+v+g*.16666667,w=u*.3+m+y*.16666667,S=a+_,E=w,T=p+18;p<T;p+=2)d[p]=S,d[p+1]=E,_+=x,w+=b,x+=g,b+=y,S+=_,E+=w},t.prototype.getCurvePercent=function(e,r){var i=this.curves,a=i[r];switch(a){case 0:var s=this.frames[r];return(e-s)/(this.frames[r+this.getFrameEntries()]-s);case 1:return 0}if(a-=2,i[a]>e){var o=this.frames[r];return i[a+1]*(e-o)/(i[a]-o)}var u=a+18;for(a+=2;a<u;a+=2)if(i[a]>=e){var h=i[a-2],l=i[a-1];return l+(e-h)/(i[a]-h)*(i[a+1]-l)}var c=i[u-2],f=i[u-1];return f+(1-f)*(e-c)/(this.frames[r+this.getFrameEntries()]-c)},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.getAttachment();if(l&&!(!(l instanceof Wr)||l.timelineAttachment!=this.attachment)){var c=h.deform;c.length==0&&(o=C.setup);var f=this.vertices,d=f[0].length,p=this.frames;if(i<p[0]){switch(o){case C.setup:c.length=0;return;case C.first:if(s==1){c.length=0;return}c.length=d;var v=l;if(v.bones){s=1-s;for(var g=0;g<d;g++)c[g]*=s}else for(var m=v.vertices,g=0;g<d;g++)c[g]+=(m[g]-c[g])*s}return}if(c.length=d,i>=p[p.length-1]){var y=f[p.length-1];if(s==1)if(o==C.add){var v=l;if(v.bones)for(var b=0;b<d;b++)c[b]+=y[b];else for(var m=v.vertices,x=0;x<d;x++)c[x]+=y[x]-m[x]}else Y.arrayCopy(y,0,c,0,d);else switch(o){case C.setup:{var _=l;if(_.bones)for(var E=0;E<d;E++)c[E]=y[E]*s;else for(var m=_.vertices,w=0;w<d;w++){var S=m[w];c[w]=S+(y[w]-S)*s}break}case C.first:case C.replace:for(var T=0;T<d;T++)c[T]+=(y[T]-c[T])*s;break;case C.add:var v=l;if(v.bones)for(var P=0;P<d;P++)c[P]+=y[P]*s;else for(var m=v.vertices,A=0;A<d;A++)c[A]+=(y[A]-m[A])*s}return}var M=ee.search1(p,i),R=this.getCurvePercent(i,M),F=f[M],N=f[M+1];if(s==1)if(o==C.add){var v=l;if(v.bones)for(var q=0;q<d;q++){var X=F[q];c[q]+=X+(N[q]-X)*R}else for(var m=v.vertices,D=0;D<d;D++){var X=F[D];c[D]+=X+(N[D]-X)*R-m[D]}}else for(var W=0;W<d;W++){var X=F[W];c[W]=X+(N[W]-X)*R}else switch(o){case C.setup:{var L=l;if(L.bones)for(var G=0;G<d;G++){var X=F[G];c[G]=(X+(N[G]-X)*R)*s}else for(var m=L.vertices,U=0;U<d;U++){var X=F[U],S=m[U];c[U]=S+(X+(N[U]-X)*R-S)*s}break}case C.first:case C.replace:for(var V=0;V<d;V++){var X=F[V];c[V]+=(X+(N[V]-X)*R-c[V])*s}break;case C.add:var v=l;if(v.bones)for(var z=0;z<d;z++){var X=F[z];c[z]+=(X+(N[z]-X)*R)*s}else for(var m=v.vertices,O=0;O<d;O++){var X=F[O];c[O]+=(X+(N[O]-X)*R-m[O])*s}}}}},t}(Ir),Pl=function(n){xt(t,n);function t(e){var r=n.call(this,e,t.propertyIds)||this;return r.events=new Array(e),r}return t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(e,r){this.frames[e]=r.time,this.events[e]=r},t.prototype.apply=function(e,r,i,a,s,o,u){if(a){var h=this.frames,l=this.frames.length;if(r>i)this.apply(e,r,Number.MAX_VALUE,a,s,o,u),r=-1;else if(r>=h[l-1])return;if(!(i<h[0])){var c=0;if(r<h[0])c=0;else{c=ee.search1(h,r)+1;for(var f=h[c];c>0&&h[c-1]==f;)c--}for(;c<l&&i>=h[c];c++)a.push(this.events[c])}}},t.propertyIds=[""+Ct.event],t}(ee),Sa=function(n){xt(t,n);function t(e){var r=n.call(this,e,t.propertyIds)||this;return r.drawOrders=new Array(e),r}return t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(e,r,i){this.frames[e]=r,this.drawOrders[e]=i},t.prototype.apply=function(e,r,i,a,s,o,u){if(u==mt.mixOut){o==C.setup&&Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}if(i<this.frames[0]){(o==C.setup||o==C.first)&&Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}var h=ee.search1(this.frames,i),l=this.drawOrders[h];if(!l)Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else for(var c=e.drawOrder,f=e.slots,d=0,p=l.length;d<p;d++)c[d]=f[l[d]]},t.propertyIds=[""+Ct.drawOrder],t}(ee),$d=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.ikConstraint+"|"+i])||this;return a.ikConstraintIndex=0,a.ikConstraintIndex=i,a}return t.prototype.getFrameEntries=function(){return 6},t.prototype.setFrame=function(e,r,i,a,s,o,u){e*=6,this.frames[e]=r,this.frames[e+1]=i,this.frames[e+2]=a,this.frames[e+3]=s,this.frames[e+4]=o?1:0,this.frames[e+5]=u?1:0},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.ikConstraints[this.ikConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch;return;case C.first:h.mix+=(h.data.mix-h.mix)*s,h.softness+=(h.data.softness-h.softness)*s,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}return}var c=0,f=0,d=ee.search(l,i,6),p=this.curves[d/6];switch(p){case 0:var v=l[d];c=l[d+1],f=l[d+2];var m=(i-v)/(l[d+6]-v);c+=(l[d+6+1]-c)*m,f+=(l[d+6+2]-f)*m;break;case 1:c=l[d+1],f=l[d+2];break;default:c=this.getBezierValue(i,d,1,p-2),f=this.getBezierValue(i,d,2,p+18-2)}o==C.setup?(h.mix=h.data.mix+(c-h.data.mix)*s,h.softness=h.data.softness+(f-h.data.softness)*s,u==mt.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[d+3],h.compress=l[d+4]!=0,h.stretch=l[d+5]!=0)):(h.mix+=(c-h.mix)*s,h.softness+=(f-h.softness)*s,u==mt.mixIn&&(h.bendDirection=l[d+3],h.compress=l[d+4]!=0,h.stretch=l[d+5]!=0))}},t}(Ir),qd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.transformConstraint+"|"+i])||this;return a.transformConstraintIndex=0,a.transformConstraintIndex=i,a}return t.prototype.getFrameEntries=function(){return 7},t.prototype.setFrame=function(e,r,i,a,s,o,u,h){var l=this.frames;e*=7,l[e]=r,l[e+1]=i,l[e+2]=a,l[e+3]=s,l[e+4]=o,l[e+5]=u,l[e+6]=h},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.transformConstraints[this.transformConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){var c=h.data;switch(o){case C.setup:h.mixRotate=c.mixRotate,h.mixX=c.mixX,h.mixY=c.mixY,h.mixScaleX=c.mixScaleX,h.mixScaleY=c.mixScaleY,h.mixShearY=c.mixShearY;return;case C.first:h.mixRotate+=(c.mixRotate-h.mixRotate)*s,h.mixX+=(c.mixX-h.mixX)*s,h.mixY+=(c.mixY-h.mixY)*s,h.mixScaleX+=(c.mixScaleX-h.mixScaleX)*s,h.mixScaleY+=(c.mixScaleY-h.mixScaleY)*s,h.mixShearY+=(c.mixShearY-h.mixShearY)*s}return}var f,d,p,v,m,g,y=ee.search(l,i,7),x=this.curves[y/7];switch(x){case 0:var b=l[y];f=l[y+1],d=l[y+2],p=l[y+3],v=l[y+4],m=l[y+5],g=l[y+6];var _=(i-b)/(l[y+7]-b);f+=(l[y+7+1]-f)*_,d+=(l[y+7+2]-d)*_,p+=(l[y+7+3]-p)*_,v+=(l[y+7+4]-v)*_,m+=(l[y+7+5]-m)*_,g+=(l[y+7+6]-g)*_;break;case 1:f=l[y+1],d=l[y+2],p=l[y+3],v=l[y+4],m=l[y+5],g=l[y+6];break;default:f=this.getBezierValue(i,y,1,x-2),d=this.getBezierValue(i,y,2,x+18-2),p=this.getBezierValue(i,y,3,x+18*2-2),v=this.getBezierValue(i,y,4,x+18*3-2),m=this.getBezierValue(i,y,5,x+18*4-2),g=this.getBezierValue(i,y,6,x+18*5-2)}if(o==C.setup){var c=h.data;h.mixRotate=c.mixRotate+(f-c.mixRotate)*s,h.mixX=c.mixX+(d-c.mixX)*s,h.mixY=c.mixY+(p-c.mixY)*s,h.mixScaleX=c.mixScaleX+(v-c.mixScaleX)*s,h.mixScaleY=c.mixScaleY+(m-c.mixScaleY)*s,h.mixShearY=c.mixShearY+(g-c.mixShearY)*s}else h.mixRotate+=(f-h.mixRotate)*s,h.mixX+=(d-h.mixX)*s,h.mixY+=(p-h.mixY)*s,h.mixScaleX+=(v-h.mixScaleX)*s,h.mixScaleY+=(m-h.mixScaleY)*s,h.mixShearY+=(g-h.mixShearY)*s}},t}(Ir),Zd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.pathConstraintPosition+"|"+i)||this;return a.pathConstraintIndex=0,a.pathConstraintIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.position=h.data.position;return;case C.first:h.position+=(h.data.position-h.position)*s}return}var c=this.getCurveValue(i);o==C.setup?h.position=h.data.position+(c-h.data.position)*s:h.position+=(c-h.position)*s}},t}(Cr),Kd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,Ct.pathConstraintSpacing+"|"+i)||this;return a.pathConstraintIndex=0,a.pathConstraintIndex=i,a}return t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.spacing=h.data.spacing;return;case C.first:h.spacing+=(h.data.spacing-h.spacing)*s}return}var c=this.getCurveValue(i);o==C.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*s:h.spacing+=(c-h.spacing)*s}},t}(Cr),Jd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,r,[Ct.pathConstraintMix+"|"+i])||this;return a.pathConstraintIndex=0,a.pathConstraintIndex=i,a}return t.prototype.getFrameEntries=function(){return 4},t.prototype.setFrame=function(e,r,i,a,s){var o=this.frames;e<<=2,o[e]=r,o[e+1]=i,o[e+2]=a,o[e+3]=s},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){switch(o){case C.setup:h.mixRotate=h.data.mixRotate,h.mixX=h.data.mixX,h.mixY=h.data.mixY;return;case C.first:h.mixRotate+=(h.data.mixRotate-h.mixRotate)*s,h.mixX+=(h.data.mixX-h.mixX)*s,h.mixY+=(h.data.mixY-h.mixY)*s}return}var c,f,d,p=ee.search(l,i,4),v=this.curves[p>>2];switch(v){case 0:var m=l[p];c=l[p+1],f=l[p+2],d=l[p+3];var g=(i-m)/(l[p+4]-m);c+=(l[p+4+1]-c)*g,f+=(l[p+4+2]-f)*g,d+=(l[p+4+3]-d)*g;break;case 1:c=l[p+1],f=l[p+2],d=l[p+3];break;default:c=this.getBezierValue(i,p,1,v-2),f=this.getBezierValue(i,p,2,v+18-2),d=this.getBezierValue(i,p,3,v+18*2-2)}if(o==C.setup){var y=h.data;h.mixRotate=y.mixRotate+(c-y.mixRotate)*s,h.mixX=y.mixX+(f-y.mixX)*s,h.mixY=y.mixY+(d-y.mixY)*s}else h.mixRotate+=(c-h.mixRotate)*s,h.mixX+=(f-h.mixX)*s,h.mixY+=(d-h.mixY)*s}},t}(Ir),Qd=function(n){xt(t,n);function t(e,r,i){var a=n.call(this,e,[Ct.sequence+"|"+r+"|"+i.sequence.id])||this;return a.slotIndex=r,a.attachment=i,a}return t.prototype.getFrameEntries=function(){return t.ENTRIES},t.prototype.getSlotIndex=function(){return this.slotIndex},t.prototype.getAttachment=function(){return this.attachment},t.prototype.setFrame=function(e,r,i,a,s){var o=this.frames;e*=t.ENTRIES,o[e]=r,o[e+t.MODE]=i|a<<4,o[e+t.DELAY]=s},t.prototype.apply=function(e,r,i,a,s,o,u){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.attachment,c=this.attachment;if(!(l!=c&&(!(l instanceof Wr)||l.timelineAttachment!=c))){var f=this.frames;if(i<f[0]){(o==C.setup||o==C.first)&&(h.sequenceIndex=-1);return}var d=ee.search(f,i,t.ENTRIES),p=f[d],v=f[d+t.MODE],m=f[d+t.DELAY];if(this.attachment.sequence){var g=v>>4,y=this.attachment.sequence.regions.length,x=Fd[v&15];if(x!=Ae.hold)switch(g+=(i-p)/m+1e-5|0,x){case Ae.once:g=Math.min(y-1,g);break;case Ae.loop:g%=y;break;case Ae.pingpong:{var b=(y<<1)-2;g=b==0?0:g%b,g>=y&&(g=b-g);break}case Ae.onceReverse:g=Math.max(y-1-g,0);break;case Ae.loopReverse:g=y-1-g%y;break;case Ae.pingpongReverse:{var b=(y<<1)-2;g=b==0?0:(g+y-1)%b,g>=y&&(g=b-g)}}h.sequenceIndex=g}}}},t.ENTRIES=3,t.MODE=1,t.DELAY=2,t}(ee),ux=function(){function n(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new fx(this),this.propertyIDs=new x0,this.animationsChanged=!1,this.trackEntryPool=new _l(function(){return new cx}),this.data=t}return n.emptyAnimation=function(){return n._emptyAnimation},n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var a=e[r];if(a){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var s=t*a.timeScale;if(a.delay>0){if(a.delay-=s,a.delay>0)continue;s=-a.delay,a.delay=0}var o=a.next;if(o){var u=a.trackLast-o.delay;if(u>=0){for(o.delay=0,o.trackTime+=a.timeScale==0?0:(u/a.timeScale+t)*o.timeScale,a.trackTime+=s,this.setCurrent(r,o,!0);o.mixingFrom;)o.mixTime+=t,o=o.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&!a.mixingFrom){e[r]=null,this.queue.end(a),this.clearNext(a);continue}if(a.mixingFrom&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for(a.mixingFrom=null,h&&(h.mixingTo=null);h;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=s}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(!r)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((r.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=r.mixingFrom,r.mixingFrom&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var e=this.events,r=this.tracks,i=!1,a=0,s=r.length;a<s;a++){var o=r[a];if(!(!o||o.delay>0)){i=!0;var u=a==0?C.first:o.mixBlend,h=o.alpha;o.mixingFrom?h*=this.applyMixingFrom(o,t,u):o.trackTime>=o.trackEnd&&!o.next&&(h=0);var l=o.animationLast,c=o.getAnimationTime(),f=c,d=e;o.reverse&&(f=o.animation.duration-f,d=null);var p=o.animation.timelines,v=p.length;if(a==0&&h==1||u==C.add)for(var m=0;m<v;m++){Y.webkit602BugfixHelper(h,u);var g=p[m];g instanceof di?this.applyAttachmentTimeline(g,t,f,u,!0):g.apply(t,l,f,d,h,u,mt.mixIn)}else{var y=o.timelineMode,x=o.shortestRotation,b=!x&&o.timelinesRotation.length!=v<<1;b&&(o.timelinesRotation.length=v<<1);for(var m=0;m<v;m++){var _=p[m],w=y[m]==Fu?u:C.setup;!x&&_ instanceof $s?this.applyRotateTimeline(_,t,f,h,w,o.timelinesRotation,m<<1,b):_ instanceof di?this.applyAttachmentTimeline(_,t,f,u,!0):(Y.webkit602BugfixHelper(h,u),_.apply(t,l,f,d,h,w,mt.mixIn))}}this.queueEvents(o,c),e.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime}}for(var S=this.unkeyedState+Tm,E=t.slots,T=0,A=t.slots.length;T<A;T++){var P=E[T];if(P.attachmentState==S){var M=P.data.attachmentName;P.setAttachment(M?t.getAttachment(P.data.index,M):null)}}return this.unkeyedState+=2,this.queue.drain(),i},n.prototype.applyMixingFrom=function(t,e,r){var i=t.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,e,r);var a=0;t.mixDuration==0?(a=1,r==C.first&&(r=C.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),r!=C.first&&(r=i.mixBlend));var s=a<i.attachmentThreshold,o=a<i.drawOrderThreshold,u=i.animation.timelines,h=u.length,l=i.alpha*t.interruptAlpha,c=l*(1-a),f=i.animationLast,d=i.getAnimationTime(),p=d,v=null;if(i.reverse?p=i.animation.duration-p:a<i.eventThreshold&&(v=this.events),r==C.add)for(var m=0;m<h;m++)u[m].apply(e,f,p,v,c,r,mt.mixOut);else{var g=i.timelineMode,y=i.timelineHoldMix,x=i.shortestRotation,b=!x&&i.timelinesRotation.length!=h<<1;b&&(i.timelinesRotation.length=h<<1),i.totalAlpha=0;for(var m=0;m<h;m++){var _=u[m],w=mt.mixOut,S=void 0,E=0;switch(g[m]){case Fu:if(!o&&_ instanceof Sa)continue;S=r,E=c;break;case Sm:S=C.setup,E=c;break;case Em:S=r,E=l;break;case Ou:S=C.setup,E=l;break;default:S=C.setup;var T=y[m];E=l*Math.max(0,1-T.mixTime/T.mixDuration);break}i.totalAlpha+=E,!x&&_ instanceof $s?this.applyRotateTimeline(_,e,p,E,S,i.timelinesRotation,m<<1,b):_ instanceof di?this.applyAttachmentTimeline(_,e,p,S,s):(Y.webkit602BugfixHelper(E,r),o&&_ instanceof Sa&&S==C.setup&&(w=mt.mixIn),_.apply(e,f,p,v,E,S,w))}}return t.mixDuration>0&&this.queueEvents(i,d),this.events.length=0,i.nextAnimationLast=d,i.nextTrackLast=i.trackTime,a},n.prototype.applyAttachmentTimeline=function(t,e,r,i,a){var s=e.slots[t.slotIndex];s.bone.active&&(r<t.frames[0]?(i==C.setup||i==C.first)&&this.setAttachment(e,s,s.data.attachmentName,a):this.setAttachment(e,s,t.attachmentNames[ee.search1(t.frames,r)],a),s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+Tm))},n.prototype.setAttachment=function(t,e,r,i){e.setAttachment(r?t.getAttachment(e.data.index,r):null),i&&(e.attachmentState=this.unkeyedState+BR)},n.prototype.applyRotateTimeline=function(t,e,r,i,a,s,o,u){if(u&&(s[o]=0),i==1){t.apply(e,0,r,null,1,a,mt.mixIn);return}var h=e.bones[t.boneIndex];if(h.active){var l=t.frames,c=0,f=0;if(r<l[0])switch(a){case C.setup:h.rotation=h.data.rotation;default:return;case C.first:c=h.rotation,f=h.data.rotation}else c=a==C.setup?h.data.rotation:h.rotation,f=h.data.rotation+t.getCurveValue(r);var d=0,p=f-c;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)d=s[o];else{var v=0,m=0;u?(v=0,m=p):(v=s[o],m=s[o+1]);var g=p>0,y=v>=0;B.signum(m)!=B.signum(p)&&Math.abs(m)<=90&&(Math.abs(v)>180&&(v+=360*B.signum(v)),y=g),d=p+v-v%360,y!=g&&(d+=360*B.signum(v)),s[o]=d}s[o+1]=p,h.rotation=c+d*i}},n.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,a=i-r,s=t.trackLast%a,o=this.events,u=0,h=o.length;u<h;u++){var l=o[u];if(l.time<s)break;l.time>i||this.queue.event(t,l)}var c=!1;for(t.loop?c=a==0||s>t.trackTime%a:c=e>=i&&t.animationLast<i,c&&this.queue.complete(t);u<h;u++){var f=o[u];f.time<r||this.queue.event(t,f)}},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(e){this.queue.end(e),this.clearNext(e);for(var r=e;;){var i=r.mixingFrom;if(!i)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,i&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,r){r===void 0&&(r=!1);var i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},n.prototype.setAnimationWith=function(t,e,r){if(r===void 0&&(r=!1),!e)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);a&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.clearNext(a),a=a.mixingFrom,i=!1):this.clearNext(a));var s=this.trackEntry(t,e,r,a);return this.setCurrent(t,s,i),this.queue.drain(),s},n.prototype.addAnimation=function(t,e,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);var a=this.data.skeletonData.findAnimation(e);if(!a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,r,i)},n.prototype.addAnimationWith=function(t,e,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=0),!e)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(a)for(;a.next;)a=a.next;var s=this.trackEntry(t,e,r,a);return a?(a.next=s,s.previous=a,i<=0&&(i+=a.getTrackComplete()-s.mixDuration)):(this.setCurrent(t,s,!0),this.queue.drain()),s.delay=i,s},n.prototype.setEmptyAnimation=function(t,e){e===void 0&&(e=0);var r=this.setAnimationWith(t,n.emptyAnimation(),!1);return r.mixDuration=e,r.trackEnd=e,r},n.prototype.addEmptyAnimation=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=0);var i=this.addAnimationWith(t,n.emptyAnimation(),!1,r);return r<=0&&(i.delay+=i.mixDuration-e),i.mixDuration=e,i.trackEnd=e,i},n.prototype.setEmptyAnimations=function(t){t===void 0&&(t=0);var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var a=this.tracks[r];a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(Y.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)},n.prototype.trackEntry=function(t,e,r,i){var a=this.trackEntryPool.obtain();return a.reset(),a.trackIndex=t,a.animation=e,a.loop=r,a.holdPrevious=!1,a.reverse=!1,a.shortestRotation=!1,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.mixTime=0,a.mixDuration=i?this.data.getMix(i.animation,e):0,a.interruptAlpha=1,a.totalAlpha=0,a.mixBlend=C.replace,a},n.prototype.clearNext=function(t){for(var e=t.next;e;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var t=this.tracks,e=0,r=t.length;e<r;e++){var i=t[e];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do(!i.mixingTo||i.mixBlend!=C.add)&&this.computeHold(i),i=i.mixingTo;while(i)}}},n.prototype.computeHold=function(t){var e=t.mixingTo,r=t.animation.timelines,i=t.animation.timelines.length,a=t.timelineMode;a.length=i;var s=t.timelineHoldMix;s.length=0;var o=this.propertyIDs;if(e&&e.holdPrevious){for(var u=0;u<i;u++)a[u]=o.addAll(r[u].getPropertyIds())?Ou:Em;return}t:for(var u=0;u<i;u++){var h=r[u],l=h.getPropertyIds();if(!o.addAll(l))a[u]=Fu;else if(!e||h instanceof di||h instanceof Sa||h instanceof Pl||!e.animation.hasTimeline(l))a[u]=Sm;else{for(var c=e.mixingTo;c;c=c.mixingTo)if(!c.animation.hasTimeline(l)){if(t.mixDuration>0){a[u]=OR,s[u]=c;continue t}break}a[u]=Ou}}},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.prototype.setAnimationByName=function(t,e,r){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,r)},n.prototype.addAnimationByName=function(t,e,r,i){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,r,i)},n.prototype.hasAnimation=function(t){var e=this.data.skeletonData.findAnimation(t);return e!==null},n.prototype.hasAnimationByName=function(t){return n.deprecatedWarning3||(n.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},n._emptyAnimation=new Al("<empty>",[],0),n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n.deprecatedWarning3=!1,n}(),cx=function(){function n(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=C.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return n.prototype.reset=function(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},n.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},n.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},n.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},n.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},n.prototype.getTrackComplete=function(){var t=this.animationEnd-this.animationStart;if(t!=0){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime},Object.defineProperty(n.prototype,"time",{get:function(){return n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endTime",{get:function(){return n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){n.deprecatedWarning2||(n.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),n.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},n.deprecatedWarning1=!1,n.deprecatedWarning2=!1,n}(),fx=function(){function n(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return n.prototype.start=function(t){this.objects.push(Ye.start),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.interrupt=function(t){this.objects.push(Ye.interrupt),this.objects.push(t)},n.prototype.end=function(t){this.objects.push(Ye.end),this.objects.push(t),this.animState.animationsChanged=!0},n.prototype.dispose=function(t){this.objects.push(Ye.dispose),this.objects.push(t)},n.prototype.complete=function(t){this.objects.push(Ye.complete),this.objects.push(t)},n.prototype.event=function(t,e){this.objects.push(Ye.event),this.objects.push(t),this.objects.push(e)},n.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],a=t[r+1];switch(i){case Ye.start:a.listener&&a.listener.start&&a.listener.start(a);for(var s=0;s<e.length;s++){var o=e[s];o.start&&o.start(a)}break;case Ye.interrupt:a.listener&&a.listener.interrupt&&a.listener.interrupt(a);for(var s=0;s<e.length;s++){var o=e[s];o.interrupt&&o.interrupt(a)}break;case Ye.end:a.listener&&a.listener.end&&a.listener.end(a);for(var s=0;s<e.length;s++){var o=e[s];o.end&&o.end(a)}case Ye.dispose:a.listener&&a.listener.dispose&&a.listener.dispose(a);for(var s=0;s<e.length;s++){var o=e[s];o.dispose&&o.dispose(a)}this.animState.trackEntryPool.free(a);break;case Ye.complete:a.listener&&a.listener.complete&&a.listener.complete(a);for(var s=0;s<e.length;s++){var o=e[s];o.complete&&o.complete(a)}break;case Ye.event:var u=t[r+++2];a.listener&&a.listener.event&&a.listener.event(a,u);for(var s=0;s<e.length;s++){var o=e[s];o.event&&o.event(a,u)}break}}this.clear(),this.drainDisabled=!1}},n.prototype.clear=function(){this.objects.length=0},n}(),Ye;(function(n){n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event"})(Ye||(Ye={}));var FR=function(){function n(){}return n.prototype.start=function(t){},n.prototype.interrupt=function(t){},n.prototype.end=function(t){},n.prototype.dispose=function(t){},n.prototype.complete=function(t){},n.prototype.event=function(t,e){},n}(),Fu=0,Sm=1,Em=2,Ou=3,OR=4,Tm=1,BR=2,dx=function(){function n(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return n.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(!a)throw new Error("Animation not found: "+e);this.setMixWith(i,a,r)},n.prototype.setMixWith=function(t,e,r){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},n.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return i===void 0?this.defaultMix:i},n}(),tp=function(){function n(t){this.atlas=t}return n.prototype.loadSequence=function(t,e,r){for(var i=r.regions,a=0,s=i.length;a<s;a++){var o=r.getPath(e,a),u=this.atlas.findRegion(o);if(u==null)throw new Error("Region not found in atlas: "+o+" (sequence: "+t+")");i[a]=u,i[a].renderObject=i[a]}},n.prototype.newRegionAttachment=function(t,e,r,i){var a=new Cd(e,r);if(i!=null)this.loadSequence(e,r,i);else{var s=this.atlas.findRegion(r);if(!s)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");s.renderObject=s,a.region=s}return a},n.prototype.newMeshAttachment=function(t,e,r,i){var a=new Tl(e,r);if(i!=null)this.loadSequence(e,r,i);else{var s=this.atlas.findRegion(r);if(!s)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");s.renderObject=s,a.region=s}return a},n.prototype.newBoundingBoxAttachment=function(t,e){return new ox(e)},n.prototype.newPathAttachment=function(t,e){return new js(e)},n.prototype.newPointAttachment=function(t,e){return new lx(e)},n.prototype.newClippingAttachment=function(t,e){return new hx(e)},n}(),Af=function(){function n(t,e,r){if(this.matrix=new te,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(n.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),n.prototype.isActive=function(){return this.active},n.prototype.update=function(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)},n.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},n.prototype.updateWorldTransformWith=function(t,e,r,i,a,s,o){this.ax=t,this.ay=e,this.arotation=r,this.ascaleX=i,this.ascaleY=a,this.ashearX=s,this.ashearY=o;var u=this.parent,h=this.matrix,l=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(!u){var f=this.skeleton,d=r+90+o;h.a=B.cosDeg(r+s)*i*l,h.c=B.cosDeg(d)*a*l,h.b=B.sinDeg(r+s)*i*c,h.d=B.sinDeg(d)*a*c,h.tx=t*l+f.x,h.ty=e*c+f.y;return}var p=u.matrix.a,v=u.matrix.c,m=u.matrix.b,g=u.matrix.d;switch(h.tx=p*t+v*e+u.matrix.tx,h.ty=m*t+g*e+u.matrix.ty,this.data.transformMode){case dt.Normal:{var d=r+90+o,y=B.cosDeg(r+s)*i,x=B.cosDeg(d)*a,b=B.sinDeg(r+s)*i,_=B.sinDeg(d)*a;h.a=p*y+v*b,h.c=p*x+v*_,h.b=m*y+g*b,h.d=m*x+g*_;return}case dt.OnlyTranslation:{var d=r+90+o;h.a=B.cosDeg(r+s)*i,h.c=B.cosDeg(d)*a,h.b=B.sinDeg(r+s)*i,h.d=B.sinDeg(d)*a;break}case dt.NoRotationOrReflection:{var w=p*p+m*m,S=0;w>1e-4?(w=Math.abs(p*g-v*m)/w,p/=l,m/=c,v=m*w,g=p*w,S=Math.atan2(m,p)*B.radDeg):(p=0,m=0,S=90-Math.atan2(g,v)*B.radDeg);var E=r+s-S,T=r+o-S+90,y=B.cosDeg(E)*i,x=B.cosDeg(T)*a,b=B.sinDeg(E)*i,_=B.sinDeg(T)*a;h.a=p*y-v*b,h.c=p*x-v*_,h.b=m*y+g*b,h.d=m*x+g*_;break}case dt.NoScale:case dt.NoScaleOrReflection:{var A=B.cosDeg(r),P=B.sinDeg(r),M=(p*A+v*P)/l,R=(m*A+g*P)/c,w=Math.sqrt(M*M+R*R);w>1e-5&&(w=1/w),M*=w,R*=w,w=Math.sqrt(M*M+R*R),this.data.transformMode==dt.NoScale&&p*g-v*m<0!=(l<0!=c<0)&&(w=-w);var F=Math.PI/2+Math.atan2(R,M),N=Math.cos(F)*w,D=Math.sin(F)*w,y=B.cosDeg(s)*i,x=B.cosDeg(90+o)*a,b=B.sinDeg(s)*i,_=B.sinDeg(90+o)*a;h.a=M*y+N*b,h.c=M*x+N*_,h.b=R*y+D*b,h.d=R*x+D*_;break}}h.a*=l,h.c*=l,h.b*=c,h.d*=c},n.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},n.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},n.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},n.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)},n.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)},n.prototype.updateAppliedTransform=function(){var t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg;return}var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),a=e.tx-r.tx,s=e.ty-r.ty;this.ax=a*r.d*i-s*r.c*i,this.ay=s*r.a*i-a*r.b*i;var o=i*r.d,u=i*r.a,h=i*r.c,l=i*r.b,c=o*e.a-h*e.b,f=o*e.c-h*e.d,d=u*e.b-l*e.a,p=u*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){var v=c*p-f*d;this.ascaleY=v/this.ascaleX,this.ashearY=Math.atan2(c*f+d*p,v)*B.radDeg,this.arotation=Math.atan2(d,c)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,f)*B.radDeg},n.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=1/(r*s-i*a),u=t.x-e.tx,h=t.y-e.ty;return t.x=u*s*o-h*i*o,t.y=h*r*o-u*a*o,t},n.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},n.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},n.prototype.localToWorldRotation=function(t){t-=this.rotation-this.shearX;var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},n.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,a=e.b,s=e.d,o=B.cosDeg(t),u=B.sinDeg(t);e.a=o*r-u*a,e.c=o*i-u*s,e.b=u*r+o*a,e.d=u*i+o*s},n}(),ep=function(){function n(t,e,r){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=dt.Normal,this.skinRequired=!1,this.color=new tt,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=r}return n}(),Il=function(){function n(t,e,r){this.name=t,this.order=e,this.skinRequired=r}return n}(),rp=function(){function n(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}return n}(),np=function(){function n(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}return n}(),px=function(){function n(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++){var i=e.findBone(t.bones[r].name);if(!i)throw new Error("Couldn't find bone "+t.bones[r].name);this.bones.push(i)}var a=e.findBone(t.target.name);if(!a)throw new Error("Couldn't find bone "+t.target.name);this.target=a}return n.prototype.isActive=function(){return this.active},n.prototype.update=function(){if(this.mix!=0){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}},n.prototype.apply1=function(t,e,r,i,a,s,o){var u=t.parent.matrix;if(!u)throw new Error("IK bone must have parent.");var h=u.a,l=u.c,c=u.b,f=u.d,d=-t.ashearX-t.arotation,p=0,v=0,m=t.skeleton.scaleX,g=-t.skeleton.scaleY;switch(t.data.transformMode){case dt.OnlyTranslation:p=e-t.worldX,v=r-t.worldY,v=-v;break;case dt.NoRotationOrReflection:var y=Math.abs(h*f-l*c)/(h*h+c*c),x=h/m,b=c/g;l=-b*y*m,f=x*y*g,d+=Math.atan2(b,x)*B.radDeg;default:var _=e-u.tx,w=r-u.ty,S=h*f-l*c;p=(_*f-w*l)/S-t.ax,v=(w*h-_*c)/S-t.ay}d+=Math.atan2(v,p)*B.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var E=t.ascaleX,T=t.ascaleY;if(i||a){switch(t.data.transformMode){case dt.NoScale:case dt.NoScaleOrReflection:p=e-t.worldX,v=r-t.worldY}var A=t.data.length*E,P=Math.sqrt(p*p+v*v);if(i&&P<A||a&&P>A&&A>1e-4){var y=(P/A-1)*o+1;E*=y,s&&(T*=y)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*o,E,T,t.ashearX,t.ashearY)},n.prototype.apply2=function(t,e,r,i,a,s,o,u,h){var l=t.ax,c=t.ay,f=t.ascaleX,d=t.ascaleY,p=f,v=d,m=e.ascaleX,g=t.matrix,y=0,x=0,b=0;f<0?(f=-f,y=180,b=-1):(y=0,b=1),d<0&&(d=-d,b=-b),m<0?(m=-m,x=180):x=0;var _=e.ax,w=0,S=0,E=0,T=g.a,A=g.c,P=g.b,M=g.d,R=Math.abs(f-d)<=1e-4;!R||s?(w=0,S=T*_+g.tx,E=P*_+g.ty):(w=e.ay,S=T*_+A*w+g.tx,E=P*_+M*w+g.ty);var F=t.parent.matrix;if(!F)throw new Error("IK parent must itself have a parent.");T=F.a,A=F.c,P=F.b,M=F.d;var N=1/(T*M-A*P),D=S-F.tx,X=E-F.ty,q=(D*M-X*A)*N-l,W=(X*T-D*P)*N-c,L=Math.sqrt(q*q+W*W),U=e.data.length*m,G,V;if(L<1e-4){this.apply1(t,r,i,!1,s,!1,h),e.updateWorldTransformWith(_,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}D=r-F.tx,X=i-F.ty;var O=(D*M-X*A)*N-l,z=(X*T-D*P)*N-c,j=O*O+z*z;if(u!=0){u*=f*(m+1)*.5;var K=Math.sqrt(j),Z=K-L-U*f+u;if(Z>0){var Q=Math.min(1,Z/(u*2))-1;Q=(Z-u*(1-Q*Q))/K,O-=Q*O,z-=Q*z,j=O*O+z*z}}t:if(R){U*=f;var nt=(j-L*L-U*U)/(2*L*U);nt<-1?(nt=-1,V=Math.PI*a):nt>1?(nt=1,V=0,s&&(T=(Math.sqrt(j)/(L+U)-1)*h+1,p*=T,o&&(v*=T))):V=Math.acos(nt)*a,T=L+U*nt,A=U*Math.sin(V),G=Math.atan2(z*T-O*A,O*T+z*A)}else{T=f*U,A=d*U;var J=T*T,it=A*A,st=Math.atan2(z,O);P=it*L*L+J*j-J*it;var ot=-2*it*L,pt=it-J;if(M=ot*ot-4*pt*P,M>=0){var ct=Math.sqrt(M);ot<0&&(ct=-ct),ct=-(ot+ct)*.5;var lt=ct/pt,Pt=P/ct,Ot=Math.abs(lt)<Math.abs(Pt)?lt:Pt;if(Ot*Ot<=j){X=Math.sqrt(j-Ot*Ot)*a,G=st-Math.atan2(X,Ot),V=Math.atan2(X/d,(Ot-L)/f);break t}}var re=B.PI,we=L-T,Se=we*we,Wt=0,Be=0,Ke=L+T,Ne=Ke*Ke,De=0;P=-T*L/(J-it),P>=-1&&P<=1&&(P=Math.acos(P),D=T*Math.cos(P)+L,X=A*Math.sin(P),M=D*D+X*X,M<Se&&(re=P,Se=M,we=D,Wt=X),M>Ne&&(Be=P,Ne=M,Ke=D,De=X)),j<=(Se+Ne)*.5?(G=st-Math.atan2(Wt*a,we),V=re*a):(G=st-Math.atan2(De*a,Ke),V=Be*a)}var Je=Math.atan2(w,_)*b,Ue=t.arotation;G=(G-Je)*B.radDeg+y-Ue,G>180?G-=360:G<-180&&(G+=360),t.updateWorldTransformWith(l,c,Ue+G*h,p,v,0,0),Ue=e.arotation,V=((V+Je)*B.radDeg-e.ashearX)*b+x-Ue,V>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(_,w,Ue+V*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},n}(),ip=function(n){xt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r._target=null,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return Object.defineProperty(t.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(e){this._target=e},enumerable:!1,configurable:!0}),t}(Il),ap=function(n){xt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r._target=null,r.positionMode=zt.Fixed,r.spacingMode=ce.Fixed,r.rotateMode=Qt.Chain,r.offsetRotation=0,r.position=0,r.spacing=0,r.mixRotate=0,r.mixX=0,r.mixY=0,r}return Object.defineProperty(t.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("SlotData not set.")},set:function(e){this._target=e},enumerable:!1,configurable:!0}),t}(Il),ce;(function(n){n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n[n.Proportional=3]="Proportional"})(ce||(ce={}));var vx=function(){function n(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++){var a=e.findBone(t.bones[r].name);if(!a)throw new Error("Couldn't find bone "+t.bones[r].name+".");this.bones.push(a)}var s=e.findSlot(t.target.name);if(!s)throw new Error("Couldn't find target bone "+t.target.name);this.target=s,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}return n.prototype.isActive=function(){return this.active},n.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof js){var e=this.mixRotate,r=this.mixX,i=this.mixY;if(!(e==0&&r==0&&i==0)){var a=this.data,s=a.rotateMode==Qt.Tangent,o=a.rotateMode==Qt.ChainScale,u=this.bones,h=u.length,l=s?h:h+1,c=Y.setArraySize(this.spaces,l),f=o?this.lengths=Y.setArraySize(this.lengths,h):[],d=this.spacing;switch(a.spacingMode){case ce.Percent:if(o)for(var p=0,v=l-1;p<v;p++){var m=u[p],g=m.data.length;if(g<n.epsilon)f[p]=0;else{var y=g*m.matrix.a,x=g*m.matrix.b;f[p]=Math.sqrt(y*y+x*x)}}Y.arrayFill(c,1,l,d);break;case ce.Proportional:for(var b=0,p=0,v=l-1;p<v;){var m=u[p],g=m.data.length;if(g<n.epsilon)o&&(f[p]=0),c[++p]=d;else{var y=g*m.matrix.a,x=g*m.matrix.b,_=Math.sqrt(y*y+x*x);o&&(f[p]=_),c[++p]=_,b+=_}}if(b>0){b=l/b*d;for(var p=1;p<l;p++)c[p]*=b}break;default:for(var w=a.spacingMode==ce.Length,p=0,v=l-1;p<v;){var m=u[p],g=m.data.length;if(g<n.epsilon)o&&(f[p]=0),c[++p]=d;else{var y=g*m.matrix.a,x=g*m.matrix.b,S=Math.sqrt(y*y+x*x);o&&(f[p]=S),c[++p]=(w?g+d:d)*S/g}}}var E=this.computeWorldPositions(t,l,s),T=E[0],A=E[1],P=a.offsetRotation,M=!1;if(P==0)M=a.rotateMode==Qt.Chain;else{M=!1;var R=this.target.bone.matrix;P*=R.a*R.d-R.b*R.c>0?B.degRad:-B.degRad}for(var p=0,R=3;p<h;p++,R+=3){var m=u[p],F=m.matrix;F.tx+=(T-F.tx)*r,F.ty+=(A-F.ty)*i;var y=E[R],x=E[R+1],N=y-T,D=x-A;if(o){var X=f[p];if(X!=0){var q=(Math.sqrt(N*N+D*D)/X-1)*e+1;F.a*=q,F.b*=q}}if(T=y,A=x,e>0){var W=F.a,L=F.c,U=F.b,G=F.d,V=0,O=0,z=0;if(s?V=E[R-1]:c[p+1]==0?V=E[R+2]:V=Math.atan2(D,N),V-=Math.atan2(U,W),M){O=Math.cos(V),z=Math.sin(V);var j=m.data.length;T+=(j*(O*W-z*U)-N)*e,A+=(j*(z*W+O*U)-D)*e}else V+=P;V>B.PI?V-=B.PI2:V<-B.PI&&(V+=B.PI2),V*=e,O=Math.cos(V),z=Math.sin(V),F.a=O*W-z*U,F.c=O*L-z*G,F.b=z*W+O*U,F.d=z*L+O*G}m.updateAppliedTransform()}}}},n.prototype.computeWorldPositions=function(t,e,r){var i=this.target,a=this.position,s=this.spaces,o=Y.setArraySize(this.positions,e*3+2),u=this.world,h=t.closed,l=t.worldVerticesLength,c=l/6,f=n.NONE;if(!t.constantSpeed){var d=t.lengths;c-=h?1:2;var p=d[c];this.data.positionMode==zt.Percent&&(a*=p);var v;switch(this.data.spacingMode){case ce.Percent:v=p;break;case ce.Proportional:v=p/e;break;default:v=1}u=Y.setArraySize(this.world,8);for(var m=0,g=0,y=0;m<e;m++,g+=3){var x=s[m]*v;a+=x;var b=a;if(h)b%=p,b<0&&(b+=p),y=0;else if(b<0){f!=n.BEFORE&&(f=n.BEFORE,t.computeWorldVertices(i,2,4,u,0,2)),this.addBeforePosition(b,u,0,o,g);continue}else if(b>p){f!=n.AFTER&&(f=n.AFTER,t.computeWorldVertices(i,l-6,4,u,0,2)),this.addAfterPosition(b-p,u,0,o,g);continue}for(;;y++){var _=d[y];if(!(b>_)){if(y==0)b/=_;else{var w=d[y-1];b=(b-w)/(_-w)}break}}y!=f&&(f=y,h&&y==c?(t.computeWorldVertices(i,l-4,4,u,0,2),t.computeWorldVertices(i,0,4,u,4,2)):t.computeWorldVertices(i,y*6+2,8,u,0,2)),this.addCurvePosition(b,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],o,g,r||m>0&&x==0)}return o}h?(l+=2,u=Y.setArraySize(this.world,l),t.computeWorldVertices(i,2,l-4,u,0,2),t.computeWorldVertices(i,0,2,u,l-4,2),u[l-2]=u[0],u[l-1]=u[1]):(c--,l-=4,u=Y.setArraySize(this.world,l),t.computeWorldVertices(i,2,l,u,0,2));for(var S=Y.setArraySize(this.curves,c),E=0,T=u[0],A=u[1],P=0,M=0,R=0,F=0,N=0,D=0,X=0,q=0,W=0,L=0,U=0,G=0,V=0,O=0,m=0,z=2;m<c;m++,z+=6)P=u[z],M=u[z+1],R=u[z+2],F=u[z+3],N=u[z+4],D=u[z+5],X=(T-P*2+R)*.1875,q=(A-M*2+F)*.1875,W=((P-R)*3-T+N)*.09375,L=((M-F)*3-A+D)*.09375,U=X*2+W,G=q*2+L,V=(P-T)*.75+X+W*.16666667,O=(M-A)*.75+q+L*.16666667,E+=Math.sqrt(V*V+O*O),V+=U,O+=G,U+=W,G+=L,E+=Math.sqrt(V*V+O*O),V+=U,O+=G,E+=Math.sqrt(V*V+O*O),V+=U+W,O+=G+L,E+=Math.sqrt(V*V+O*O),S[m]=E,T=N,A=D;this.data.positionMode==zt.Percent&&(a*=E);var j;switch(this.data.spacingMode){case ce.Percent:j=E;break;case ce.Proportional:j=E/e;break;default:j=1}for(var K=this.segments,Z=0,m=0,g=0,y=0,Q=0;m<e;m++,g+=3){var x=s[m]*j;a+=x;var b=a;if(h)b%=E,b<0&&(b+=E),y=0;else if(b<0){this.addBeforePosition(b,u,0,o,g);continue}else if(b>E){this.addAfterPosition(b-E,u,l-4,o,g);continue}for(;;y++){var nt=S[y];if(!(b>nt)){if(y==0)b/=nt;else{var w=S[y-1];b=(b-w)/(nt-w)}break}}if(y!=f){f=y;var J=y*6;for(T=u[J],A=u[J+1],P=u[J+2],M=u[J+3],R=u[J+4],F=u[J+5],N=u[J+6],D=u[J+7],X=(T-P*2+R)*.03,q=(A-M*2+F)*.03,W=((P-R)*3-T+N)*.006,L=((M-F)*3-A+D)*.006,U=X*2+W,G=q*2+L,V=(P-T)*.3+X+W*.16666667,O=(M-A)*.3+q+L*.16666667,Z=Math.sqrt(V*V+O*O),K[0]=Z,J=1;J<8;J++)V+=U,O+=G,U+=W,G+=L,Z+=Math.sqrt(V*V+O*O),K[J]=Z;V+=U,O+=G,Z+=Math.sqrt(V*V+O*O),K[8]=Z,V+=U+W,O+=G+L,Z+=Math.sqrt(V*V+O*O),K[9]=Z,Q=0}for(b*=Z;;Q++){var it=K[Q];if(!(b>it)){if(Q==0)b/=it;else{var w=K[Q-1];b=Q+(b-w)/(it-w)}break}}this.addCurvePosition(b*.1,T,A,P,M,R,F,N,D,o,g,r||m>0&&x==0)}return o},n.prototype.addBeforePosition=function(t,e,r,i,a){var s=e[r],o=e[r+1],u=e[r+2]-s,h=e[r+3]-o,l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addAfterPosition=function(t,e,r,i,a){var s=e[r+2],o=e[r+3],u=s-e[r],h=o-e[r+1],l=Math.atan2(h,u);i[a]=s+t*Math.cos(l),i[a+1]=o+t*Math.sin(l),i[a+2]=l},n.prototype.addCurvePosition=function(t,e,r,i,a,s,o,u,h,l,c,f){if(t==0||isNaN(t)){l[c]=e,l[c+1]=r,l[c+2]=Math.atan2(a-r,i-e);return}var d=t*t,p=d*t,v=1-t,m=v*v,g=m*v,y=v*t,x=y*3,b=v*x,_=x*t,w=e*g+i*b+s*_+u*p,S=r*g+a*b+o*_+h*p;l[c]=w,l[c+1]=S,f&&(t<.001?l[c+2]=Math.atan2(a-r,i-e):l[c+2]=Math.atan2(S-(r*m+a*y*2+o*d),w-(e*m+i*y*2+s*d)))},n.NONE=-1,n.BEFORE=-2,n.AFTER=-3,n.epsilon=1e-5,n}(),mx=function(){function n(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new tt,this.darkColor=t.darkColor?new tt:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}return n.prototype.getSkeleton=function(){return this.bone.skeleton},n.prototype.getAttachment=function(){return this.attachment},n.prototype.setAttachment=function(t){this.attachment!=t&&((!(t instanceof Wr)||!(this.attachment instanceof Wr)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)},n.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null},n}(),gx=function(){function n(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new Ds,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(var r=0;r<t.bones.length;r++){var i=e.findBone(t.bones[r].name);if(!i)throw new Error("Couldn't find bone "+t.bones[r].name+".");this.bones.push(i)}var a=e.findBone(t.target.name);if(!a)throw new Error("Couldn't find target bone "+t.target.name+".");this.target=a}return n.prototype.isActive=function(){return this.active},n.prototype.update=function(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())},n.prototype.applyAbsoluteWorld=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,a=this.mixScaleY,s=this.mixShearY,o=e!=0||r!=0,u=this.target,h=u.matrix,l=h.a,c=h.c,f=h.b,d=h.d,p=l*d-c*f>0?B.degRad:-B.degRad,v=this.data.offsetRotation*p,m=this.data.offsetShearY*p,g=this.bones,y=0,x=g.length;y<x;y++){var b=g[y],_=b.matrix;if(t!=0){var w=_.a,S=_.c,E=_.b,T=_.d,A=Math.atan2(f,l)-Math.atan2(E,w)+v;A>B.PI?A-=B.PI2:A<-B.PI&&(A+=B.PI2),A*=t;var P=Math.cos(A),M=Math.sin(A);_.a=P*w-M*E,_.c=P*S-M*T,_.b=M*w+P*E,_.d=M*S+P*T}if(o){var R=this.temp;u.localToWorld(R.set(this.data.offsetX,this.data.offsetY)),_.tx+=(R.x-_.tx)*e,_.ty+=(R.y-_.ty)*r}if(i!=0){var F=Math.sqrt(_.a*_.a+_.b*_.b);F!=0&&(F=(F+(Math.sqrt(l*l+f*f)-F+this.data.offsetScaleX)*i)/F),_.a*=F,_.b*=F}if(a!=0){var F=Math.sqrt(_.c*_.c+_.d*_.d);F!=0&&(F=(F+(Math.sqrt(c*c+d*d)-F+this.data.offsetScaleY)*a)/F),_.c*=F,_.d*=F}if(s>0){var S=_.c,T=_.d,N=Math.atan2(T,S),A=Math.atan2(d,c)-Math.atan2(f,l)-(N-Math.atan2(_.b,_.a));A>B.PI?A-=B.PI2:A<-B.PI&&(A+=B.PI2),A=N+(A+m)*s;var F=Math.sqrt(S*S+T*T);_.c=Math.cos(A)*F,_.d=Math.sin(A)*F}b.updateAppliedTransform()}},n.prototype.applyRelativeWorld=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,a=this.mixScaleY,s=this.mixShearY,o=e!=0||r!=0,u=this.target,h=u.matrix,l=h.a,c=h.c,f=h.b,d=h.d,p=l*d-c*f>0?B.degRad:-B.degRad,v=this.data.offsetRotation*p,m=this.data.offsetShearY*p,g=this.bones,y=0,x=g.length;y<x;y++){var b=g[y],_=b.matrix;if(t!=0){var w=_.a,S=_.c,E=_.b,T=_.d,A=Math.atan2(f,l)+v;A>B.PI?A-=B.PI2:A<-B.PI&&(A+=B.PI2),A*=t;var P=Math.cos(A),M=Math.sin(A);_.a=P*w-M*E,_.c=P*S-M*T,_.b=M*w+P*E,_.d=M*S+P*T}if(o){var R=this.temp;u.localToWorld(R.set(this.data.offsetX,this.data.offsetY)),_.tx+=R.x*e,_.ty+=R.y*r}if(i!=0){var F=(Math.sqrt(l*l+f*f)-1+this.data.offsetScaleX)*i+1;_.a*=F,_.b*=F}if(a!=0){var F=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleY)*a+1;_.c*=F,_.d*=F}if(s>0){var A=Math.atan2(d,c)-Math.atan2(f,l);A>B.PI?A-=B.PI2:A<-B.PI&&(A+=B.PI2);var S=_.c,T=_.d;A=Math.atan2(T,S)+(A-B.PI/2+m)*s;var F=Math.sqrt(S*S+T*T);_.c=Math.cos(A)*F,_.d=Math.sin(A)*F}b.updateAppliedTransform()}},n.prototype.applyAbsoluteLocal=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,a=this.mixScaleY,s=this.mixShearY,o=this.target,u=this.bones,h=0,l=u.length;h<l;h++){var c=u[h],f=c.arotation;if(t!=0){var d=o.arotation-f+this.data.offsetRotation;d-=(16384-(16384.499999999996-d/360|0))*360,f+=d*t}var p=c.ax,v=c.ay;p+=(o.ax-p+this.data.offsetX)*e,v+=(o.ay-v+this.data.offsetY)*r;var m=c.ascaleX,g=c.ascaleY;i!=0&&m!=0&&(m=(m+(o.ascaleX-m+this.data.offsetScaleX)*i)/m),a!=0&&g!=0&&(g=(g+(o.ascaleY-g+this.data.offsetScaleY)*a)/g);var y=c.ashearY;if(s!=0){var d=o.ashearY-y+this.data.offsetShearY;d-=(16384-(16384.499999999996-d/360|0))*360,y+=d*s}c.updateWorldTransformWith(p,v,f,m,g,c.ashearX,y)}},n.prototype.applyRelativeLocal=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,a=this.mixScaleY,s=this.mixShearY,o=this.target,u=this.bones,h=0,l=u.length;h<l;h++){var c=u[h],f=c.arotation+(o.arotation+this.data.offsetRotation)*t,d=c.ax+(o.ax+this.data.offsetX)*e,p=c.ay+(o.ay+this.data.offsetY)*r,v=c.ascaleX*((o.ascaleX-1+this.data.offsetScaleX)*i+1),m=c.ascaleY*((o.ascaleY-1+this.data.offsetScaleY)*a+1),g=c.ashearY+(o.ashearY+this.data.offsetShearY)*s;c.updateWorldTransformWith(d,p,f,v,m,c.ashearX,g)}},n}(),yx=function(){function n(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(!r.parent)i=new Af(r,this,null);else{var a=this.bones[r.parent.index];i=new Af(r,this,a),a.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var e=0;e<t.slots.length;e++){var s=t.slots[e],i=this.bones[s.boneData.index],o=new mx(s,i);this.slots.push(o),this.drawOrder.push(o)}this.ikConstraints=new Array;for(var e=0;e<t.ikConstraints.length;e++){var u=t.ikConstraints[e];this.ikConstraints.push(new px(u,this))}this.transformConstraints=new Array;for(var e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new gx(h,this))}this.pathConstraints=new Array;for(var e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new vx(l,this))}this.color=new tt(1,1,1,1),this.updateCache()}return n.prototype.updateCache=function(){var t=this._updateCache;t.length=0;for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];a.sorted=a.data.skinRequired,a.active=!a.sorted}if(this.skin)for(var s=this.skin.bones,r=0,i=this.skin.bones.length;r<i;r++){var a=this.bones[s[r].index];do a.sorted=!1,a.active=!0,a=a.parent;while(a)}var o=this.ikConstraints,u=this.transformConstraints,h=this.pathConstraints,l=o.length,c=u.length,f=h.length,d=l+c+f;t:for(var r=0;r<d;r++){for(var p=0;p<l;p++){var v=o[p];if(v.data.order==r){this.sortIkConstraint(v);continue t}}for(var p=0;p<c;p++){var v=u[p];if(v.data.order==r){this.sortTransformConstraint(v);continue t}}for(var p=0;p<f;p++){var v=h[p];if(v.data.order==r){this.sortPathConstraint(v);continue t}}}for(var r=0,i=e.length;r<i;r++)this.sortBone(e[r])},n.prototype.sortIkConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),r.length==1)this._updateCache.push(t),this.sortReset(i.children);else{var a=r[r.length-1];this.sortBone(a),this._updateCache.push(t),this.sortReset(i.children),a.sorted=!0}}},n.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){var e=t.target,r=e.data.index,i=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,r,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],r,i);var o=e.getAttachment();o instanceof js&&this.sortPathConstraintAttachmentWith(o,i);for(var u=t.bones,h=u.length,a=0;a<h;a++)this.sortBone(u[a]);this._updateCache.push(t);for(var a=0;a<h;a++)this.sortReset(u[a].children);for(var a=0;a<h;a++)u[a].sorted=!0}},n.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!!t.active){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var a=e[i];this.sortBone(a.parent),this.sortBone(a)}else for(var i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var i=0;i<r;i++)this.sortReset(e[i].children);for(var i=0;i<r;i++)e[i].sorted=!0}},n.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],r)},n.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof js){var r=t.bones;if(!r)this.sortBone(e);else for(var i=this.bones,a=0,s=r.length;a<s;){var o=r[a++];for(o+=a;a<o;)this.sortBone(i[r[a++]])}}},n.prototype.sortBone=function(t){if(t&&!t.sorted){var e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},n.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},n.prototype.updateWorldTransform=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY}for(var a=this._updateCache,e=0,r=a.length;e<r;e++)a[e].update()},n.prototype.updateWorldTransformWith=function(t){var e=this.getRootBone(),r=t.matrix.a,i=t.matrix.c,a=t.matrix.b,s=t.matrix.d;e.matrix.tx=r*this.x+i*this.y+t.worldX,e.matrix.ty=a*this.x+s*this.y+t.worldY;var o=e.rotation+90+e.shearY,u=B.cosDeg(e.rotation+e.shearX)*e.scaleX,h=B.cosDeg(o)*e.scaleY,l=B.sinDeg(e.rotation+e.shearX)*e.scaleX,c=B.sinDeg(o)*e.scaleY,f=this.scaleX,d=-this.scaleY;e.matrix.a=(r*u+i*l)*f,e.matrix.c=(r*h+i*c)*f,e.matrix.b=(a*u+s*l)*d,e.matrix.d=(a*h+s*c)*d;for(var p=this._updateCache,v=0,m=p.length;v<m;v++){var g=p[v];g!=e&&g.update()}},n.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},n.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();for(var i=this.ikConstraints,e=0,r=i.length;e<r;e++){var a=i[e];a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}for(var s=this.transformConstraints,e=0,r=s.length;e<r;e++){var a=s[e],o=a.data;a.mixRotate=o.mixRotate,a.mixX=o.mixX,a.mixY=o.mixY,a.mixScaleX=o.mixScaleX,a.mixScaleY=o.mixScaleY,a.mixShearY=o.mixShearY}for(var u=this.pathConstraints,e=0,r=u.length;e<r;e++){var a=u[e],o=a.data;a.position=o.position,a.spacing=o.spacing,a.mixRotate=o.mixRotate,a.mixX=o.mixX,a.mixY=o.mixY}},n.prototype.setSlotsToSetupPose=function(){var t=this.slots;Y.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},n.prototype.getRootBone=function(){return this.bones.length==0?null:this.bones[0]},n.prototype.findBone=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.findSlot=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},n.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)},n.prototype.setSkin=function(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r],s=a.data.attachmentName;if(s){var o=t.getAttachment(r,s);o&&a.setAttachment(o)}}this.skin=t,this.updateCache()}},n.prototype.getAttachmentByName=function(t,e){var r=this.data.findSlot(t);if(!r)throw new Error("Can't find slot with name "+t);return this.getAttachment(r.index,e)},n.prototype.getAttachment=function(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){var r=this.skin.getAttachment(t,e);if(r)return r}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},n.prototype.setAttachment=function(t,e){if(!t)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,a=r.length;i<a;i++){var s=r[i];if(s.data.name==t){var o=null;if(e&&(o=this.getAttachment(i,e),!o))throw new Error("Attachment not found: "+e+", for slot: "+t);s.setAttachment(o);return}}throw new Error("Slot not found: "+t)},n.prototype.findIkConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.data.name==t)return a}return null},n.prototype.getBoundsRect=function(){var t=new Ds,e=new Ds;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}},n.prototype.getBounds=function(t,e,r){if(r===void 0&&(r=new Array(2)),!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var c=i[h];if(c.bone.active){var f=0,d=null,p=c.getAttachment();if(p instanceof Cd)f=8,d=Y.setArraySize(r,f,0),p.computeWorldVertices(c,d,0,2);else if(p instanceof Tl){var v=p;f=v.worldVerticesLength,d=Y.setArraySize(r,f,0),v.computeWorldVertices(c,0,f,d,0,2)}if(d)for(var m=0,g=d.length;m<g;m+=2){var y=d[m],x=d[m+1];a=Math.min(a,y),s=Math.min(s,x),o=Math.max(o,y),u=Math.max(u,x)}}}t.set(a,s),e.set(o-a,u-s)},Object.defineProperty(n.prototype,"flipX",{get:function(){return this.scaleX==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flipY",{get:function(){return this.scaleY==-1},set:function(t){n.deprecatedWarning1||(n.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1},enumerable:!1,configurable:!0}),n.deprecatedWarning1=!1,n}(),sp=function(){function n(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}return n.prototype.findBone=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findBoneIndex=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSlot=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findSlotIndex=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n.prototype.findSkin=function(t){if(!t)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findEvent=function(t){if(!t)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findAnimation=function(t){if(!t)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findIkConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findTransformConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var a=e[r];if(a.name==t)return a}return null},n.prototype.findPathConstraintIndex=function(t){if(t==null)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},n}(),op=function(){function n(t,e,r){if(this.index=0,this.color=new tt(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=at.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!r)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r}return n}(),hp=function(n){xt(t,n);function t(e){var r=n.call(this,e,0,!1)||this;return r.bones=new Array,r._target=null,r.mixRotate=0,r.mixX=0,r.mixY=0,r.mixScaleX=0,r.mixScaleY=0,r.mixShearY=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return Object.defineProperty(t.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(e){this._target=e},enumerable:!1,configurable:!0}),t}(Il),Mf=function(){function n(t,e,r){this.slotIndex=t,this.name=e,this.attachment=r}return n}(),Jh=function(){function n(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}return n.prototype.setAttachment=function(t,e,r){if(!r)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},n.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==r){i=!0;break}i||this.bones.push(r)}for(var e=0;e<t.constraints.length;e++){for(var s=t.constraints[e],i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}for(var o=t.getAttachments(),e=0;e<o.length;e++){var u=o[e];this.setAttachment(u.slotIndex,u.name,u.attachment)}},n.prototype.copySkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==r){i=!0;break}i||this.bones.push(r)}for(var e=0;e<t.constraints.length;e++){for(var s=t.constraints[e],i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}for(var o=t.getAttachments(),e=0;e<o.length;e++){var u=o[e];u.attachment&&(u.attachment instanceof Tl?(u.attachment=u.attachment.newLinkedMesh(),this.setAttachment(u.slotIndex,u.name,u.attachment)):(u.attachment=u.attachment.copy(),this.setAttachment(u.slotIndex,u.name,u.attachment)))}},n.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},n.prototype.removeAttachment=function(t,e){var r=this.attachments[t];r&&delete r[e]},n.prototype.getAttachments=function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var r=this.attachments[e];if(r)for(var i in r){var a=r[i];a&&t.push(new Mf(e,i,a))}}return t},n.prototype.getAttachmentsForSlot=function(t,e){var r=this.attachments[t];if(r)for(var i in r){var a=r[i];a&&e.push(new Mf(t,i,a))}},n.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},n.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var a=t.slots[i],s=a.getAttachment();if(s&&r<e.attachments.length){var o=e.attachments[r];for(var u in o){var h=o[u];if(s==h){var l=this.getAttachment(r,u);l&&a.setAttachment(l);break}}}r++}},n}(),xx=function(){function n(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return n.prototype.readSkeletonData=function(t){var e=this.scale,r=new sp;r.name="";var i=new jh(t),a=i.readInt32(),s=i.readInt32();r.hash=s==0&&a==0?null:s.toString(16)+a.toString(16),r.version=i.readString();var o=r.version.substr(0,3);if(o!=="4.0"&&o!=="4.1"){var u="Spine 4.1 loader cant load version "+r.version+". Please configure your pixi-spine bundle";console.error(u)}this.ver40=o==="4.0",r.x=i.readFloat(),r.y=i.readFloat(),r.width=i.readFloat(),r.height=i.readFloat();var h=i.readBoolean();h&&(r.fps=i.readFloat(),r.imagesPath=i.readString(),r.audioPath=i.readString());var l=0;l=i.readInt(!0);for(var c=0;c<l;c++){var f=i.readString();if(!f)throw new Error("String in string table must not be null.");i.strings.push(f)}l=i.readInt(!0);for(var c=0;c<l;c++){var d=i.readString();if(!d)throw new Error("Bone name must not be null.");var p=c==0?null:r.bones[i.readInt(!0)],v=new ep(c,d,p);v.rotation=i.readFloat(),v.x=i.readFloat()*e,v.y=i.readFloat()*e,v.scaleX=i.readFloat(),v.scaleY=i.readFloat(),v.shearX=i.readFloat(),v.shearY=i.readFloat(),v.length=i.readFloat()*e,v.transformMode=i.readInt(!0),v.skinRequired=i.readBoolean(),h&&tt.rgba8888ToColor(v.color,i.readInt32()),r.bones.push(v)}l=i.readInt(!0);for(var c=0;c<l;c++){var m=i.readString();if(!m)throw new Error("Slot name must not be null.");var g=r.bones[i.readInt(!0)],v=new op(c,m,g);tt.rgba8888ToColor(v.color,i.readInt32());var y=i.readInt32();y!=-1&&tt.rgb888ToColor(v.darkColor=new tt,y),v.attachmentName=i.readStringRef(),v.blendMode=i.readInt(!0),r.slots.push(v)}l=i.readInt(!0);for(var c=0,x=void 0;c<l;c++){var b=i.readString();if(!b)throw new Error("IK constraint data name must not be null.");var v=new ip(b);v.order=i.readInt(!0),v.skinRequired=i.readBoolean(),x=i.readInt(!0);for(var _=0;_<x;_++)v.bones.push(r.bones[i.readInt(!0)]);v.target=r.bones[i.readInt(!0)],v.mix=i.readFloat(),v.softness=i.readFloat()*e,v.bendDirection=i.readByte(),v.compress=i.readBoolean(),v.stretch=i.readBoolean(),v.uniform=i.readBoolean(),r.ikConstraints.push(v)}l=i.readInt(!0);for(var c=0,x=void 0;c<l;c++){var w=i.readString();if(!w)throw new Error("Transform constraint data name must not be null.");var v=new hp(w);v.order=i.readInt(!0),v.skinRequired=i.readBoolean(),x=i.readInt(!0);for(var _=0;_<x;_++)v.bones.push(r.bones[i.readInt(!0)]);v.target=r.bones[i.readInt(!0)],v.local=i.readBoolean(),v.relative=i.readBoolean(),v.offsetRotation=i.readFloat(),v.offsetX=i.readFloat()*e,v.offsetY=i.readFloat()*e,v.offsetScaleX=i.readFloat(),v.offsetScaleY=i.readFloat(),v.offsetShearY=i.readFloat(),v.mixRotate=i.readFloat(),v.mixX=i.readFloat(),v.mixY=i.readFloat(),v.mixScaleX=i.readFloat(),v.mixScaleY=i.readFloat(),v.mixShearY=i.readFloat(),r.transformConstraints.push(v)}l=i.readInt(!0);for(var c=0,x=void 0;c<l;c++){var S=i.readString();if(!S)throw new Error("Path constraint data name must not be null.");var v=new ap(S);v.order=i.readInt(!0),v.skinRequired=i.readBoolean(),x=i.readInt(!0);for(var _=0;_<x;_++)v.bones.push(r.bones[i.readInt(!0)]);v.target=r.slots[i.readInt(!0)],v.positionMode=i.readInt(!0),v.spacingMode=i.readInt(!0),v.rotateMode=i.readInt(!0),v.offsetRotation=i.readFloat(),v.position=i.readFloat(),v.positionMode==zt.Fixed&&(v.position*=e),v.spacing=i.readFloat(),(v.spacingMode==ce.Length||v.spacingMode==ce.Fixed)&&(v.spacing*=e),v.mixRotate=i.readFloat(),v.mixX=i.readFloat(),v.mixY=i.readFloat(),r.pathConstraints.push(v)}var E=this.readSkin(i,r,!0,h);E&&(r.defaultSkin=E,r.skins.push(E));{var c=r.skins.length;for(Y.setArraySize(r.skins,l=c+i.readInt(!0));c<l;c++){var T=this.readSkin(i,r,!1,h);if(!T)throw new Error("readSkin() should not have returned null.");r.skins[c]=T}}l=this.linkedMeshes.length;for(var c=0;c<l;c++){var A=this.linkedMeshes[c],T=A.skin?r.findSkin(A.skin):r.defaultSkin;if(!T)throw new Error("Not skin found for linked mesh.");if(!A.parent)throw new Error("Linked mesh parent must not be null");var P=T.getAttachment(A.slotIndex,A.parent);if(!P)throw new Error("Parent mesh not found: "+A.parent);A.mesh.timelineAttachment=A.inheritTimeline?P:A.mesh,A.mesh.setParentMesh(P)}this.linkedMeshes.length=0,l=i.readInt(!0);for(var c=0;c<l;c++){var M=i.readStringRef();if(!M)throw new Error;var v=new np(M);v.intValue=i.readInt(!1),v.floatValue=i.readFloat(),v.stringValue=i.readString(),v.audioPath=i.readString(),v.audioPath&&(v.volume=i.readFloat(),v.balance=i.readFloat()),r.events.push(v)}l=i.readInt(!0);for(var c=0;c<l;c++){var R=i.readString();if(!R)throw new Error("Animatio name must not be null.");r.animations.push(this.readAnimation(i,R,r))}return r},n.prototype.readSkin=function(t,e,r,i){var a=null,s=0;if(r){if(s=t.readInt(!0),s==0)return null;a=new Jh("default")}else{var o=t.readStringRef();if(!o)throw new Error("Skin name must not be null.");a=new Jh(o),a.bones.length=t.readInt(!0);for(var u=0,h=a.bones.length;u<h;u++)a.bones[u]=e.bones[t.readInt(!0)];for(var u=0,h=t.readInt(!0);u<h;u++)a.constraints.push(e.ikConstraints[t.readInt(!0)]);for(var u=0,h=t.readInt(!0);u<h;u++)a.constraints.push(e.transformConstraints[t.readInt(!0)]);for(var u=0,h=t.readInt(!0);u<h;u++)a.constraints.push(e.pathConstraints[t.readInt(!0)]);s=t.readInt(!0)}for(var u=0;u<s;u++)for(var l=t.readInt(!0),c=0,f=t.readInt(!0);c<f;c++){var d=t.readStringRef();if(!d)throw new Error("Attachment name must not be null");var p=this.readAttachment(t,e,a,l,d,i);p&&a.setAttachment(l,d,p)}return a},n.prototype.readAttachment=function(t,e,r,i,a,s){var o=this.scale,u=t.readStringRef();switch(u||(u=a),t.readByte()){case yt.Region:{var h=t.readStringRef(),l=t.readFloat(),c=t.readFloat(),f=t.readFloat(),d=t.readFloat(),p=t.readFloat(),v=t.readFloat(),m=t.readFloat(),g=t.readInt32(),y=this.readSequence(t);h||(h=u);var x=this.attachmentLoader.newRegionAttachment(r,u,h,y);return x?(x.path=h,x.x=c*o,x.y=f*o,x.scaleX=d,x.scaleY=p,x.rotation=l,x.width=v*o,x.height=m*o,tt.rgba8888ToColor(x.color,g),x.sequence=y,y==null&&x.updateRegion(),x):null}case yt.BoundingBox:{var b=t.readInt(!0),_=this.readVertices(t,b),g=s?t.readInt32():0,w=this.attachmentLoader.newBoundingBoxAttachment(r,u);return w?(w.worldVerticesLength=b<<1,w.vertices=_.vertices,w.bones=_.bones,s&&tt.rgba8888ToColor(w.color,g),w):null}case yt.Mesh:{var h=t.readStringRef(),g=t.readInt32(),b=t.readInt(!0),S=this.readFloatArray(t,b<<1,1),E=this.readShortArray(t),_=this.readVertices(t,b),T=t.readInt(!0),y=this.readSequence(t),A=[],v=0,m=0;s&&(A=this.readShortArray(t),v=t.readFloat(),m=t.readFloat()),h||(h=u);var P=this.attachmentLoader.newMeshAttachment(r,u,h,y);return P?(P.path=h,tt.rgba8888ToColor(P.color,g),P.bones=_.bones,P.vertices=_.vertices,P.worldVerticesLength=b<<1,P.triangles=E,P.regionUVs=new Float32Array(S),P.hullLength=T<<1,P.sequence=y,s&&(P.edges=A,P.width=v*o,P.height=m*o),P):null}case yt.LinkedMesh:{var h=t.readStringRef(),g=t.readInt32(),M=t.readStringRef(),R=t.readStringRef(),F=t.readBoolean(),y=this.readSequence(t),v=0,m=0;s&&(v=t.readFloat(),m=t.readFloat()),h||(h=u);var P=this.attachmentLoader.newMeshAttachment(r,u,h,y);return P?(P.path=h,tt.rgba8888ToColor(P.color,g),P.sequence=y,s&&(P.width=v*o,P.height=m*o),this.linkedMeshes.push(new NR(P,M,i,R,F)),P):null}case yt.Path:{for(var N=t.readBoolean(),D=t.readBoolean(),b=t.readInt(!0),_=this.readVertices(t,b),X=Y.newArray(b/3,0),q=0,W=X.length;q<W;q++)X[q]=t.readFloat()*o;var g=s?t.readInt32():0,h=this.attachmentLoader.newPathAttachment(r,u);return h?(h.closed=N,h.constantSpeed=D,h.worldVerticesLength=b<<1,h.vertices=_.vertices,h.bones=_.bones,h.lengths=X,s&&tt.rgba8888ToColor(h.color,g),h):null}case yt.Point:{var l=t.readFloat(),c=t.readFloat(),f=t.readFloat(),g=s?t.readInt32():0,L=this.attachmentLoader.newPointAttachment(r,u);return L?(L.x=c*o,L.y=f*o,L.rotation=l,s&&tt.rgba8888ToColor(L.color,g),L):null}case yt.Clipping:{var U=t.readInt(!0),b=t.readInt(!0),_=this.readVertices(t,b),g=s?t.readInt32():0,G=this.attachmentLoader.newClippingAttachment(r,u);return G?(G.endSlot=e.slots[U],G.worldVerticesLength=b<<1,G.vertices=_.vertices,G.bones=_.bones,s&&tt.rgba8888ToColor(G.color,g),G):null}}return null},n.prototype.readSequence=function(t){if(this.ver40||!t.readBoolean())return null;var e=new Rd(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e},n.prototype.readDeformTimelineType=function(t){return this.ver40?Am:t.readByte()},n.prototype.readVertices=function(t,e){var r=this.scale,i=e<<1,a=new kR;if(!t.readBoolean())return a.vertices=this.readFloatArray(t,i,r),a;for(var s=new Array,o=new Array,u=0;u<e;u++){var h=t.readInt(!0);o.push(h);for(var l=0;l<h;l++)o.push(t.readInt(!0)),s.push(t.readFloat()*r),s.push(t.readFloat()*r),s.push(t.readFloat())}return a.vertices=Y.toFloatArray(s),a.bones=o,a},n.prototype.readFloatArray=function(t,e,r){var i=new Array(e);if(r==1)for(var a=0;a<e;a++)i[a]=t.readFloat();else for(var a=0;a<e;a++)i[a]=t.readFloat()*r;return i},n.prototype.readShortArray=function(t){for(var e=t.readInt(!0),r=new Array(e),i=0;i<e;i++)r[i]=t.readShort();return r},n.prototype.readAnimation=function(t,e,r){t.readInt(!0);for(var i=new Array,a=this.scale,s=0,o=t.readInt(!0);s<o;s++)for(var u=t.readInt(!0),h=0,l=t.readInt(!0);h<l;h++){var c=t.readByte(),f=t.readInt(!0),d=f-1;switch(c){case jR:{for(var p=new di(f,u),v=0;v<f;v++)p.setFrame(v,t.readFloat(),t.readStringRef());i.push(p);break}case $R:{for(var m=t.readInt(!0),p=new zd(f,m,u),g=t.readFloat(),y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,v=0,w=0;p.setFrame(v,g,y,x,b,_),v!=d;v++){var S=t.readFloat(),E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,y,E,1),Et(t,p,w++,v,1,g,S,x,T,1),Et(t,p,w++,v,2,g,S,b,A,1),Et(t,p,w++,v,3,g,S,_,P,1)}g=S,y=E,x=T,b=A,_=P}i.push(p);break}case qR:{for(var m=t.readInt(!0),p=new Gd(f,m,u),g=t.readFloat(),y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,v=0,w=0;p.setFrame(v,g,y,x,b),v!=d;v++){var S=t.readFloat(),E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,y,E,1),Et(t,p,w++,v,1,g,S,x,T,1),Et(t,p,w++,v,2,g,S,b,A,1)}g=S,y=E,x=T,b=A}i.push(p);break}case ZR:{for(var m=t.readInt(!0),p=new Wd(f,m,u),g=t.readFloat(),y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,v=0,w=0;p.setFrame(v,g,y,x,b,_,E,T,A),v!=d;v++){var S=t.readFloat(),M=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,q=t.readUnsignedByte()/255;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,y,M,1),Et(t,p,w++,v,1,g,S,x,R,1),Et(t,p,w++,v,2,g,S,b,F,1),Et(t,p,w++,v,3,g,S,_,N,1),Et(t,p,w++,v,4,g,S,E,D,1),Et(t,p,w++,v,5,g,S,T,X,1),Et(t,p,w++,v,6,g,S,A,q,1)}g=S,y=M,x=R,b=F,_=N,E=D,T=X,A=q}i.push(p);break}case KR:{for(var m=t.readInt(!0),p=new Hd(f,m,u),g=t.readFloat(),y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,v=0,w=0;p.setFrame(v,g,y,x,b,E,T,A),v!=d;v++){var S=t.readFloat(),M=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,q=t.readUnsignedByte()/255;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,y,M,1),Et(t,p,w++,v,1,g,S,x,R,1),Et(t,p,w++,v,2,g,S,b,F,1),Et(t,p,w++,v,3,g,S,E,D,1),Et(t,p,w++,v,4,g,S,T,X,1),Et(t,p,w++,v,5,g,S,A,q,1)}g=S,y=M,x=R,b=F,E=D,T=X,A=q}i.push(p);break}case JR:{for(var p=new Yd(f,t.readInt(!0),u),g=t.readFloat(),_=t.readUnsignedByte()/255,v=0,w=0;p.setFrame(v,g,_),v!=d;v++){var S=t.readFloat(),P=t.readUnsignedByte()/255;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,_,P,1)}g=S,_=P}i.push(p)}}}for(var s=0,o=t.readInt(!0);s<o;s++)for(var W=t.readInt(!0),h=0,l=t.readInt(!0);h<l;h++){var L=t.readByte(),f=t.readInt(!0),m=t.readInt(!0);switch(L){case LR:i.push(Qr(t,new $s(f,m,W),1));break;case DR:i.push(Bu(t,new Od(f,m,W),a));break;case UR:i.push(Qr(t,new Bd(f,m,W),a));break;case VR:i.push(Qr(t,new Nd(f,m,W),a));break;case XR:i.push(Bu(t,new kd(f,m,W),1));break;case zR:i.push(Qr(t,new Ld(f,m,W),1));break;case GR:i.push(Qr(t,new Dd(f,m,W),1));break;case YR:i.push(Bu(t,new Ud(f,m,W),1));break;case WR:i.push(Qr(t,new Vd(f,m,W),1));break;case HR:i.push(Qr(t,new Xd(f,m,W),1))}}for(var s=0,o=t.readInt(!0);s<o;s++){for(var U=t.readInt(!0),f=t.readInt(!0),d=f-1,p=new $d(f,t.readInt(!0),U),g=t.readFloat(),G=t.readFloat(),V=t.readFloat()*a,v=0,w=0;p.setFrame(v,g,G,V,t.readByte(),t.readBoolean(),t.readBoolean()),v!=d;v++){var S=t.readFloat(),O=t.readFloat(),z=t.readFloat()*a;switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,G,O,1),Et(t,p,w++,v,1,g,S,V,z,a)}g=S,G=O,V=z}i.push(p)}for(var s=0,o=t.readInt(!0);s<o;s++){for(var U=t.readInt(!0),f=t.readInt(!0),d=f-1,p=new qd(f,t.readInt(!0),U),g=t.readFloat(),j=t.readFloat(),K=t.readFloat(),Z=t.readFloat(),Q=t.readFloat(),nt=t.readFloat(),J=t.readFloat(),v=0,w=0;p.setFrame(v,g,j,K,Z,Q,nt,J),v!=d;v++){var S=t.readFloat(),it=t.readFloat(),st=t.readFloat(),ot=t.readFloat(),pt=t.readFloat(),ct=t.readFloat(),lt=t.readFloat();switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,j,it,1),Et(t,p,w++,v,1,g,S,K,st,1),Et(t,p,w++,v,2,g,S,Z,ot,1),Et(t,p,w++,v,3,g,S,Q,pt,1),Et(t,p,w++,v,4,g,S,nt,ct,1),Et(t,p,w++,v,5,g,S,J,lt,1)}g=S,j=it,K=st,Z=ot,Q=pt,nt=ct,J=lt}i.push(p)}for(var s=0,o=t.readInt(!0);s<o;s++)for(var U=t.readInt(!0),Pt=r.pathConstraints[U],h=0,l=t.readInt(!0);h<l;h++)switch(t.readByte()){case t2:i.push(Qr(t,new Zd(t.readInt(!0),t.readInt(!0),U),Pt.positionMode==zt.Fixed?a:1));break;case e2:i.push(Qr(t,new Kd(t.readInt(!0),t.readInt(!0),U),Pt.spacingMode==ce.Length||Pt.spacingMode==ce.Fixed?a:1));break;case r2:for(var p=new Jd(t.readInt(!0),t.readInt(!0),U),g=t.readFloat(),j=t.readFloat(),K=t.readFloat(),Z=t.readFloat(),v=0,w=0,d=p.getFrameCount()-1;p.setFrame(v,g,j,K,Z),v!=d;v++){var S=t.readFloat(),it=t.readFloat(),st=t.readFloat(),ot=t.readFloat();switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,j,it,1),Et(t,p,w++,v,1,g,S,K,st,1),Et(t,p,w++,v,2,g,S,Z,ot,1)}g=S,j=it,K=st,Z=ot}i.push(p)}for(var s=0,o=t.readInt(!0);s<o;s++)for(var Ot=r.skins[t.readInt(!0)],h=0,l=t.readInt(!0);h<l;h++)for(var u=t.readInt(!0),re=0,we=t.readInt(!0);re<we;re++){var Se=t.readStringRef();if(!Se)throw new Error("attachmentName must not be null.");var Wt=Ot.getAttachment(u,Se),c=this.readDeformTimelineType(t),f=t.readInt(!0),d=f-1;switch(c){case Am:{for(var Be=Wt,Ke=Be.bones,Ne=Be.vertices,De=Ke?Ne.length/3*2:Ne.length,m=t.readInt(!0),p=new jd(f,m,u,Be),g=t.readFloat(),v=0,w=0;;v++){var Je=void 0,Ue=t.readInt(!0);if(Ue==0)Je=Ke?Y.newFloatArray(De):Ne;else{Je=Y.newFloatArray(De);var Hn=t.readInt(!0);if(Ue+=Hn,a==1)for(var me=Hn;me<Ue;me++)Je[me]=t.readFloat();else for(var me=Hn;me<Ue;me++)Je[me]=t.readFloat()*a;if(!Ke)for(var me=0,Di=Je.length;me<Di;me++)Je[me]+=Ne[me]}if(p.setFrame(v,g,Je),v==d)break;var S=t.readFloat();switch(t.readByte()){case xr:p.setStepped(v);break;case br:Et(t,p,w++,v,0,g,S,0,1,1)}g=S}i.push(p);break}case QR:{for(var p=new Qd(f,u,Wt),v=0;v<f;v++){var g=t.readFloat(),Wa=t.readInt32();p.setFrame(v,g,Fd[Wa&15],Wa>>4,t.readFloat())}i.push(p);break}}}var Lt=t.readInt(!0);if(Lt>0){for(var p=new Sa(Lt),Zr=r.slots.length,s=0;s<Lt;s++){for(var g=t.readFloat(),Ha=t.readInt(!0),yn=Y.newArray(Zr,0),h=Zr-1;h>=0;h--)yn[h]=-1;for(var ja=Y.newArray(Zr-Ha,0),xn=0,bn=0,h=0;h<Ha;h++){for(var u=t.readInt(!0);xn!=u;)ja[bn++]=xn++;yn[xn+t.readInt(!0)]=xn++}for(;xn<Zr;)ja[bn++]=xn++;for(var h=Zr-1;h>=0;h--)yn[h]==-1&&(yn[h]=ja[--bn]);p.setFrame(s,g,yn)}i.push(p)}var Ui=t.readInt(!0);if(Ui>0){for(var p=new Pl(Ui),s=0;s<Ui;s++){var g=t.readFloat(),_n=r.events[t.readInt(!0)],or=new rp(g,_n);or.intValue=t.readInt(!1),or.floatValue=t.readFloat(),or.stringValue=t.readBoolean()?t.readString():_n.stringValue,or.data.audioPath&&(or.volume=t.readFloat(),or.balance=t.readFloat()),p.setFrame(s,or)}i.push(p)}for(var jn=0,s=0,o=i.length;s<o;s++)jn=Math.max(jn,i[s].getDuration());return new Al(e,i,jn)},n.BlendModeValues=[at.NORMAL,at.ADD,at.MULTIPLY,at.SCREEN],n}(),NR=function(){function n(t,e,r,i,a){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritTimeline=a}return n}(),kR=function(){function n(t,e){t===void 0&&(t=null),e===void 0&&(e=null),this.bones=t,this.vertices=e}return n}();function Qr(n,t,e){for(var r=n.readFloat(),i=n.readFloat()*e,a=0,s=0,o=t.getFrameCount()-1;t.setFrame(a,r,i),a!=o;a++){var u=n.readFloat(),h=n.readFloat()*e;switch(n.readByte()){case xr:t.setStepped(a);break;case br:Et(n,t,s++,a,0,r,u,i,h,e)}r=u,i=h}return t}function Bu(n,t,e){for(var r=n.readFloat(),i=n.readFloat()*e,a=n.readFloat()*e,s=0,o=0,u=t.getFrameCount()-1;t.setFrame(s,r,i,a),s!=u;s++){var h=n.readFloat(),l=n.readFloat()*e,c=n.readFloat()*e;switch(n.readByte()){case xr:t.setStepped(s);break;case br:Et(n,t,o++,s,0,r,h,i,l,e),Et(n,t,o++,s,1,r,h,a,c,e)}r=h,i=l,a=c}return t}function Et(n,t,e,r,i,a,s,o,u,h){t.setBezier(e,r,i,a,o,n.readFloat(),n.readFloat()*h,n.readFloat(),n.readFloat()*h,s,u)}var LR=0,DR=1,UR=2,VR=3,XR=4,zR=5,GR=6,YR=7,WR=8,HR=9,jR=0,$R=1,qR=2,ZR=3,KR=4,JR=5,Am=0,QR=1,t2=0,e2=1,r2=2,xr=1,br=2,n2=function(n){xt(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(hd),bx=function(){function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return n.prototype.readSkeletonData=function(t){var e=this.scale,r=new sp,i=typeof t=="string"?JSON.parse(t):t,a=i.skeleton;if(a){r.hash=a.hash,r.version=a.spine;var s=r.version.substr(0,3);if(s!=="4.0"&&s!=="4.1"){var o="Spine 4.1 loader cant load version "+a.spine+". Please configure your pixi-spine bundle";console.error(o)}r.x=a.x,r.y=a.y,r.width=a.width,r.height=a.height,r.fps=a.fps,r.imagesPath=a.images}if(i.bones)for(var u=0;u<i.bones.length;u++){var h=i.bones[u],l=null,c=H(h,"parent",null);if(c!=null&&(l=r.findBone(c),l==null))throw new Error("Parent bone not found: "+c);var f=new ep(r.bones.length,h.name,l);f.length=H(h,"length",0)*e,f.x=H(h,"x",0)*e,f.y=H(h,"y",0)*e,f.rotation=H(h,"rotation",0),f.scaleX=H(h,"scaleX",1),f.scaleY=H(h,"scaleY",1),f.shearX=H(h,"shearX",0),f.shearY=H(h,"shearY",0),f.transformMode=Y.enumValue(dt,H(h,"transform","Normal")),f.skinRequired=H(h,"skin",!1);var d=H(h,"color",null);d&&f.color.setFromString(d),r.bones.push(f)}if(i.slots)for(var u=0;u<i.slots.length;u++){var p=i.slots[u],v=r.findBone(p.bone);if(!v)throw new Error("Couldn't find bone "+p.bone+" for slot "+p.name);var f=new op(r.slots.length,p.name,v),d=H(p,"color",null);d&&f.color.setFromString(d);var m=H(p,"dark",null);m&&(f.darkColor=tt.fromString(m)),f.attachmentName=H(p,"attachment",null),f.blendMode=n.blendModeFromString(H(p,"blend","normal")),r.slots.push(f)}if(i.ik)for(var u=0;u<i.ik.length;u++){var g=i.ik[u],f=new ip(g.name);f.order=H(g,"order",0),f.skinRequired=H(g,"skin",!1);for(var y=0;y<g.bones.length;y++){var x=g.bones[y],b=r.findBone(x);if(b==null)throw new Error("IK bone not found: "+x);f.bones.push(b)}f.target=r.findBone(g.target),f.mix=H(g,"mix",1),f.softness=H(g,"softness",0)*e,f.bendDirection=H(g,"bendPositive",!0)?1:-1,f.compress=H(g,"compress",!1),f.stretch=H(g,"stretch",!1),f.uniform=H(g,"uniform",!1),r.ikConstraints.push(f)}if(i.transform)for(var u=0;u<i.transform.length;u++){var g=i.transform[u],f=new hp(g.name);f.order=H(g,"order",0),f.skinRequired=H(g,"skin",!1);for(var y=0;y<g.bones.length;y++){var x=g.bones[y],b=r.findBone(x);if(!b)throw new Error("Couldn't find bone "+x+" for transform constraint "+g.name+".");f.bones.push(b)}var _=g.target,w=r.findBone(_);if(!w)throw new Error("Couldn't find target bone "+_+" for transform constraint "+g.name+".");f.target=w,f.local=H(g,"local",!1),f.relative=H(g,"relative",!1),f.offsetRotation=H(g,"rotation",0),f.offsetX=H(g,"x",0)*e,f.offsetY=H(g,"y",0)*e,f.offsetScaleX=H(g,"scaleX",0),f.offsetScaleY=H(g,"scaleY",0),f.offsetShearY=H(g,"shearY",0),f.mixRotate=H(g,"mixRotate",1),f.mixX=H(g,"mixX",1),f.mixY=H(g,"mixY",f.mixX),f.mixScaleX=H(g,"mixScaleX",1),f.mixScaleY=H(g,"mixScaleY",f.mixScaleX),f.mixShearY=H(g,"mixShearY",1),r.transformConstraints.push(f)}if(i.path)for(var u=0;u<i.path.length;u++){var g=i.path[u],f=new ap(g.name);f.order=H(g,"order",0),f.skinRequired=H(g,"skin",!1);for(var y=0;y<g.bones.length;y++){var x=g.bones[y],b=r.findBone(x);if(!b)throw new Error("Couldn't find bone "+x+" for path constraint "+g.name+".");f.bones.push(b)}var _=g.target,w=r.findSlot(_);if(!w)throw new Error("Couldn't find target slot "+_+" for path constraint "+g.name+".");f.target=w,f.positionMode=Y.enumValue(zt,H(g,"positionMode","Percent")),f.spacingMode=Y.enumValue(ce,H(g,"spacingMode","Length")),f.rotateMode=Y.enumValue(Qt,H(g,"rotateMode","Tangent")),f.offsetRotation=H(g,"rotation",0),f.position=H(g,"position",0),f.positionMode==zt.Fixed&&(f.position*=e),f.spacing=H(g,"spacing",0),(f.spacingMode==ce.Length||f.spacingMode==ce.Fixed)&&(f.spacing*=e),f.mixRotate=H(g,"mixRotate",1),f.mixX=H(g,"mixX",1),f.mixY=H(g,"mixY",f.mixX),r.pathConstraints.push(f)}if(i.skins)for(var u=0;u<i.skins.length;u++){var S=i.skins[u],E=new Jh(S.name);if(S.bones)for(var y=0;y<S.bones.length;y++){var x=S.bones[y],b=r.findBone(x);if(!b)throw new Error("Couldn't find bone "+x+" for skin "+S.name+".");E.bones.push(b)}if(S.ik)for(var y=0;y<S.ik.length;y++){var T=S.ik[y],A=r.findIkConstraint(T);if(!A)throw new Error("Couldn't find IK constraint "+T+" for skin "+S.name+".");E.constraints.push(A)}if(S.transform)for(var y=0;y<S.transform.length;y++){var T=S.transform[y],A=r.findTransformConstraint(T);if(!A)throw new Error("Couldn't find transform constraint "+T+" for skin "+S.name+".");E.constraints.push(A)}if(S.path)for(var y=0;y<S.path.length;y++){var T=S.path[y],A=r.findPathConstraint(T);if(!A)throw new Error("Couldn't find path constraint "+T+" for skin "+S.name+".");E.constraints.push(A)}for(var P in S.attachments){var M=r.findSlot(P);if(!M)throw new Error("Couldn't find slot "+P+" for skin "+S.name+".");var p=S.attachments[P];for(var R in p){var F=this.readAttachment(p[R],E,M.index,R,r);F&&E.setAttachment(M.index,R,F)}}r.skins.push(E),E.name=="default"&&(r.defaultSkin=E)}for(var u=0,N=this.linkedMeshes.length;u<N;u++){var D=this.linkedMeshes[u],E=D.skin?r.findSkin(D.skin):r.defaultSkin;if(!E)throw new Error("Skin not found: "+D.skin);var X=E.getAttachment(D.slotIndex,D.parent);if(!X)throw new Error("Parent mesh not found: "+D.parent);D.mesh.timelineAttachment=D.inheritTimeline?X:D.mesh,D.mesh.setParentMesh(X)}if(this.linkedMeshes.length=0,i.events)for(var q in i.events){var W=i.events[q],f=new np(q);f.intValue=H(W,"int",0),f.floatValue=H(W,"float",0),f.stringValue=H(W,"string",""),f.audioPath=H(W,"audio",null),f.audioPath&&(f.volume=H(W,"volume",1),f.balance=H(W,"balance",0)),r.events.push(f)}if(i.animations)for(var L in i.animations){var U=i.animations[L];this.readAnimation(U,L,r)}return r},n.prototype.readAttachment=function(t,e,r,i,a){var s=this.scale;switch(i=H(t,"name",i),H(t,"type","region")){case"region":{var o=H(t,"path",i),u=this.readSequence(H(t,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(e,i,o,u);if(!h)return null;h.path=o,h.x=H(t,"x",0)*s,h.y=H(t,"y",0)*s,h.scaleX=H(t,"scaleX",1),h.scaleY=H(t,"scaleY",1),h.rotation=H(t,"rotation",0),h.width=t.width*s,h.height=t.height*s,h.sequence=u;var l=H(t,"color",null);return l&&h.color.setFromString(l),h}case"boundingbox":{var c=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(!c)return null;this.readVertices(t,c,t.vertexCount<<1);var l=H(t,"color",null);return l&&c.color.setFromString(l),c}case"mesh":case"linkedmesh":{var o=H(t,"path",i),u=this.readSequence(H(t,"sequence",null)),f=this.attachmentLoader.newMeshAttachment(e,i,o,u);if(!f)return null;f.path=o;var l=H(t,"color",null);l&&f.color.setFromString(l),f.width=H(t,"width",0)*s,f.height=H(t,"height",0)*s,f.sequence=u;var d=H(t,"parent",null);if(d)return this.linkedMeshes.push(new i2(f,H(t,"skin",null),r,d,H(t,"timelines",!0))),f;var p=t.uvs;return this.readVertices(t,f,p.length),f.triangles=t.triangles,f.regionUVs=new Float32Array(p),f.edges=H(t,"edges",null),f.hullLength=H(t,"hull",0)*2,f}case"path":{var o=this.attachmentLoader.newPathAttachment(e,i);if(!o)return null;o.closed=H(t,"closed",!1),o.constantSpeed=H(t,"constantSpeed",!0);var v=t.vertexCount;this.readVertices(t,o,v<<1);for(var m=Y.newArray(v/3,0),g=0;g<t.lengths.length;g++)m[g]=t.lengths[g]*s;o.lengths=m;var l=H(t,"color",null);return l&&o.color.setFromString(l),o}case"point":{var y=this.attachmentLoader.newPointAttachment(e,i);if(!y)return null;y.x=H(t,"x",0)*s,y.y=H(t,"y",0)*s,y.rotation=H(t,"rotation",0);var l=H(t,"color",null);return l&&y.color.setFromString(l),y}case"clipping":{var x=this.attachmentLoader.newClippingAttachment(e,i);if(!x)return null;var b=H(t,"end",null);if(b!=null){var _=a.findSlot(b);if(_==null)throw new Error("Clipping end slot not found: "+b);x.endSlot=_}var v=t.vertexCount;this.readVertices(t,x,v<<1);var l=H(t,"color",null);return l&&x.color.setFromString(l),x}}return null},n.prototype.readSequence=function(t){if(t==null)return null;var e=new Rd(H(t,"count",0));return e.start=H(t,"start",1),e.digits=H(t,"digits",0),e.setupIndex=H(t,"setup",0),e},n.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var a=t.vertices;if(r==a.length){var s=Y.toFloatArray(a);if(i!=1)for(var o=0,u=a.length;o<u;o++)s[o]*=i;e.vertices=s;return}for(var h=new Array,l=new Array,o=0,u=a.length;o<u;){var c=a[o++];l.push(c);for(var f=o+c*4;o<f;o+=4)l.push(a[o]),h.push(a[o+1]*i),h.push(a[o+2]*i),h.push(a[o+3])}e.bones=l,e.vertices=Y.toFloatArray(h)},n.prototype.readAnimation=function(t,e,r){var i=this.scale,a=new Array;if(t.slots)for(var s in t.slots){var o=t.slots[s],u=r.findSlot(s);if(!u)throw new Error("Slot not found: "+s);var h=u.index;for(var l in o){var c=o[l];if(c){var f=c.length;if(l=="attachment"){for(var d=new di(f,h),p=0;p<f;p++){var v=c[p];d.setFrame(p,H(v,"time",0),H(v,"name",null))}a.push(d)}else if(l=="rgba"){for(var d=new zd(f,f<<2,h),v=c[0],m=H(v,"time",0),g=tt.fromString(v.color),p=0,y=0;;p++){d.setFrame(p,m,g.r,g.g,g.b,g.a);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),_=tt.fromString(x.color),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,g.r,_.r,1),y=Tt(w,d,y,p,1,m,b,g.g,_.g,1),y=Tt(w,d,y,p,2,m,b,g.b,_.b,1),y=Tt(w,d,y,p,3,m,b,g.a,_.a,1)),m=b,g=_,v=x}a.push(d)}else if(l=="rgb"){for(var d=new Gd(f,f*3,h),v=c[0],m=H(v,"time",0),g=tt.fromString(v.color),p=0,y=0;;p++){d.setFrame(p,m,g.r,g.g,g.b);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),_=tt.fromString(x.color),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,g.r,_.r,1),y=Tt(w,d,y,p,1,m,b,g.g,_.g,1),y=Tt(w,d,y,p,2,m,b,g.b,_.b,1)),m=b,g=_,v=x}a.push(d)}else if(l=="alpha")a.push(Or(c,new Yd(f,f,h),0,1));else if(l=="rgba2"){for(var d=new Wd(f,f*7,h),v=c[0],m=H(v,"time",0),g=tt.fromString(v.light),S=tt.fromString(v.dark),p=0,y=0;;p++){d.setFrame(p,m,g.r,g.g,g.b,g.a,S.r,S.g,S.b);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),_=tt.fromString(x.light),E=tt.fromString(x.dark),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,g.r,_.r,1),y=Tt(w,d,y,p,1,m,b,g.g,_.g,1),y=Tt(w,d,y,p,2,m,b,g.b,_.b,1),y=Tt(w,d,y,p,3,m,b,g.a,_.a,1),y=Tt(w,d,y,p,4,m,b,S.r,E.r,1),y=Tt(w,d,y,p,5,m,b,S.g,E.g,1),y=Tt(w,d,y,p,6,m,b,S.b,E.b,1)),m=b,g=_,S=E,v=x}a.push(d)}else if(l=="rgb2"){for(var d=new Hd(f,f*6,h),v=c[0],m=H(v,"time",0),g=tt.fromString(v.light),S=tt.fromString(v.dark),p=0,y=0;;p++){d.setFrame(p,m,g.r,g.g,g.b,S.r,S.g,S.b);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),_=tt.fromString(x.light),E=tt.fromString(x.dark),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,g.r,_.r,1),y=Tt(w,d,y,p,1,m,b,g.g,_.g,1),y=Tt(w,d,y,p,2,m,b,g.b,_.b,1),y=Tt(w,d,y,p,3,m,b,S.r,E.r,1),y=Tt(w,d,y,p,4,m,b,S.g,E.g,1),y=Tt(w,d,y,p,5,m,b,S.b,E.b,1)),m=b,g=_,S=E,v=x}a.push(d)}}}}if(t.bones)for(var T in t.bones){var A=t.bones[T],P=r.findBone(T);if(!P)throw new Error("Bone not found: "+T);var M=P.index;for(var l in A){var c=A[l],R=c.length;if(R!=0){if(l==="rotate")a.push(Or(c,new $s(R,R,M),0,1));else if(l==="translate"){var d=new Od(R,R<<1,M);a.push(Nu(c,d,"x","y",0,i))}else if(l==="translatex"){var d=new Bd(R,R,M);a.push(Or(c,d,0,i))}else if(l==="translatey"){var d=new Nd(R,R,M);a.push(Or(c,d,0,i))}else if(l==="scale"){var d=new kd(R,R<<1,M);a.push(Nu(c,d,"x","y",1,1))}else if(l==="scalex"){var d=new Ld(R,R,M);a.push(Or(c,d,1,1))}else if(l==="scaley"){var d=new Dd(R,R,M);a.push(Or(c,d,1,1))}else if(l==="shear"){var d=new Ud(R,R<<1,M);a.push(Nu(c,d,"x","y",0,1))}else if(l==="shearx"){var d=new Vd(R,R,M);a.push(Or(c,d,0,1))}else if(l==="sheary"){var d=new Xd(R,R,M);a.push(Or(c,d,0,1))}}}}if(t.ik)for(var F in t.ik){var N=t.ik[F],v=N[0];if(v){var D=r.findIkConstraint(F);if(!D)throw new Error("IK Constraint not found: "+F);for(var X=r.ikConstraints.indexOf(D),d=new $d(N.length,N.length<<1,X),m=H(v,"time",0),q=H(v,"mix",1),W=H(v,"softness",0)*i,p=0,y=0;;p++){d.setFrame(p,m,q,W,H(v,"bendPositive",!0)?1:-1,H(v,"compress",!1),H(v,"stretch",!1));var x=N[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),L=H(x,"mix",1),U=H(x,"softness",0)*i,w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,q,L,1),y=Tt(w,d,y,p,1,m,b,W,U,i)),m=b,q=L,W=U,v=x}a.push(d)}}if(t.transform)for(var F in t.transform){var c=t.transform[F],v=c[0];if(v){var D=r.findTransformConstraint(F);if(!D)throw new Error("Transform constraint not found: "+F);for(var X=r.transformConstraints.indexOf(D),d=new qd(c.length,c.length*6,X),m=H(v,"time",0),G=H(v,"mixRotate",1),V=H(v,"mixX",1),O=H(v,"mixY",V),z=H(v,"mixScaleX",1),j=H(v,"mixScaleY",z),K=H(v,"mixShearY",1),p=0,y=0;;p++){d.setFrame(p,m,G,V,O,z,j,K);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),Z=H(x,"mixRotate",1),Q=H(x,"mixX",1),nt=H(x,"mixY",Q),J=H(x,"mixScaleX",1),it=H(x,"mixScaleY",J),st=H(x,"mixShearY",1),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,G,Z,1),y=Tt(w,d,y,p,1,m,b,V,Q,1),y=Tt(w,d,y,p,2,m,b,O,nt,1),y=Tt(w,d,y,p,3,m,b,z,J,1),y=Tt(w,d,y,p,4,m,b,j,it,1),y=Tt(w,d,y,p,5,m,b,K,st,1)),m=b,G=Z,V=Q,O=nt,z=J,j=it,z=J,v=x}a.push(d)}}if(t.path)for(var F in t.path){var N=t.path[F],D=r.findPathConstraint(F);if(!D)throw new Error("Path constraint not found: "+F);var X=r.pathConstraints.indexOf(D);for(var l in N){var c=N[l],v=c[0];if(v){var ot=c.length;if(l==="position"){var d=new Zd(ot,ot,X);a.push(Or(c,d,0,D.positionMode==zt.Fixed?i:1))}else if(l==="spacing"){var d=new Kd(ot,ot,X);a.push(Or(c,d,0,D.spacingMode==ce.Length||D.spacingMode==ce.Fixed?i:1))}else if(l==="mix"){for(var d=new Jd(ot,ot*3,X),m=H(v,"time",0),G=H(v,"mixRotate",1),V=H(v,"mixX",1),O=H(v,"mixY",V),p=0,y=0;;p++){d.setFrame(p,m,G,V,O);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),Z=H(x,"mixRotate",1),Q=H(x,"mixX",1),nt=H(x,"mixY",Q),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,G,Z,1),y=Tt(w,d,y,p,1,m,b,V,Q,1),y=Tt(w,d,y,p,2,m,b,O,nt,1)),m=b,G=Z,V=Q,O=nt,v=x}a.push(d)}}}}if(t.deform){t.attachments={};for(var pt in t.deform){var ct=t.deform[pt],lt=t.attachments[pt]={};for(var s in ct){var o=ct[s],Pt=lt[s]={};for(var Ot in o)Pt[Ot]={deform:o[Ot]}}}}if(t.attachments)for(var re in t.attachments){var we=t.attachments[re],Se=r.findSkin(re);if(Se!=null)for(var Wt in we){var o=we[Wt],u=r.findSlot(Wt);if(!u)throw new Error("Slot not found: "+Wt);var h=u.index;for(var Be in o){var Ke=o[Be],Ne=Se.getAttachment(h,Be);for(var De in Ke){var c=Ke[De],v=c[0];if(v){if(De=="deform"){for(var Je=Ne.bones,Ue=Ne.vertices,Hn=Je?Ue.length/3*2:Ue.length,d=new jd(c.length,c.length,h,Ne),m=H(v,"time",0),p=0,y=0;;p++){var me=void 0,Di=H(v,"vertices",null);if(!Di)me=Je?Y.newFloatArray(Hn):Ue;else{me=Y.newFloatArray(Hn);var Wa=H(v,"offset",0);if(Y.arrayCopy(Di,0,me,Wa,Di.length),i!=1)for(var Lt=Wa,Zr=Lt+Di.length;Lt<Zr;Lt++)me[Lt]*=i;if(!Je)for(var Lt=0;Lt<Hn;Lt++)me[Lt]+=Ue[Lt]}d.setFrame(p,m,me);var x=c[p+1];if(!x){d.shrink(y);break}var b=H(x,"time",0),w=v.curve;w&&(y=Tt(w,d,y,p,0,m,b,0,1,1)),m=b,v=x}a.push(d)}else if(De=="sequence"){for(var d=new Qd(c.length,h,Ne),Ha=0,p=0;p<c.length;p++){var yn=H(v,"delay",Ha),m=H(v,"time",0),ja=Ae[H(v,"mode","hold")],xn=H(v,"index",0);d.setFrame(p,m,ja,xn,yn),Ha=yn,v=c[p+1]}a.push(d)}}}}}}if(t.drawOrder){for(var d=new Sa(t.drawOrder.length),bn=r.slots.length,p=0,Lt=0;Lt<t.drawOrder.length;Lt++,p++){var Ui=t.drawOrder[Lt],_n=null,or=H(Ui,"offsets",null);if(or){_n=Y.newArray(bn,-1);for(var jn=Y.newArray(bn-or.length,0),Vi=0,Nl=0,wn=0;wn<or.length;wn++){var Bp=or[wn],u=r.findSlot(Bp.slot);if(!u)throw new Error("Slot not found: "+u);for(var h=u.index;Vi!=h;)jn[Nl++]=Vi++;_n[Vi+Bp.offset]=Vi++}for(;Vi<bn;)jn[Nl++]=Vi++;for(var wn=bn-1;wn>=0;wn--)_n[wn]==-1&&(_n[wn]=jn[--Nl])}d.setFrame(p,H(Ui,"time",0),_n)}a.push(d)}if(t.events){for(var d=new Pl(t.events.length),p=0,Lt=0;Lt<t.events.length;Lt++,p++){var Sn=t.events[Lt],$a=r.findEvent(Sn.name);if(!$a)throw new Error("Event not found: "+Sn.name);var $n=new rp(Y.toSinglePrecision(H(Sn,"time",0)),$a);$n.intValue=H(Sn,"int",$a.intValue),$n.floatValue=H(Sn,"float",$a.floatValue),$n.stringValue=H(Sn,"string",$a.stringValue),$n.data.audioPath&&($n.volume=H(Sn,"volume",1),$n.balance=H(Sn,"balance",0)),d.setFrame(p,$n)}a.push(d)}for(var yo=0,Lt=0,Zr=a.length;Lt<Zr;Lt++)yo=Math.max(yo,a[Lt].getDuration());if(isNaN(yo))throw new Error("Error while parsing animation, duration is NaN");r.animations.push(new Al(e,a,yo))},n.blendModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return at.NORMAL;if(t=="additive")return at.ADD;if(t=="multiply")return at.MULTIPLY;if(t=="screen")return at.SCREEN;throw new Error("Unknown blend mode: "+t)},n}(),i2=function(){function n(t,e,r,i,a){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritTimeline=a}return n}();function Or(n,t,e,r){for(var i=n[0],a=H(i,"time",0),s=H(i,"value",e)*r,o=0,u=0;;u++){t.setFrame(u,a,s);var h=n[u+1];if(!h)return t.shrink(o),t;var l=H(h,"time",0),c=H(h,"value",e)*r;i.curve&&(o=Tt(i.curve,t,o,u,0,a,l,s,c,r)),a=l,s=c,i=h}}function Nu(n,t,e,r,i,a){for(var s=n[0],o=H(s,"time",0),u=H(s,e,i)*a,h=H(s,r,i)*a,l=0,c=0;;c++){t.setFrame(c,o,u,h);var f=n[c+1];if(!f)return t.shrink(l),t;var d=H(f,"time",0),p=H(f,e,i)*a,v=H(f,r,i)*a,m=s.curve;m&&(l=Tt(m,t,l,c,0,o,d,u,p,a),l=Tt(m,t,l,c,1,o,d,h,v,a)),o=d,u=p,h=v,s=f}}function Tt(n,t,e,r,i,a,s,o,u,h){if(n=="stepped")return t.setStepped(r),e;var l=i<<2,c=n[l],f=n[l+1]*h,d=n[l+2],p=n[l+3]*h;return t.setBezier(e,r,i,a,o,c,f,d,p,s,u),e+1}function H(n,t,e){return n[t]!==void 0?n[t]:e}var a2=function(n){xt(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createSkeleton=function(e){this.skeleton=new yx(e),this.skeleton.updateWorldTransform(),this.stateData=new dx(e),this.state=new ux(this.stateData)},t}(fo);const s2=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline:Yd,Animation:Al,AnimationState:ux,AnimationStateAdapter:FR,AnimationStateData:dx,AtlasAttachmentLoader:tp,Attachment:Id,AttachmentTimeline:di,Bone:Af,BoneData:ep,BoundingBoxAttachment:ox,ClippingAttachment:hx,ConstraintData:Il,CurveTimeline:Ir,CurveTimeline1:Cr,CurveTimeline2:Ml,DeformTimeline:jd,DrawOrderTimeline:Sa,Event:rp,EventData:np,EventQueue:fx,EventTimeline:Pl,get EventType(){return Ye},IkConstraint:px,IkConstraintData:ip,IkConstraintTimeline:$d,MeshAttachment:Tl,PathAttachment:js,PathConstraint:vx,PathConstraintData:ap,PathConstraintMixTimeline:Jd,PathConstraintPositionTimeline:Zd,PathConstraintSpacingTimeline:Kd,PointAttachment:lx,RGB2Timeline:Hd,RGBA2Timeline:Wd,RGBATimeline:zd,RGBTimeline:Gd,RegionAttachment:Cd,RotateTimeline:$s,ScaleTimeline:kd,ScaleXTimeline:Ld,ScaleYTimeline:Dd,Sequence:Rd,get SequenceMode(){return Ae},SequenceModeValues:Fd,SequenceTimeline:Qd,ShearTimeline:Ud,ShearXTimeline:Vd,ShearYTimeline:Xd,Skeleton:yx,SkeletonBinary:xx,SkeletonBounds:n2,SkeletonData:sp,SkeletonJson:bx,Skin:Jh,SkinEntry:Mf,Slot:mx,SlotData:op,get SpacingMode(){return ce},Spine:a2,Timeline:ee,TrackEntry:cx,TransformConstraint:gx,TransformConstraintData:hp,TransformConstraintTimeline:qd,TranslateTimeline:Od,TranslateXTimeline:Bd,TranslateYTimeline:Nd,VertexAttachment:Wr},Symbol.toStringTag,{value:"Module"}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pf=function(n,t){return Pf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},Pf(n,t)};function _x(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Pf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var fe;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VER37=37]="VER37",n[n.VER38=38]="VER38",n[n.VER40=40]="VER40",n[n.VER41=41]="VER41"})(fe||(fe={}));function Qh(n){var t=n.substr(0,3),e=Math.floor(+t*10+.001);return t==="3.7"?fe.VER37:t==="3.8"?fe.VER38:t==="4.0"?fe.VER40:t==="4.1"?fe.VER41:e<fe.VER37?fe.VER37:fe.UNKNOWN}var o2=function(){function n(){this.scale=1}return n.prototype.readSkeletonData=function(t,e){var r=null,i=this.readVersionOldFormat(e),a=Qh(i);if(a===fe.VER38&&(r=new F0(new md(t))),i=this.readVersionNewFormat(e),a=Qh(i),(a===fe.VER40||a===fe.VER41)&&(r=new xx(new tp(t))),!r){var s="Unsupported version of spine model "+i+", please update pixi-spine";console.error(s)}return r.scale=this.scale,r.readSkeletonData(e)},n.prototype.readVersionOldFormat=function(t){var e=new jh(t),r;try{e.readString(),r=e.readString()}catch{r=""}return r||""},n.prototype.readVersionNewFormat=function(t){var e=new jh(t);e.readInt32(),e.readInt32();var r;try{r=e.readString()}catch{r=""}return r||""},n}(),h2=function(){function n(){this.scale=1}return n.prototype.readSkeletonData=function(t,e){var r=e.skeleton.spine,i=Qh(r),a=null;if(i===fe.VER37&&(a=new sx(new H0(t))),i===fe.VER38&&(a=new O0(new md(t))),(i===fe.VER40||i===fe.VER41)&&(a=new bx(new tp(t))),!a){var s="Unsupported version of spine model "+r+", please update pixi-spine";console.error(s)}return a.scale=this.scale,a.readSkeletonData(e)},n}(),wx=function(n){_x(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createBinaryParser=function(){return new o2},t.prototype.createJsonParser=function(){return new h2},t.prototype.parseData=function(e,r,i,a){var s=r;e.spineData=s.readSkeletonData(i,a),e.spineAtlas=i},t.registerLoaderPlugin=function(){Ai.registerPlugin(t)},t.use=new t().genMiddleware().use,t}(pR),Sx=function(n){_x(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createSkeleton=function(e){var r=Qh(e.version),i=null;if(r===fe.VER37&&(i=RR),r===fe.VER38&&(i=ER),(r===fe.VER40||r===fe.VER41)&&(i=s2),!i){var a="Cant detect version of spine model "+e.version;console.error(a)}this.skeleton=new i.Skeleton(e),this.skeleton.updateWorldTransform(),this.stateData=new i.AnimationStateData(e),this.state=new i.AnimationState(this.stateData)},t}(fo);wx.registerLoaderPlugin();const l2="man39_mixamo_core_v1",u2="powerof2/Man_39.json",c2="in_place",f2=.45,d2={hips:{bone:"bone",translate:!0},spine:"TORSO",spine1:"TORSO2",spine2:"TORSO3",neck:"NECK",head:"HEAD",leftArm:"ARM_L",leftForeArm:"FOREARM_R",leftHand:"L_Palm",rightArm:"ARM_R",rightForeArm:"FOREARM_L",rightHand:"R_Palm",leftUpLeg:"2",leftLeg:"3",leftFoot:"4",rightUpLeg:"bone3",rightLeg:"bone4",rightFoot:"bone6"},p2={sourceLeftJoint:"leftArm",sourceRightJoint:"rightArm",targetLeftBone:"ARM_L",targetRightBone:"ARM_R"},v2={maxDeltaDeg:70,angleMedianWindow:5,angleSmoothingAlpha:.55,angleSmoothingPasses:2,angleDeadbandDeg:.02,translationMedianWindow:5,translationSmoothingAlpha:.5,translationSmoothingPasses:2,translationDeadband:.01,inPlaceTrendAlpha:.03,yawInfluence:.05,outOfPlaneSuppression:.85,sourceSideCalibrationFrames:5},m2={uniformKeyframes:!0,reduceRotationKeys:!1,reduceTranslationKeys:!1,fillMissingWithZero:!0,referenceFrameCount:3},g2={minAngle:-175,maxAngle:175,rotationEpsilonDeg:.08,translationEpsilon:.03},y2={hips:{multiplier:1,offset:0},spine:{multiplier:1,offset:0},spine1:{multiplier:1,offset:0},spine2:{multiplier:1,offset:0},neck:{multiplier:1,offset:0},head:{multiplier:1,offset:0},leftArm:{multiplier:1,offset:0},leftForeArm:{multiplier:1,offset:0},leftHand:{multiplier:1,offset:0},rightArm:{multiplier:1,offset:0},rightForeArm:{multiplier:1,offset:0},rightHand:{multiplier:1,offset:0},leftUpLeg:{multiplier:1,offset:0},leftLeg:{multiplier:1,offset:0},leftFoot:{multiplier:1,offset:0},rightUpLeg:{multiplier:1,offset:0},rightLeg:{multiplier:1,offset:0},rightFoot:{multiplier:1,offset:0}},x2={id:l2,targetSkeleton:u2,rootMotion:c2,translationScale:f2,targetBones:d2,sideCalibration:p2,projection:v2,timeline:m2,limits:g2,jointAdjustments:y2};/**
 * @license
 * Copyright 2010-2026 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Ex="183",If=0,b2=1,Mm=1,Pm=100,Im=204,Cm=205,Rm=3,lp=0,Fm="attached",_2="detached",Tx=300,w2=303,tl=1e3,pa=1001,Om=1002,Bm=1003,S2=1006,E2=1008,Ax=1009,Mx=1015,Px=1023,T2=2200,Ix=2201,A2=2202,el=2300,Cf=2301,ku=2302,Nm=2303,va=2400,ma=2401,rl=2402,up=2500,M2=2501,Cx=0,Rx="",Vt="srgb",km="srgb-linear",Lm="linear",Lu="srgb",Hi=7680,Dm=519,Um=35044,pi=2e3,nl=2001;function P2(n){for(let t=n.length-1;t>=0;--t)if(n[t]>=65535)return!0;return!1}function I2(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Rf(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}const Vm={};function Fx(n){const t=n[0];if(typeof t=="string"&&t.startsWith("TSL:")){const e=n[1];e&&e.isStackTrace?n[0]+=" "+e.getLocation():n[1]='Stack trace not available. Enable "THREE.Node.captureStackTrace" to capture stack traces.'}return n}function Nt(...n){n=Fx(n);const t="THREE."+n.shift();{const e=n[0];e&&e.isStackTrace?console.warn(e.getError(t)):console.warn(t,...n)}}function jt(...n){n=Fx(n);const t="THREE."+n.shift();{const e=n[0];e&&e.isStackTrace?console.error(e.getError(t)):console.error(t,...n)}}function Xm(...n){const t=n.join(" ");t in Vm||(Vm[t]=!0,Nt(...n))}class po{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(e)===-1&&r[t].push(e)}hasEventListener(t,e){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(e)!==-1}removeEventListener(t,e){const r=this._listeners;if(r===void 0)return;const i=r[t];if(i!==void 0){const a=i.indexOf(e);a!==-1&&i.splice(a,1)}}dispatchEvent(t){const e=this._listeners;if(e===void 0)return;const r=e[t.type];if(r!==void 0){t.target=this;const i=r.slice(0);for(let a=0,s=i.length;a<s;a++)i[a].call(this,t);t.target=null}}}const ke=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let zm=1234567;const xs=Math.PI/180,qs=180/Math.PI;function Wn(){const n=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ke[n&255]+ke[n>>8&255]+ke[n>>16&255]+ke[n>>24&255]+"-"+ke[t&255]+ke[t>>8&255]+"-"+ke[t>>16&15|64]+ke[t>>24&255]+"-"+ke[e&63|128]+ke[e>>8&255]+"-"+ke[e>>16&255]+ke[e>>24&255]+ke[r&255]+ke[r>>8&255]+ke[r>>16&255]+ke[r>>24&255]).toLowerCase()}function _t(n,t,e){return Math.max(t,Math.min(e,n))}function cp(n,t){return(n%t+t)%t}function C2(n,t,e,r,i){return r+(n-t)*(i-r)/(e-t)}function R2(n,t,e){return n!==t?(e-n)/(t-n):0}function bs(n,t,e){return(1-e)*n+e*t}function F2(n,t,e,r){return bs(n,t,1-Math.exp(-e*r))}function O2(n,t=1){return t-Math.abs(cp(n,t*2)-t)}function B2(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*(3-2*n))}function N2(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*n*(n*(n*6-15)+10))}function k2(n,t){return n+Math.floor(Math.random()*(t-n+1))}function L2(n,t){return n+Math.random()*(t-n)}function D2(n){return n*(.5-Math.random())}function U2(n){n!==void 0&&(zm=n);let t=zm+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function V2(n){return n*xs}function X2(n){return n*qs}function z2(n){return(n&n-1)===0&&n!==0}function G2(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Y2(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function W2(n,t,e,r,i){const a=Math.cos,s=Math.sin,o=a(e/2),u=s(e/2),h=a((t+r)/2),l=s((t+r)/2),c=a((t-r)/2),f=s((t-r)/2),d=a((r-t)/2),p=s((r-t)/2);switch(i){case"XYX":n.set(o*l,u*c,u*f,o*h);break;case"YZY":n.set(u*f,o*l,u*c,o*h);break;case"ZXZ":n.set(u*c,u*f,o*l,o*h);break;case"XZX":n.set(o*l,u*p,u*d,o*h);break;case"YXY":n.set(u*d,o*l,u*p,o*h);break;case"ZYZ":n.set(u*p,u*d,o*l,o*h);break;default:Nt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function ha(n,t){switch(t.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ve(n,t){switch(t.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const We={DEG2RAD:xs,RAD2DEG:qs,generateUUID:Wn,clamp:_t,euclideanModulo:cp,mapLinear:C2,inverseLerp:R2,lerp:bs,damp:F2,pingpong:O2,smoothstep:B2,smootherstep:N2,randInt:k2,randFloat:L2,randFloatSpread:D2,seededRandom:U2,degToRad:V2,radToDeg:X2,isPowerOfTwo:z2,ceilPowerOfTwo:G2,floorPowerOfTwo:Y2,setQuaternionFromProperEuler:W2,normalize:Ve,denormalize:ha};class ve{constructor(t=0,e=0){ve.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=_t(this.x,t.x,e.x),this.y=_t(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=_t(this.x,t,e),this.y=_t(this.y,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_t(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(_t(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),a=this.x-t.x,s=this.y-t.y;return this.x=a*r-s*i+t.x,this.y=a*i+s*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class le{constructor(t=0,e=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=i}static slerpFlat(t,e,r,i,a,s,o){let u=r[i+0],h=r[i+1],l=r[i+2],c=r[i+3],f=a[s+0],d=a[s+1],p=a[s+2],v=a[s+3];if(c!==v||u!==f||h!==d||l!==p){let m=u*f+h*d+l*p+c*v;m<0&&(f=-f,d=-d,p=-p,v=-v,m=-m);let g=1-o;if(m<.9995){const y=Math.acos(m),x=Math.sin(y);g=Math.sin(g*y)/x,o=Math.sin(o*y)/x,u=u*g+f*o,h=h*g+d*o,l=l*g+p*o,c=c*g+v*o}else{u=u*g+f*o,h=h*g+d*o,l=l*g+p*o,c=c*g+v*o;const y=1/Math.sqrt(u*u+h*h+l*l+c*c);u*=y,h*=y,l*=y,c*=y}}t[e]=u,t[e+1]=h,t[e+2]=l,t[e+3]=c}static multiplyQuaternionsFlat(t,e,r,i,a,s){const o=r[i],u=r[i+1],h=r[i+2],l=r[i+3],c=a[s],f=a[s+1],d=a[s+2],p=a[s+3];return t[e]=o*p+l*c+u*d-h*f,t[e+1]=u*p+l*f+h*c-o*d,t[e+2]=h*p+l*d+o*f-u*c,t[e+3]=l*p-o*c-u*f-h*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const r=t._x,i=t._y,a=t._z,s=t._order,o=Math.cos,u=Math.sin,h=o(r/2),l=o(i/2),c=o(a/2),f=u(r/2),d=u(i/2),p=u(a/2);switch(s){case"XYZ":this._x=f*l*c+h*d*p,this._y=h*d*c-f*l*p,this._z=h*l*p+f*d*c,this._w=h*l*c-f*d*p;break;case"YXZ":this._x=f*l*c+h*d*p,this._y=h*d*c-f*l*p,this._z=h*l*p-f*d*c,this._w=h*l*c+f*d*p;break;case"ZXY":this._x=f*l*c-h*d*p,this._y=h*d*c+f*l*p,this._z=h*l*p+f*d*c,this._w=h*l*c-f*d*p;break;case"ZYX":this._x=f*l*c-h*d*p,this._y=h*d*c+f*l*p,this._z=h*l*p-f*d*c,this._w=h*l*c+f*d*p;break;case"YZX":this._x=f*l*c+h*d*p,this._y=h*d*c+f*l*p,this._z=h*l*p-f*d*c,this._w=h*l*c-f*d*p;break;case"XZY":this._x=f*l*c-h*d*p,this._y=h*d*c-f*l*p,this._z=h*l*p+f*d*c,this._w=h*l*c+f*d*p;break;default:Nt("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],a=e[8],s=e[1],o=e[5],u=e[9],h=e[2],l=e[6],c=e[10],f=r+o+c;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(l-u)*d,this._y=(a-h)*d,this._z=(s-i)*d}else if(r>o&&r>c){const d=2*Math.sqrt(1+r-o-c);this._w=(l-u)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(a+h)/d}else if(o>c){const d=2*Math.sqrt(1+o-r-c);this._w=(a-h)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(u+l)/d}else{const d=2*Math.sqrt(1+c-r-o);this._w=(s-i)/d,this._x=(a+h)/d,this._y=(u+l)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<1e-8?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(_t(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(r===0)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,a=t._z,s=t._w,o=e._x,u=e._y,h=e._z,l=e._w;return this._x=r*l+s*o+i*h-a*u,this._y=i*l+s*u+a*o-r*h,this._z=a*l+s*h+r*u-i*o,this._w=s*l-r*o-i*u-a*h,this._onChangeCallback(),this}slerp(t,e){let r=t._x,i=t._y,a=t._z,s=t._w,o=this.dot(t);o<0&&(r=-r,i=-i,a=-a,s=-s,o=-o);let u=1-e;if(o<.9995){const h=Math.acos(o),l=Math.sin(h);u=Math.sin(u*h)/l,e=Math.sin(e*h)/l,this._x=this._x*u+r*e,this._y=this._y*u+i*e,this._z=this._z*u+a*e,this._w=this._w*u+s*e,this._onChangeCallback()}else this._x=this._x*u+r*e,this._y=this._y*u+i*e,this._z=this._z*u+a*e,this._w=this._w*u+s*e,this.normalize();return this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(i*Math.sin(t),i*Math.cos(t),a*Math.sin(e),a*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ${constructor(t=0,e=0,r=0){$.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return r===void 0&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(Gm.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Gm.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*e+a[3]*r+a[6]*i,this.y=a[1]*e+a[4]*r+a[7]*i,this.z=a[2]*e+a[5]*r+a[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,a=t.elements,s=1/(a[3]*e+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*e+a[4]*r+a[8]*i+a[12])*s,this.y=(a[1]*e+a[5]*r+a[9]*i+a[13])*s,this.z=(a[2]*e+a[6]*r+a[10]*i+a[14])*s,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,a=t.x,s=t.y,o=t.z,u=t.w,h=2*(s*i-o*r),l=2*(o*e-a*i),c=2*(a*r-s*e);return this.x=e+u*h+s*c-o*l,this.y=r+u*l+o*h-a*c,this.z=i+u*c+a*l-s*h,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*e+a[4]*r+a[8]*i,this.y=a[1]*e+a[5]*r+a[9]*i,this.z=a[2]*e+a[6]*r+a[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=_t(this.x,t.x,e.x),this.y=_t(this.y,t.y,e.y),this.z=_t(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=_t(this.x,t,e),this.y=_t(this.y,t,e),this.z=_t(this.z,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_t(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,a=t.z,s=e.x,o=e.y,u=e.z;return this.x=i*u-a*o,this.y=a*s-r*u,this.z=r*o-i*s,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return Du.copy(this).projectOnVector(t),this.sub(Du)}reflect(t){return this.sub(Du.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(_t(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=Math.random()*2-1,r=Math.sqrt(1-e*e);return this.x=r*Math.cos(t),this.y=e,this.z=r*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Du=new $,Gm=new le;class qr{constructor(t,e,r,i,a,s,o,u,h){qr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,r,i,a,s,o,u,h)}set(t,e,r,i,a,s,o,u,h){const l=this.elements;return l[0]=t,l[1]=i,l[2]=o,l[3]=e,l[4]=a,l[5]=u,l[6]=r,l[7]=s,l[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,a=this.elements,s=r[0],o=r[3],u=r[6],h=r[1],l=r[4],c=r[7],f=r[2],d=r[5],p=r[8],v=i[0],m=i[3],g=i[6],y=i[1],x=i[4],b=i[7],_=i[2],w=i[5],S=i[8];return a[0]=s*v+o*y+u*_,a[3]=s*m+o*x+u*w,a[6]=s*g+o*b+u*S,a[1]=h*v+l*y+c*_,a[4]=h*m+l*x+c*w,a[7]=h*g+l*b+c*S,a[2]=f*v+d*y+p*_,a[5]=f*m+d*x+p*w,a[8]=f*g+d*b+p*S,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],l=t[8];return e*s*l-e*o*h-r*a*l+r*o*u+i*a*h-i*s*u}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],l=t[8],c=l*s-o*h,f=o*u-l*a,d=h*a-s*u,p=e*c+r*f+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return t[0]=c*v,t[1]=(i*h-l*r)*v,t[2]=(o*r-i*s)*v,t[3]=f*v,t[4]=(l*e-i*u)*v,t[5]=(i*a-o*e)*v,t[6]=d*v,t[7]=(r*u-h*e)*v,t[8]=(s*e-r*a)*v,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,a,s,o){const u=Math.cos(a),h=Math.sin(a);return this.set(r*u,r*h,-r*(u*s+h*o)+s+t,-i*h,i*u,-i*(-h*s+u*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(Uu.makeScale(t,e)),this}rotate(t){return this.premultiply(Uu.makeRotation(-t)),this}translate(t,e){return this.premultiply(Uu.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<9;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Uu=new qr,Ym=new qr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Wm=new qr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function H2(){const n={enabled:!0,workingColorSpace:km,spaces:{},convert:function(i,a,s){return this.enabled===!1||a===s||!a||!s||(this.spaces[a].transfer===Lu&&(i.r=pn(i.r),i.g=pn(i.g),i.b=pn(i.b)),this.spaces[a].primaries!==this.spaces[s].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[s].fromXYZ)),this.spaces[s].transfer===Lu&&(i.r=Ea(i.r),i.g=Ea(i.g),i.b=Ea(i.b))),i},workingToColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},colorSpaceToWorking:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Rx?Lm:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,s){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,a){return Xm("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(i,a)},toWorkingColorSpace:function(i,a){return Xm("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(i,a)}},t=[.64,.33,.3,.6,.15,.06],e=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[km]:{primaries:t,whitePoint:r,transfer:Lm,toXYZ:Ym,fromXYZ:Wm,luminanceCoefficients:e,workingColorSpaceConfig:{unpackColorSpace:Vt},outputColorSpaceConfig:{drawingBufferColorSpace:Vt}},[Vt]:{primaries:t,whitePoint:r,transfer:Lu,toXYZ:Ym,fromXYZ:Wm,luminanceCoefficients:e,outputColorSpaceConfig:{drawingBufferColorSpace:Vt}}}),n}const ye=H2();function pn(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Ea(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let ji;class j2{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let r;if(t instanceof HTMLCanvasElement)r=t;else{ji===void 0&&(ji=Rf("canvas")),ji.width=t.width,ji.height=t.height;const i=ji.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),r=ji}return r.toDataURL(e)}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=Rf("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),a=i.data;for(let s=0;s<a.length;s++)a[s]=pn(a[s]/255)*255;return r.putImageData(i,0,0),e}else if(t.data){const e=t.data.slice(0);for(let r=0;r<e.length;r++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[r]=Math.floor(pn(e[r]/255)*255):e[r]=pn(e[r]);return{data:e,width:t.width,height:t.height}}else return Nt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let $2=0;class q2{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$2++}),this.uuid=Wn(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):typeof VideoFrame<"u"&&e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):e!==null?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let s=0,o=i.length;s<o;s++)i[s].isDataTexture?a.push(Vu(i[s].image)):a.push(Vu(i[s]))}else a=Vu(i);r.url=a}return e||(t.images[this.uuid]=r),r}}function Vu(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?j2.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(Nt("Texture: Unable to serialize Texture."),{})}let Z2=0;const Xu=new $;class Yr extends po{constructor(t=Yr.DEFAULT_IMAGE,e=Yr.DEFAULT_MAPPING,r=pa,i=pa,a=S2,s=E2,o=Px,u=Ax,h=Yr.DEFAULT_ANISOTROPY,l=Rx){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Z2++}),this.uuid=Wn(),this.name="",this.source=new q2(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=s,this.anisotropy=h,this.format=o,this.internalFormat=null,this.type=u,this.offset=new ve(0,0),this.repeat=new ve(1,1),this.center=new ve(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=l,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Xu).x}get height(){return this.source.getSize(Xu).y}get depth(){return this.source.getSize(Xu).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const r=t[e];if(r===void 0){Nt(`Texture.setValues(): parameter '${e}' has value of undefined.`);continue}const i=this[e];if(i===void 0){Nt(`Texture.setValues(): property '${e}' does not exist.`);continue}i&&r&&i.isVector2&&r.isVector2||i&&r&&i.isVector3&&r.isVector3||i&&r&&i.isMatrix3&&r.isMatrix3?i.copy(r):this[e]=r}}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),e||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Tx)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case tl:t.x=t.x-Math.floor(t.x);break;case pa:t.x=t.x<0?0:1;break;case Om:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case tl:t.y=t.y-Math.floor(t.y);break;case pa:t.y=t.y<0?0:1;break;case Om:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Yr.DEFAULT_IMAGE=null;Yr.DEFAULT_MAPPING=Tx;Yr.DEFAULT_ANISOTROPY=1;class tr{constructor(t=0,e=0,r=0,i=1){tr.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,a=this.w,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i+s[12]*a,this.y=s[1]*e+s[5]*r+s[9]*i+s[13]*a,this.z=s[2]*e+s[6]*r+s[10]*i+s[14]*a,this.w=s[3]*e+s[7]*r+s[11]*i+s[15]*a,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,a;const u=t.elements,h=u[0],l=u[4],c=u[8],f=u[1],d=u[5],p=u[9],v=u[2],m=u[6],g=u[10];if(Math.abs(l-f)<.01&&Math.abs(c-v)<.01&&Math.abs(p-m)<.01){if(Math.abs(l+f)<.1&&Math.abs(c+v)<.1&&Math.abs(p+m)<.1&&Math.abs(h+d+g-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const x=(h+1)/2,b=(d+1)/2,_=(g+1)/2,w=(l+f)/4,S=(c+v)/4,E=(p+m)/4;return x>b&&x>_?x<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(x),i=w/r,a=S/r):b>_?b<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(b),r=w/i,a=E/i):_<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(_),r=S/a,i=E/a),this.set(r,i,a,e),this}let y=Math.sqrt((m-p)*(m-p)+(c-v)*(c-v)+(f-l)*(f-l));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(c-v)/y,this.z=(f-l)/y,this.w=Math.acos((h+d+g-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=_t(this.x,t.x,e.x),this.y=_t(this.y,t.y,e.y),this.z=_t(this.z,t.z,e.z),this.w=_t(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=_t(this.x,t,e),this.y=_t(this.y,t,e),this.z=_t(this.z,t,e),this.w=_t(this.w,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_t(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ft{constructor(t,e,r,i,a,s,o,u,h,l,c,f,d,p,v,m){ft.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,r,i,a,s,o,u,h,l,c,f,d,p,v,m)}set(t,e,r,i,a,s,o,u,h,l,c,f,d,p,v,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=i,g[1]=a,g[5]=s,g[9]=o,g[13]=u,g[2]=h,g[6]=l,g[10]=c,g[14]=f,g[3]=d,g[7]=p,g[11]=v,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ft().fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return this.determinant()===0?(t.set(1,0,0),e.set(0,1,0),r.set(0,0,1),this):(t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this)}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){if(t.determinant()===0)return this.identity();const e=this.elements,r=t.elements,i=1/$i.setFromMatrixColumn(t,0).length(),a=1/$i.setFromMatrixColumn(t,1).length(),s=1/$i.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=0,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,i=t.y,a=t.z,s=Math.cos(r),o=Math.sin(r),u=Math.cos(i),h=Math.sin(i),l=Math.cos(a),c=Math.sin(a);if(t.order==="XYZ"){const f=s*l,d=s*c,p=o*l,v=o*c;e[0]=u*l,e[4]=-u*c,e[8]=h,e[1]=d+p*h,e[5]=f-v*h,e[9]=-o*u,e[2]=v-f*h,e[6]=p+d*h,e[10]=s*u}else if(t.order==="YXZ"){const f=u*l,d=u*c,p=h*l,v=h*c;e[0]=f+v*o,e[4]=p*o-d,e[8]=s*h,e[1]=s*c,e[5]=s*l,e[9]=-o,e[2]=d*o-p,e[6]=v+f*o,e[10]=s*u}else if(t.order==="ZXY"){const f=u*l,d=u*c,p=h*l,v=h*c;e[0]=f-v*o,e[4]=-s*c,e[8]=p+d*o,e[1]=d+p*o,e[5]=s*l,e[9]=v-f*o,e[2]=-s*h,e[6]=o,e[10]=s*u}else if(t.order==="ZYX"){const f=s*l,d=s*c,p=o*l,v=o*c;e[0]=u*l,e[4]=p*h-d,e[8]=f*h+v,e[1]=u*c,e[5]=v*h+f,e[9]=d*h-p,e[2]=-h,e[6]=o*u,e[10]=s*u}else if(t.order==="YZX"){const f=s*u,d=s*h,p=o*u,v=o*h;e[0]=u*l,e[4]=v-f*c,e[8]=p*c+d,e[1]=c,e[5]=s*l,e[9]=-o*l,e[2]=-h*l,e[6]=d*c+p,e[10]=f-v*c}else if(t.order==="XZY"){const f=s*u,d=s*h,p=o*u,v=o*h;e[0]=u*l,e[4]=-c,e[8]=h*l,e[1]=f*c+v,e[5]=s*l,e[9]=d*c-p,e[2]=p*c-d,e[6]=o*l,e[10]=v*c+f}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(K2,t,J2)}lookAt(t,e,r){const i=this.elements;return er.subVectors(t,e),er.lengthSq()===0&&(er.z=1),er.normalize(),An.crossVectors(r,er),An.lengthSq()===0&&(Math.abs(r.z)===1?er.x+=1e-4:er.z+=1e-4,er.normalize(),An.crossVectors(r,er)),An.normalize(),Ho.crossVectors(er,An),i[0]=An.x,i[4]=Ho.x,i[8]=er.x,i[1]=An.y,i[5]=Ho.y,i[9]=er.y,i[2]=An.z,i[6]=Ho.z,i[10]=er.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,a=this.elements,s=r[0],o=r[4],u=r[8],h=r[12],l=r[1],c=r[5],f=r[9],d=r[13],p=r[2],v=r[6],m=r[10],g=r[14],y=r[3],x=r[7],b=r[11],_=r[15],w=i[0],S=i[4],E=i[8],T=i[12],A=i[1],P=i[5],M=i[9],R=i[13],F=i[2],N=i[6],D=i[10],X=i[14],q=i[3],W=i[7],L=i[11],U=i[15];return a[0]=s*w+o*A+u*F+h*q,a[4]=s*S+o*P+u*N+h*W,a[8]=s*E+o*M+u*D+h*L,a[12]=s*T+o*R+u*X+h*U,a[1]=l*w+c*A+f*F+d*q,a[5]=l*S+c*P+f*N+d*W,a[9]=l*E+c*M+f*D+d*L,a[13]=l*T+c*R+f*X+d*U,a[2]=p*w+v*A+m*F+g*q,a[6]=p*S+v*P+m*N+g*W,a[10]=p*E+v*M+m*D+g*L,a[14]=p*T+v*R+m*X+g*U,a[3]=y*w+x*A+b*F+_*q,a[7]=y*S+x*P+b*N+_*W,a[11]=y*E+x*M+b*D+_*L,a[15]=y*T+x*R+b*X+_*U,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],a=t[12],s=t[1],o=t[5],u=t[9],h=t[13],l=t[2],c=t[6],f=t[10],d=t[14],p=t[3],v=t[7],m=t[11],g=t[15],y=u*d-h*f,x=o*d-h*c,b=o*f-u*c,_=s*d-h*l,w=s*f-u*l,S=s*c-o*l;return e*(v*y-m*x+g*b)-r*(p*y-m*_+g*w)+i*(p*x-v*_+g*S)-a*(p*b-v*w+m*S)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],l=t[8],c=t[9],f=t[10],d=t[11],p=t[12],v=t[13],m=t[14],g=t[15],y=e*o-r*s,x=e*u-i*s,b=e*h-a*s,_=r*u-i*o,w=r*h-a*o,S=i*h-a*u,E=l*v-c*p,T=l*m-f*p,A=l*g-d*p,P=c*m-f*v,M=c*g-d*v,R=f*g-d*m,F=y*R-x*M+b*P+_*A-w*T+S*E;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const N=1/F;return t[0]=(o*R-u*M+h*P)*N,t[1]=(i*M-r*R-a*P)*N,t[2]=(v*S-m*w+g*_)*N,t[3]=(f*w-c*S-d*_)*N,t[4]=(u*A-s*R-h*T)*N,t[5]=(e*R-i*A+a*T)*N,t[6]=(m*b-p*S-g*x)*N,t[7]=(l*S-f*b+d*x)*N,t[8]=(s*M-o*A+h*E)*N,t[9]=(r*A-e*M-a*E)*N,t[10]=(p*w-v*b+g*y)*N,t[11]=(c*b-l*w-d*y)*N,t[12]=(o*T-s*P-u*E)*N,t[13]=(e*P-r*T+i*E)*N,t[14]=(v*x-p*_-m*y)*N,t[15]=(l*_-c*x+f*y)*N,this}scale(t){const e=this.elements,r=t.x,i=t.y,a=t.z;return e[0]*=r,e[4]*=i,e[8]*=a,e[1]*=r,e[5]*=i,e[9]*=a,e[2]*=r,e[6]*=i,e[10]*=a,e[3]*=r,e[7]*=i,e[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),a=1-r,s=t.x,o=t.y,u=t.z,h=a*s,l=a*o;return this.set(h*s+r,h*o-i*u,h*u+i*o,0,h*o+i*u,l*o+r,l*u-i*s,0,h*u-i*o,l*u+i*s,a*u*u+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,i,a,s){return this.set(1,r,a,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,a=e._x,s=e._y,o=e._z,u=e._w,h=a+a,l=s+s,c=o+o,f=a*h,d=a*l,p=a*c,v=s*l,m=s*c,g=o*c,y=u*h,x=u*l,b=u*c,_=r.x,w=r.y,S=r.z;return i[0]=(1-(v+g))*_,i[1]=(d+b)*_,i[2]=(p-x)*_,i[3]=0,i[4]=(d-b)*w,i[5]=(1-(f+g))*w,i[6]=(m+y)*w,i[7]=0,i[8]=(p+x)*S,i[9]=(m-y)*S,i[10]=(1-(f+v))*S,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;t.x=i[12],t.y=i[13],t.z=i[14];const a=this.determinant();if(a===0)return r.set(1,1,1),e.identity(),this;let s=$i.set(i[0],i[1],i[2]).length();const o=$i.set(i[4],i[5],i[6]).length(),u=$i.set(i[8],i[9],i[10]).length();a<0&&(s=-s),pr.copy(this);const h=1/s,l=1/o,c=1/u;return pr.elements[0]*=h,pr.elements[1]*=h,pr.elements[2]*=h,pr.elements[4]*=l,pr.elements[5]*=l,pr.elements[6]*=l,pr.elements[8]*=c,pr.elements[9]*=c,pr.elements[10]*=c,e.setFromRotationMatrix(pr),r.x=s,r.y=o,r.z=u,this}makePerspective(t,e,r,i,a,s,o=pi,u=!1){const h=this.elements,l=2*a/(e-t),c=2*a/(r-i),f=(e+t)/(e-t),d=(r+i)/(r-i);let p,v;if(u)p=a/(s-a),v=s*a/(s-a);else if(o===pi)p=-(s+a)/(s-a),v=-2*s*a/(s-a);else if(o===nl)p=-s/(s-a),v=-s*a/(s-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return h[0]=l,h[4]=0,h[8]=f,h[12]=0,h[1]=0,h[5]=c,h[9]=d,h[13]=0,h[2]=0,h[6]=0,h[10]=p,h[14]=v,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(t,e,r,i,a,s,o=pi,u=!1){const h=this.elements,l=2/(e-t),c=2/(r-i),f=-(e+t)/(e-t),d=-(r+i)/(r-i);let p,v;if(u)p=1/(s-a),v=s/(s-a);else if(o===pi)p=-2/(s-a),v=-(s+a)/(s-a);else if(o===nl)p=-1/(s-a),v=-a/(s-a);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return h[0]=l,h[4]=0,h[8]=0,h[12]=f,h[1]=0,h[5]=c,h[9]=0,h[13]=d,h[2]=0,h[6]=0,h[10]=p,h[14]=v,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<16;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const $i=new $,pr=new ft,K2=new $(0,0,0),J2=new $(1,1,1),An=new $,Ho=new $,er=new $,Hm=new ft,jm=new le;class Qe{constructor(t=0,e=0,r=0,i=Qe.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i=this._order){return this._x=t,this._y=e,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const i=t.elements,a=i[0],s=i[4],o=i[8],u=i[1],h=i[5],l=i[9],c=i[2],f=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(_t(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(f,h),this._z=0);break;case"YXZ":this._x=Math.asin(-_t(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-c,a),this._z=0);break;case"ZXY":this._x=Math.asin(_t(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-_t(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(_t(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-c,a)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-_t(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-l,d),this._y=0);break;default:Nt("Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return Hm.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Hm,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return jm.setFromEuler(this),this.setFromQuaternion(jm,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Qe.DEFAULT_ORDER="XYZ";class Q2{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let tF=0;const $m=new $,qi=new le,tn=new ft,jo=new $,ns=new $,eF=new $,rF=new le,qm=new $(1,0,0),Zm=new $(0,1,0),Km=new $(0,0,1),Jm={type:"added"},nF={type:"removed"},Zi={type:"childadded",child:null},zu={type:"childremoved",child:null};class Jt extends po{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tF++}),this.uuid=Wn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Jt.DEFAULT_UP.clone();const t=new $,e=new Qe,r=new le,i=new $(1,1,1);function a(){r.setFromEuler(e,!1)}function s(){e.setFromQuaternion(r,void 0,!1)}e._onChange(a),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new ft},normalMatrix:{value:new qr}}),this.matrix=new ft,this.matrixWorld=new ft,this.matrixAutoUpdate=Jt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Q2,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.static=!1,this.userData={},this.pivot=null}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return qi.setFromAxisAngle(t,e),this.quaternion.multiply(qi),this}rotateOnWorldAxis(t,e){return qi.setFromAxisAngle(t,e),this.quaternion.premultiply(qi),this}rotateX(t){return this.rotateOnAxis(qm,t)}rotateY(t){return this.rotateOnAxis(Zm,t)}rotateZ(t){return this.rotateOnAxis(Km,t)}translateOnAxis(t,e){return $m.copy(t).applyQuaternion(this.quaternion),this.position.add($m.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(qm,t)}translateY(t){return this.translateOnAxis(Zm,t)}translateZ(t){return this.translateOnAxis(Km,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(tn.copy(this.matrixWorld).invert())}lookAt(t,e,r){t.isVector3?jo.copy(t):jo.set(t,e,r);const i=this.parent;this.updateWorldMatrix(!0,!1),ns.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?tn.lookAt(ns,jo,this.up):tn.lookAt(jo,ns,this.up),this.quaternion.setFromRotationMatrix(tn),i&&(tn.extractRotation(i.matrixWorld),qi.setFromRotationMatrix(tn),this.quaternion.premultiply(qi.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(jt("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Jm),Zi.child=t,this.dispatchEvent(Zi),Zi.child=null):jt("Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(nF),zu.child=t,this.dispatchEvent(zu),zu.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),tn.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),tn.multiply(t.parent.matrixWorld)),t.applyMatrix4(tn),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Jm),Zi.child=t,this.dispatchEvent(Zi),Zi.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r].getObjectByProperty(t,e);if(s!==void 0)return s}}getObjectsByProperty(t,e,r=[]){this[t]===e&&r.push(this);const i=this.children;for(let a=0,s=i.length;a<s;a++)i[a].getObjectsByProperty(t,e,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ns,t,eF),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ns,rF,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);const t=this.pivot;if(t!==null){const e=t.x,r=t.y,i=t.z,a=this.matrix.elements;a[12]+=e-a[0]*e-a[4]*r-a[8]*i,a[13]+=r-a[1]*e-a[5]*r-a[9]*i,a[14]+=i-a[2]*e-a[6]*r-a[10]*i}this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].updateMatrixWorld(t)}updateWorldMatrix(t,e){const r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),e===!0){const i=this.children;for(let a=0,s=i.length;a<s;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),this.static!==!1&&(i.static=this.static),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.pivot!==null&&(i.pivot=this.pivot.toArray()),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.morphTargetDictionary!==void 0&&(i.morphTargetDictionary=Object.assign({},this.morphTargetDictionary)),this.morphTargetInfluences!==void 0&&(i.morphTargetInfluences=this.morphTargetInfluences.slice()),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(t),i.indirectTexture=this._indirectTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function a(o,u){return o[u.uuid]===void 0&&(o[u.uuid]=u.toJSON(t)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(t.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const u=o.shapes;if(Array.isArray(u))for(let h=0,l=u.length;h<l;h++){const c=u[h];a(t.shapes,c)}else a(t.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let u=0,h=this.material.length;u<h;u++)o.push(a(t.materials,this.material[u]));i.material=o}else i.material=a(t.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const u=this.animations[o];i.animations.push(a(t.animations,u))}}if(e){const o=s(t.geometries),u=s(t.materials),h=s(t.textures),l=s(t.images),c=s(t.shapes),f=s(t.skeletons),d=s(t.animations),p=s(t.nodes);o.length>0&&(r.geometries=o),u.length>0&&(r.materials=u),h.length>0&&(r.textures=h),l.length>0&&(r.images=l),c.length>0&&(r.shapes=c),f.length>0&&(r.skeletons=f),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function s(o){const u=[];for(const h in o){const l=o[h];delete l.metadata,u.push(l)}return u}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),t.pivot!==null&&(this.pivot=t.pivot.clone()),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.static=t.static,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let r=0;r<t.children.length;r++){const i=t.children[r];this.add(i.clone())}return this}}Jt.DEFAULT_UP=new $(0,1,0);Jt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class Qm extends Jt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Ox={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Mn={h:0,s:0,l:0},$o={h:0,s:0,l:0};function Gu(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*6*(2/3-e):n}class ue{constructor(t,e,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,r)}set(t,e,r){if(e===void 0&&r===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,e,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Vt){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,ye.colorSpaceToWorking(this,e),this}setRGB(t,e,r,i=ye.workingColorSpace){return this.r=t,this.g=e,this.b=r,ye.colorSpaceToWorking(this,i),this}setHSL(t,e,r,i=ye.workingColorSpace){if(t=cp(t,1),e=_t(e,0,1),r=_t(r,0,1),e===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+e):r+e-r*e,s=2*r-a;this.r=Gu(s,a,t+1/3),this.g=Gu(s,a,t),this.b=Gu(s,a,t-1/3)}return ye.colorSpaceToWorking(this,i),this}setStyle(t,e=Vt){function r(a){a!==void 0&&parseFloat(a)<1&&Nt("Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const s=i[1],o=i[2];switch(s){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,e);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,e);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,e);break;default:Nt("Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=i[1],s=a.length;if(s===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,e);if(s===6)return this.setHex(parseInt(a,16),e);Nt("Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Vt){const r=Ox[t.toLowerCase()];return r!==void 0?this.setHex(r,e):Nt("Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=pn(t.r),this.g=pn(t.g),this.b=pn(t.b),this}copyLinearToSRGB(t){return this.r=Ea(t.r),this.g=Ea(t.g),this.b=Ea(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Vt){return ye.workingToColorSpace(Le.copy(this),t),Math.round(_t(Le.r*255,0,255))*65536+Math.round(_t(Le.g*255,0,255))*256+Math.round(_t(Le.b*255,0,255))}getHexString(t=Vt){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=ye.workingColorSpace){ye.workingToColorSpace(Le.copy(this),e);const r=Le.r,i=Le.g,a=Le.b,s=Math.max(r,i,a),o=Math.min(r,i,a);let u,h;const l=(o+s)/2;if(o===s)u=0,h=0;else{const c=s-o;switch(h=l<=.5?c/(s+o):c/(2-s-o),s){case r:u=(i-a)/c+(i<a?6:0);break;case i:u=(a-r)/c+2;break;case a:u=(r-i)/c+4;break}u/=6}return t.h=u,t.s=h,t.l=l,t}getRGB(t,e=ye.workingColorSpace){return ye.workingToColorSpace(Le.copy(this),e),t.r=Le.r,t.g=Le.g,t.b=Le.b,t}getStyle(t=Vt){ye.workingToColorSpace(Le.copy(this),t);const e=Le.r,r=Le.g,i=Le.b;return t!==Vt?`color(${t} ${e.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(t,e,r){return this.getHSL(Mn),this.setHSL(Mn.h+t,Mn.s+e,Mn.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this}lerpHSL(t,e){this.getHSL(Mn),t.getHSL($o);const r=bs(Mn.h,$o.h,e),i=bs(Mn.s,$o.s,e),a=bs(Mn.l,$o.l,e);return this.setHSL(r,i,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,r=this.g,i=this.b,a=t.elements;return this.r=a[0]*e+a[3]*r+a[6]*i,this.g=a[1]*e+a[4]*r+a[7]*i,this.b=a[2]*e+a[5]*r+a[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Le=new ue;ue.NAMES=Ox;const vr=new $,en=new $,Yu=new $,rn=new $,Ki=new $,Ji=new $,tg=new $,Wu=new $,Hu=new $,ju=new $,$u=new tr,qu=new tr,Zu=new tr;class Er{constructor(t=new $,e=new $,r=new $){this.a=t,this.b=e,this.c=r}static getNormal(t,e,r,i){i.subVectors(r,e),vr.subVectors(t,e),i.cross(vr);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(t,e,r,i,a){vr.subVectors(i,e),en.subVectors(r,e),Yu.subVectors(t,e);const s=vr.dot(vr),o=vr.dot(en),u=vr.dot(Yu),h=en.dot(en),l=en.dot(Yu),c=s*h-o*o;if(c===0)return a.set(0,0,0),null;const f=1/c,d=(h*u-o*l)*f,p=(s*l-o*u)*f;return a.set(1-d-p,p,d)}static containsPoint(t,e,r,i){return this.getBarycoord(t,e,r,i,rn)===null?!1:rn.x>=0&&rn.y>=0&&rn.x+rn.y<=1}static getInterpolation(t,e,r,i,a,s,o,u){return this.getBarycoord(t,e,r,i,rn)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,rn.x),u.addScaledVector(s,rn.y),u.addScaledVector(o,rn.z),u)}static getInterpolatedAttribute(t,e,r,i,a,s){return $u.setScalar(0),qu.setScalar(0),Zu.setScalar(0),$u.fromBufferAttribute(t,e),qu.fromBufferAttribute(t,r),Zu.fromBufferAttribute(t,i),s.setScalar(0),s.addScaledVector($u,a.x),s.addScaledVector(qu,a.y),s.addScaledVector(Zu,a.z),s}static isFrontFacing(t,e,r,i){return vr.subVectors(r,e),en.subVectors(t,e),vr.cross(en).dot(i)<0}set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this}setFromPointsAndIndices(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,r,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return vr.subVectors(this.c,this.b),en.subVectors(this.a,this.b),vr.cross(en).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Er.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Er.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,r,i,a){return Er.getInterpolation(t,this.a,this.b,this.c,e,r,i,a)}containsPoint(t){return Er.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Er.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const r=this.a,i=this.b,a=this.c;let s,o;Ki.subVectors(i,r),Ji.subVectors(a,r),Wu.subVectors(t,r);const u=Ki.dot(Wu),h=Ji.dot(Wu);if(u<=0&&h<=0)return e.copy(r);Hu.subVectors(t,i);const l=Ki.dot(Hu),c=Ji.dot(Hu);if(l>=0&&c<=l)return e.copy(i);const f=u*c-l*h;if(f<=0&&u>=0&&l<=0)return s=u/(u-l),e.copy(r).addScaledVector(Ki,s);ju.subVectors(t,a);const d=Ki.dot(ju),p=Ji.dot(ju);if(p>=0&&d<=p)return e.copy(a);const v=d*h-u*p;if(v<=0&&h>=0&&p<=0)return o=h/(h-p),e.copy(r).addScaledVector(Ji,o);const m=l*p-d*c;if(m<=0&&c-l>=0&&d-p>=0)return tg.subVectors(a,i),o=(c-l)/(c-l+(d-p)),e.copy(i).addScaledVector(tg,o);const g=1/(m+v+f);return s=v*g,o=f*g,e.copy(r).addScaledVector(Ki,s).addScaledVector(Ji,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}class Va{constructor(t=new $(1/0,1/0,1/0),e=new $(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e+=3)this.expandByPoint(mr.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,r=t.count;e<r;e++)this.expandByPoint(mr.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=mr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const a=r.getAttribute("position");if(e===!0&&a!==void 0&&t.isInstancedMesh!==!0)for(let s=0,o=a.count;s<o;s++)t.isMesh===!0?t.getVertexPosition(s,mr):mr.fromBufferAttribute(a,s),mr.applyMatrix4(t.matrixWorld),this.expandByPoint(mr);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),qo.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),qo.copy(r.boundingBox)),qo.applyMatrix4(t.matrixWorld),this.union(qo)}const i=t.children;for(let a=0,s=i.length;a<s;a++)this.expandByObject(i[a],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,mr),mr.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(is),Zo.subVectors(this.max,is),Qi.subVectors(t.a,is),ta.subVectors(t.b,is),ea.subVectors(t.c,is),Pn.subVectors(ta,Qi),In.subVectors(ea,ta),ti.subVectors(Qi,ea);let e=[0,-Pn.z,Pn.y,0,-In.z,In.y,0,-ti.z,ti.y,Pn.z,0,-Pn.x,In.z,0,-In.x,ti.z,0,-ti.x,-Pn.y,Pn.x,0,-In.y,In.x,0,-ti.y,ti.x,0];return!Ku(e,Qi,ta,ea,Zo)||(e=[1,0,0,0,1,0,0,0,1],!Ku(e,Qi,ta,ea,Zo))?!1:(Ko.crossVectors(Pn,In),e=[Ko.x,Ko.y,Ko.z],Ku(e,Qi,ta,ea,Zo))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,mr).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(mr).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(nn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),nn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),nn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),nn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),nn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),nn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),nn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),nn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(nn),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const nn=[new $,new $,new $,new $,new $,new $,new $,new $],mr=new $,qo=new Va,Qi=new $,ta=new $,ea=new $,Pn=new $,In=new $,ti=new $,is=new $,Zo=new $,Ko=new $,ei=new $;function Ku(n,t,e,r,i){for(let a=0,s=n.length-3;a<=s;a+=3){ei.fromArray(n,a);const o=i.x*Math.abs(ei.x)+i.y*Math.abs(ei.y)+i.z*Math.abs(ei.z),u=t.dot(ei),h=e.dot(ei),l=r.dot(ei);if(Math.max(-Math.max(u,h,l),Math.min(u,h,l))>o)return!1}return!0}const oe=new $,Jo=new ve;let iF=0;class Ta{constructor(t,e,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:iF++}),this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=r,this.usage=Um,this.updateRanges=[],this.gpuType=Mx,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[t+i]=e.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,r=this.count;e<r;e++)Jo.fromBufferAttribute(this,e),Jo.applyMatrix3(t),this.setXY(e,Jo.x,Jo.y);else if(this.itemSize===3)for(let e=0,r=this.count;e<r;e++)oe.fromBufferAttribute(this,e),oe.applyMatrix3(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}applyMatrix4(t){for(let e=0,r=this.count;e<r;e++)oe.fromBufferAttribute(this,e),oe.applyMatrix4(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)oe.fromBufferAttribute(this,e),oe.applyNormalMatrix(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)oe.fromBufferAttribute(this,e),oe.transformDirection(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let r=this.array[t*this.itemSize+e];return this.normalized&&(r=ha(r,this.array)),r}setComponent(t,e,r){return this.normalized&&(r=Ve(r,this.array)),this.array[t*this.itemSize+e]=r,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ha(e,this.array)),e}setX(t,e){return this.normalized&&(e=Ve(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ha(e,this.array)),e}setY(t,e){return this.normalized&&(e=Ve(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ha(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Ve(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ha(e,this.array)),e}setW(t,e){return this.normalized&&(e=Ve(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,r){return t*=this.itemSize,this.normalized&&(e=Ve(e,this.array),r=Ve(r,this.array)),this.array[t+0]=e,this.array[t+1]=r,this}setXYZ(t,e,r,i){return t*=this.itemSize,this.normalized&&(e=Ve(e,this.array),r=Ve(r,this.array),i=Ve(i,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,e,r,i,a){return t*=this.itemSize,this.normalized&&(e=Ve(e,this.array),r=Ve(r,this.array),i=Ve(i,this.array),a=Ve(a,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Um&&(t.usage=this.usage),t}}class Bx extends Ta{constructor(t,e,r){super(new Uint16Array(t),e,r)}}class aF extends Ta{constructor(t,e,r){super(new Uint32Array(t),e,r)}}class Nn extends Ta{constructor(t,e,r){super(new Float32Array(t),e,r)}}const sF=new Va,as=new $,Ju=new $;class Xa{constructor(t=new $,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;e!==void 0?r.copy(e):sF.setFromPoints(t).getCenter(r);let i=0;for(let a=0,s=t.length;a<s;a++)i=Math.max(i,r.distanceToSquared(t[a]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;as.subVectors(t,this.center);const e=as.lengthSq();if(e>this.radius*this.radius){const r=Math.sqrt(e),i=(r-this.radius)*.5;this.center.addScaledVector(as,i/r),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Ju.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(as.copy(t.center).add(Ju)),this.expandByPoint(as.copy(t.center).sub(Ju))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}let oF=0;const hr=new ft,Qu=new Jt,ra=new $,rr=new Va,ss=new Va,Ee=new $;class bi extends po{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:oF++}),this.uuid=Wn(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(P2(t)?aF:Bx)(t,1):this.index=t,this}setIndirect(t,e=0){return this.indirect=t,this.indirectOffset=e,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new qr().getNormalMatrix(t);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return hr.makeRotationFromQuaternion(t),this.applyMatrix4(hr),this}rotateX(t){return hr.makeRotationX(t),this.applyMatrix4(hr),this}rotateY(t){return hr.makeRotationY(t),this.applyMatrix4(hr),this}rotateZ(t){return hr.makeRotationZ(t),this.applyMatrix4(hr),this}translate(t,e,r){return hr.makeTranslation(t,e,r),this.applyMatrix4(hr),this}scale(t,e,r){return hr.makeScale(t,e,r),this.applyMatrix4(hr),this}lookAt(t){return Qu.lookAt(t),Qu.updateMatrix(),this.applyMatrix4(Qu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ra).negate(),this.translate(ra.x,ra.y,ra.z),this}setFromPoints(t){const e=this.getAttribute("position");if(e===void 0){const r=[];for(let i=0,a=t.length;i<a;i++){const s=t[i];r.push(s.x,s.y,s.z||0)}this.setAttribute("position",new Nn(r,3))}else{const r=Math.min(t.length,e.count);for(let i=0;i<r;i++){const a=t[i];e.setXYZ(i,a.x,a.y,a.z||0)}t.length>e.count&&Nt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Va);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){jt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new $(-1/0,-1/0,-1/0),new $(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let r=0,i=e.length;r<i;r++){const a=e[r];rr.setFromBufferAttribute(a),this.morphTargetsRelative?(Ee.addVectors(this.boundingBox.min,rr.min),this.boundingBox.expandByPoint(Ee),Ee.addVectors(this.boundingBox.max,rr.max),this.boundingBox.expandByPoint(Ee)):(this.boundingBox.expandByPoint(rr.min),this.boundingBox.expandByPoint(rr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&jt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Xa);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){jt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new $,1/0);return}if(t){const r=this.boundingSphere.center;if(rr.setFromBufferAttribute(t),e)for(let a=0,s=e.length;a<s;a++){const o=e[a];ss.setFromBufferAttribute(o),this.morphTargetsRelative?(Ee.addVectors(rr.min,ss.min),rr.expandByPoint(Ee),Ee.addVectors(rr.max,ss.max),rr.expandByPoint(Ee)):(rr.expandByPoint(ss.min),rr.expandByPoint(ss.max))}rr.getCenter(r);let i=0;for(let a=0,s=t.count;a<s;a++)Ee.fromBufferAttribute(t,a),i=Math.max(i,r.distanceToSquared(Ee));if(e)for(let a=0,s=e.length;a<s;a++){const o=e[a],u=this.morphTargetsRelative;for(let h=0,l=o.count;h<l;h++)Ee.fromBufferAttribute(o,h),u&&(ra.fromBufferAttribute(t,h),Ee.add(ra)),i=Math.max(i,r.distanceToSquared(Ee))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&jt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){jt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.position,i=e.normal,a=e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ta(new Float32Array(4*r.count),4));const s=this.getAttribute("tangent"),o=[],u=[];for(let E=0;E<r.count;E++)o[E]=new $,u[E]=new $;const h=new $,l=new $,c=new $,f=new ve,d=new ve,p=new ve,v=new $,m=new $;function g(E,T,A){h.fromBufferAttribute(r,E),l.fromBufferAttribute(r,T),c.fromBufferAttribute(r,A),f.fromBufferAttribute(a,E),d.fromBufferAttribute(a,T),p.fromBufferAttribute(a,A),l.sub(h),c.sub(h),d.sub(f),p.sub(f);const P=1/(d.x*p.y-p.x*d.y);isFinite(P)&&(v.copy(l).multiplyScalar(p.y).addScaledVector(c,-d.y).multiplyScalar(P),m.copy(c).multiplyScalar(d.x).addScaledVector(l,-p.x).multiplyScalar(P),o[E].add(v),o[T].add(v),o[A].add(v),u[E].add(m),u[T].add(m),u[A].add(m))}let y=this.groups;y.length===0&&(y=[{start:0,count:t.count}]);for(let E=0,T=y.length;E<T;++E){const A=y[E],P=A.start,M=A.count;for(let R=P,F=P+M;R<F;R+=3)g(t.getX(R+0),t.getX(R+1),t.getX(R+2))}const x=new $,b=new $,_=new $,w=new $;function S(E){_.fromBufferAttribute(i,E),w.copy(_);const T=o[E];x.copy(T),x.sub(_.multiplyScalar(_.dot(T))).normalize(),b.crossVectors(w,T);const P=b.dot(u[E])<0?-1:1;s.setXYZW(E,x.x,x.y,x.z,P)}for(let E=0,T=y.length;E<T;++E){const A=y[E],P=A.start,M=A.count;for(let R=P,F=P+M;R<F;R+=3)S(t.getX(R+0)),S(t.getX(R+1)),S(t.getX(R+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ta(new Float32Array(e.count*3),3),this.setAttribute("normal",r);else for(let f=0,d=r.count;f<d;f++)r.setXYZ(f,0,0,0);const i=new $,a=new $,s=new $,o=new $,u=new $,h=new $,l=new $,c=new $;if(t)for(let f=0,d=t.count;f<d;f+=3){const p=t.getX(f+0),v=t.getX(f+1),m=t.getX(f+2);i.fromBufferAttribute(e,p),a.fromBufferAttribute(e,v),s.fromBufferAttribute(e,m),l.subVectors(s,a),c.subVectors(i,a),l.cross(c),o.fromBufferAttribute(r,p),u.fromBufferAttribute(r,v),h.fromBufferAttribute(r,m),o.add(l),u.add(l),h.add(l),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(v,u.x,u.y,u.z),r.setXYZ(m,h.x,h.y,h.z)}else for(let f=0,d=e.count;f<d;f+=3)i.fromBufferAttribute(e,f+0),a.fromBufferAttribute(e,f+1),s.fromBufferAttribute(e,f+2),l.subVectors(s,a),c.subVectors(i,a),l.cross(c),r.setXYZ(f+0,l.x,l.y,l.z),r.setXYZ(f+1,l.x,l.y,l.z),r.setXYZ(f+2,l.x,l.y,l.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Ee.fromBufferAttribute(t,e),Ee.normalize(),t.setXYZ(e,Ee.x,Ee.y,Ee.z)}toNonIndexed(){function t(o,u){const h=o.array,l=o.itemSize,c=o.normalized,f=new h.constructor(u.length*l);let d=0,p=0;for(let v=0,m=u.length;v<m;v++){o.isInterleavedBufferAttribute?d=u[v]*o.data.stride+o.offset:d=u[v]*l;for(let g=0;g<l;g++)f[p++]=h[d++]}return new Ta(f,l,c)}if(this.index===null)return Nt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new bi,r=this.index.array,i=this.attributes;for(const o in i){const u=i[o],h=t(u,r);e.setAttribute(o,h)}const a=this.morphAttributes;for(const o in a){const u=[],h=a[o];for(let l=0,c=h.length;l<c;l++){const f=h[l],d=t(f,r);u.push(d)}e.morphAttributes[o]=u}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,u=s.length;o<u;o++){const h=s[o];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(t[h]=u[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const u in r){const h=r[u];t.data.attributes[u]=h.toJSON(t.data)}const i={};let a=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],l=[];for(let c=0,f=h.length;c<f;c++){const d=h[c];l.push(d.toJSON(t.data))}l.length>0&&(i[u]=l,a=!0)}a&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return o!==null&&(t.data.boundingSphere=o.toJSON()),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone());const i=t.attributes;for(const h in i){const l=i[h];this.setAttribute(h,l.clone(e))}const a=t.morphAttributes;for(const h in a){const l=[],c=a[h];for(let f=0,d=c.length;f<d;f++)l.push(c[f].clone(e));this.morphAttributes[h]=l}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let h=0,l=s.length;h<l;h++){const c=s[h];this.addGroup(c.start,c.count,c.materialIndex)}const o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());const u=t.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let hF=0;class Cl extends po{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:hF++}),this.uuid=Wn(),this.name="",this.type="Material",this.blending=Mm,this.side=If,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Im,this.blendDst=Cm,this.blendEquation=Pm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ue(0,0,0),this.blendAlpha=0,this.depthFunc=Rm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Dm,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Hi,this.stencilZFail=Hi,this.stencilZPass=Hi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const r=t[e];if(r===void 0){Nt(`Material: parameter '${e}' has value of undefined.`);continue}const i=this[e];if(i===void 0){Nt(`Material: '${e}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[e]=r}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(r.sheenColorMap=this.sheenColorMap.toJSON(t).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(r.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(t).uuid),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Mm&&(r.blending=this.blending),this.side!==If&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==Im&&(r.blendSrc=this.blendSrc),this.blendDst!==Cm&&(r.blendDst=this.blendDst),this.blendEquation!==Pm&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Rm&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Dm&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Hi&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Hi&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Hi&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.allowOverride===!1&&(r.allowOverride=!1),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const s=[];for(const o in a){const u=a[o];delete u.metadata,s.push(u)}return s}if(e){const a=i(t.textures),s=i(t.images);a.length>0&&(r.textures=a),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let r=null;if(e!==null){const i=e.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=e[a].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.allowOverride=t.allowOverride,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}const an=new $,tc=new $,Qo=new $,Cn=new $,ec=new $,th=new $,rc=new $;class fp{constructor(t=new $,e=new $(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,an)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=an.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(an.copy(this.origin).addScaledVector(this.direction,e),an.distanceToSquared(t))}distanceSqToSegment(t,e,r,i){tc.copy(t).add(e).multiplyScalar(.5),Qo.copy(e).sub(t).normalize(),Cn.copy(this.origin).sub(tc);const a=t.distanceTo(e)*.5,s=-this.direction.dot(Qo),o=Cn.dot(this.direction),u=-Cn.dot(Qo),h=Cn.lengthSq(),l=Math.abs(1-s*s);let c,f,d,p;if(l>0)if(c=s*u-o,f=s*o-u,p=a*l,c>=0)if(f>=-p)if(f<=p){const v=1/l;c*=v,f*=v,d=c*(c+s*f+2*o)+f*(s*c+f+2*u)+h}else f=a,c=Math.max(0,-(s*f+o)),d=-c*c+f*(f+2*u)+h;else f=-a,c=Math.max(0,-(s*f+o)),d=-c*c+f*(f+2*u)+h;else f<=-p?(c=Math.max(0,-(-s*a+o)),f=c>0?-a:Math.min(Math.max(-a,-u),a),d=-c*c+f*(f+2*u)+h):f<=p?(c=0,f=Math.min(Math.max(-a,-u),a),d=f*(f+2*u)+h):(c=Math.max(0,-(s*a+o)),f=c>0?a:Math.min(Math.max(-a,-u),a),d=-c*c+f*(f+2*u)+h);else f=s>0?-a:a,c=Math.max(0,-(s*f+o)),d=-c*c+f*(f+2*u)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,c),i&&i.copy(tc).addScaledVector(Qo,f),d}intersectSphere(t,e){an.subVectors(t.center,this.origin);const r=an.dot(this.direction),i=an.dot(an)-r*r,a=t.radius*t.radius;if(i>a)return null;const s=Math.sqrt(a-i),o=r-s,u=r+s;return u<0?null:o<0?this.at(u,e):this.at(o,e)}intersectsSphere(t){return t.radius<0?!1:this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null}intersectPlane(t,e){const r=this.distanceToPlane(t);return r===null?null:this.at(r,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let r,i,a,s,o,u;const h=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,f=this.origin;return h>=0?(r=(t.min.x-f.x)*h,i=(t.max.x-f.x)*h):(r=(t.max.x-f.x)*h,i=(t.min.x-f.x)*h),l>=0?(a=(t.min.y-f.y)*l,s=(t.max.y-f.y)*l):(a=(t.max.y-f.y)*l,s=(t.min.y-f.y)*l),r>s||a>i||((a>r||isNaN(r))&&(r=a),(s<i||isNaN(i))&&(i=s),c>=0?(o=(t.min.z-f.z)*c,u=(t.max.z-f.z)*c):(o=(t.max.z-f.z)*c,u=(t.min.z-f.z)*c),r>u||o>i)||((o>r||r!==r)&&(r=o),(u<i||i!==i)&&(i=u),i<0)?null:this.at(r>=0?r:i,e)}intersectsBox(t){return this.intersectBox(t,an)!==null}intersectTriangle(t,e,r,i,a){ec.subVectors(e,t),th.subVectors(r,t),rc.crossVectors(ec,th);let s=this.direction.dot(rc),o;if(s>0){if(i)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Cn.subVectors(this.origin,t);const u=o*this.direction.dot(th.crossVectors(Cn,th));if(u<0)return null;const h=o*this.direction.dot(ec.cross(Cn));if(h<0||u+h>s)return null;const l=-o*Cn.dot(rc);return l<0?null:this.at(l/s,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class lF extends Cl{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qe,this.combine=lp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const eg=new ft,ri=new fp,eh=new Xa,rg=new $,rh=new $,nh=new $,ih=new $,nc=new $,ah=new $,ng=new $,sh=new $;class Nx extends Jt{constructor(t=new bi,e=new lF){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){const i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}getVertexPosition(t,e){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,s=r.morphTargetsRelative;e.fromBufferAttribute(i,t);const o=this.morphTargetInfluences;if(a&&o){ah.set(0,0,0);for(let u=0,h=a.length;u<h;u++){const l=o[u],c=a[u];l!==0&&(nc.fromBufferAttribute(c,t),s?ah.addScaledVector(nc,l):ah.addScaledVector(nc.sub(e),l))}e.add(ah)}return e}raycast(t,e){const r=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),eh.copy(r.boundingSphere),eh.applyMatrix4(a),ri.copy(t.ray).recast(t.near),!(eh.containsPoint(ri.origin)===!1&&(ri.intersectSphere(eh,rg)===null||ri.origin.distanceToSquared(rg)>(t.far-t.near)**2))&&(eg.copy(a).invert(),ri.copy(t.ray).applyMatrix4(eg),!(r.boundingBox!==null&&ri.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,e,ri)))}_computeIntersections(t,e,r){let i;const a=this.geometry,s=this.material,o=a.index,u=a.attributes.position,h=a.attributes.uv,l=a.attributes.uv1,c=a.attributes.normal,f=a.groups,d=a.drawRange;if(o!==null)if(Array.isArray(s))for(let p=0,v=f.length;p<v;p++){const m=f[p],g=s[m.materialIndex],y=Math.max(m.start,d.start),x=Math.min(o.count,Math.min(m.start+m.count,d.start+d.count));for(let b=y,_=x;b<_;b+=3){const w=o.getX(b),S=o.getX(b+1),E=o.getX(b+2);i=oh(this,g,t,r,h,l,c,w,S,E),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=m.materialIndex,e.push(i))}}else{const p=Math.max(0,d.start),v=Math.min(o.count,d.start+d.count);for(let m=p,g=v;m<g;m+=3){const y=o.getX(m),x=o.getX(m+1),b=o.getX(m+2);i=oh(this,s,t,r,h,l,c,y,x,b),i&&(i.faceIndex=Math.floor(m/3),e.push(i))}}else if(u!==void 0)if(Array.isArray(s))for(let p=0,v=f.length;p<v;p++){const m=f[p],g=s[m.materialIndex],y=Math.max(m.start,d.start),x=Math.min(u.count,Math.min(m.start+m.count,d.start+d.count));for(let b=y,_=x;b<_;b+=3){const w=b,S=b+1,E=b+2;i=oh(this,g,t,r,h,l,c,w,S,E),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=m.materialIndex,e.push(i))}}else{const p=Math.max(0,d.start),v=Math.min(u.count,d.start+d.count);for(let m=p,g=v;m<g;m+=3){const y=m,x=m+1,b=m+2;i=oh(this,s,t,r,h,l,c,y,x,b),i&&(i.faceIndex=Math.floor(m/3),e.push(i))}}}}function uF(n,t,e,r,i,a,s,o){let u;if(t.side===b2?u=r.intersectTriangle(s,a,i,!0,o):u=r.intersectTriangle(i,a,s,t.side===If,o),u===null)return null;sh.copy(o),sh.applyMatrix4(n.matrixWorld);const h=e.ray.origin.distanceTo(sh);return h<e.near||h>e.far?null:{distance:h,point:sh.clone(),object:n}}function oh(n,t,e,r,i,a,s,o,u,h){n.getVertexPosition(o,rh),n.getVertexPosition(u,nh),n.getVertexPosition(h,ih);const l=uF(n,t,e,r,rh,nh,ih,ng);if(l){const c=new $;Er.getBarycoord(ng,rh,nh,ih,c),i&&(l.uv=Er.getInterpolatedAttribute(i,o,u,h,c,new ve)),a&&(l.uv1=Er.getInterpolatedAttribute(a,o,u,h,c,new ve)),s&&(l.normal=Er.getInterpolatedAttribute(s,o,u,h,c,new $),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const f={a:o,b:u,c:h,normal:new $,materialIndex:0};Er.getNormal(rh,nh,ih,f.normal),l.face=f,l.barycoord=c}return l}const ig=new $,ag=new tr,sg=new tr,cF=new $,og=new ft,hh=new $,ic=new Xa,hg=new ft,ac=new fp;class fF extends Nx{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Fm,this.bindMatrix=new ft,this.bindMatrixInverse=new ft,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;this.boundingBox===null&&(this.boundingBox=new Va),this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let r=0;r<e.count;r++)this.getVertexPosition(r,hh),this.boundingBox.expandByPoint(hh)}computeBoundingSphere(){const t=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Xa),this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let r=0;r<e.count;r++)this.getVertexPosition(r,hh),this.boundingSphere.expandByPoint(hh)}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,e){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),ic.copy(this.boundingSphere),ic.applyMatrix4(i),t.ray.intersectsSphere(ic)!==!1&&(hg.copy(i).invert(),ac.copy(t.ray).applyMatrix4(hg),!(this.boundingBox!==null&&ac.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(t,e,ac)))}getVertexPosition(t,e){return super.getVertexPosition(t,e),this.applyBoneTransform(t,e),e}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new tr,e=this.geometry.attributes.skinWeight;for(let r=0,i=e.count;r<i;r++){t.fromBufferAttribute(e,r);const a=1/t.manhattanLength();a!==1/0?t.multiplyScalar(a):t.set(1,0,0,0),e.setXYZW(r,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===Fm?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===_2?this.bindMatrixInverse.copy(this.bindMatrix).invert():Nt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,e){const r=this.skeleton,i=this.geometry;ag.fromBufferAttribute(i.attributes.skinIndex,t),sg.fromBufferAttribute(i.attributes.skinWeight,t),ig.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let a=0;a<4;a++){const s=sg.getComponent(a);if(s!==0){const o=ag.getComponent(a);og.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),e.addScaledVector(cF.copy(ig).applyMatrix4(og),s)}}return e.applyMatrix4(this.bindMatrixInverse)}}class Ff extends Jt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class dF extends Yr{constructor(t=null,e=1,r=1,i,a,s,o,u,h=Bm,l=Bm,c,f){super(null,s,o,u,h,l,i,a,c,f),this.isDataTexture=!0,this.image={data:t,width:e,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const lg=new ft,pF=new ft;class dp{constructor(t=[],e=[]){this.uuid=Wn(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),e.length===0)this.calculateInverses();else if(t.length!==e.length){Nt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new ft)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const r=new ft;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const r=this.bones[t];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const t=this.bones,e=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let a=0,s=t.length;a<s;a++){const o=t[a]?t[a].matrixWorld:pF;lg.multiplyMatrices(o,e[a]),lg.toArray(r,a*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new dp(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=Math.ceil(t/4)*4,t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const r=new dF(e,t,t,Px,Mx);return r.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=r,this}getBoneByName(t){for(let e=0,r=this.bones.length;e<r;e++){const i=this.bones[e];if(i.name===t)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let r=0,i=t.bones.length;r<i;r++){const a=t.bones[r];let s=e[a];s===void 0&&(Nt("Skeleton: No bone found with UUID:",a),s=new Ff),this.bones.push(s),this.boneInverses.push(new ft().fromArray(t.boneInverses[r]))}return this.init(),this}toJSON(){const t={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,r=this.boneInverses;for(let i=0,a=e.length;i<a;i++){const s=e[i];t.bones.push(s.uuid);const o=r[i];t.boneInverses.push(o.toArray())}return t}}const sc=new $,vF=new $,mF=new qr;class na{constructor(t=new $(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,r,i){return this.normal.set(t,e,r),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,r){const i=sc.subVectors(r,e).cross(vF.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const r=t.delta(sc),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:e.copy(t.start).addScaledVector(r,a)}intersectsLine(t){const e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return e<0&&r>0||r<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const r=e||mF.getNormalMatrix(t),i=this.coplanarPoint(sc).applyMatrix4(t),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ni=new Xa,gF=new ve(.5,.5),lh=new $;class yF{constructor(t=new na,e=new na,r=new na,i=new na,a=new na,s=new na){this.planes=[t,e,r,i,a,s]}set(t,e,r,i,a,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(r),o[3].copy(i),o[4].copy(a),o[5].copy(s),this}copy(t){const e=this.planes;for(let r=0;r<6;r++)e[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t,e=pi,r=!1){const i=this.planes,a=t.elements,s=a[0],o=a[1],u=a[2],h=a[3],l=a[4],c=a[5],f=a[6],d=a[7],p=a[8],v=a[9],m=a[10],g=a[11],y=a[12],x=a[13],b=a[14],_=a[15];if(i[0].setComponents(h-s,d-l,g-p,_-y).normalize(),i[1].setComponents(h+s,d+l,g+p,_+y).normalize(),i[2].setComponents(h+o,d+c,g+v,_+x).normalize(),i[3].setComponents(h-o,d-c,g-v,_-x).normalize(),r)i[4].setComponents(u,f,m,b).normalize(),i[5].setComponents(h-u,d-f,g-m,_-b).normalize();else if(i[4].setComponents(h-u,d-f,g-m,_-b).normalize(),e===pi)i[5].setComponents(h+u,d+f,g+m,_+b).normalize();else if(e===nl)i[5].setComponents(u,f,m,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),ni.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),ni.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(ni)}intersectsSprite(t){ni.center.set(0,0,0);const e=gF.distanceTo(t.center);return ni.radius=.7071067811865476+e,ni.applyMatrix4(t.matrixWorld),this.intersectsSphere(ni)}intersectsSphere(t){const e=this.planes,r=t.center,i=-t.radius;for(let a=0;a<6;a++)if(e[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(t){const e=this.planes;for(let r=0;r<6;r++){const i=e[r];if(lh.x=i.normal.x>0?t.max.x:t.min.x,lh.y=i.normal.y>0?t.max.y:t.min.y,lh.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(lh)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class kx extends Cl{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ue(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const il=new $,al=new $,ug=new ft,os=new fp,uh=new Xa,oc=new $,cg=new $;class xF extends Jt{constructor(t=new bi,e=new kx){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position,r=[0];for(let i=1,a=e.count;i<a;i++)il.fromBufferAttribute(e,i-1),al.fromBufferAttribute(e,i),r[i]=r[i-1],r[i]+=il.distanceTo(al);t.setAttribute("lineDistance",new Nn(r,1))}else Nt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const r=this.geometry,i=this.matrixWorld,a=t.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),uh.copy(r.boundingSphere),uh.applyMatrix4(i),uh.radius+=a,t.ray.intersectsSphere(uh)===!1)return;ug.copy(i).invert(),os.copy(t.ray).applyMatrix4(ug);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=o*o,h=this.isLineSegments?2:1,l=r.index,f=r.attributes.position;if(l!==null){const d=Math.max(0,s.start),p=Math.min(l.count,s.start+s.count);for(let v=d,m=p-1;v<m;v+=h){const g=l.getX(v),y=l.getX(v+1),x=ch(this,t,os,u,g,y,v);x&&e.push(x)}if(this.isLineLoop){const v=l.getX(p-1),m=l.getX(d),g=ch(this,t,os,u,v,m,p-1);g&&e.push(g)}}else{const d=Math.max(0,s.start),p=Math.min(f.count,s.start+s.count);for(let v=d,m=p-1;v<m;v+=h){const g=ch(this,t,os,u,v,v+1,v);g&&e.push(g)}if(this.isLineLoop){const v=ch(this,t,os,u,p-1,d,p-1);v&&e.push(v)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){const i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}}function ch(n,t,e,r,i,a,s){const o=n.geometry.attributes.position;if(il.fromBufferAttribute(o,i),al.fromBufferAttribute(o,a),e.distanceSqToSegment(il,al,oc,cg)>r)return;oc.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(oc);if(!(h<t.near||h>t.far))return{distance:h,point:cg.clone().applyMatrix4(n.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:n}}class bF{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Nt("Curve: .getPoint() not implemented.")}getPointAt(t,e){const r=this.getUtoTmapping(t);return this.getPoint(r,e)}getPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return e}getSpacedPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let r,i=this.getPoint(0),a=0;e.push(0);for(let s=1;s<=t;s++)r=this.getPoint(s/t),a+=r.distanceTo(i),e.push(a),i=r;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e=null){const r=this.getLengths();let i=0;const a=r.length;let s;e?s=e:s=t*r[a-1];let o=0,u=a-1,h;for(;o<=u;)if(i=Math.floor(o+(u-o)/2),h=r[i]-s,h<0)o=i+1;else if(h>0)u=i-1;else{u=i;break}if(i=u,r[i]===s)return i/(a-1);const l=r[i],f=r[i+1]-l,d=(s-l)/f;return(i+d)/(a-1)}getTangent(t,e){let i=t-1e-4,a=t+1e-4;i<0&&(i=0),a>1&&(a=1);const s=this.getPoint(i),o=this.getPoint(a),u=e||(s.isVector2?new ve:new $);return u.copy(o).sub(s).normalize(),u}getTangentAt(t,e){const r=this.getUtoTmapping(t);return this.getTangent(r,e)}computeFrenetFrames(t,e=!1){const r=new $,i=[],a=[],s=[],o=new $,u=new ft;for(let d=0;d<=t;d++){const p=d/t;i[d]=this.getTangentAt(p,new $)}a[0]=new $,s[0]=new $;let h=Number.MAX_VALUE;const l=Math.abs(i[0].x),c=Math.abs(i[0].y),f=Math.abs(i[0].z);l<=h&&(h=l,r.set(1,0,0)),c<=h&&(h=c,r.set(0,1,0)),f<=h&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),a[0].crossVectors(i[0],o),s[0].crossVectors(i[0],a[0]);for(let d=1;d<=t;d++){if(a[d]=a[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(_t(i[d-1].dot(i[d]),-1,1));a[d].applyMatrix4(u.makeRotationAxis(o,p))}s[d].crossVectors(i[d],a[d])}if(e===!0){let d=Math.acos(_t(a[0].dot(a[t]),-1,1));d/=t,i[0].dot(o.crossVectors(a[0],a[t]))>0&&(d=-d);for(let p=1;p<=t;p++)a[p].applyMatrix4(u.makeRotationAxis(i[p],d*p)),s[p].crossVectors(i[p],a[p])}return{tangents:i,normals:a,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}function _F(n,t,e=2){const r=t&&t.length,i=r?t[0]*e:n.length;let a=Lx(n,0,i,e,!0);const s=[];if(!a||a.next===a.prev)return s;let o,u,h;if(r&&(a=AF(n,t,a,e)),n.length>80*e){o=n[0],u=n[1];let l=o,c=u;for(let f=e;f<i;f+=e){const d=n[f],p=n[f+1];d<o&&(o=d),p<u&&(u=p),d>l&&(l=d),p>c&&(c=p)}h=Math.max(l-o,c-u),h=h!==0?32767/h:0}return Zs(a,s,e,o,u,h,0),s}function Lx(n,t,e,r,i){let a;if(i===LF(n,t,e,r)>0)for(let s=t;s<e;s+=r)a=fg(s/r|0,n[s],n[s+1],a);else for(let s=e-r;s>=t;s-=r)a=fg(s/r|0,n[s],n[s+1],a);return a&&Fa(a,a.next)&&(Js(a),a=a.next),a}function Pi(n,t){if(!n)return n;t||(t=n);let e=n,r;do if(r=!1,!e.steiner&&(Fa(e,e.next)||qt(e.prev,e,e.next)===0)){if(Js(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Zs(n,t,e,r,i,a,s){if(!n)return;!s&&a&&RF(n,r,i,a);let o=n;for(;n.prev!==n.next;){const u=n.prev,h=n.next;if(a?SF(n,r,i,a):wF(n)){t.push(u.i,n.i,h.i),Js(n),n=h.next,o=h.next;continue}if(n=h,n===o){s?s===1?(n=EF(Pi(n),t),Zs(n,t,e,r,i,a,2)):s===2&&TF(n,t,e,r,i,a):Zs(Pi(n),t,e,r,i,a,1);break}}}function wF(n){const t=n.prev,e=n,r=n.next;if(qt(t,e,r)>=0)return!1;const i=t.x,a=e.x,s=r.x,o=t.y,u=e.y,h=r.y,l=Math.min(i,a,s),c=Math.min(o,u,h),f=Math.max(i,a,s),d=Math.max(o,u,h);let p=r.next;for(;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=c&&p.y<=d&&us(i,o,a,u,s,h,p.x,p.y)&&qt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function SF(n,t,e,r){const i=n.prev,a=n,s=n.next;if(qt(i,a,s)>=0)return!1;const o=i.x,u=a.x,h=s.x,l=i.y,c=a.y,f=s.y,d=Math.min(o,u,h),p=Math.min(l,c,f),v=Math.max(o,u,h),m=Math.max(l,c,f),g=Of(d,p,t,e,r),y=Of(v,m,t,e,r);let x=n.prevZ,b=n.nextZ;for(;x&&x.z>=g&&b&&b.z<=y;){if(x.x>=d&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==s&&us(o,l,u,c,h,f,x.x,x.y)&&qt(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=d&&b.x<=v&&b.y>=p&&b.y<=m&&b!==i&&b!==s&&us(o,l,u,c,h,f,b.x,b.y)&&qt(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=d&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==s&&us(o,l,u,c,h,f,x.x,x.y)&&qt(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=d&&b.x<=v&&b.y>=p&&b.y<=m&&b!==i&&b!==s&&us(o,l,u,c,h,f,b.x,b.y)&&qt(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function EF(n,t){let e=n;do{const r=e.prev,i=e.next.next;!Fa(r,i)&&Ux(r,e,e.next,i)&&Ks(r,i)&&Ks(i,r)&&(t.push(r.i,e.i,i.i),Js(e),Js(e.next),e=n=i),e=e.next}while(e!==n);return Pi(e)}function TF(n,t,e,r,i,a){let s=n;do{let o=s.next.next;for(;o!==s.prev;){if(s.i!==o.i&&BF(s,o)){let u=Vx(s,o);s=Pi(s,s.next),u=Pi(u,u.next),Zs(s,t,e,r,i,a,0),Zs(u,t,e,r,i,a,0);return}o=o.next}s=s.next}while(s!==n)}function AF(n,t,e,r){const i=[];for(let a=0,s=t.length;a<s;a++){const o=t[a]*r,u=a<s-1?t[a+1]*r:n.length,h=Lx(n,o,u,r,!1);h===h.next&&(h.steiner=!0),i.push(OF(h))}i.sort(MF);for(let a=0;a<i.length;a++)e=PF(i[a],e);return e}function MF(n,t){let e=n.x-t.x;if(e===0&&(e=n.y-t.y,e===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(t.next.y-t.y)/(t.next.x-t.x);e=r-i}return e}function PF(n,t){const e=IF(n,t);if(!e)return t;const r=Vx(e,n);return Pi(r,r.next),Pi(e,e.next)}function IF(n,t){let e=t;const r=n.x,i=n.y;let a=-1/0,s;if(Fa(n,e))return e;do{if(Fa(n,e.next))return e.next;if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const c=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(c<=r&&c>a&&(a=c,s=e.x<e.next.x?e:e.next,c===r))return s}e=e.next}while(e!==t);if(!s)return null;const o=s,u=s.x,h=s.y;let l=1/0;e=s;do{if(r>=e.x&&e.x>=u&&r!==e.x&&Dx(i<h?r:a,i,u,h,i<h?a:r,i,e.x,e.y)){const c=Math.abs(i-e.y)/(r-e.x);Ks(e,n)&&(c<l||c===l&&(e.x>s.x||e.x===s.x&&CF(s,e)))&&(s=e,l=c)}e=e.next}while(e!==o);return s}function CF(n,t){return qt(n.prev,n,t.prev)<0&&qt(t.next,n,n.next)<0}function RF(n,t,e,r){let i=n;do i.z===0&&(i.z=Of(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,FF(i)}function FF(n){let t,e=1;do{let r=n,i;n=null;let a=null;for(t=0;r;){t++;let s=r,o=0;for(let h=0;h<e&&(o++,s=s.nextZ,!!s);h++);let u=e;for(;o>0||u>0&&s;)o!==0&&(u===0||!s||r.z<=s.z)?(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,u--),a?a.nextZ=i:n=i,i.prevZ=a,a=i;r=s}a.nextZ=null,e*=2}while(t>1);return n}function Of(n,t,e,r,i){return n=(n-e)*i|0,t=(t-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function OF(n){let t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function Dx(n,t,e,r,i,a,s,o){return(i-s)*(t-o)>=(n-s)*(a-o)&&(n-s)*(r-o)>=(e-s)*(t-o)&&(e-s)*(a-o)>=(i-s)*(r-o)}function us(n,t,e,r,i,a,s,o){return!(n===s&&t===o)&&Dx(n,t,e,r,i,a,s,o)}function BF(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!NF(n,t)&&(Ks(n,t)&&Ks(t,n)&&kF(n,t)&&(qt(n.prev,n,t.prev)||qt(n,t.prev,t))||Fa(n,t)&&qt(n.prev,n,n.next)>0&&qt(t.prev,t,t.next)>0)}function qt(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function Fa(n,t){return n.x===t.x&&n.y===t.y}function Ux(n,t,e,r){const i=dh(qt(n,t,e)),a=dh(qt(n,t,r)),s=dh(qt(e,r,n)),o=dh(qt(e,r,t));return!!(i!==a&&s!==o||i===0&&fh(n,e,t)||a===0&&fh(n,r,t)||s===0&&fh(e,n,r)||o===0&&fh(e,t,r))}function fh(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function dh(n){return n>0?1:n<0?-1:0}function NF(n,t){let e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&Ux(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function Ks(n,t){return qt(n.prev,n,n.next)<0?qt(n,t,n.next)>=0&&qt(n,n.prev,t)>=0:qt(n,t,n.prev)<0||qt(n,n.next,t)<0}function kF(n,t){let e=n,r=!1;const i=(n.x+t.x)/2,a=(n.y+t.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&i<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==n);return r}function Vx(n,t){const e=Bf(n.i,n.x,n.y),r=Bf(t.i,t.x,t.y),i=n.next,a=t.prev;return n.next=t,t.prev=n,e.next=i,i.prev=e,r.next=e,e.prev=r,a.next=r,r.prev=a,r}function fg(n,t,e,r){const i=Bf(n,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Js(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Bf(n,t,e){return{i:n,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function LF(n,t,e,r){let i=0;for(let a=t,s=e-r;a<e;a+=r)i+=(n[s]-n[a])*(n[a+1]+n[s+1]),s=a;return i}class DF{static triangulate(t,e,r=2){return _F(t,e,r)}}class pp{static area(t){const e=t.length;let r=0;for(let i=e-1,a=0;a<e;i=a++)r+=t[i].x*t[a].y-t[a].x*t[i].y;return r*.5}static isClockWise(t){return pp.area(t)<0}static triangulateShape(t,e){const r=[],i=[],a=[];dg(t),pg(r,t);let s=t.length;e.forEach(dg);for(let u=0;u<e.length;u++)i.push(s),s+=e[u].length,pg(r,e[u]);const o=DF.triangulate(r,i);for(let u=0;u<o.length;u+=3)a.push(o.slice(u,u+3));return a}}function dg(n){const t=n.length;t>2&&n[t-1].equals(n[0])&&n.pop()}function pg(n,t){for(let e=0;e<t.length;e++)n.push(t[e].x),n.push(t[e].y)}class ph extends Cl{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ue(16777215),this.specular=new ue(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cx,this.normalScale=new ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qe,this.combine=lp,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class UF extends Cl{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cx,this.normalScale=new ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qe,this.combine=lp,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}function vh(n,t){return!n||n.constructor===t?n:typeof t.BYTES_PER_ELEMENT=="number"?new t(n):Array.prototype.slice.call(n)}function VF(n){function t(i,a){return n[i]-n[a]}const e=n.length,r=new Array(e);for(let i=0;i!==e;++i)r[i]=i;return r.sort(t),r}function vg(n,t,e){const r=n.length,i=new n.constructor(r);for(let a=0,s=0;s!==r;++a){const o=e[a]*t;for(let u=0;u!==t;++u)i[s++]=n[o+u]}return i}function Xx(n,t,e,r){let i=1,a=n[0];for(;a!==void 0&&a[r]===void 0;)a=n[i++];if(a===void 0)return;let s=a[r];if(s!==void 0)if(Array.isArray(s))do s=a[r],s!==void 0&&(t.push(a.time),e.push(...s)),a=n[i++];while(a!==void 0);else if(s.toArray!==void 0)do s=a[r],s!==void 0&&(t.push(a.time),s.toArray(e,e.length)),a=n[i++];while(a!==void 0);else do s=a[r],s!==void 0&&(t.push(a.time),e.push(s)),a=n[i++];while(a!==void 0)}class vo{constructor(t,e,r,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new e.constructor(r),this.sampleValues=e,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let r=this._cachedIndex,i=e[r],a=e[r-1];t:{e:{let s;r:{n:if(!(t<i)){for(let o=r+2;;){if(i===void 0){if(t<a)break n;return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(a=i,i=e[++r],t<i)break e}s=e.length;break r}if(!(t>=a)){const o=e[1];t<o&&(r=2,a=o);for(let u=r-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===u)break;if(i=a,a=e[--r-1],t>=a)break e}s=r,r=0;break r}break t}for(;r<s;){const o=r+s>>>1;t<e[o]?s=o:r=o+1}if(i=e[r],a=e[r-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,i)}return this.interpolate_(r,a,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,r=this.sampleValues,i=this.valueSize,a=t*i;for(let s=0;s!==i;++s)e[s]=r[a+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class XF extends vo{constructor(t,e,r,i){super(t,e,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:va,endingEnd:va}}intervalChanged_(t,e,r){const i=this.parameterPositions;let a=t-2,s=t+1,o=i[a],u=i[s];if(o===void 0)switch(this.getSettings_().endingStart){case ma:a=t,o=2*e-r;break;case rl:a=i.length-2,o=e+i[a]-i[a+1];break;default:a=t,o=r}if(u===void 0)switch(this.getSettings_().endingEnd){case ma:s=t,u=2*r-e;break;case rl:s=1,u=r+i[1]-i[0];break;default:s=t-1,u=e}const h=(r-e)*.5,l=this.valueSize;this._weightPrev=h/(e-o),this._weightNext=h/(u-r),this._offsetPrev=a*l,this._offsetNext=s*l}interpolate_(t,e,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,u=t*o,h=u-o,l=this._offsetPrev,c=this._offsetNext,f=this._weightPrev,d=this._weightNext,p=(r-e)/(i-e),v=p*p,m=v*p,g=-f*m+2*f*v-f*p,y=(1+f)*m+(-1.5-2*f)*v+(-.5+f)*p+1,x=(-1-d)*m+(1.5+d)*v+.5*p,b=d*m-d*v;for(let _=0;_!==o;++_)a[_]=g*s[l+_]+y*s[h+_]+x*s[u+_]+b*s[c+_];return a}}class zx extends vo{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t,e,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,u=t*o,h=u-o,l=(r-e)/(i-e),c=1-l;for(let f=0;f!==o;++f)a[f]=s[h+f]*c+s[u+f]*l;return a}}class zF extends vo{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class GF extends vo{interpolate_(t,e,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,u=t*o,h=u-o,l=this.settings||this.DefaultSettings_,c=l.inTangents,f=l.outTangents;if(!c||!f){const v=(r-e)/(i-e),m=1-v;for(let g=0;g!==o;++g)a[g]=s[h+g]*m+s[u+g]*v;return a}const d=o*2,p=t-1;for(let v=0;v!==o;++v){const m=s[h+v],g=s[u+v],y=p*d+v*2,x=f[y],b=f[y+1],_=t*d+v*2,w=c[_],S=c[_+1];let E=(r-e)/(i-e),T,A,P,M,R;for(let F=0;F<8;F++){T=E*E,A=T*E,P=1-E,M=P*P,R=M*P;const D=R*e+3*M*E*x+3*P*T*w+A*i-r;if(Math.abs(D)<1e-10)break;const X=3*M*(x-e)+6*P*E*(w-x)+3*T*(i-w);if(Math.abs(X)<1e-10)break;E=E-D/X,E=Math.max(0,Math.min(1,E))}a[v]=R*m+3*M*E*b+3*P*T*S+A*g}return a}}class Rr{constructor(t,e,r,i){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=vh(e,this.TimeBufferType),this.values=vh(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let r;if(e.toJSON!==this.toJSON)r=e.toJSON(t);else{r={name:t.name,times:vh(t.times,Array),values:vh(t.values,Array)};const i=t.getInterpolation();i!==t.DefaultInterpolation&&(r.interpolation=i)}return r.type=t.ValueTypeName,r}InterpolantFactoryMethodDiscrete(t){return new zF(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new zx(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new XF(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodBezier(t){const e=new GF(this.times,this.values,this.getValueSize(),t);return this.settings&&(e.settings=this.settings),e}setInterpolation(t){let e;switch(t){case el:e=this.InterpolantFactoryMethodDiscrete;break;case Cf:e=this.InterpolantFactoryMethodLinear;break;case ku:e=this.InterpolantFactoryMethodSmooth;break;case Nm:e=this.InterpolantFactoryMethodBezier;break}if(e===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return Nt("KeyframeTrack:",r),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return el;case this.InterpolantFactoryMethodLinear:return Cf;case this.InterpolantFactoryMethodSmooth:return ku;case this.InterpolantFactoryMethodBezier:return Nm}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let r=0,i=e.length;r!==i;++r)e[r]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let r=0,i=e.length;r!==i;++r)e[r]*=t}return this}trim(t,e){const r=this.times,i=r.length;let a=0,s=i-1;for(;a!==i&&r[a]<t;)++a;for(;s!==-1&&r[s]>e;)--s;if(++s,a!==0||s!==i){a>=s&&(s=Math.max(s,1),a=s-1);const o=this.getValueSize();this.times=r.slice(a,s),this.values=this.values.slice(a*o,s*o)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(jt("KeyframeTrack: Invalid value size in track.",this),t=!1);const r=this.times,i=this.values,a=r.length;a===0&&(jt("KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==a;o++){const u=r[o];if(typeof u=="number"&&isNaN(u)){jt("KeyframeTrack: Time is not a valid number.",this,o,u),t=!1;break}if(s!==null&&s>u){jt("KeyframeTrack: Out of order keys.",this,o,u,s),t=!1;break}s=u}if(i!==void 0&&I2(i))for(let o=0,u=i.length;o!==u;++o){const h=i[o];if(isNaN(h)){jt("KeyframeTrack: Value is not a valid number.",this,o,h),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===ku,a=t.length-1;let s=1;for(let o=1;o<a;++o){let u=!1;const h=t[o],l=t[o+1];if(h!==l&&(o!==1||h!==t[0]))if(i)u=!0;else{const c=o*r,f=c-r,d=c+r;for(let p=0;p!==r;++p){const v=e[c+p];if(v!==e[f+p]||v!==e[d+p]){u=!0;break}}}if(u){if(o!==s){t[s]=t[o];const c=o*r,f=s*r;for(let d=0;d!==r;++d)e[f+d]=e[c+d]}++s}}if(a>0){t[s]=t[a];for(let o=a*r,u=s*r,h=0;h!==r;++h)e[u+h]=e[o+h];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*r)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),r=this.constructor,i=new r(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}Rr.prototype.ValueTypeName="";Rr.prototype.TimeBufferType=Float32Array;Rr.prototype.ValueBufferType=Float32Array;Rr.prototype.DefaultInterpolation=Cf;class za extends Rr{constructor(t,e,r){super(t,e,r)}}za.prototype.ValueTypeName="bool";za.prototype.ValueBufferType=Array;za.prototype.DefaultInterpolation=el;za.prototype.InterpolantFactoryMethodLinear=void 0;za.prototype.InterpolantFactoryMethodSmooth=void 0;class Gx extends Rr{constructor(t,e,r,i){super(t,e,r,i)}}Gx.prototype.ValueTypeName="color";class Qs extends Rr{constructor(t,e,r,i){super(t,e,r,i)}}Qs.prototype.ValueTypeName="number";class YF extends vo{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t,e,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,u=(r-e)/(i-e);let h=t*o;for(let l=h+o;h!==l;h+=4)le.slerpFlat(a,0,s,h-o,s,h,u);return a}}class Oa extends Rr{constructor(t,e,r,i){super(t,e,r,i)}InterpolantFactoryMethodLinear(t){return new YF(this.times,this.values,this.getValueSize(),t)}}Oa.prototype.ValueTypeName="quaternion";Oa.prototype.InterpolantFactoryMethodSmooth=void 0;class Ga extends Rr{constructor(t,e,r){super(t,e,r)}}Ga.prototype.ValueTypeName="string";Ga.prototype.ValueBufferType=Array;Ga.prototype.DefaultInterpolation=el;Ga.prototype.InterpolantFactoryMethodLinear=void 0;Ga.prototype.InterpolantFactoryMethodSmooth=void 0;class to extends Rr{constructor(t,e,r,i){super(t,e,r,i)}}to.prototype.ValueTypeName="vector";class Nf{constructor(t="",e=-1,r=[],i=up){this.name=t,this.tracks=r,this.duration=e,this.blendMode=i,this.uuid=Wn(),this.userData={},this.duration<0&&this.resetDuration()}static parse(t){const e=[],r=t.tracks,i=1/(t.fps||1);for(let s=0,o=r.length;s!==o;++s)e.push(HF(r[s]).scale(i));const a=new this(t.name,t.duration,e,t.blendMode);return a.uuid=t.uuid,a.userData=JSON.parse(t.userData||"{}"),a}static toJSON(t){const e=[],r=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode,userData:JSON.stringify(t.userData)};for(let a=0,s=r.length;a!==s;++a)e.push(Rr.toJSON(r[a]));return i}static CreateFromMorphTargetSequence(t,e,r,i){const a=e.length,s=[];for(let o=0;o<a;o++){let u=[],h=[];u.push((o+a-1)%a,o,(o+1)%a),h.push(0,1,0);const l=VF(u);u=vg(u,1,l),h=vg(h,1,l),!i&&u[0]===0&&(u.push(a),h.push(h[0])),s.push(new Qs(".morphTargetInfluences["+e[o].name+"]",u,h).scale(1/r))}return new this(t,-1,s)}static findByName(t,e){let r=t;if(!Array.isArray(t)){const i=t;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===e)return r[i];return null}static CreateClipsFromMorphTargetSequences(t,e,r){const i={},a=/^([\w-]*?)([\d]+)$/;for(let o=0,u=t.length;o<u;o++){const h=t[o],l=h.name.match(a);if(l&&l.length>1){const c=l[1];let f=i[c];f||(i[c]=f=[]),f.push(h)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],e,r));return s}static parseAnimation(t,e){if(Nt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!t)return jt("AnimationClip: No animation in JSONLoader data."),null;const r=function(c,f,d,p,v){if(d.length!==0){const m=[],g=[];Xx(d,m,g,p),m.length!==0&&v.push(new c(f,m,g))}},i=[],a=t.name||"default",s=t.fps||30,o=t.blendMode;let u=t.length||-1;const h=t.hierarchy||[];for(let c=0;c<h.length;c++){const f=h[c].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const d={};let p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let v=0;v<f[p].morphTargets.length;v++)d[f[p].morphTargets[v]]=-1;for(const v in d){const m=[],g=[];for(let y=0;y!==f[p].morphTargets.length;++y){const x=f[p];m.push(x.time),g.push(x.morphTarget===v?1:0)}i.push(new Qs(".morphTargetInfluence["+v+"]",m,g))}u=d.length*s}else{const d=".bones["+e[c].name+"]";r(to,d+".position",f,"pos",i),r(Oa,d+".quaternion",f,"rot",i),r(to,d+".scale",f,"scl",i)}}return i.length===0?null:new this(a,u,i,o)}resetDuration(){const t=this.tracks;let e=0;for(let r=0,i=t.length;r!==i;++r){const a=this.tracks[r];e=Math.max(e,a.times[a.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let r=0;r<this.tracks.length;r++)t.push(this.tracks[r].clone());const e=new this.constructor(this.name,this.duration,t,this.blendMode);return e.userData=JSON.parse(JSON.stringify(this.userData)),e}toJSON(){return this.constructor.toJSON(this)}}function WF(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Qs;case"vector":case"vector2":case"vector3":case"vector4":return to;case"color":return Gx;case"quaternion":return Oa;case"bool":case"boolean":return za;case"string":return Ga}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function HF(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=WF(n.type);if(n.times===void 0){const e=[],r=[];Xx(n.keys,e,r,"value"),n.times=e,n.values=r}return t.parse!==void 0?t.parse(n):new t(n.name,n.times,n.values,n.interpolation)}const _s={enabled:!1,files:{},add:function(n,t){this.enabled!==!1&&(mg(n)||(this.files[n]=t))},get:function(n){if(this.enabled!==!1&&!mg(n))return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};function mg(n){try{const t=n.slice(n.indexOf(":")+1);return new URL(t).protocol==="blob:"}catch{return!1}}class jF{constructor(t,e,r){const i=this;let a=!1,s=0,o=0,u;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this._abortController=null,this.itemStart=function(l){o++,a===!1&&i.onStart!==void 0&&i.onStart(l,s,o),a=!0},this.itemEnd=function(l){s++,i.onProgress!==void 0&&i.onProgress(l,s,o),s===o&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(l){i.onError!==void 0&&i.onError(l)},this.resolveURL=function(l){return u?u(l):l},this.setURLModifier=function(l){return u=l,this},this.addHandler=function(l,c){return h.push(l,c),this},this.removeHandler=function(l){const c=h.indexOf(l);return c!==-1&&h.splice(c,2),this},this.getHandler=function(l){for(let c=0,f=h.length;c<f;c+=2){const d=h[c],p=h[c+1];if(d.global&&(d.lastIndex=0),d.test(l))return p}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const $F=new jF;class Ii{constructor(t){this.manager=t!==void 0?t:$F,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}load(){}loadAsync(t,e){const r=this;return new Promise(function(i,a){r.load(t,i,e,a)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}Ii.DEFAULT_MATERIAL_NAME="__DEFAULT";const sn={};class qF extends Error{constructor(t,e){super(t),this.response=e}}class ZF extends Ii{constructor(t){super(t),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(t,e,r,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const a=_s.get(`file:${t}`);if(a!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(a),this.manager.itemEnd(t)},0),a;if(sn[t]!==void 0){sn[t].push({onLoad:e,onProgress:r,onError:i});return}sn[t]=[],sn[t].push({onLoad:e,onProgress:r,onError:i});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,u=this.responseType;fetch(s).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&Nt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const l=sn[t],c=h.body.getReader(),f=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),d=f?parseInt(f):0,p=d!==0;let v=0;const m=new ReadableStream({start(g){y();function y(){c.read().then(({done:x,value:b})=>{if(x)g.close();else{v+=b.byteLength;const _=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:d});for(let w=0,S=l.length;w<S;w++){const E=l[w];E.onProgress&&E.onProgress(_)}g.enqueue(b),y()}},x=>{g.error(x)})}}});return new Response(m)}else throw new qF(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(l=>new DOMParser().parseFromString(l,o));case"json":return h.json();default:if(o==="")return h.text();{const c=/charset="?([^;"\s]*)"?/i.exec(o),f=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(f);return h.arrayBuffer().then(p=>d.decode(p))}}}).then(h=>{_s.add(`file:${t}`,h);const l=sn[t];delete sn[t];for(let c=0,f=l.length;c<f;c++){const d=l[c];d.onLoad&&d.onLoad(h)}}).catch(h=>{const l=sn[t];if(l===void 0)throw this.manager.itemError(t),h;delete sn[t];for(let c=0,f=l.length;c<f;c++){const d=l[c];d.onError&&d.onError(h)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const ia=new WeakMap;class KF extends Ii{constructor(t){super(t)}load(t,e,r,i){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const a=this,s=_s.get(`image:${t}`);if(s!==void 0){if(s.complete===!0)a.manager.itemStart(t),setTimeout(function(){e&&e(s),a.manager.itemEnd(t)},0);else{let c=ia.get(s);c===void 0&&(c=[],ia.set(s,c)),c.push({onLoad:e,onError:i})}return s}const o=Rf("img");function u(){l(),e&&e(this);const c=ia.get(this)||[];for(let f=0;f<c.length;f++){const d=c[f];d.onLoad&&d.onLoad(this)}ia.delete(this),a.manager.itemEnd(t)}function h(c){l(),i&&i(c),_s.remove(`image:${t}`);const f=ia.get(this)||[];for(let d=0;d<f.length;d++){const p=f[d];p.onError&&p.onError(c)}ia.delete(this),a.manager.itemError(t),a.manager.itemEnd(t)}function l(){o.removeEventListener("load",u,!1),o.removeEventListener("error",h,!1)}return o.addEventListener("load",u,!1),o.addEventListener("error",h,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),_s.add(`image:${t}`,o),a.manager.itemStart(t),o.src=t,o}}class JF extends Ii{constructor(t){super(t)}load(t,e,r,i){const a=new Yr,s=new KF(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(o){a.image=o,a.needsUpdate=!0,e!==void 0&&e(a)},r,i),a}}class Rl extends Jt{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new ue(t),this.intensity=e}dispose(){this.dispatchEvent({type:"dispose"})}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,e}}const hc=new ft,gg=new $,yg=new $;class vp{constructor(t){this.camera=t,this.intensity=1,this.bias=0,this.biasNode=null,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ve(512,512),this.mapType=Ax,this.map=null,this.mapPass=null,this.matrix=new ft,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new yF,this._frameExtents=new ve(1,1),this._viewportCount=1,this._viewports=[new tr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,r=this.matrix;gg.setFromMatrixPosition(t.matrixWorld),e.position.copy(gg),yg.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(yg),e.updateMatrixWorld(),hc.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hc,e.coordinateSystem,e.reversedDepth),e.coordinateSystem===nl||e.reversedDepth?r.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(hc)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.intensity=t.intensity,this.bias=t.bias,this.radius=t.radius,this.autoUpdate=t.autoUpdate,this.needsUpdate=t.needsUpdate,this.normalBias=t.normalBias,this.blurSamples=t.blurSamples,this.mapSize.copy(t.mapSize),this.biasNode=t.biasNode,this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.intensity!==1&&(t.intensity=this.intensity),this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}const mh=new $,gh=new le,Br=new $;class Yx extends Jt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ft,this.projectionMatrix=new ft,this.projectionMatrixInverse=new ft,this.coordinateSystem=pi,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorld.decompose(mh,gh,Br),Br.x===1&&Br.y===1&&Br.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(mh,gh,Br.set(1,1,1)).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorld.decompose(mh,gh,Br),Br.x===1&&Br.y===1&&Br.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(mh,gh,Br.set(1,1,1)).invert()}clone(){return new this.constructor().copy(this)}}const Rn=new $,xg=new ve,bg=new ve;class mp extends Yx{constructor(t=50,e=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=qs*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(xs*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return qs*2*Math.atan(Math.tan(xs*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,r){Rn.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(Rn.x,Rn.y).multiplyScalar(-t/Rn.z),Rn.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Rn.x,Rn.y).multiplyScalar(-t/Rn.z)}getViewSize(t,e){return this.getViewBounds(t,xg,bg),e.subVectors(bg,xg)}setViewOffset(t,e,r,i,a,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(xs*.5*this.fov)/this.zoom,r=2*e,i=this.aspect*r,a=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const u=s.fullWidth,h=s.fullHeight;a+=s.offsetX*i/u,e-=s.offsetY*r/h,i*=s.width/u,r*=s.height/h}const o=this.filmOffset;o!==0&&(a+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,e,e-r,t,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}class QF extends vp{constructor(){super(new mp(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(t){const e=this.camera,r=qs*2*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,a=t.distance||e.far;(r!==e.fov||i!==e.aspect||a!==e.far)&&(e.fov=r,e.aspect=i,e.far=a,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class tO extends Rl{constructor(t,e,r=0,i=Math.PI/3,a=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Jt.DEFAULT_UP),this.updateMatrix(),this.target=new Jt,this.distance=r,this.angle=i,this.penumbra=a,this.decay=s,this.map=null,this.shadow=new QF}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.map=t.map,this.shadow=t.shadow.clone(),this}toJSON(t){const e=super.toJSON(t);return e.object.distance=this.distance,e.object.angle=this.angle,e.object.decay=this.decay,e.object.penumbra=this.penumbra,e.object.target=this.target.uuid,this.map&&this.map.isTexture&&(e.object.map=this.map.toJSON(t).uuid),e.object.shadow=this.shadow.toJSON(),e}}class eO extends vp{constructor(){super(new mp(90,1,.5,500)),this.isPointLightShadow=!0}}class _g extends Rl{constructor(t,e,r=0,i=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new eO}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}toJSON(t){const e=super.toJSON(t);return e.object.distance=this.distance,e.object.decay=this.decay,e.object.shadow=this.shadow.toJSON(),e}}class rO extends Yx{constructor(t=-1,e=1,r=1,i=-1,a=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=r,this.bottom=i,this.near=a,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,r,i,a,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-t,s=r+t,o=i+e,u=i-e;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=h*this.view.offsetX,s=a+h*this.view.width,o-=l*this.view.offsetY,u=o-l*this.view.height}this.projectionMatrix.makeOrthographic(a,s,o,u,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}class nO extends vp{constructor(){super(new rO(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class iO extends Rl{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Jt.DEFAULT_UP),this.updateMatrix(),this.target=new Jt,this.shadow=new nO}dispose(){super.dispose(),this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}toJSON(t){const e=super.toJSON(t);return e.object.shadow=this.shadow.toJSON(),e.object.target=this.target.uuid,e}}class aO extends Rl{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class sO{static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.slice(0,e+1)}static resolveURL(t,e){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class oO{constructor(t,e,r){this.binding=t,this.valueSize=r;let i,a,s;switch(e){case"quaternion":i=this._slerp,a=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,a=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const r=this.buffer,i=this.valueSize,a=t*i+i;let s=this.cumulativeWeight;if(s===0){for(let o=0;o!==i;++o)r[a+o]=r[o];s=e}else{s+=e;const o=e/s;this._mixBufferRegion(r,a,0,o,i)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,r),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,r=this.buffer,i=t*e+e,a=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const u=e*this._origIndex;this._mixBufferRegion(r,i,u,1-a,e)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*e,1,e);for(let u=e,h=e+e;u!==h;++u)if(r[u]!==r[u+e]){o.setValue(r,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,r=this.valueSize,i=r*this._origIndex;t.getValue(e,i);for(let a=r,s=i;a!==s;++a)e[a]=e[i+a%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let r=t;r<e;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[e+r]=this.buffer[t+r]}_select(t,e,r,i,a){if(i>=.5)for(let s=0;s!==a;++s)t[e+s]=t[r+s]}_slerp(t,e,r,i){le.slerpFlat(t,e,t,e,t,r,i)}_slerpAdditive(t,e,r,i,a){const s=this._workIndex*a;le.multiplyQuaternionsFlat(t,s,t,e,t,r),le.slerpFlat(t,e,t,e,t,s,i)}_lerp(t,e,r,i,a){const s=1-i;for(let o=0;o!==a;++o){const u=e+o;t[u]=t[u]*s+t[r+o]*i}}_lerpAdditive(t,e,r,i,a){for(let s=0;s!==a;++s){const o=e+s;t[o]=t[o]+t[r+s]*i}}}const gp="\\[\\]\\.:\\/",hO=new RegExp("["+gp+"]","g"),yp="[^"+gp+"]",lO="[^"+gp.replace("\\.","")+"]",uO=/((?:WC+[\/:])*)/.source.replace("WC",yp),cO=/(WCOD+)?/.source.replace("WCOD",lO),fO=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",yp),dO=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",yp),pO=new RegExp("^"+uO+cO+fO+dO+"$"),vO=["material","materials","bones","map"];class mO{constructor(t,e,r){const i=r||It.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(t,e)}setValue(t,e){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=r.length;i!==a;++i)r[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}class It{constructor(t,e,r){this.path=e,this.parsedPath=r||It.parseTrackName(e),this.node=It.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,r){return t&&t.isAnimationObjectGroup?new It.Composite(t,e,r):new It(t,e,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(hO,"")}static parseTrackName(t){const e=pO.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const a=r.nodeName.substring(i+1);vO.indexOf(a)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=a)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(r!==void 0)return r}if(t.children){const r=function(a){for(let s=0;s<a.length;s++){const o=a[s];if(o.name===e||o.uuid===e)return o;const u=r(o.children);if(u)return u}return null},i=r(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)t[e++]=r[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,r=e.objectName,i=e.propertyName;let a=e.propertyIndex;if(t||(t=It.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){Nt("PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let h=e.objectIndex;switch(r){case"materials":if(!t.material){jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){jt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){jt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let l=0;l<t.length;l++)if(t[l].name===h){h=l;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){jt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){jt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(h!==void 0){if(t[h]===void 0){jt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[h]}}const s=t[i];if(s===void 0){const h=e.nodeName;jt("PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?o=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[a]!==void 0&&(a=t.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=a}else s.fromArray!==void 0&&s.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}It.Composite=mO;It.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};It.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};It.prototype.GetterByBindingType=[It.prototype._getValue_direct,It.prototype._getValue_array,It.prototype._getValue_arrayElement,It.prototype._getValue_toArray];It.prototype.SetterByBindingTypeAndVersioning=[[It.prototype._setValue_direct,It.prototype._setValue_direct_setNeedsUpdate,It.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[It.prototype._setValue_array,It.prototype._setValue_array_setNeedsUpdate,It.prototype._setValue_array_setMatrixWorldNeedsUpdate],[It.prototype._setValue_arrayElement,It.prototype._setValue_arrayElement_setNeedsUpdate,It.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[It.prototype._setValue_fromArray,It.prototype._setValue_fromArray_setNeedsUpdate,It.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gO{constructor(t,e,r=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=r,this.blendMode=i;const a=e.tracks,s=a.length,o=new Array(s),u={endingStart:va,endingEnd:va};for(let h=0;h!==s;++h){const l=a[h].createInterpolant(null);o[h]=l,l.settings=u}this._interpolantSettings=u,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ix,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,r=!1){if(t.fadeOut(e),this.fadeIn(e),r===!0){const i=this._clip.duration,a=t._clip.duration,s=a/i,o=i/a;t.warp(1,s,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,r=!1){return t.crossFadeFrom(this,e,r)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,r){const i=this._mixer,a=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const u=o.parameterPositions,h=o.sampleValues;return u[0]=a,u[1]=a+r,h[0]=t/s,h[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,r,i){if(!this.enabled){this._updateWeight(t);return}const a=this._startTime;if(a!==null){const u=(t-a)*r;u<0||r===0?e=0:(this._startTime=null,e=r*u)}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const u=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case M2:for(let l=0,c=u.length;l!==c;++l)u[l].evaluate(s),h[l].accumulateAdditive(o);break;case up:default:for(let l=0,c=u.length;l!==c;++l)u[l].evaluate(s),h[l].accumulate(i,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(t)[0];e*=i,t>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(t)[0];e*=i,t>r.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,r=this.loop;let i=this.time+t,a=this._loopCount;const s=r===A2;if(t===0)return a===-1?i:s&&(a&1)===1?e-i:i;if(r===T2){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else if(i<0)i=0;else{this.time=i;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(a===-1&&(t>=0?(a=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=e||i<0){const o=Math.floor(i/e);i-=e*o,a+=Math.abs(o);const u=this.repetitions-a;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(u===1){const h=t<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=a,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(s&&(a&1)===1)return e-i}return i}_setEndings(t,e,r){const i=this._interpolantSettings;r?(i.endingStart=ma,i.endingEnd=ma):(t?i.endingStart=this.zeroSlopeAtStart?ma:va:i.endingStart=rl,e?i.endingEnd=this.zeroSlopeAtEnd?ma:va:i.endingEnd=rl)}_scheduleFading(t,e,r){const i=this._mixer,a=i.time;let s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,u=s.sampleValues;return o[0]=a,u[0]=e,o[1]=a+t,u[1]=r,this}}const yO=new Float32Array(1);class xO extends po{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}_bindAction(t,e){const r=t._localRoot||this._root,i=t._clip.tracks,a=i.length,s=t._propertyBindings,o=t._interpolants,u=r.uuid,h=this._bindingsByRootAndName;let l=h[u];l===void 0&&(l={},h[u]=l);for(let c=0;c!==a;++c){const f=i[c],d=f.name;let p=l[d];if(p!==void 0)++p.referenceCount,s[c]=p;else{if(p=s[c],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,u,d));continue}const v=e&&e._propertyBindings[c].binding.parsedPath;p=new oO(It.create(r,d,v),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,u,d),s[c]=p}o[c].resultBuffer=p.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const r=(t._localRoot||this._root).uuid,i=t._clip.uuid,a=this._actionsByClip[i];this._bindAction(t,a&&a.knownActions[0]),this._addInactiveAction(t,i,r)}const e=t._propertyBindings;for(let r=0,i=e.length;r!==i;++r){const a=e[r];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let r=0,i=e.length;r!==i;++r){const a=e[r];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,r){const i=this._actions,a=this._actionsByClip;let s=a[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,a[e]=s;else{const o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[r]=t}_removeInactiveAction(t){const e=this._actions,r=e[e.length-1],i=t._cacheIndex;r._cacheIndex=i,e[i]=r,e.pop(),t._cacheIndex=null;const a=t._clip.uuid,s=this._actionsByClip,o=s[a],u=o.knownActions,h=u[u.length-1],l=t._byClipCacheIndex;h._byClipCacheIndex=l,u[l]=h,u.pop(),t._byClipCacheIndex=null;const c=o.actionByRoot,f=(t._localRoot||this._root).uuid;delete c[f],u.length===0&&delete s[a],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let r=0,i=e.length;r!==i;++r){const a=e[r];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(t){const e=this._actions,r=t._cacheIndex,i=this._nActiveActions++,a=e[i];t._cacheIndex=i,e[i]=t,a._cacheIndex=r,e[r]=a}_takeBackAction(t){const e=this._actions,r=t._cacheIndex,i=--this._nActiveActions,a=e[i];t._cacheIndex=i,e[i]=t,a._cacheIndex=r,e[r]=a}_addInactiveBinding(t,e,r){const i=this._bindingsByRootAndName,a=this._bindings;let s=i[e];s===void 0&&(s={},i[e]=s),s[r]=t,t._cacheIndex=a.length,a.push(t)}_removeInactiveBinding(t){const e=this._bindings,r=t.binding,i=r.rootNode.uuid,a=r.path,s=this._bindingsByRootAndName,o=s[i],u=e[e.length-1],h=t._cacheIndex;u._cacheIndex=h,e[h]=u,e.pop(),delete o[a],Object.keys(o).length===0&&delete s[i]}_lendBinding(t){const e=this._bindings,r=t._cacheIndex,i=this._nActiveBindings++,a=e[i];t._cacheIndex=i,e[i]=t,a._cacheIndex=r,e[r]=a}_takeBackBinding(t){const e=this._bindings,r=t._cacheIndex,i=--this._nActiveBindings,a=e[i];t._cacheIndex=i,e[i]=t,a._cacheIndex=r,e[r]=a}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let r=t[e];return r===void 0&&(r=new zx(new Float32Array(2),new Float32Array(2),1,yO),r.__cacheIndex=e,t[e]=r),r}_takeBackControlInterpolant(t){const e=this._controlInterpolants,r=t.__cacheIndex,i=--this._nActiveControlInterpolants,a=e[i];t.__cacheIndex=i,e[i]=t,a.__cacheIndex=r,e[r]=a}clipAction(t,e,r){const i=e||this._root,a=i.uuid;let s=typeof t=="string"?Nf.findByName(i,t):t;const o=s!==null?s.uuid:t,u=this._actionsByClip[o];let h=null;if(r===void 0&&(s!==null?r=s.blendMode:r=up),u!==void 0){const c=u.actionByRoot[a];if(c!==void 0&&c.blendMode===r)return c;h=u.knownActions[0],s===null&&(s=h._clip)}if(s===null)return null;const l=new gO(this,s,e,r);return this._bindAction(l,h),this._addInactiveAction(l,o,a),l}existingAction(t,e){const r=e||this._root,i=r.uuid,a=typeof t=="string"?Nf.findByName(r,t):t,s=a?a.uuid:t,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let r=e-1;r>=0;--r)t[r].stop();return this}update(t){t*=this.timeScale;const e=this._actions,r=this._nActiveActions,i=this.time+=t,a=Math.sign(t),s=this._accuIndex^=1;for(let h=0;h!==r;++h)e[h]._update(i,t,a,s);const o=this._bindings,u=this._nActiveBindings;for(let h=0;h!==u;++h)o[h].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,r=t.uuid,i=this._actionsByClip,a=i[r];if(a!==void 0){const s=a.knownActions;for(let o=0,u=s.length;o!==u;++o){const h=s[o];this._deactivateAction(h);const l=h._cacheIndex,c=e[e.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(h)}delete i[r]}}uncacheRoot(t){const e=t.uuid,r=this._actionsByClip;for(const s in r){const o=r[s].actionByRoot,u=o[e];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const i=this._bindingsByRootAndName,a=i[e];if(a!==void 0)for(const s in a){const o=a[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(t,e){const r=this.existingAction(t,e);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ex}}));typeof window<"u"&&(window.__THREE__?Nt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ex);/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var ur=Uint8Array,ga=Uint16Array,bO=Int32Array,Wx=new ur([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hx=new ur([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_O=new ur([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jx=function(n,t){for(var e=new ga(31),r=0;r<31;++r)e[r]=t+=1<<n[r-1];for(var i=new bO(e[30]),r=1;r<30;++r)for(var a=e[r];a<e[r+1];++a)i[a]=a-e[r]<<5|r;return{b:e,r:i}},$x=jx(Wx,2),qx=$x.b,wO=$x.r;qx[28]=258,wO[258]=28;var SO=jx(Hx,0),EO=SO.b,kf=new ga(32768);for(var Dt=0;Dt<32768;++Dt){var Fn=(Dt&43690)>>1|(Dt&21845)<<1;Fn=(Fn&52428)>>2|(Fn&13107)<<2,Fn=(Fn&61680)>>4|(Fn&3855)<<4,kf[Dt]=((Fn&65280)>>8|(Fn&255)<<8)>>1}var ws=function(n,t,e){for(var r=n.length,i=0,a=new ga(t);i<r;++i)n[i]&&++a[n[i]-1];var s=new ga(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(e){o=new ga(1<<t);var u=15-t;for(i=0;i<r;++i)if(n[i])for(var h=i<<4|n[i],l=t-n[i],c=s[n[i]-1]++<<l,f=c|(1<<l)-1;c<=f;++c)o[kf[c]>>u]=h}else for(o=new ga(r),i=0;i<r;++i)n[i]&&(o[i]=kf[s[n[i]-1]++]>>15-n[i]);return o},mo=new ur(288);for(var Dt=0;Dt<144;++Dt)mo[Dt]=8;for(var Dt=144;Dt<256;++Dt)mo[Dt]=9;for(var Dt=256;Dt<280;++Dt)mo[Dt]=7;for(var Dt=280;Dt<288;++Dt)mo[Dt]=8;var Zx=new ur(32);for(var Dt=0;Dt<32;++Dt)Zx[Dt]=5;var TO=ws(mo,9,1),AO=ws(Zx,5,1),lc=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},gr=function(n,t,e){var r=t/8|0;return(n[r]|n[r+1]<<8)>>(t&7)&e},uc=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(t&7)},MO=function(n){return(n+7)/8|0},PO=function(n,t,e){return(e==null||e>n.length)&&(e=n.length),new ur(n.subarray(t,e))},IO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wr=function(n,t,e){var r=new Error(t||IO[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,wr),!e)throw r;return r},CO=function(n,t,e,r){var i=n.length,a=0;if(!i||t.f&&!t.l)return e||new ur(0);var s=!e,o=s||t.i!=2,u=t.i;s&&(e=new ur(i*3));var h=function(J){var it=e.length;if(J>it){var st=new ur(Math.max(it*2,J));st.set(e),e=st}},l=t.f||0,c=t.p||0,f=t.b||0,d=t.l,p=t.d,v=t.m,m=t.n,g=i*8;do{if(!d){l=gr(n,c,1);var y=gr(n,c+1,3);if(c+=3,y)if(y==1)d=TO,p=AO,v=9,m=5;else if(y==2){var w=gr(n,c,31)+257,S=gr(n,c+10,15)+4,E=w+gr(n,c+5,31)+1;c+=14;for(var T=new ur(E),A=new ur(19),P=0;P<S;++P)A[_O[P]]=gr(n,c+P*3,7);c+=S*3;for(var M=lc(A),R=(1<<M)-1,F=ws(A,M,1),P=0;P<E;){var N=F[gr(n,c,R)];c+=N&15;var x=N>>4;if(x<16)T[P++]=x;else{var D=0,X=0;for(x==16?(X=3+gr(n,c,3),c+=2,D=T[P-1]):x==17?(X=3+gr(n,c,7),c+=3):x==18&&(X=11+gr(n,c,127),c+=7);X--;)T[P++]=D}}var q=T.subarray(0,w),W=T.subarray(w);v=lc(q),m=lc(W),d=ws(q,v,1),p=ws(W,m,1)}else wr(1);else{var x=MO(c)+4,b=n[x-4]|n[x-3]<<8,_=x+b;if(_>i){u&&wr(0);break}o&&h(f+b),e.set(n.subarray(x,_),f),t.b=f+=b,t.p=c=_*8,t.f=l;continue}if(c>g){u&&wr(0);break}}o&&h(f+131072);for(var L=(1<<v)-1,U=(1<<m)-1,G=c;;G=c){var D=d[uc(n,c)&L],V=D>>4;if(c+=D&15,c>g){u&&wr(0);break}if(D||wr(2),V<256)e[f++]=V;else if(V==256){G=c,d=null;break}else{var O=V-254;if(V>264){var P=V-257,z=Wx[P];O=gr(n,c,(1<<z)-1)+qx[P],c+=z}var j=p[uc(n,c)&U],K=j>>4;j||wr(3),c+=j&15;var W=EO[K];if(K>3){var z=Hx[K];W+=uc(n,c)&(1<<z)-1,c+=z}if(c>g){u&&wr(0);break}o&&h(f+131072);var Z=f+O;if(f<W){var Q=a-W,nt=Math.min(W,Z);for(Q+f<0&&wr(3);f<nt;++f)e[f]=r[Q+f]}for(;f<Z;++f)e[f]=e[f-W]}}t.l=d,t.p=G,t.b=f,t.f=l,d&&(l=1,t.m=v,t.d=p,t.n=m)}while(!l);return f!=e.length&&s?PO(e,0,f):e.subarray(0,f)},RO=new ur(0),FO=function(n,t){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&wr(6,"invalid zlib data"),(n[1]>>5&1)==1&&wr(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function OO(n,t){return CO(n.subarray(FO(n),-4),{i:2},t,t)}var BO=typeof TextDecoder<"u"&&new TextDecoder,NO=0;try{BO.decode(RO,{stream:!0}),NO=1}catch{}function Kx(n,t,e){const r=e.length-n-1;if(t>=e[r])return r-1;if(t<=e[n])return n;let i=n,a=r,s=Math.floor((i+a)/2);for(;t<e[s]||t>=e[s+1];)t<e[s]?a=s:i=s,s=Math.floor((i+a)/2);return s}function kO(n,t,e,r){const i=[],a=[],s=[];i[0]=1;for(let o=1;o<=e;++o){a[o]=t-r[n+1-o],s[o]=r[n+o]-t;let u=0;for(let h=0;h<o;++h){const l=s[h+1],c=a[o-h],f=i[h]/(l+c);i[h]=u+l*f,u=c*f}i[o]=u}return i}function LO(n,t,e,r){const i=Kx(n,r,t),a=kO(i,r,n,t),s=new tr(0,0,0,0);for(let o=0;o<=n;++o){const u=e[i-n+o],h=a[o],l=u.w*h;s.x+=u.x*l,s.y+=u.y*l,s.z+=u.z*l,s.w+=u.w*h}return s}function DO(n,t,e,r,i){const a=[];for(let c=0;c<=e;++c)a[c]=0;const s=[];for(let c=0;c<=r;++c)s[c]=a.slice(0);const o=[];for(let c=0;c<=e;++c)o[c]=a.slice(0);o[0][0]=1;const u=a.slice(0),h=a.slice(0);for(let c=1;c<=e;++c){u[c]=t-i[n+1-c],h[c]=i[n+c]-t;let f=0;for(let d=0;d<c;++d){const p=h[d+1],v=u[c-d];o[c][d]=p+v;const m=o[d][c-1]/o[c][d];o[d][c]=f+p*m,f=v*m}o[c][c]=f}for(let c=0;c<=e;++c)s[0][c]=o[c][e];for(let c=0;c<=e;++c){let f=0,d=1;const p=[];for(let v=0;v<=e;++v)p[v]=a.slice(0);p[0][0]=1;for(let v=1;v<=r;++v){let m=0;const g=c-v,y=e-v;c>=v&&(p[d][0]=p[f][0]/o[y+1][g],m=p[d][0]*o[g][y]);const x=g>=-1?1:-g,b=c-1<=y?v-1:e-c;for(let w=x;w<=b;++w)p[d][w]=(p[f][w]-p[f][w-1])/o[y+1][g+w],m+=p[d][w]*o[g+w][y];c<=y&&(p[d][v]=-p[f][v-1]/o[y+1][c],m+=p[d][v]*o[c][y]),s[v][c]=m;const _=f;f=d,d=_}}let l=e;for(let c=1;c<=r;++c){for(let f=0;f<=e;++f)s[c][f]*=l;l*=e-c}return s}function UO(n,t,e,r,i){const a=i<n?i:n,s=[],o=Kx(n,r,t),u=DO(o,r,n,a,t),h=[];for(let l=0;l<e.length;++l){const c=e[l].clone(),f=c.w;c.x*=f,c.y*=f,c.z*=f,h[l]=c}for(let l=0;l<=a;++l){const c=h[o-n].clone().multiplyScalar(u[l][0]);for(let f=1;f<=n;++f)c.add(h[o-n+f].clone().multiplyScalar(u[l][f]));s[l]=c}for(let l=a+1;l<=i+1;++l)s[l]=new tr(0,0,0);return s}function VO(n,t){let e=1;for(let i=2;i<=n;++i)e*=i;let r=1;for(let i=2;i<=t;++i)r*=i;for(let i=2;i<=n-t;++i)r*=i;return e/r}function XO(n){const t=n.length,e=[],r=[];for(let a=0;a<t;++a){const s=n[a];e[a]=new $(s.x,s.y,s.z),r[a]=s.w}const i=[];for(let a=0;a<t;++a){const s=e[a].clone();for(let o=1;o<=a;++o)s.sub(i[a-o].clone().multiplyScalar(VO(a,o)*r[o]));i[a]=s.divideScalar(r[0])}return i}function zO(n,t,e,r,i){const a=UO(n,t,e,r,i);return XO(a)}class GO extends bF{constructor(t,e,r,i,a){super();const s=e?e.length-1:0,o=r?r.length:0;this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=i||0,this.endKnot=a||s;for(let u=0;u<o;++u){const h=r[u];this.controlPoints[u]=new tr(h.x,h.y,h.z,h.w)}}getPoint(t,e=new $){const r=e,i=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),a=LO(this.degree,this.knots,this.controlPoints,i);return a.w!==1&&a.divideScalar(a.w),r.set(a.x,a.y,a.z)}getTangent(t,e=new $){const r=e,i=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),a=zO(this.degree,this.knots,this.controlPoints,i,1);return r.copy(a[1]).normalize(),r}toJSON(){const t=super.toJSON();return t.degree=this.degree,t.knots=[...this.knots],t.controlPoints=this.controlPoints.map(e=>e.toArray()),t.startKnot=this.startKnot,t.endKnot=this.endKnot,t}fromJSON(t){return super.fromJSON(t),this.degree=t.degree,this.knots=[...t.knots],this.controlPoints=t.controlPoints.map(e=>new tr(e[0],e[1],e[2],e[3])),this.startKnot=t.startKnot,this.endKnot=t.endKnot,this}}let bt,ne,Xe;class YO extends Ii{constructor(t){super(t)}load(t,e,r,i){const a=this,s=a.path===""?sO.extractUrlBase(t):a.path,o=new ZF(this.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(t,function(u){try{e(a.parse(u,s))}catch(h){i?i(h):console.error(h),a.manager.itemError(t)}},r,i)}parse(t,e){if(ZO(t))bt=new qO().parse(t);else{const i=tb(t);if(!KO(i))throw new Error("THREE.FBXLoader: Unknown format.");if(Sg(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Sg(i));bt=new $O().parse(i)}const r=new JF(this.manager).setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);return new WO(r,this.manager).parse(bt)}}class WO{constructor(t,e){this.textureLoader=t,this.manager=e}parse(){ne=this.parseConnections();const t=this.parseImages(),e=this.parseTextures(t),r=this.parseMaterials(e),i=this.parseDeformers(),a=new HO().parse(i);return this.parseScene(i,a,r),Xe}parseConnections(){const t=new Map;return"Connections"in bt&&bt.Connections.connections.forEach(function(r){const i=r[0],a=r[1],s=r[2];t.has(i)||t.set(i,{parents:[],children:[]});const o={ID:a,relationship:s};t.get(i).parents.push(o),t.has(a)||t.set(a,{parents:[],children:[]});const u={ID:i,relationship:s};t.get(a).children.push(u)}),t}parseImages(){const t={},e={};if("Video"in bt.Objects){const r=bt.Objects.Video;for(const i in r){const a=r[i],s=parseInt(i);if(t[s]=a.RelativeFilename||a.Filename,"Content"in a){const o=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,u=typeof a.Content=="string"&&a.Content!=="";if(o||u){const h=this.parseImage(r[i]);e[a.RelativeFilename||a.Filename]=h}}}}for(const r in t){const i=t[r];e[i]!==void 0?t[r]=e[i]:t[r]=t[r].split("\\").pop()}return t}parseImage(t){const e=t.Content,r=t.RelativeFilename||t.Filename,i=r.slice(r.lastIndexOf(".")+1).toLowerCase();let a;switch(i){case"bmp":a="image/bmp";break;case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"tif":a="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",r),a="image/tga";break;case"webp":a="image/webp";break;default:console.warn('FBXLoader: Image type "'+i+'" is not supported.');return}if(typeof e=="string")return"data:"+a+";base64,"+e;{const s=new Uint8Array(e);return window.URL.createObjectURL(new Blob([s],{type:a}))}}parseTextures(t){const e=new Map;if("Texture"in bt.Objects){const r=bt.Objects.Texture;for(const i in r){const a=this.parseTexture(r[i],t);e.set(parseInt(i),a)}}return e}parseTexture(t,e){const r=this.loadTexture(t,e);r.ID=t.id,r.name=t.attrName;const i=t.WrapModeU,a=t.WrapModeV,s=i!==void 0?i.value:0,o=a!==void 0?a.value:0;if(r.wrapS=s===0?tl:pa,r.wrapT=o===0?tl:pa,"Scaling"in t){const u=t.Scaling.value;r.repeat.x=u[0],r.repeat.y=u[1]}if("Translation"in t){const u=t.Translation.value;r.offset.x=u[0],r.offset.y=u[1]}return r}loadTexture(t,e){const r=t.FileName.split(".").pop().toLowerCase();let i=this.manager.getHandler(`.${r}`);i===null&&(i=this.textureLoader);const a=i.path;a||i.setPath(this.textureLoader.path);const s=ne.get(t.id).children;let o;if(s!==void 0&&s.length>0&&e[s[0].ID]!==void 0&&(o=e[s[0].ID],(o.indexOf("blob:")===0||o.indexOf("data:")===0)&&i.setPath(void 0)),o===void 0)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new Yr;const u=i.load(o);return i.setPath(a),u}parseMaterials(t){const e=new Map;if("Material"in bt.Objects){const r=bt.Objects.Material;for(const i in r){const a=this.parseMaterial(r[i],t);a!==null&&e.set(parseInt(i),a)}}return e}parseMaterial(t,e){const r=t.id,i=t.attrName;let a=t.ShadingModel;if(typeof a=="object"&&(a=a.value),!ne.has(r))return null;const s=this.parseParameters(t,e,r);let o;switch(a.toLowerCase()){case"phong":o=new ph;break;case"lambert":o=new UF;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),o=new ph;break}return o.setValues(s),o.name=i,o}parseParameters(t,e,r){const i={};t.BumpFactor&&(i.bumpScale=t.BumpFactor.value),t.Diffuse?i.color=ye.colorSpaceToWorking(new ue().fromArray(t.Diffuse.value),Vt):t.DiffuseColor&&(t.DiffuseColor.type==="Color"||t.DiffuseColor.type==="ColorRGB")&&(i.color=ye.colorSpaceToWorking(new ue().fromArray(t.DiffuseColor.value),Vt)),t.DisplacementFactor&&(i.displacementScale=t.DisplacementFactor.value),t.Emissive?i.emissive=ye.colorSpaceToWorking(new ue().fromArray(t.Emissive.value),Vt):t.EmissiveColor&&(t.EmissiveColor.type==="Color"||t.EmissiveColor.type==="ColorRGB")&&(i.emissive=ye.colorSpaceToWorking(new ue().fromArray(t.EmissiveColor.value),Vt)),t.EmissiveFactor&&(i.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),i.opacity=1-(t.TransparencyFactor?parseFloat(t.TransparencyFactor.value):0),(i.opacity===1||i.opacity===0)&&(i.opacity=t.Opacity?parseFloat(t.Opacity.value):null,i.opacity===null&&(i.opacity=1-(t.TransparentColor?parseFloat(t.TransparentColor.value[0]):0))),i.opacity<1&&(i.transparent=!0),t.ReflectionFactor&&(i.reflectivity=t.ReflectionFactor.value),t.Shininess&&(i.shininess=t.Shininess.value),t.Specular?i.specular=ye.colorSpaceToWorking(new ue().fromArray(t.Specular.value),Vt):t.SpecularColor&&t.SpecularColor.type==="Color"&&(i.specular=ye.colorSpaceToWorking(new ue().fromArray(t.SpecularColor.value),Vt));const a=this;return ne.get(r).children.forEach(function(s){const o=s.relationship;switch(o){case"Bump":i.bumpMap=a.getTexture(e,s.ID);break;case"Maya|TEX_ao_map":i.aoMap=a.getTexture(e,s.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=a.getTexture(e,s.ID),i.map!==void 0&&(i.map.colorSpace=Vt);break;case"DisplacementColor":i.displacementMap=a.getTexture(e,s.ID);break;case"EmissiveColor":i.emissiveMap=a.getTexture(e,s.ID),i.emissiveMap!==void 0&&(i.emissiveMap.colorSpace=Vt);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=a.getTexture(e,s.ID);break;case"ReflectionColor":i.envMap=a.getTexture(e,s.ID),i.envMap!==void 0&&(i.envMap.mapping=w2,i.envMap.colorSpace=Vt);break;case"SpecularColor":i.specularMap=a.getTexture(e,s.ID),i.specularMap!==void 0&&(i.specularMap.colorSpace=Vt);break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=a.getTexture(e,s.ID),i.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",o);break}}),i}getTexture(t,e){return"LayeredTexture"in bt.Objects&&e in bt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),e=ne.get(e).children[0].ID),t.get(e)}parseDeformers(){const t={},e={};if("Deformer"in bt.Objects){const r=bt.Objects.Deformer;for(const i in r){const a=r[i],s=ne.get(parseInt(i));if(a.attrType==="Skin"){const o=this.parseSkeleton(s,r);o.ID=i,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),o.geometryID=s.parents[0].ID,t[i]=o}else if(a.attrType==="BlendShape"){const o={id:i};o.rawTargets=this.parseMorphTargets(s,r),o.id=i,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),e[i]=o}}}return{skeletons:t,morphTargets:e}}parseSkeleton(t,e){const r=[];return t.children.forEach(function(i){const a=e[i.ID];if(a.attrType!=="Cluster")return;const s={ID:i.ID,indices:[],weights:[],transformLink:new ft().fromArray(a.TransformLink.a)};"Indexes"in a&&(s.indices=a.Indexes.a,s.weights=a.Weights.a),r.push(s)}),{rawBones:r,bones:[]}}parseMorphTargets(t,e){const r=[];for(let i=0;i<t.children.length;i++){const a=t.children[i],s=e[a.ID],o={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if(s.attrType!=="BlendShapeChannel")return;o.geoID=ne.get(parseInt(a.ID)).children.filter(function(u){return u.relationship===void 0})[0].ID,r.push(o)}return r}parseScene(t,e,r){Xe=new Qm;const i=this.parseModels(t.skeletons,e,r),a=bt.Objects.Model,s=this;i.forEach(function(u){const h=a[u.ID];s.setLookAtProperties(u,h),ne.get(u.ID).parents.forEach(function(c){const f=i.get(c.ID);f!==void 0&&f.add(u)}),u.parent===null&&Xe.add(u)}),this.bindSkeleton(t.skeletons,e,i),this.addGlobalSceneSettings(),Xe.traverse(function(u){if(u.userData.transformData){u.parent&&(u.userData.transformData.parentMatrix=u.parent.matrix,u.userData.transformData.parentMatrixWorld=u.parent.matrixWorld);const h=Qx(u.userData.transformData);u.applyMatrix4(h),u.updateWorldMatrix()}});const o=new jO().parse();Xe.children.length===1&&Xe.children[0].isGroup&&(Xe.children[0].animations=o,Xe=Xe.children[0]),Xe.animations=o}parseModels(t,e,r){const i=new Map,a=bt.Objects.Model;for(const s in a){const o=parseInt(s),u=a[s],h=ne.get(o);let l=this.buildSkeleton(h,t,o,u.attrName);if(!l){switch(u.attrType){case"Camera":l=this.createCamera(h);break;case"Light":l=this.createLight(h);break;case"Mesh":l=this.createMesh(h,e,r);break;case"NurbsCurve":l=this.createCurve(h,e);break;case"LimbNode":case"Root":l=new Ff;break;case"Null":default:l=new Qm;break}l.name=u.attrName?It.sanitizeNodeName(u.attrName):"",l.userData.originalName=u.attrName,l.ID=o}this.getTransformData(l,u),i.set(o,l)}return i}buildSkeleton(t,e,r,i){let a=null;return t.parents.forEach(function(s){for(const o in e){const u=e[o];u.rawBones.forEach(function(h,l){if(h.ID===s.ID){const c=a;a=new Ff,a.matrixWorld.copy(h.transformLink),a.name=i?It.sanitizeNodeName(i):"",a.userData.originalName=i,a.ID=r,u.bones[l]=a,c!==null&&a.add(c)}})}}),a}createCamera(t){let e,r;if(t.children.forEach(function(i){const a=bt.Objects.NodeAttribute[i.ID];a!==void 0&&(r=a)}),r===void 0)e=new Jt;else{let i=0;r.CameraProjectionType!==void 0&&r.CameraProjectionType.value===1&&(i=1);let a=1;r.NearPlane!==void 0&&(a=r.NearPlane.value/1e3);let s=1e3;r.FarPlane!==void 0&&(s=r.FarPlane.value/1e3);let o=window.innerWidth,u=window.innerHeight;r.AspectWidth!==void 0&&r.AspectHeight!==void 0&&(o=r.AspectWidth.value,u=r.AspectHeight.value);const h=o/u;let l=45;r.FieldOfView!==void 0&&(l=r.FieldOfView.value);const c=r.FocalLength?r.FocalLength.value:null;switch(i){case 0:e=new mp(l,h,a,s),c!==null&&e.setFocalLength(c);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),e=new Jt;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+i+"."),e=new Jt;break}}return e}createLight(t){let e,r;if(t.children.forEach(function(i){const a=bt.Objects.NodeAttribute[i.ID];a!==void 0&&(r=a)}),r===void 0)e=new Jt;else{let i;r.LightType===void 0?i=0:i=r.LightType.value;let a=16777215;r.Color!==void 0&&(a=ye.colorSpaceToWorking(new ue().fromArray(r.Color.value),Vt));let s=r.Intensity===void 0?1:r.Intensity.value/100;r.CastLightOnObject!==void 0&&r.CastLightOnObject.value===0&&(s=0);let o=0;r.FarAttenuationEnd!==void 0&&(r.EnableFarAttenuation!==void 0&&r.EnableFarAttenuation.value===0?o=0:o=r.FarAttenuationEnd.value);const u=1;switch(i){case 0:e=new _g(a,s,o,u);break;case 1:e=new iO(a,s);break;case 2:let h=Math.PI/3;r.InnerAngle!==void 0&&(h=We.degToRad(r.InnerAngle.value));let l=0;r.OuterAngle!==void 0&&(l=We.degToRad(r.OuterAngle.value),l=Math.max(l,1)),e=new tO(a,s,o,h,l,u);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),e=new _g(a,s);break}r.CastShadows!==void 0&&r.CastShadows.value===1&&(e.castShadow=!0)}return e}createMesh(t,e,r){let i,a=null,s=null;const o=[];if(t.children.forEach(function(u){e.has(u.ID)&&(a=e.get(u.ID)),r.has(u.ID)&&o.push(r.get(u.ID))}),o.length>1?s=o:o.length>0?s=o[0]:(s=new ph({name:Ii.DEFAULT_MATERIAL_NAME,color:13421772}),o.push(s)),"color"in a.attributes&&o.forEach(function(u){u.vertexColors=!0}),a.groups.length>0){let u=!1;for(let h=0,l=a.groups.length;h<l;h++){const c=a.groups[h];(c.materialIndex<0||c.materialIndex>=o.length)&&(c.materialIndex=o.length,u=!0)}if(u){const h=new ph;o.push(h)}}return a.FBX_Deformer?(i=new fF(a,s),i.normalizeSkinWeights()):i=new Nx(a,s),i}createCurve(t,e){const r=t.children.reduce(function(a,s){return e.has(s.ID)&&(a=e.get(s.ID)),a},null),i=new kx({name:Ii.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new xF(r,i)}getTransformData(t,e){const r={};"InheritType"in e&&(r.inheritType=parseInt(e.InheritType.value)),"RotationOrder"in e?r.eulerOrder=eo(e.RotationOrder.value):r.eulerOrder=eo(0),"Lcl_Translation"in e&&(r.translation=e.Lcl_Translation.value),"PreRotation"in e&&(r.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(r.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(r.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(r.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(r.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(r.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(r.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(r.rotationPivot=e.RotationPivot.value),t.userData.transformData=r}setLookAtProperties(t,e){"LookAtProperty"in e&&ne.get(t.ID).children.forEach(function(i){if(i.relationship==="LookAtProperty"){const a=bt.Objects.Model[i.ID];if("Lcl_Translation"in a){const s=a.Lcl_Translation.value;t.target!==void 0?(t.target.position.fromArray(s),Xe.add(t.target)):t.lookAt(new $().fromArray(s))}}})}bindSkeleton(t,e,r){const i=this.parsePoseNodes();for(const a in t){const s=t[a];ne.get(parseInt(s.ID)).parents.forEach(function(u){if(e.has(u.ID)){const h=u.ID;ne.get(h).parents.forEach(function(c){r.has(c.ID)&&r.get(c.ID).bind(new dp(s.bones),i[c.ID])})}})}}parsePoseNodes(){const t={};if("Pose"in bt.Objects){const e=bt.Objects.Pose;for(const r in e)if(e[r].attrType==="BindPose"&&e[r].NbPoseNodes>0){const i=e[r].PoseNode;Array.isArray(i)?i.forEach(function(a){t[a.Node]=new ft().fromArray(a.Matrix.a)}):t[i.Node]=new ft().fromArray(i.Matrix.a)}}return t}addGlobalSceneSettings(){if("GlobalSettings"in bt){if("AmbientColor"in bt.GlobalSettings){const t=bt.GlobalSettings.AmbientColor.value,e=t[0],r=t[1],i=t[2];if(e!==0||r!==0||i!==0){const a=new ue().setRGB(e,r,i,Vt);Xe.add(new aO(a,1))}}"UnitScaleFactor"in bt.GlobalSettings&&(Xe.userData.unitScaleFactor=bt.GlobalSettings.UnitScaleFactor.value)}}}class HO{constructor(){this.negativeMaterialIndices=!1}parse(t){const e=new Map;if("Geometry"in bt.Objects){const r=bt.Objects.Geometry;for(const i in r){const a=ne.get(parseInt(i)),s=this.parseGeometry(a,r[i],t);e.set(parseInt(i),s)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),e}parseGeometry(t,e,r){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,r);case"NurbsCurve":return this.parseNurbsGeometry(e)}}parseMeshGeometry(t,e,r){const i=r.skeletons,a=[],s=t.parents.map(function(c){return bt.Objects.Model[c.ID]});if(s.length===0)return;const o=t.children.reduce(function(c,f){return i[f.ID]!==void 0&&(c=i[f.ID]),c},null);t.children.forEach(function(c){r.morphTargets[c.ID]!==void 0&&a.push(r.morphTargets[c.ID])});const u=s[0],h={};"RotationOrder"in u&&(h.eulerOrder=eo(u.RotationOrder.value)),"InheritType"in u&&(h.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(h.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(h.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(h.scale=u.GeometricScaling.value);const l=Qx(h);return this.genGeometry(e,o,a,l)}genGeometry(t,e,r,i){const a=new bi;t.attrName&&(a.name=t.attrName);const s=this.parseGeoNode(t,e),o=this.genBuffers(s),u=new Nn(o.vertex,3);if(u.applyMatrix4(i),a.setAttribute("position",u),o.colors.length>0&&a.setAttribute("color",new Nn(o.colors,3)),e&&(a.setAttribute("skinIndex",new Bx(o.weightsIndices,4)),a.setAttribute("skinWeight",new Nn(o.vertexWeights,4)),a.FBX_Deformer=e),o.normal.length>0){const h=new qr().getNormalMatrix(i),l=new Nn(o.normal,3);l.applyNormalMatrix(h),a.setAttribute("normal",l)}if(o.uvs.forEach(function(h,l){const c=l===0?"uv":`uv${l}`;a.setAttribute(c,new Nn(o.uvs[l],2))}),s.material&&s.material.mappingType!=="AllSame"){let h=o.materialIndex[0],l=0;if(o.materialIndex.forEach(function(c,f){c!==h&&(a.addGroup(l,f-l,h),h=c,l=f)}),a.groups.length>0){const c=a.groups[a.groups.length-1],f=c.start+c.count;f!==o.materialIndex.length&&a.addGroup(f,o.materialIndex.length-f,h)}a.groups.length===0&&a.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(a,t,r,i),a}parseGeoNode(t,e){const r={};if(r.vertexPositions=t.Vertices!==void 0?t.Vertices.a:[],r.vertexIndices=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],t.LayerElementColor&&t.LayerElementColor[0].Colors&&(r.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(r.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(r.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){r.uv=[];let i=0;for(;t.LayerElementUV[i];)t.LayerElementUV[i].UV&&r.uv.push(this.parseUVs(t.LayerElementUV[i])),i++}return r.weightTable={},e!==null&&(r.skeleton=e,e.rawBones.forEach(function(i,a){i.indices.forEach(function(s,o){r.weightTable[s]===void 0&&(r.weightTable[s]=[]),r.weightTable[s].push({id:a,weight:i.weights[o]})})})),r}genBuffers(t){const e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let r=0,i=0,a=!1,s=[],o=[],u=[],h=[],l=[],c=[];const f=this;return t.vertexIndices.forEach(function(d,p){let v,m=!1;d<0&&(d=d^-1,m=!0);let g=[],y=[];if(s.push(d*3,d*3+1,d*3+2),t.color){const x=yh(p,r,d,t.color);u.push(x[0],x[1],x[2])}if(t.skeleton){if(t.weightTable[d]!==void 0&&t.weightTable[d].forEach(function(x){y.push(x.weight),g.push(x.id)}),y.length>4){a||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),a=!0);const x=[0,0,0,0],b=[0,0,0,0];y.forEach(function(_,w){let S=_,E=g[w];b.forEach(function(T,A,P){if(S>T){P[A]=S,S=T;const M=x[A];x[A]=E,E=M}})}),g=x,y=b}for(;y.length<4;)y.push(0),g.push(0);for(let x=0;x<4;++x)l.push(y[x]),c.push(g[x])}if(t.normal){const x=yh(p,r,d,t.normal);o.push(x[0],x[1],x[2])}t.material&&t.material.mappingType!=="AllSame"&&(v=yh(p,r,d,t.material)[0],v<0&&(f.negativeMaterialIndices=!0,v=0)),t.uv&&t.uv.forEach(function(x,b){const _=yh(p,r,d,x);h[b]===void 0&&(h[b]=[]),h[b].push(_[0]),h[b].push(_[1])}),i++,m&&(f.genFace(e,t,s,v,o,u,h,l,c,i),r++,i=0,s=[],o=[],u=[],h=[],l=[],c=[])}),e}getNormalNewell(t){const e=new $(0,0,0);for(let r=0;r<t.length;r++){const i=t[r],a=t[(r+1)%t.length];e.x+=(i.y-a.y)*(i.z+a.z),e.y+=(i.z-a.z)*(i.x+a.x),e.z+=(i.x-a.x)*(i.y+a.y)}return e.normalize(),e}getNormalTangentAndBitangent(t){const e=this.getNormalNewell(t),i=(Math.abs(e.z)>.5?new $(0,1,0):new $(0,0,1)).cross(e).normalize(),a=e.clone().cross(i).normalize();return{normal:e,tangent:i,bitangent:a}}flattenVertex(t,e,r){return new ve(t.dot(e),t.dot(r))}genFace(t,e,r,i,a,s,o,u,h,l){let c;if(l>3){const f=[],d=e.baseVertexPositions||e.vertexPositions;for(let g=0;g<r.length;g+=3)f.push(new $(d[r[g]],d[r[g+1]],d[r[g+2]]));const{tangent:p,bitangent:v}=this.getNormalTangentAndBitangent(f),m=[];for(const g of f)m.push(this.flattenVertex(g,p,v));c=pp.triangulateShape(m,[])}else c=[[0,1,2]];for(const[f,d,p]of c)t.vertex.push(e.vertexPositions[r[f*3]]),t.vertex.push(e.vertexPositions[r[f*3+1]]),t.vertex.push(e.vertexPositions[r[f*3+2]]),t.vertex.push(e.vertexPositions[r[d*3]]),t.vertex.push(e.vertexPositions[r[d*3+1]]),t.vertex.push(e.vertexPositions[r[d*3+2]]),t.vertex.push(e.vertexPositions[r[p*3]]),t.vertex.push(e.vertexPositions[r[p*3+1]]),t.vertex.push(e.vertexPositions[r[p*3+2]]),e.skeleton&&(t.vertexWeights.push(u[f*4]),t.vertexWeights.push(u[f*4+1]),t.vertexWeights.push(u[f*4+2]),t.vertexWeights.push(u[f*4+3]),t.vertexWeights.push(u[d*4]),t.vertexWeights.push(u[d*4+1]),t.vertexWeights.push(u[d*4+2]),t.vertexWeights.push(u[d*4+3]),t.vertexWeights.push(u[p*4]),t.vertexWeights.push(u[p*4+1]),t.vertexWeights.push(u[p*4+2]),t.vertexWeights.push(u[p*4+3]),t.weightsIndices.push(h[f*4]),t.weightsIndices.push(h[f*4+1]),t.weightsIndices.push(h[f*4+2]),t.weightsIndices.push(h[f*4+3]),t.weightsIndices.push(h[d*4]),t.weightsIndices.push(h[d*4+1]),t.weightsIndices.push(h[d*4+2]),t.weightsIndices.push(h[d*4+3]),t.weightsIndices.push(h[p*4]),t.weightsIndices.push(h[p*4+1]),t.weightsIndices.push(h[p*4+2]),t.weightsIndices.push(h[p*4+3])),e.color&&(t.colors.push(s[f*3]),t.colors.push(s[f*3+1]),t.colors.push(s[f*3+2]),t.colors.push(s[d*3]),t.colors.push(s[d*3+1]),t.colors.push(s[d*3+2]),t.colors.push(s[p*3]),t.colors.push(s[p*3+1]),t.colors.push(s[p*3+2])),e.material&&e.material.mappingType!=="AllSame"&&(t.materialIndex.push(i),t.materialIndex.push(i),t.materialIndex.push(i)),e.normal&&(t.normal.push(a[f*3]),t.normal.push(a[f*3+1]),t.normal.push(a[f*3+2]),t.normal.push(a[d*3]),t.normal.push(a[d*3+1]),t.normal.push(a[d*3+2]),t.normal.push(a[p*3]),t.normal.push(a[p*3+1]),t.normal.push(a[p*3+2])),e.uv&&e.uv.forEach(function(v,m){t.uvs[m]===void 0&&(t.uvs[m]=[]),t.uvs[m].push(o[m][f*2]),t.uvs[m].push(o[m][f*2+1]),t.uvs[m].push(o[m][d*2]),t.uvs[m].push(o[m][d*2+1]),t.uvs[m].push(o[m][p*2]),t.uvs[m].push(o[m][p*2+1])})}addMorphTargets(t,e,r,i){if(r.length===0)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const a=this;r.forEach(function(s){s.rawTargets.forEach(function(o){const u=bt.Objects.Geometry[o.geoID];u!==void 0&&a.genMorphGeometry(t,e,u,i,o.name)})})}genMorphGeometry(t,e,r,i,a){const s=e.Vertices!==void 0?e.Vertices.a:[],o=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],u=r.Vertices!==void 0?r.Vertices.a:[],h=r.Indexes!==void 0?r.Indexes.a:[],l=t.attributes.position.count*3,c=new Float32Array(l);for(let v=0;v<h.length;v++){const m=h[v]*3;c[m]=u[v*3],c[m+1]=u[v*3+1],c[m+2]=u[v*3+2]}const f={vertexIndices:o,vertexPositions:c,baseVertexPositions:s},d=this.genBuffers(f),p=new Nn(d.vertex,3);p.name=a||r.attrName,p.applyMatrix4(i),t.morphAttributes.position.push(p)}parseNormals(t){const e=t.MappingInformationType,r=t.ReferenceInformationType,i=t.Normals.a;let a=[];return r==="IndexToDirect"&&("NormalIndex"in t?a=t.NormalIndex.a:"NormalsIndex"in t&&(a=t.NormalsIndex.a)),{dataSize:3,buffer:i,indices:a,mappingType:e,referenceType:r}}parseUVs(t){const e=t.MappingInformationType,r=t.ReferenceInformationType,i=t.UV.a;let a=[];return r==="IndexToDirect"&&(a=t.UVIndex.a),{dataSize:2,buffer:i,indices:a,mappingType:e,referenceType:r}}parseVertexColors(t){const e=t.MappingInformationType,r=t.ReferenceInformationType,i=t.Colors.a;let a=[];r==="IndexToDirect"&&(a=t.ColorIndex.a);for(let s=0,o=new ue;s<i.length;s+=4)o.fromArray(i,s),ye.colorSpaceToWorking(o,Vt),o.toArray(i,s);return{dataSize:4,buffer:i,indices:a,mappingType:e,referenceType:r}}parseMaterialIndices(t){const e=t.MappingInformationType,r=t.ReferenceInformationType;if(e==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};const i=t.Materials.a,a=[];for(let s=0;s<i.length;++s)a.push(s);return{dataSize:1,buffer:i,indices:a,mappingType:e,referenceType:r}}parseNurbsGeometry(t){const e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new bi;const r=e-1,i=t.KnotVector.a,a=[],s=t.Points.a;for(let c=0,f=s.length;c<f;c+=4)a.push(new tr().fromArray(s,c));let o,u;if(t.Form==="Closed")a.push(a[0]);else if(t.Form==="Periodic"){o=r,u=i.length-1-o;for(let c=0;c<r;++c)a.push(a[c])}const l=new GO(r,i,a,o,u).getPoints(a.length*12);return new bi().setFromPoints(l)}}class jO{parse(){const t=[],e=this.parseClips();if(e!==void 0)for(const r in e){const i=e[r],a=this.addClip(i);t.push(a)}return t}parseClips(){if(bt.Objects.AnimationCurve===void 0)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const e=this.parseAnimationLayers(t);return this.parseAnimStacks(e)}parseAnimationCurveNodes(){const t=bt.Objects.AnimationCurveNode,e=new Map;for(const r in t){const i=t[r];if(i.attrName.match(/S|R|T|DeformPercent/)!==null){const a={id:i.id,attr:i.attrName,curves:{}};e.set(a.id,a)}}return e}parseAnimationCurves(t){const e=bt.Objects.AnimationCurve;for(const r in e){const i={id:e[r].id,times:e[r].KeyTime.a.map(JO),values:e[r].KeyValueFloat.a},a=ne.get(i.id);if(a!==void 0){const s=a.parents[0].ID,o=a.parents[0].relationship;o.match(/X/)?t.get(s).curves.x=i:o.match(/Y/)?t.get(s).curves.y=i:o.match(/Z/)?t.get(s).curves.z=i:o.match(/DeformPercent/)&&t.has(s)&&(t.get(s).curves.morph=i)}}}parseAnimationLayers(t){const e=bt.Objects.AnimationLayer,r=new Map;for(const i in e){const a=[],s=ne.get(parseInt(i));s!==void 0&&(s.children.forEach(function(u,h){if(t.has(u.ID)){const l=t.get(u.ID);if(l.curves.x!==void 0||l.curves.y!==void 0||l.curves.z!==void 0){if(a[h]===void 0){const c=ne.get(u.ID).parents.filter(function(f){return f.relationship!==void 0})[0].ID;if(c!==void 0){const f=bt.Objects.Model[c.toString()];if(f===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",u);return}const d={modelName:f.attrName?It.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Xe.traverse(function(p){p.ID===f.id&&(d.transform=p.matrix,p.userData.transformData&&(d.eulerOrder=p.userData.transformData.eulerOrder))}),d.transform||(d.transform=new ft),"PreRotation"in f&&(d.preRotation=f.PreRotation.value),"PostRotation"in f&&(d.postRotation=f.PostRotation.value),a[h]=d}}a[h]&&(a[h][l.attr]=l)}else if(l.curves.morph!==void 0){if(a[h]===void 0){const c=ne.get(u.ID).parents.filter(function(g){return g.relationship!==void 0})[0].ID,f=ne.get(c).parents[0].ID,d=ne.get(f).parents[0].ID,p=ne.get(d).parents[0].ID,v=bt.Objects.Model[p],m={modelName:v.attrName?It.sanitizeNodeName(v.attrName):"",morphName:bt.Objects.Deformer[c].attrName};a[h]=m}a[h][l.attr]=l}}}),r.set(parseInt(i),a))}return r}parseAnimStacks(t){const e=bt.Objects.AnimationStack,r={};for(const i in e){const a=ne.get(parseInt(i)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const s=t.get(a[0].ID);r[i]={name:e[i].attrName,layer:s}}return r}addClip(t){let e=[];const r=this;return t.layer.forEach(function(i){e=e.concat(r.generateTracks(i))}),new Nf(t.name,-1,e)}generateTracks(t){const e=[];let r=new $,i=new $;if(t.transform&&t.transform.decompose(r,new le,i),r=r.toArray(),i=i.toArray(),t.T!==void 0&&Object.keys(t.T.curves).length>0){const a=this.generateVectorTrack(t.modelName,t.T.curves,r,"position");a!==void 0&&e.push(a)}if(t.R!==void 0&&Object.keys(t.R.curves).length>0){const a=this.generateRotationTrack(t.modelName,t.R.curves,t.preRotation,t.postRotation,t.eulerOrder);a!==void 0&&e.push(a)}if(t.S!==void 0&&Object.keys(t.S.curves).length>0){const a=this.generateVectorTrack(t.modelName,t.S.curves,i,"scale");a!==void 0&&e.push(a)}if(t.DeformPercent!==void 0){const a=this.generateMorphTrack(t);a!==void 0&&e.push(a)}return e}generateVectorTrack(t,e,r,i){const a=this.getTimesForAllAxes(e),s=this.getKeyframeTrackValues(a,e,r);return new to(t+"."+i,a,s)}generateRotationTrack(t,e,r,i,a){let s,o;if(e.x!==void 0&&e.y!==void 0&&e.z!==void 0){const f=this.interpolateRotations(e.x,e.y,e.z,a);s=f[0],o=f[1]}const u=eo(0);r!==void 0&&(r=r.map(We.degToRad),r.push(u),r=new Qe().fromArray(r),r=new le().setFromEuler(r)),i!==void 0&&(i=i.map(We.degToRad),i.push(u),i=new Qe().fromArray(i),i=new le().setFromEuler(i).invert());const h=new le,l=new Qe,c=[];if(!o||!s)return new Oa(t+".quaternion",[0],[0]);for(let f=0;f<o.length;f+=3)l.set(o[f],o[f+1],o[f+2],a),h.setFromEuler(l),r!==void 0&&h.premultiply(r),i!==void 0&&h.multiply(i),f>2&&new le().fromArray(c,(f-3)/3*4).dot(h)<0&&h.set(-h.x,-h.y,-h.z,-h.w),h.toArray(c,f/3*4);return new Oa(t+".quaternion",s,c)}generateMorphTrack(t){const e=t.DeformPercent.curves.morph,r=e.values.map(function(a){return a/100}),i=Xe.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new Qs(t.modelName+".morphTargetInfluences["+i+"]",e.times,r)}getTimesForAllAxes(t){let e=[];if(t.x!==void 0&&(e=e.concat(t.x.times)),t.y!==void 0&&(e=e.concat(t.y.times)),t.z!==void 0&&(e=e.concat(t.z.times)),e=e.sort(function(r,i){return r-i}),e.length>1){let r=1,i=e[0];for(let a=1;a<e.length;a++){const s=e[a];s!==i&&(e[r]=s,i=s,r++)}e=e.slice(0,r)}return e}getKeyframeTrackValues(t,e,r){const i=r,a=[];let s=-1,o=-1,u=-1;return t.forEach(function(h){if(e.x&&(s=e.x.times.indexOf(h)),e.y&&(o=e.y.times.indexOf(h)),e.z&&(u=e.z.times.indexOf(h)),s!==-1){const l=e.x.values[s];a.push(l),i[0]=l}else a.push(i[0]);if(o!==-1){const l=e.y.values[o];a.push(l),i[1]=l}else a.push(i[1]);if(u!==-1){const l=e.z.values[u];a.push(l),i[2]=l}else a.push(i[2])}),a}interpolateRotations(t,e,r,i){const a=[],s=[];a.push(t.times[0]),s.push(We.degToRad(t.values[0])),s.push(We.degToRad(e.values[0])),s.push(We.degToRad(r.values[0]));for(let o=1;o<t.values.length;o++){const u=[t.values[o-1],e.values[o-1],r.values[o-1]];if(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))continue;const h=u.map(We.degToRad),l=[t.values[o],e.values[o],r.values[o]];if(isNaN(l[0])||isNaN(l[1])||isNaN(l[2]))continue;const c=l.map(We.degToRad),f=[l[0]-u[0],l[1]-u[1],l[2]-u[2]],d=[Math.abs(f[0]),Math.abs(f[1]),Math.abs(f[2])];if(d[0]>=180||d[1]>=180||d[2]>=180){const v=Math.max(...d)/180,m=new Qe(...h,i),g=new Qe(...c,i),y=new le().setFromEuler(m),x=new le().setFromEuler(g);y.dot(x)&&x.set(-x.x,-x.y,-x.z,-x.w);const b=t.times[o-1],_=t.times[o]-b,w=new le,S=new Qe;for(let E=0;E<1;E+=1/v)w.copy(y.clone().slerp(x.clone(),E)),a.push(b+E*_),S.setFromQuaternion(w,i),s.push(S.x),s.push(S.y),s.push(S.z)}else a.push(t.times[o]),s.push(We.degToRad(t.values[o])),s.push(We.degToRad(e.values[o])),s.push(We.degToRad(r.values[o]))}return[a,s]}}class $O{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,e){this.currentProp=t,this.currentPropName=e}parse(t){this.currentIndent=0,this.allNodes=new Jx,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const e=this,r=t.split(/[\r\n]+/);return r.forEach(function(i,a){const s=i.match(/^[\s\t]*;/),o=i.match(/^[\s\t]*$/);if(s||o)return;const u=i.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),h=i.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=i.match("^\\t{"+(e.currentIndent-1)+"}}");u?e.parseNodeBegin(i,u):h?e.parseNodeProperty(i,h,r[++a]):l?e.popStack():i.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(i)}),this.allNodes}parseNodeBegin(t,e){const r=e[1].trim().replace(/^"/,"").replace(/"$/,""),i=e[2].split(",").map(function(u){return u.trim().replace(/^"/,"").replace(/"$/,"")}),a={name:r},s=this.parseNodeAttr(i),o=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(r,a):r in o?(r==="PoseNode"?o.PoseNode.push(a):o[r].id!==void 0&&(o[r]={},o[r][o[r].id]=o[r]),s.id!==""&&(o[r][s.id]=a)):typeof s.id=="number"?(o[r]={},o[r][s.id]=a):r!=="Properties70"&&(r==="PoseNode"?o[r]=[a]:o[r]=a),typeof s.id=="number"&&(a.id=s.id),s.name!==""&&(a.attrName=s.name),s.type!==""&&(a.attrType=s.type),this.pushStack(a)}parseNodeAttr(t){let e=t[0];t[0]!==""&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));let r="",i="";return t.length>1&&(r=t[1].replace(/^(\w+)::/,""),i=t[2]),{id:e,name:r,type:i}}parseNodeProperty(t,e,r){let i=e[1].replace(/^"/,"").replace(/"$/,"").trim(),a=e[2].replace(/^"/,"").replace(/"$/,"").trim();i==="Content"&&a===","&&(a=r.replace(/"/g,"").replace(/,$/,"").trim());const s=this.getCurrentNode();if(s.name==="Properties70"){this.parseNodeSpecialProperty(t,i,a);return}if(i==="C"){const u=a.split(",").slice(1),h=parseInt(u[0]),l=parseInt(u[1]);let c=a.split(",").slice(3);c=c.map(function(f){return f.trim().replace(/^"/,"")}),i="connections",a=[h,l],tB(a,c),s[i]===void 0&&(s[i]=[])}i==="Node"&&(s.id=a),i in s&&Array.isArray(s[i])?s[i].push(a):i!=="a"?s[i]=a:s.a=a,this.setCurrentProp(s,i),i==="a"&&a.slice(-1)!==","&&(s.a=fc(a))}parseNodePropertyContinued(t){const e=this.getCurrentNode();e.a+=t,t.slice(-1)!==","&&(e.a=fc(e.a))}parseNodeSpecialProperty(t,e,r){const i=r.split('",').map(function(l){return l.trim().replace(/^\"/,"").replace(/\s/,"_")}),a=i[0],s=i[1],o=i[2],u=i[3];let h=i[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=fc(h);break}this.getPrevNode()[a]={type:s,type2:o,flag:u,value:h},this.setCurrentProp(this.getPrevNode(),a)}}class qO{parse(t){const e=new wg(t);e.skip(23);const r=e.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);const i=new Jx;for(;!this.endOfContent(e);){const a=this.parseNode(e,r);a!==null&&i.add(a.name,a)}return i}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,e){const r={},i=e>=7500?t.getUint64():t.getUint32(),a=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();const s=t.getUint8(),o=t.getString(s);if(i===0)return null;const u=[];for(let f=0;f<a;f++)u.push(this.parseProperty(t));const h=u.length>0?u[0]:"",l=u.length>1?u[1]:"",c=u.length>2?u[2]:"";for(r.singleProperty=a===1&&t.getOffset()===i;i>t.getOffset();){const f=this.parseNode(t,e);f!==null&&this.parseSubNode(o,r,f)}return r.propertyList=u,typeof h=="number"&&(r.id=h),l!==""&&(r.attrName=l),c!==""&&(r.attrType=c),o!==""&&(r.name=o),r}parseSubNode(t,e,r){if(r.singleProperty===!0){const i=r.propertyList[0];Array.isArray(i)?(e[r.name]=r,r.a=i):e[r.name]=i}else if(t==="Connections"&&r.name==="C"){const i=[];r.propertyList.forEach(function(a,s){s!==0&&i.push(a)}),e.connections===void 0&&(e.connections=[]),e.connections.push(i)}else if(r.name==="Properties70")Object.keys(r).forEach(function(a){e[a]=r[a]});else if(t==="Properties70"&&r.name==="P"){let i=r.propertyList[0],a=r.propertyList[1];const s=r.propertyList[2],o=r.propertyList[3];let u;i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),a.indexOf("Lcl ")===0&&(a=a.replace("Lcl ","Lcl_")),a==="Color"||a==="ColorRGB"||a==="Vector"||a==="Vector3D"||a.indexOf("Lcl_")===0?u=[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:u=r.propertyList[4],e[i]={type:a,type2:s,flag:o,value:u}}else e[r.name]===void 0?typeof r.id=="number"?(e[r.name]={},e[r.name][r.id]=r):e[r.name]=r:r.name==="PoseNode"?(Array.isArray(e[r.name])||(e[r.name]=[e[r.name]]),e[r.name].push(r)):e[r.name][r.id]===void 0&&(e[r.name][r.id]=r)}parseProperty(t){const e=t.getString(1);let r;switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return r=t.getUint32(),t.getArrayBuffer(r);case"S":return r=t.getUint32(),t.getString(r);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=t.getUint32(),a=t.getUint32(),s=t.getUint32();if(a===0)switch(e){case"b":case"c":return t.getBooleanArray(i);case"d":return t.getFloat64Array(i);case"f":return t.getFloat32Array(i);case"i":return t.getInt32Array(i);case"l":return t.getInt64Array(i)}const o=OO(new Uint8Array(t.getArrayBuffer(s))),u=new wg(o.buffer);switch(e){case"b":case"c":return u.getBooleanArray(i);case"d":return u.getFloat64Array(i);case"f":return u.getFloat32Array(i);case"i":return u.getInt32Array(i);case"l":return u.getInt64Array(i)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}}class wg{constructor(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=e!==void 0?e:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(t){const e=[];for(let r=0;r<t;r++)e.push(this.getBoolean());return e}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const e=[];for(let r=0;r<t;r++)e.push(this.getInt32());return e}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),e&2147483648?(e=~e&4294967295,t=~t&4294967295,t===4294967295&&(e=e+1&4294967295),t=t+1&4294967295,-(e*4294967296+t)):e*4294967296+t}getInt64Array(t){const e=[];for(let r=0;r<t;r++)e.push(this.getInt64());return e}getUint64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),e*4294967296+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const e=[];for(let r=0;r<t;r++)e.push(this.getFloat32());return e}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const e=[];for(let r=0;r<t;r++)e.push(this.getFloat64());return e}getArrayBuffer(t){const e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}getString(t){const e=this.offset;let r=new Uint8Array(this.dv.buffer,e,t);this.skip(t);const i=r.indexOf(0);return i>=0&&(r=new Uint8Array(this.dv.buffer,e,i)),this._textDecoder.decode(r)}}class Jx{add(t,e){this[t]=e}}function ZO(n){const t="Kaydara FBX Binary  \0";return n.byteLength>=t.length&&t===tb(n,0,t.length)}function KO(n){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let e=0;function r(i){const a=n[i-1];return n=n.slice(e+i),e++,a}for(let i=0;i<t.length;++i)if(r(1)===t[i])return!1;return!0}function Sg(n){const t=/FBXVersion: (\d+)/,e=n.match(t);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function JO(n){return n/46186158e3}const QO=[];function yh(n,t,e,r){let i;switch(r.mappingType){case"ByPolygonVertex":i=n;break;case"ByPolygon":i=t;break;case"ByVertice":i=e;break;case"AllSame":i=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}r.referenceType==="IndexToDirect"&&(i=r.indices[i]);const a=i*r.dataSize,s=a+r.dataSize;return eB(QO,r.buffer,a,s)}const cc=new Qe,aa=new $;function Qx(n){const t=new ft,e=new ft,r=new ft,i=new ft,a=new ft,s=new ft,o=new ft,u=new ft,h=new ft,l=new ft,c=new ft,f=new ft,d=n.inheritType?n.inheritType:0;n.translation&&t.setPosition(aa.fromArray(n.translation));const p=eo(0);if(n.preRotation){const P=n.preRotation.map(We.degToRad);P.push(p),e.makeRotationFromEuler(cc.fromArray(P))}if(n.rotation){const P=n.rotation.map(We.degToRad);P.push(n.eulerOrder||p),r.makeRotationFromEuler(cc.fromArray(P))}if(n.postRotation){const P=n.postRotation.map(We.degToRad);P.push(p),i.makeRotationFromEuler(cc.fromArray(P)),i.invert()}n.scale&&a.scale(aa.fromArray(n.scale)),n.scalingOffset&&o.setPosition(aa.fromArray(n.scalingOffset)),n.scalingPivot&&s.setPosition(aa.fromArray(n.scalingPivot)),n.rotationOffset&&u.setPosition(aa.fromArray(n.rotationOffset)),n.rotationPivot&&h.setPosition(aa.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(c.copy(n.parentMatrix),l.copy(n.parentMatrixWorld));const v=e.clone().multiply(r).multiply(i),m=new ft;m.extractRotation(l);const g=new ft;g.copyPosition(l);const y=g.clone().invert().multiply(l),x=m.clone().invert().multiply(y),b=a,_=new ft;if(d===0)_.copy(m).multiply(v).multiply(x).multiply(b);else if(d===1)_.copy(m).multiply(x).multiply(v).multiply(b);else{const M=new ft().scale(new $().setFromMatrixScale(c)).clone().invert(),R=x.clone().multiply(M);_.copy(m).multiply(v).multiply(R).multiply(b)}const w=h.clone().invert(),S=s.clone().invert();let E=t.clone().multiply(u).multiply(h).multiply(e).multiply(r).multiply(i).multiply(w).multiply(o).multiply(s).multiply(a).multiply(S);const T=new ft().copyPosition(E),A=l.clone().multiply(T);return f.copyPosition(A),E=f.clone().multiply(_),E.premultiply(l.invert()),E}function eo(n){n=n||0;const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return n===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[n]}function fc(n){return n.split(",").map(function(e){return parseFloat(e)})}function tb(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=n.byteLength),new TextDecoder().decode(new Uint8Array(n,t,e))}function tB(n,t){for(let e=0,r=n.length,i=t.length;e<i;e++,r++)n[r]=t[e]}function eB(n,t,e,r){for(let i=e,a=0;i<r;i++,a++)n[a]=t[i];return n}const rB=30;function vi(n,t=0){const e=Number(n);return Number.isFinite(e)?e:t}function nB(n){if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);throw new Error("FBX input must be ArrayBuffer or typed array.")}function iB(n){return String(n||"clip").trim().split("/").pop().split("\\").pop().replace(/\.[^.]+$/,"")||"clip"}function aB(n,t){const e=Math.max(1/t,n),r=Math.max(2,Math.floor(e*t)+1),i=new Array(r);for(let a=0;a<r;a+=1)a===r-1?i[a]=e:i[a]=a/t;return i}function sB(n=[]){if(!Array.isArray(n)||!n.length)return null;let t=n[0];for(const e of n)((e==null?void 0:e.duration)||0)>((t==null?void 0:t.duration)||0)&&(t=e);return t}function oB(n){if(!(n!=null&&n.name))return!1;if(n.isBone||n.type==="Bone")return!0;if(n.isMesh||n.type==="Mesh")return!1;const t=n.name.toLowerCase();return t.includes("mixamorig")||t.includes("hips")||t.includes("spine")||t.includes("neck")||t.includes("head")||t.includes("arm")||t.includes("hand")||t.includes("leg")||t.includes("foot")||t.includes("root")}function hB(n){const t=[];return n.traverse(e=>{oB(e)&&t.push(e)}),t}function lB(n,t){let e=n.parent;for(;e;){if(t.has(e))return e.name||null;e=e.parent}return null}function Eg(n){return{x:vi(n==null?void 0:n.x,0),y:vi(n==null?void 0:n.y,0),z:vi(n==null?void 0:n.z,0)}}function uB(n){return{x:vi(n==null?void 0:n.x,0),y:vi(n==null?void 0:n.y,0),z:vi(n==null?void 0:n.z,0),w:vi(n==null?void 0:n.w,1)}}function cB(n,t){const e=new Map;for(const a of n)e.set(a.name,lB(a,t));const r=new Map,i=(a,s=new Set)=>{if(!a)return 0;if(r.has(a))return r.get(a);if(s.has(a))return 0;s.add(a);const o=e.get(a),u=o?i(o,s)+1:0;return s.delete(a),r.set(a,u),u};for(const a of n)i(a.name);return{parentByName:e,depthByName:r}}async function fB(n,t="clip.fbx",e={}){const r=Math.max(1,Number(e.fps)||rB),i=[],s=new YO().parse(nB(n),""),o=sB(s.animations||[]);if(!o)throw new Error("No animation clips were found in this FBX file.");const u=hB(s);if(!u.length)throw new Error("No FBX joint nodes were found for retargeting.");const h=new Set(u),{parentByName:l,depthByName:c}=cB(u,h),f=Math.max(o.duration||0,1/r),d=aB(f,r),p=new xO(s),v=p.clipAction(o);v.setLoop(Ix,1/0),v.play();const m=new $,g=new le,y={};for(const S of u)y[S.name]={name:S.name,sourceName:S.name,parentName:l.get(S.name)||null,positions:[],rotations:[]};s.updateMatrixWorld(!0);const x=new $,b=new le,_=u.map(S=>(S.getWorldPosition(x),S.getWorldQuaternion(b),{name:S.name||"",parentName:l.get(S.name)||null,isBone:!!(S.isBone||S.type==="Bone"),depth:Math.max(0,c.get(S.name)||0),restWorldPosition:Eg(x),restLocalPosition:Eg(S.position),restWorldQuaternion:uB(b),frame0WorldPosition:null})),w=new Map(_.map(S=>[S.name,S]));for(const S of d){p.setTime(S),s.updateMatrixWorld(!0);for(const E of u){const T=y[E.name];if(E.getWorldPosition(m),E.getWorldQuaternion(g),T.positions.push({x:m.x,y:m.y,z:m.z}),T.rotations.push({x:g.x,y:g.y,z:g.z,w:g.w}),S===d[0]){const A=w.get(E.name);A&&(A.frame0WorldPosition={x:m.x,y:m.y,z:m.z})}}}return p.stopAllAction(),p.uncacheRoot(s),u.every(S=>!S.isBone)&&i.push("FBX had no explicit bone nodes; retargeting used heuristic node selection."),{sourceFile:t,clipName:o.name||iB(t),fps:r,duration:d[d.length-1],frameTimes:d,jointTracks:y,skeleton:{nodes:_},warnings:i,metadata:{clipName:o.name||null,clipDuration:o.duration,trackedJointCount:u.length}}}const Tg=Object.freeze(["hips","spine","spine1","spine2","neck","head","leftArm","leftForeArm","leftHand","rightArm","rightForeArm","rightHand","leftUpLeg","leftLeg","leftFoot","rightUpLeg","rightLeg","rightFoot"]),dB=Object.freeze({hips:["mixamorig:hips","hips","hip","pelvis","root","centerhips"],spine:["mixamorig:spine","spine","spine0","spine_01","abdomen"],spine1:["mixamorig:spine1","spine1","spine_02","chest"],spine2:["mixamorig:spine2","spine2","spine_03","upperchest"],neck:["mixamorig:neck","neck","neck1"],head:["mixamorig:head","head","headtop"],leftArm:["mixamorig:leftarm","leftarm","larm","arm_l","lupperarm","leftshoulder","lshldr","lshoulder"],leftForeArm:["mixamorig:leftforearm","leftforearm","lforearm","forearm_l","lfore_arm"],leftHand:["mixamorig:lefthand","lefthand","lhand","hand_l","leftpalm","lpalm"],rightArm:["mixamorig:rightarm","rightarm","rarm","arm_r","rupperarm","rightshoulder","rshldr","rshoulder"],rightForeArm:["mixamorig:rightforearm","rightforearm","rforearm","forearm_r","rfore_arm"],rightHand:["mixamorig:righthand","righthand","rhand","hand_r","rightpalm","rpalm"],leftUpLeg:["mixamorig:leftupleg","leftupleg","lthigh","upleg_l","leftthigh","leftupperleg"],leftLeg:["mixamorig:leftleg","leftleg","lleg","calf_l","leftcalf","leftshin","lshin"],leftFoot:["mixamorig:leftfoot","leftfoot","lfoot","foot_l","leftankle"],rightUpLeg:["mixamorig:rightupleg","rightupleg","rthigh","upleg_r","rightthigh","rightupperleg"],rightLeg:["mixamorig:rightleg","rightleg","rleg","calf_r","rightcalf","rightshin","rshin"],rightFoot:["mixamorig:rightfoot","rightfoot","rfoot","foot_r","rightankle"]}),pB=Object.freeze({spine:["hips"],spine1:["spine","hips"],spine2:["spine1","spine","hips"],neck:["spine2","spine1","spine"],head:["neck","spine2","spine1"],leftForeArm:["leftArm"],leftHand:["leftForeArm","leftArm"],rightForeArm:["rightArm"],rightHand:["rightForeArm","rightArm"],leftLeg:["leftUpLeg"],leftFoot:["leftLeg","leftUpLeg"],rightLeg:["rightUpLeg"],rightFoot:["rightLeg","rightUpLeg"]});function eb(n){return String(n||"").toLowerCase().replace(/[^a-z0-9]+/g,"")}function vB(n){const t=new Set;for(const e of n||[]){const r=eb(e);r&&t.add(r)}return t}function mB(n,t){if(!t.size)return null;for(const e of n)if(t.has(e.normalizedName))return e;return null}function rb(n,t={}){const e=[],r=Array.isArray(n==null?void 0:n.warnings)?n.warnings:[];e.push(...r);const i=t.aliases||{},a={};for(const f of Tg)a[f]=vB(i[f]||dB[f]||[]);const s=(n==null?void 0:n.jointTracks)||{},o=Object.values(s).map(f=>({track:f,normalizedName:eb(f.name||f.sourceName)})),u={},h={},l=[];for(const f of Tg){const d=mB(o,a[f]);if(!d){l.push(f);continue}u[f]={name:f,sourceName:d.track.name,parentName:d.track.parentName,positions:d.track.positions||[],rotations:d.track.rotations||[]},h[f]=d.track.name}const c=[];for(const f of l){const p=(pB[f]||[]).find(m=>!!u[m]);if(!p){c.push(f);continue}const v=u[p];u[f]={name:f,sourceName:v.sourceName,parentName:v.parentName,positions:v.positions||[],rotations:v.rotations||[],derivedFrom:p},h[f]=v.sourceName,e.push(`Canonical joint "${f}" was missing; reusing "${p}" source track "${v.sourceName}".`)}return c.length&&e.push(`Missing canonical joints: ${c.join(", ")}`),{fps:n==null?void 0:n.fps,duration:n==null?void 0:n.duration,frameTimes:(n==null?void 0:n.frameTimes)||[],canonicalTracks:u,mapping:h,missingCanonicalJoints:c,warnings:e}}const gB=Math.PI/180;function Li(n,t,e){return Math.max(t,Math.min(e,n))}function xp(n){return n*gB}function Ag(n=[]){if(!n.length)return[];const t=[n[0]];for(let e=1;e<n.length;e+=1){const r=t[e-1];let i=n[e];for(;i-r>180;)i-=360;for(;i-r<-180;)i+=360;t.push(i)}return t}function yB(n=[],t=40){if(!n.length)return[];const e=[n[0]],r=Math.max(0,Number(t)||0);for(let i=1;i<n.length;i+=1){const a=e[i-1],s=n[i]-a,o=Li(s,-r,r);e.push(a+o)}return e}function nb(n=[],t=0){if(!n.length||t<=0)return n.slice();const e=[n[0]];for(let r=1;r<n.length;r+=1){const i=e[r-1],a=n[r];e.push(Math.abs(a-i)<t?i:a)}return e}function Mg(n=[],t=1){if(!n.length||t>=1)return n.slice();const e=Li(t,0,1),r=[n[0]];for(let i=1;i<n.length;i+=1)r.push(r[i-1]+(n[i]-r[i-1])*e);return r}function ar(n,t=4){const e=10**t;return Math.round(n*e)/e}const xB=Object.freeze({maxDeltaDeg:70,angleMedianWindow:5,angleSmoothingAlpha:.55,angleSmoothingPasses:2,angleDeadbandDeg:.02,translationMedianWindow:5,translationSmoothingAlpha:.5,translationSmoothingPasses:2,translationDeadband:.01,inPlaceTrendAlpha:.03,yawInfluence:.05,outOfPlaneSuppression:.85,sourceSideCalibrationFrames:5}),ib=Object.freeze({hips:null,spine:"hips",spine1:"spine",spine2:"spine1",neck:"spine2",head:"neck",leftArm:"spine2",leftForeArm:"leftArm",leftHand:"leftForeArm",rightArm:"spine2",rightForeArm:"rightArm",rightHand:"rightForeArm",leftUpLeg:"hips",leftLeg:"leftUpLeg",leftFoot:"leftLeg",rightUpLeg:"hips",rightLeg:"rightUpLeg",rightFoot:"rightLeg"}),bB=Object.freeze({hips:"spine",spine:"spine1",spine1:"spine2",spine2:"neck",neck:"head",head:null,leftArm:"leftForeArm",leftForeArm:"leftHand",leftHand:null,rightArm:"rightForeArm",rightForeArm:"rightHand",rightHand:null,leftUpLeg:"leftLeg",leftLeg:"leftFoot",leftFoot:null,rightUpLeg:"rightLeg",rightLeg:"rightFoot",rightFoot:null}),ro=Object.freeze(["x","y","z"]);function dc(n,t=null){const e=String(n||"").trim().toLowerCase();return ro.includes(e)?e:t}function Tr(n,t){return Ze(n==null?void 0:n[t],0)}function ii(n,t){const e=(n==null?void 0:n.positions)||[];if(!e.length)return null;const r=Li(Math.floor(Ze(t,1)),1,e.length),i={x:0,y:0,z:0};let a=0;for(let s=0;s<r;s+=1){const o=e[s];o&&(i.x+=Tr(o,"x"),i.y+=Tr(o,"y"),i.z+=Tr(o,"z"),a+=1)}return a?{x:i.x/a,y:i.y/a,z:i.z/a}:null}function _B(n){const t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},e={x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY};for(const r of Object.values(n||{}))for(const i of(r==null?void 0:r.positions)||[])if(i)for(const a of ro){const s=Tr(i,a);t[a]=Math.min(t[a],s),e[a]=Math.max(e[a],s)}return{x:Number.isFinite(t.x)&&Number.isFinite(e.x)?Math.max(0,e.x-t.x):0,y:Number.isFinite(t.y)&&Number.isFinite(e.y)?Math.max(0,e.y-t.y):0,z:Number.isFinite(t.z)&&Number.isFinite(e.z)?Math.max(0,e.z-t.z):0}}function pc(n,t=new Set){let e=null,r=Number.NEGATIVE_INFINITY;for(const i of ro){if(t.has(i))continue;const a=Math.abs(Ze(n==null?void 0:n[i],0));a>r&&(r=a,e=i)}return e||ro.find(i=>!t.has(i))||"x"}function wB(n,t,e){const r=(t==null?void 0:t.axisMapping)||{},i=dc(r.horizontal||(t==null?void 0:t.horizontalAxis),null),a=dc(r.vertical||(t==null?void 0:t.verticalAxis),null),s=dc(r.depth||(t==null?void 0:t.depthAxis),null),o=new Set([i,a,s].filter(Boolean));if(i&&a&&s&&o.size===3)return{horizontalAxis:i,verticalAxis:a,depthAxis:s};const u=Ze(t==null?void 0:t.sourceSideCalibrationFrames,5),h=_B(n),l=ii(n==null?void 0:n.hips,u),c=ii(n==null?void 0:n.head,u)||ii(n==null?void 0:n.neck,u),f=ii(n==null?void 0:n.leftArm,u),d=ii(n==null?void 0:n.rightArm,u),p=ii(n==null?void 0:n.leftUpLeg,u),v=ii(n==null?void 0:n.rightUpLeg,u),m=l&&c?Ss(c,l):{x:h.x,y:h.y,z:h.z},g=pc(m),y=f&&d?Ss(f,d):p&&v?Ss(p,v):{x:h.x,y:h.y,z:h.z},x=pc(y,new Set([g])),b=ro.find(_=>_!==x&&_!==g)||pc(h,new Set([x,g]));return e.push(`Projection axes inferred as horizontal=${x}, vertical=${g}, depth=${b}.`),{horizontalAxis:x,verticalAxis:g,depthAxis:b}}function SB(n){return Math.atan2(n.y,n.x)*180/Math.PI}function Ss(n,t){return{x:n.x-t.x,y:n.y-t.y,z:n.z-t.z}}function Pg(n){return Math.hypot(n.x,n.y)}function Ze(n,t=0){const e=Number(n);return Number.isFinite(e)?e:t}function EB(n,t){const e=Math.floor(Ze(n,t));return e<3?1:e%2===0?e+1:e}function ab(n,t){if(!Array.isArray(n)||n.length<3)return Array.isArray(n)?n.slice():[];const e=EB(t,1);if(e<=1)return n.slice();const r=Math.floor(e/2),i=new Array(n.length);for(let a=0;a<n.length;a+=1){const s=[];for(let o=-r;o<=r;o+=1){const u=Li(a+o,0,n.length-1);s.push(Ze(n[u],0))}s.sort((o,u)=>o-u),i[a]=s[Math.floor(s.length/2)]}return i}function sb(n,t,e=1){if(!Array.isArray(n)||n.length<2)return Array.isArray(n)?n.slice():[];const r=Math.max(1,Math.floor(Ze(e,1)));let i=n.slice();for(let a=0;a<r;a+=1){const s=Mg(i,t);i=Mg(s.slice().reverse(),t).reverse()}return i}function Ig(n,t){if(!Array.isArray(n)||!n.length)return[];const e=ab(n,t.medianWindow),r=sb(e,Ze(t.smoothingAlpha,1),t.smoothingPasses);return nb(r,Math.max(0,Ze(t.deadband,0)))}function TB(n,t,e,r,i){var c,f;const a=n[t];if(!a)return null;const s=bB[t],o=ib[t],u=s?n[s]:null,h=o?n[o]:null,l=new Array(e).fill(0);for(let d=0;d<e;d+=1){const p=a.positions[d];if(!p)continue;let v=null;if((c=u==null?void 0:u.positions)!=null&&c[d]?v=Ss(u.positions[d],p):(f=h==null?void 0:h.positions)!=null&&f[d]&&(v=Ss(p,h.positions[d])),!v){l[d]=d>0?l[d-1]:0;continue}const m={x:Tr(v,i.horizontalAxis),y:Tr(v,i.verticalAxis)};if(Pg(m)<=1e-5){l[d]=d>0?l[d-1]:0;continue}const g=Tr(v,i.depthAxis),y=SB(m),x=Math.max(1e-6,Pg(m)),b=Math.abs(g)/(x+Math.abs(g)+1e-6),_=1-Li(b*Ze(r.outOfPlaneSuppression,0),0,.95),w=Math.atan2(g,x)*180/Math.PI;l[d]=y+w*Ze(r.yawInfluence,0)*_}return l}function Cg(n,t){const e=Ag(n),r=ab(e,t.angleMedianWindow),i=yB(r,t.maxDeltaDeg),a=sb(i,t.angleSmoothingAlpha,t.angleSmoothingPasses),s=nb(a,t.angleDeadbandDeg);return Ag(s)}function AB(n,t,e){const r=n[t];if(!r)return null;const i=ib[t];if(!i||!n[i])return r.slice();const a=n[i],s=new Array(e);for(let o=0;o<e;o+=1)s[o]=r[o]-a[o];return s}function MB(n,t,e,r){var m;const i=new Array(t).fill(null).map(()=>({x:0,y:0}));if(!((m=n==null?void 0:n.positions)!=null&&m.length))return i;const a=n.positions[0]||{x:0,y:0,z:0},s=Tr(a,r.horizontalAxis),o=Tr(a,r.verticalAxis),u=new Array(t).fill(0),h=new Array(t).fill(0);for(let g=0;g<t;g+=1){const y=n.positions[g]||a;u[g]=Tr(y,r.horizontalAxis)-s,h[g]=Tr(y,r.verticalAxis)-o}let l=u[0],c=h[0];const f=new Array(t),d=new Array(t);for(let g=0;g<t;g+=1)l+=(u[g]-l)*e.inPlaceTrendAlpha,c+=(h[g]-c)*e.inPlaceTrendAlpha,f[g]=u[g]-l,d[g]=h[g]-c;const p=Ig(f,{medianWindow:e.translationMedianWindow,smoothingAlpha:e.translationSmoothingAlpha,smoothingPasses:e.translationSmoothingPasses,deadband:e.translationDeadband}),v=Ig(d,{medianWindow:e.translationMedianWindow,smoothingAlpha:e.translationSmoothingAlpha,smoothingPasses:e.translationSmoothingPasses,deadband:e.translationDeadband});for(let g=0;g<t;g+=1)i[g]={x:p[g],y:v[g]};return i}function Rg(n,t,e){var o;if(!t)return null;const r=(n==null?void 0:n.positions)||[];if(!r.length)return null;const i=Li(Math.floor(Ze(e,1)),1,r.length);let a=0,s=0;for(let u=0;u<i;u+=1){const h=Ze((o=r[u])==null?void 0:o[t],Number.NaN);Number.isFinite(h)&&(a+=h,s+=1)}return s?a/s:null}function PB(n,t={}){const e={...xB,...t||{}},r=[...(n==null?void 0:n.warnings)||[]],i=(n==null?void 0:n.frameTimes)||[],a=i.length,s=(n==null?void 0:n.canonicalTracks)||{};if(!a)throw new Error("No animation frames available for 3D to 2D projection.");const o=wB(s,e,r),u={};for(const p of Object.keys(s)){const v=TB(s,p,a,e,o);v&&(u[p]=Cg(v,e))}const h={};for(const p of Object.keys(u)){const v=AB(u,p,a);v&&(h[p]=Cg(v,e))}const l=s.hips||null,c=MB(l,a,e,o),f=Rg(s.leftArm,o.horizontalAxis,Ze(e.sourceSideCalibrationFrames,5)),d=Rg(s.rightArm,o.horizontalAxis,Ze(e.sourceSideCalibrationFrames,5));return(!Number.isFinite(f)||!Number.isFinite(d))&&r.push("Unable to derive source side calibration from left/right arm first-frame positions."),{fps:n==null?void 0:n.fps,duration:n==null?void 0:n.duration,frameTimes:i,jointAngles:h,worldJointAngles:u,hipsTranslation:c,sourceSide:{leftArmX:Number.isFinite(f)?f:null,rightArmX:Number.isFinite(d)?d:null},axisMapping:o,missingCanonicalJoints:(n==null?void 0:n.missingCanonicalJoints)||[],warnings:r}}const IB=Object.freeze({leftArm:"rightArm",leftForeArm:"rightForeArm",leftHand:"rightHand",leftUpLeg:"rightUpLeg",leftLeg:"rightLeg",leftFoot:"rightFoot",rightArm:"leftArm",rightForeArm:"leftForeArm",rightHand:"leftHand",rightUpLeg:"leftUpLeg",rightLeg:"leftLeg",rightFoot:"leftFoot"}),CB=Object.freeze({spine:["hips"],spine1:["spine","hips"],spine2:["spine1","spine","hips"],neck:["spine2","spine1","spine"],head:["neck","spine2","spine1"],leftForeArm:["leftArm"],leftHand:["leftForeArm","leftArm"],rightForeArm:["rightArm"],rightHand:["rightForeArm","rightArm"],leftLeg:["leftUpLeg"],leftFoot:["leftLeg","leftUpLeg"],rightLeg:["rightUpLeg"],rightFoot:["rightLeg","rightUpLeg"]});function de(n,t=0){const e=Number(n);return Number.isFinite(e)?e:t}function Nr(n,t){return Object.prototype.hasOwnProperty.call(n||{},t)}function ob(n,t,e){if(!Array.isArray(n)||n.length<=2)return n||[];const r=Math.max(0,de(e,0)),i=[n[0]];for(let a=1;a<n.length-1;a+=1){const s=n[a],o=i[i.length-1];let u=!1;for(const h of t){const l=de(s[h],0),c=de(o[h],0);if(Math.abs(l-c)>r){u=!0;break}}u&&i.push(s)}return i.push(n[n.length-1]),i}function RB(n){const t=Array.isArray(n==null?void 0:n.bones)?n.bones:[],e=new Map;for(const r of t)r!=null&&r.name&&e.set(r.name,r);return e}function FB(n){const t=Array.isArray(n==null?void 0:n.bones)?n.bones:[],e=new Map(t.map(a=>[a.name,a])),r=new Map,i=a=>{if(r.has(a))return r.get(a);const s=e.get(a);if(!s)return null;const o=de(s.x,0),u=de(s.y,0),h=de(s.rotation,0),l=de(s.scaleX,1),c=de(s.scaleY,1);if(!s.parent){const x={x:o,y:u,rotation:h,scaleX:l,scaleY:c};return r.set(a,x),x}const f=i(s.parent);if(!f){const x={x:o,y:u,rotation:h,scaleX:l,scaleY:c};return r.set(a,x),x}const d=xp(f.rotation),p=Math.cos(d),v=Math.sin(d),m=f.x+o*f.scaleX*p-u*f.scaleY*v,g=f.y+o*f.scaleX*v+u*f.scaleY*p,y={x:m,y:g,rotation:f.rotation+h,scaleX:f.scaleX*l,scaleY:f.scaleY*c};return r.set(a,y),y};for(const a of t)i(a.name);return r}function OB(n,t,e,r){var v,m;const i=(t==null?void 0:t.sideCalibration)||{},a=i.sourceLeftJoint||"leftArm",s=i.sourceRightJoint||"rightArm",o=i.targetLeftBone||"ARM_L",u=i.targetRightBone||"ARM_R",h=(v=n==null?void 0:n.sourceSide)==null?void 0:v.leftArmX,l=(m=n==null?void 0:n.sourceSide)==null?void 0:m.rightArmX;if(!Number.isFinite(h)||!Number.isFinite(l))return r.push(`Side auto-calibration skipped: source ${a}/${s} first-frame X is unavailable.`),!1;const c=e.get(o),f=e.get(u);if(!c||!f)return r.push(`Side auto-calibration skipped: target bones ${o}/${u} were not found in skeleton.`),!1;const d=h-l,p=c.x-f.x;return Math.abs(d)<=1e-5||Math.abs(p)<=1e-5?(r.push("Side auto-calibration skipped: arm side spread is too small to infer handedness."),!1):d*p<0}function vc(n,t){return t&&IB[n]||n}function BB(n,t,e){const r=(n==null?void 0:n.jointAdjustments)||{},i=r[t]||r[e]||null;return!i||typeof i!="object"?{multiplier:1,offset:0}:{multiplier:de(i.multiplier,1),offset:de(i.offset,0)}}function NB(n,t){const e=(n==null?void 0:n.timeline)||{},r=Nr(t,"uniformKeyframes")?!!t.uniformKeyframes:Nr(e,"uniformKeyframes")?!!e.uniformKeyframes:!0,i=Nr(t,"reduceRotationKeys")?!!t.reduceRotationKeys:Nr(e,"reduceRotationKeys")?!!e.reduceRotationKeys:!r,a=Nr(t,"reduceTranslationKeys")?!!t.reduceTranslationKeys:Nr(e,"reduceTranslationKeys")?!!e.reduceTranslationKeys:!r,s=Nr(t,"fillMissingWithZero")?!!t.fillMissingWithZero:Nr(e,"fillMissingWithZero")?!!e.fillMissingWithZero:!0,o=Math.max(1,Math.floor(Nr(t,"referenceFrameCount")?de(t.referenceFrameCount,3):Nr(e,"referenceFrameCount")?de(e.referenceFrameCount,3):3));return{uniformKeyframes:r,reduceRotationKeys:i,reduceTranslationKeys:a,fillMissingWithZero:s,referenceFrameCount:o}}function kB(n,t=3){if(!Array.isArray(n)||!n.length)return 0;const e=Math.min(Math.max(1,t),n.length);let r=0,i=0;for(let a=0;a<e;a+=1){const s=de(n[a],Number.NaN);Number.isFinite(s)&&(r+=s,i+=1)}return i?r/i:de(n[0],0)}function LB(n,t,e,r,i){if(!Array.isArray(n)||!Array.isArray(t)||!n.length||!t.length)return[];const a=Number.isFinite(r==null?void 0:r.minAngle)?r.minAngle:-360,s=Number.isFinite(r==null?void 0:r.maxAngle)?r.maxAngle:360,o=kB(t,i.referenceFrameCount),u=n.map((h,l)=>{const c=(de(t[l],o)-o)*e.multiplier+e.offset;return{time:ar(de(h,0),4),angle:ar(Li(c,a,s),4)}});return i.uniformKeyframes||!i.reduceRotationKeys?u:ob(u,["angle"],(r==null?void 0:r.rotationEpsilonDeg)??.2)}function DB(n,t,e,r,i){if(!Array.isArray(n)||!Array.isArray(t)||!n.length||!t.length)return[];const a=n.map((s,o)=>{const u=t[o]||{x:0,y:0};return{time:ar(de(s,0),4),x:ar(de(u.x,0)*e,4),y:ar(de(u.y,0)*e,4)}});return i.uniformKeyframes||!i.reduceTranslationKeys?a:ob(a,["x","y"],(r==null?void 0:r.translationEpsilon)??.12)}function UB(n,t,e,r,i){var s;const a=[t,...CB[t]||[]];for(let o=0;o<a.length;o+=1){const u=a[o],h=vc(u,e),l=(s=n==null?void 0:n.jointAngles)==null?void 0:s[h];if(!(!Array.isArray(l)||!l.length)){if(o>0){const c=`${t}|${u}|${h}`;i.has(c)||(i.add(c),r.push(`Source joint "${vc(t,e)}" missing; using fallback "${h}" for "${t}".`))}return{sourceJoint:h,sourceAngles:l}}}return{sourceJoint:vc(t,e),sourceAngles:null}}function VB({spineJson:n,canonical2d:t,profile:e,animationName:r,options:i={}}){if(!n||typeof n!="object")throw new Error("A valid Spine JSON object is required for retargeting.");const a=(t==null?void 0:t.frameTimes)||[];if(!a.length)throw new Error("No projected frame data is available for retargeting.");const s=[...(t==null?void 0:t.warnings)||[]],o=[],u=(e==null?void 0:e.targetBones)||{},h=RB(n),l=FB(n),c=OB(t,e,l,s),f=NB(e,i),d=String((i==null?void 0:i.rootMotion)||(e==null?void 0:e.rootMotion)||"in_place").trim().toLowerCase(),p=d!=="in_place"&&d!=="none",v=new Set,m=new Array(a.length).fill(0),g={},y=new Set;for(const[b,_]of Object.entries(u)){const w=typeof _=="string"?_:_==null?void 0:_.bone;if(!w)continue;if(!h.has(w)){s.push(`Target bone "${w}" is missing in skeleton.`);continue}const S=UB(t,b,c,s,v),E=S.sourceJoint,T=S.sourceAngles,A=Array.isArray(T)&&T.length?T:f.fillMissingWithZero?m:null;if(!A){s.push(`Source joint "${E}" has no projected angle data.`);continue}A===m&&s.push(`Source joint "${E}" has no projected angle data; writing static keys for "${w}".`);const P=BB(e,b,w),M=LB(a,A,P,(e==null?void 0:e.limits)||{},f);if(!M.length)continue;if(g[w]||(g[w]={}),g[w].rotate=M,y.has(w)||(y.add(w),o.push(w)),!!(typeof _=="object"&&_.translate)&&p&&b==="hips"){const F=de(e==null?void 0:e.translationScale,1),N=DB(a,(t==null?void 0:t.hipsTranslation)||[],F,(e==null?void 0:e.limits)||{},f);N.length&&(g[w].translate=N)}}if(!Object.keys(g).length)throw new Error("Retargeting produced no bone timelines.");return{animationName:String(r||"fbx_animation").trim()||"fbx_animation",duration:a[a.length-1]||0,fps:t==null?void 0:t.fps,mappedBones:o,missingCanonicalJoints:(t==null?void 0:t.missingCanonicalJoints)||[],warnings:s,sideSwapApplied:c,spineAnimation:{bones:g}}}function XB(n){return typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}function zB(n){return String(n||"").trim().replace(/\s+/g,"_").replace(/[^A-Za-z0-9_\-]/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||"fbx_animation"}function GB(n,t={}){const e=zB(n);if(!Object.prototype.hasOwnProperty.call(t,e))return e;let r=1;for(;r<1e5;){const i=r===1?`${e}_fbx`:`${e}_fbx_${r}`;if(!Object.prototype.hasOwnProperty.call(t,i))return i;r+=1}return`${e}_${Date.now()}`}function YB(n,t,e){const r=XB(n);r.animations||(r.animations={});const i=GB(t,r.animations);return r.animations[i]=e,{mergedSpineJson:r,animationName:i}}const WB=new Set(["spine-first","fbx-first"]),HB=new Set(["auto-add-bones","skip-missing","strict-fail"]),jB=new Set(["full-hierarchy"]),sa=Object.freeze({mode:"spine-first",mismatchPolicy:"auto-add-bones",scope:"full-hierarchy"}),$B=Object.freeze({hips:null,spine:"hips",spine1:"spine",spine2:"spine1",neck:"spine2",head:"neck",leftArm:"spine2",leftForeArm:"leftArm",leftHand:"leftForeArm",rightArm:"spine2",rightForeArm:"rightArm",rightHand:"rightForeArm",leftUpLeg:"hips",leftLeg:"leftUpLeg",leftFoot:"leftLeg",rightUpLeg:"hips",rightLeg:"rightUpLeg",rightFoot:"rightLeg"}),Oe=1e-5;function rt(n,t=0){const e=Number(n);return Number.isFinite(e)?e:t}function qB(n,t){return Object.prototype.hasOwnProperty.call(n||{},t)}function la(n){return typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}function hb(n){return String(n||"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"")}function bp(n,t="fbx_bone"){return String(n||"").trim().replace(/[\s/\\:;.,]+/g,"_").replace(/[^A-Za-z0-9_\-]/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||t}function ZB(n={},t=[]){const e=String(n.mode||sa.mode).trim().toLowerCase(),r=String(n.mismatchPolicy||sa.mismatchPolicy).trim().toLowerCase(),i=String(n.scope||sa.scope).trim().toLowerCase(),a={mode:WB.has(e)?e:sa.mode,mismatchPolicy:HB.has(r)?r:sa.mismatchPolicy,scope:jB.has(i)?i:sa.scope};return a.mode!==e&&t.push(`Unsupported skeleton mode "${e}" requested; defaulted to "${a.mode}".`),a.mismatchPolicy!==r&&t.push(`Unsupported skeleton mismatch policy "${r}" requested; defaulted to "${a.mismatchPolicy}".`),a.scope!==i&&t.push(`Unsupported skeleton scope "${i}" requested; defaulted to "${a.scope}".`),a}function KB(n){const t=new Map;for(const[e,r]of Object.entries((n==null?void 0:n.targetBones)||{}))if(r){if(typeof r=="string"){t.set(e,r);continue}typeof r=="object"&&r.bone&&t.set(e,r.bone)}return t}function JB(n,t){var o;const e=[],r=Array.isArray((o=n==null?void 0:n.skeleton)==null?void 0:o.nodes)?n.skeleton.nodes:[];if(r.length)for(const u of r)u!=null&&u.name&&e.push({name:u.name,parentName:u.parentName||null,depth:Math.max(0,Math.floor(rt(u.depth,0))),isBone:!!u.isBone,restWorldPosition:u.restWorldPosition||u.frame0WorldPosition||null,restLocalPosition:u.restLocalPosition||null,frame0WorldPosition:u.frame0WorldPosition||null});if(e.length){const u=new Set(e.map(h=>h.name));for(const h of e)h.parentName&&!u.has(h.parentName)&&(h.parentName=null);return e}t.push("FBX skeleton metadata was unavailable; source hierarchy fell back to sampled track parent names.");const i=Object.values((n==null?void 0:n.jointTracks)||{}),a=new Set(i.map(u=>u==null?void 0:u.name).filter(Boolean)),s=i.filter(u=>u==null?void 0:u.name).map(u=>{var h,l;return{name:u.name,parentName:a.has(u.parentName)?u.parentName:null,depth:0,isBone:!0,restWorldPosition:((h=u.positions)==null?void 0:h[0])||null,restLocalPosition:null,frame0WorldPosition:((l=u.positions)==null?void 0:l[0])||null}});return lb(s),s}function lb(n){const t=new Map(n.map(i=>[i.name,i])),e=new Map,r=(i,a=new Set)=>{if(!i)return 0;if(e.has(i))return e.get(i);if(a.has(i))return 0;a.add(i);const s=t.get(i),o=(s==null?void 0:s.parentName)||null,u=o?r(o,a):0;a.delete(i);const h=o?u+1:0;return e.set(i,h),h};for(const i of n)i.depth=r(i.name)}function ub(n){return n.slice().sort((t,e)=>t.depth-e.depth||t.name.localeCompare(e.name))}function QB(n){return new Map(n.map(t=>[t.name,t]))}function cb(n){const t=new Map;for(const e of n)e.parentName&&(t.has(e.parentName)||t.set(e.parentName,[]),t.get(e.parentName).push(e.name));for(const e of t.values())e.sort((r,i)=>r.localeCompare(i));return t}function Fg(n,t=new Set){const e=["x","y","z"];let r=null,i=Number.NEGATIVE_INFINITY;for(const a of e){if(t.has(a))continue;const s=Math.abs(rt(n==null?void 0:n[a],0));s>i&&(i=s,r=a)}return r||e.find(a=>!t.has(a))||"x"}function _i(n,t){return{x:rt(n==null?void 0:n.x,0)-rt(t==null?void 0:t.x,0),y:rt(n==null?void 0:n.y,0)-rt(t==null?void 0:t.y,0),z:rt(n==null?void 0:n.z,0)-rt(t==null?void 0:t.z,0)}}function fb(n,t,e){const r=x=>{var _;const b=(_=t==null?void 0:t.mapping)==null?void 0:_[x];return b&&n.get(b)||null},i=x=>(x==null?void 0:x.restWorldPosition)||(x==null?void 0:x.frame0WorldPosition)||null,a=i(r("hips")),s=i(r("head"))||i(r("neck")),o=i(r("leftArm")),u=i(r("rightArm")),h=i(r("leftUpLeg")),l=i(r("rightUpLeg")),c={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},f={x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY};for(const x of n.values()){const b=i(x);b&&(c.x=Math.min(c.x,rt(b.x,0)),c.y=Math.min(c.y,rt(b.y,0)),c.z=Math.min(c.z,rt(b.z,0)),f.x=Math.max(f.x,rt(b.x,0)),f.y=Math.max(f.y,rt(b.y,0)),f.z=Math.max(f.z,rt(b.z,0)))}const d={x:Number.isFinite(c.x)?f.x-c.x:0,y:Number.isFinite(c.y)?f.y-c.y:0,z:Number.isFinite(c.z)?f.z-c.z:0},p=a&&s?_i(s,a):d,v=o&&u?_i(o,u):h&&l?_i(h,l):d,m=Fg(p),g=Fg(v,new Set([m])),y=["x","y","z"].find(x=>x!==g&&x!==m)||"z";return e.push(`Skeleton conversion projection axes inferred as horizontal=${g}, vertical=${m}, depth=${y}.`),{horizontalAxis:g,verticalAxis:m,depthAxis:y}}function db(n,t){const e=new Map;for(const[r,i]of n.entries()){const a=(i==null?void 0:i.restWorldPosition)||(i==null?void 0:i.frame0WorldPosition)||null;e.set(r,{x:rt(a==null?void 0:a[t.horizontalAxis],0),y:rt(a==null?void 0:a[t.verticalAxis],0),z:rt(a==null?void 0:a[t.depthAxis],0)})}return e}function pb(n){const t=new Map;for(const e of n||[])e!=null&&e.name&&t.set(e.name,e);return t}function _p(n,t=null){if(!t)return{x:rt(n.x,0),y:rt(n.y,0),rotation:rt(n.rotation,0),scaleX:rt(n.scaleX,1),scaleY:rt(n.scaleY,1)};const e=xp(t.rotation),r=Math.cos(e),i=Math.sin(e),a=rt(n.x,0),s=rt(n.y,0),o=rt(n.scaleX,1),u=rt(n.scaleY,1);return{x:t.x+a*t.scaleX*r-s*t.scaleY*i,y:t.y+a*t.scaleX*i+s*t.scaleY*r,rotation:t.rotation+rt(n.rotation,0),scaleX:t.scaleX*o,scaleY:t.scaleY*u}}function Lf(n){const t=pb(n),e=new Map,r=(i,a=new Set)=>{if(!i)return null;if(e.has(i))return e.get(i);if(a.has(i))return null;const s=t.get(i);if(!s)return null;a.add(i);const o=s.parent?r(s.parent,a):null;a.delete(i);const u=_p({x:rt(s.x,0),y:rt(s.y,0),rotation:rt(s.rotation,0),scaleX:rt(s.scaleX,1),scaleY:rt(s.scaleY,1)},o);return e.set(i,u),u};for(const i of n||[])r(i.name);return{byName:t,worldByName:e}}function vb(n){let t=rt(n,0);for(;t>180;)t-=360;for(;t<-180;)t+=360;return t}function mb(n,t){if(!t)return{x:rt(n==null?void 0:n.x,0),y:rt(n==null?void 0:n.y,0)};const e=rt(n==null?void 0:n.x,0)-rt(t.x,0),r=rt(n==null?void 0:n.y,0)-rt(t.y,0),i=xp(rt(t.rotation,0)),a=Math.cos(i),s=Math.sin(i),o=Math.abs(rt(t.scaleX,1))<=Oe?1:rt(t.scaleX,1),u=Math.abs(rt(t.scaleY,1))<=Oe?1:rt(t.scaleY,1);return{x:(e*a+r*s)/o,y:(-e*s+r*a)/u}}function Df(n,t){return Math.hypot(rt(n==null?void 0:n.x,0)-rt(t==null?void 0:t.x,0),rt(n==null?void 0:n.y,0)-rt(t==null?void 0:t.y,0))}function tN(n,t){const e=Math.cos(t),r=Math.sin(t);return{x:n.x*e-n.y*r,y:n.x*r+n.y*e}}function eN(n=[]){if(!n.length)return null;const t=n.map(r=>rt(r,Number.NaN)).filter(r=>Number.isFinite(r)).sort((r,i)=>r-i);if(!t.length)return null;const e=Math.floor(t.length/2);return t.length%2===1?t[e]:(t[e-1]+t[e])/2}function gb(n,t){var r;const e=new Map;for(const[i,a]of t.entries()){const s=(r=n==null?void 0:n.mapping)==null?void 0:r[i];s&&a&&e.set(s,a)}return e}function yb({canonicalData:n,targetBonesByCanonical:t,sourceWorldPoints:e,spineBonesByName:r,spineWorldByName:i}){var o,u;const a=[];for(const[h,l]of t.entries()){const c=(o=n==null?void 0:n.mapping)==null?void 0:o[h],f=$B[h],d=f?(u=n==null?void 0:n.mapping)==null?void 0:u[f]:null;if(!c||!d)continue;const p=e.get(c),v=e.get(d);if(!p||!v)continue;const m=Df(p,v);if(m<=Oe)continue;const g=r.get(l);if(!g)continue;let y=Math.abs(rt(g.length,0));if(y<=Oe&&g.parent){const x=i.get(l),b=i.get(g.parent);x&&b&&(y=Df(x,b))}y<=Oe||a.push(y/m)}const s=eN(a);return Number.isFinite(s)&&s>Oe?s:1}function xb({canonicalData:n,canonicalSourceToTargetBone:t,sourceWorldPoints:e,spineWorldByName:r,scale:i,warnings:a}){var f,d,p;const s=[];for(const[v,m]of t.entries()){const g=e.get(v),y=r.get(m);g&&y&&s.push({sourceName:v,targetBoneName:m,sourcePoint:g,targetPoint:y})}if(!s.length)return a.push("Skeleton conversion alignment fell back to identity transform (no canonical source/target anchor pairs)."),{sourceOrigin:{x:0,y:0},targetOrigin:{x:0,y:0},rotationRad:0,scale:rt(i,1)};let o=s[0];const u=(f=n==null?void 0:n.mapping)==null?void 0:f.hips;if(u){const v=s.find(m=>m.sourceName===u);v&&(o=v)}let h=0;const l=(v,m)=>{const g=s.find(S=>S.sourceName===v),y=s.find(S=>S.sourceName===m);if(!g||!y)return null;const x=_i(y.sourcePoint,g.sourcePoint),b=_i(y.targetPoint,g.targetPoint);if(Math.hypot(x.x,x.y)<=Oe||Math.hypot(b.x,b.y)<=Oe)return null;const _=Math.atan2(x.y,x.x);return Math.atan2(b.y,b.x)-_},c=[["hips","head"],["leftArm","rightArm"],["leftUpLeg","rightUpLeg"]];for(const[v,m]of c){const g=(d=n==null?void 0:n.mapping)==null?void 0:d[v],y=(p=n==null?void 0:n.mapping)==null?void 0:p[m];if(!g||!y)continue;const x=l(g,y);if(x!==null){h=x;break}}if(h===0&&s.length>=2){const v=l(s[0].sourceName,s[1].sourceName);v!==null&&(h=v)}return{sourceOrigin:{x:rt(o.sourcePoint.x,0),y:rt(o.sourcePoint.y,0)},targetOrigin:{x:rt(o.targetPoint.x,0),y:rt(o.targetPoint.y,0)},rotationRad:h,scale:rt(i,1)}}function bb(n,t){var a,s,o,u;const e={x:rt(n==null?void 0:n.x,0)-rt((a=t.sourceOrigin)==null?void 0:a.x,0),y:rt(n==null?void 0:n.y,0)-rt((s=t.sourceOrigin)==null?void 0:s.y,0)},r=tN(e,rt(t.rotationRad,0)),i=rt(t.scale,1);return{x:r.x*i+rt((o=t.targetOrigin)==null?void 0:o.x,0),y:r.y*i+rt((u=t.targetOrigin)==null?void 0:u.y,0)}}function _b(n,t,e,r){var o;const i=t.get(n);if(!i)return 0;const a=e.get(n)||[];let s=null;if(a.length){const u=t.get(a[0]);u&&(s=_i(u,i))}if(!s){const u=((o=r.get(n))==null?void 0:o.parentName)||null,h=u?t.get(u):null;h&&(s=_i(i,h))}return!s||Math.hypot(s.x,s.y)<=Oe?0:Math.atan2(s.y,s.x)*(180/Math.PI)}function wb(n,t,e){const r=t.get(n);if(!r)return 0;const i=e.get(n)||[];if(!i.length)return 0;const a=t.get(i[0]);return a?Df(r,a):0}function Sb(n=[]){const t=new Map;for(const e of n){const r=hb(e);r&&(t.has(r)||t.set(r,[]),t.get(r).push(e))}return t}function Eb(n,t){const e=hb(n);if(!e||!t.has(e))return null;const r=t.get(e)||[];return r.length!==1?null:r[0]}function Tb(n,t){const e=bp(n,"fbx_bone");if(!t.has(e))return t.add(e),e;let r=1;for(;r<1e5;){const a=`${e}_fbx_${r}`;if(!t.has(a))return t.add(a),a;r+=1}const i=`${e}_${Date.now()}`;return t.add(i),i}function rN(n,t){if(n.bones||(n.bones=[]),n.bones.length){const r=n.bones.find(i=>!(i!=null&&i.parent))||n.bones[0];return(r==null?void 0:r.name)||null}const e={name:"root"};return n.bones.push(e),t.addedBones.push(e.name),e.name}function nN({spineJson:n,sourceNodes:t,sourceNodeByName:e,canonicalData:r,targetBonesByCanonical:i,options:a,report:s}){const o=la(n);o.bones||(o.bones=[]);const u=ub(t),h=cb(u),l=o.bones.map(A=>A.name).filter(Boolean),c=new Set(l),f=Sb(l),d=gb(r,i),p=new Map;for(const[A,P]of d.entries())c.has(P)&&p.set(A,P);for(const A of u){if(p.has(A.name))continue;if(c.has(A.name)){p.set(A.name,A.name);continue}const P=Eb(A.name,f);P&&p.set(A.name,P)}const{byName:v,worldByName:m}=Lf(o.bones),g=fb(e,r,s.warnings),y=db(e,g),x=yb({canonicalData:r,targetBonesByCanonical:i,sourceWorldPoints:y,spineBonesByName:v,spineWorldByName:m}),b=xb({canonicalData:r,canonicalSourceToTargetBone:d,sourceWorldPoints:y,spineWorldByName:m,scale:x,warnings:s.warnings}),_=new Map;for(const[A,P]of y.entries())_.set(A,bb(P,b));const w=rN(o,s);if(!w)throw new Error("Spine-first skeleton conversion failed because a root bone could not be resolved.");const S=[],E=new Set(o.bones.map(A=>A.name).filter(Boolean)),T=Lf(o.bones).worldByName;for(const A of u){if(p.has(A.name))continue;if(a.mismatchPolicy==="strict-fail"){S.push(A.name);continue}if(a.mismatchPolicy==="skip-missing"){s.warnings.push(`Skipped unmapped FBX source node "${A.name}" due to skeleton mismatch policy.`);continue}const P=bp(A.name,"fbx_bone"),M=Tb(P,E),R=p.get(A.parentName)||w,F=T.get(R)||{x:0,y:0,rotation:0,scaleX:1,scaleY:1},N=_.get(A.name)||{x:F.x,y:F.y},D=mb(N,F),X=_b(A.name,_,h,e),q=vb(X-rt(F.rotation,0)),W=wb(A.name,_,h),L={name:M,parent:R};Math.abs(D.x)>Oe&&(L.x=ar(D.x,4)),Math.abs(D.y)>Oe&&(L.y=ar(D.y,4)),Math.abs(q)>Oe&&(L.rotation=ar(q,4)),W>Oe&&(L.length=ar(W,4)),o.bones.push(L),s.addedBones.push(M),p.set(A.name,M),T.set(M,_p({x:rt(L.x,0),y:rt(L.y,0),rotation:rt(L.rotation,0),scaleX:rt(L.scaleX,1),scaleY:rt(L.scaleY,1)},F))}if(S.length)throw new Error(`Spine-first skeleton conversion failed with strict mismatch policy. Missing mappings: ${S.join(", ")}`);return{convertedSpineJson:o}}function iN(n,t){var r;const e=new Map;for(const[i,a]of t.entries()){const s=(r=n==null?void 0:n.mapping)==null?void 0:r[i];s&&a&&e.set(s,a)}return e}function aN(n,t,e){if(!Array.isArray(n)||!n.length)return!1;let r=0;for(;r<n.length;){const i=Math.floor(rt(n[r],Number.NaN));if(!Number.isFinite(i)||i<=0||r+1+i*4>n.length)return!1;r+=1;for(let s=0;s<i;s+=1){const o=Math.floor(rt(n[r],e));n[r]=t.get(o)??e,r+=4}}return!0}function sN(n,t){const e=n==null?void 0:n.skins;if(Array.isArray(e)){for(const r of e){const i=r==null?void 0:r.attachments;if(!(!i||typeof i!="object")){for(const[a,s]of Object.entries(i))if(!(!s||typeof s!="object"))for(const[o,u]of Object.entries(s))t(u,{skinName:(r==null?void 0:r.name)||"",slotName:a,attachmentName:o})}}return}if(!(!e||typeof e!="object")){for(const[r,i]of Object.entries(e))if(!(!i||typeof i!="object")){for(const[a,s]of Object.entries(i))if(!(!s||typeof s!="object"))for(const[o,u]of Object.entries(s))t(u,{skinName:r,slotName:a,attachmentName:o})}}}function oN(n,t,e,r,i){var l;const a=new Map;for(let c=0;c<t.length;c+=1){const f=(l=t[c])==null?void 0:l.name;if(!f)continue;const d=e(f,{context:"skin weights",allowSkip:!1});a.set(c,d||i)}const s=new Map(((n==null?void 0:n.bones)||[]).map((c,f)=>[c==null?void 0:c.name,f])),o=s.get(i)??0,u=new Map;for(const[c,f]of a.entries())u.set(c,s.get(f)??o);let h=0;sN(n,c=>{if(!c||!Array.isArray(c.vertices))return;const f=Number.isFinite(c.vertexCount)?Math.floor(c.vertexCount):Array.isArray(c.uvs)?Math.floor(c.uvs.length/2):null;if(!Number.isFinite(f)||f<=0)return;const d=f*2;c.vertices.length<=d||aN(c.vertices,u,o)&&(h+=1)}),h>0&&r.warnings.push(`Remapped weighted skin bone indices for ${h} attachment(s).`)}function Og(n){const t=new Set(((n==null?void 0:n.bones)||[]).map(a=>a==null?void 0:a.name).filter(Boolean)),e=new Set;for(const a of(n==null?void 0:n.slots)||[])a!=null&&a.bone&&!t.has(a.bone)&&e.add(a.bone);const r=[(n==null?void 0:n.ik)||[],(n==null?void 0:n.path)||[],(n==null?void 0:n.transform)||[]];for(const a of r)for(const s of a){s!=null&&s.target&&!t.has(s.target)&&e.add(s.target);for(const o of(s==null?void 0:s.bones)||[])o&&!t.has(o)&&e.add(o)}const i=(n==null?void 0:n.animations)||{};for(const a of Object.values(i))for(const s of Object.keys((a==null?void 0:a.bones)||{}))t.has(s)||e.add(s);return e}function hN({spineJson:n,sourceNodes:t,sourceNodeByName:e,canonicalData:r,targetBonesByCanonical:i,options:a,report:s}){const o=la(n),u=Array.isArray(o==null?void 0:o.bones)?o.bones:[],h=pb(u),l=ub(t),c=cb(l),f=fb(e,r,s.warnings),d=db(e,f),{byName:p,worldByName:v}=Lf(u),m=gb(r,i),g=yb({canonicalData:r,targetBonesByCanonical:i,sourceWorldPoints:d,spineBonesByName:p,spineWorldByName:v}),y=xb({canonicalData:r,canonicalSourceToTargetBone:m,sourceWorldPoints:d,spineWorldByName:v,scale:g,warnings:s.warnings}),x=new Map;for(const[O,z]of d.entries())x.set(O,bb(z,y));const b=u.find(O=>O&&!O.parent)||u.find(O=>(O==null?void 0:O.name)==="root")||null,_=(b==null?void 0:b.name)||"root",w=b?la(b):{name:_};delete w.parent;const S=la(o),E=[w],T=new Set([_]),A=new Map,P=iN(r,i);for(const O of l){const z=P.get(O.name)||bp(O.name,"fbx_bone"),j=Tb(z===_?`${z}_fbx`:z,T);A.set(O.name,j)}const M=new Map;M.set(_,{x:rt(w.x,0),y:rt(w.y,0),rotation:rt(w.rotation,0),scaleX:rt(w.scaleX,1),scaleY:rt(w.scaleY,1)});for(const O of l){const z=A.get(O.name),j=A.get(O.parentName)||_,K=M.get(j)||{x:0,y:0,rotation:0,scaleX:1,scaleY:1},Z=x.get(O.name)||{x:K.x,y:K.y},Q=mb(Z,K),nt=_b(O.name,x,c,e),J=vb(nt-rt(K.rotation,0)),it=wb(O.name,x,c),st={name:z,parent:j};Math.abs(Q.x)>Oe&&(st.x=ar(Q.x,4)),Math.abs(Q.y)>Oe&&(st.y=ar(Q.y,4)),Math.abs(J)>Oe&&(st.rotation=ar(J,4)),it>Oe&&(st.length=ar(it,4)),E.push(st),s.addedBones.push(st.name),M.set(z,_p({x:rt(st.x,0),y:rt(st.y,0),rotation:rt(st.rotation,0),scaleX:rt(st.scaleX,1),scaleY:rt(st.scaleY,1)},K))}S.bones=E;const R=new Set(E.map(O=>O==null?void 0:O.name).filter(Boolean)),F=Sb(Array.from(R)),N=new Set,D=new Map,X=(O,z=new Set)=>{if(!O)return _;if(R.has(O)||N.has(O))return O;if(z.has(O))return _;z.add(O);const j=h.get(O),K=j!=null&&j.parent&&j.parent!==O?X(j.parent,z):_;z.delete(O);const Z=j?la(j):{name:O};return Z.name=O,K&&K!==O?Z.parent=K:delete Z.parent,S.bones.push(Z),R.add(O),N.add(O),s.compatibilityBonesAdded.push(O),O},q=O=>{if(!O)return null;if(R.has(O))return O;const z=Eb(O,F);return z||null},W=(O,z={})=>{if(!O)return null;if(D.has(O))return D.get(O);const j=q(O);if(j)return D.set(O,j),j;if(a.mismatchPolicy==="strict-fail")throw new Error(`FBX-first skeleton conversion could not remap "${O}" (${z.context||"reference"}).`);if(a.mismatchPolicy==="skip-missing"&&z.allowSkip!==!1)return D.set(O,null),s.warnings.push(`Skipped unresolved bone reference "${O}" (${z.context||"reference"}).`),null;const K=X(O);return D.set(O,K),s.warnings.push(`Added compatibility bone "${O}" for unresolved ${z.context||"reference"}.`),K},L=(O,z)=>{const j=W(O,z);return j&&j!==O&&(s.remappedReferences+=1),j};if(Array.isArray(S.slots))for(const O of S.slots){if(!(O!=null&&O.bone))continue;const z=L(O.bone,{context:`slot "${O.name||"unknown"}"`});O.bone=z||_}const U=(O,z)=>{if(!Array.isArray(O))return[];const j=[];for(const K of O){const Z=la(K);if(Z.target=Z.target?L(Z.target,{context:`${z} target "${Z.name||"unknown"}"`}):Z.target,Array.isArray(Z.bones)){const Q=[];for(const nt of Z.bones){const J=L(nt,{context:`${z} bones "${Z.name||"unknown"}"`});J&&Q.push(J)}Z.bones=Q}if(a.mismatchPolicy==="skip-missing"){const Q=!Z.target||R.has(Z.target),nt=!Array.isArray(Z.bones)||Z.bones.length>0;if(!Q||!nt){s.warnings.push(`Dropped ${z} constraint "${Z.name||"unknown"}" due to unresolved bone references.`);continue}}j.push(Z)}return j};S.ik=U(S.ik,"IK"),S.path=U(S.path,"path"),S.transform=U(S.transform,"transform");const G=S.animations||{};for(const[O,z]of Object.entries(G)){const j={};for(const[K,Z]of Object.entries((z==null?void 0:z.bones)||{})){const Q=L(K,{context:`animation "${O}"`});Q&&(qB(j,Q)?(j[Q]={...j[Q]||{},...Z||{}},s.warnings.push(`Merged duplicate animation bone timelines into "${Q}" while remapping "${O}".`)):j[Q]=Z)}z.bones=j}oN(S,u,W,s,_);let V=Og(S);if(V.size){if(a.mismatchPolicy==="strict-fail")throw new Error(`FBX-first skeleton conversion left unresolved references: ${Array.from(V).join(", ")}`);if(a.mismatchPolicy==="skip-missing"){s.warnings.push(`FBX-first conversion dropped or redirected unresolved references: ${Array.from(V).join(", ")}.`);for(const O of S.slots||[])O!=null&&O.bone&&V.has(O.bone)&&(O.bone=_);for(const O of Object.values(S.animations||{}))for(const z of Object.keys((O==null?void 0:O.bones)||{}))V.has(z)&&delete O.bones[z]}else{for(const O of V)X(O);s.warnings.push(`Added compatibility bones for unresolved references: ${Array.from(V).join(", ")}.`)}}if(V=Og(S),V.size)throw new Error(`FBX-first skeleton conversion failed validation. Missing references: ${Array.from(V).join(", ")}`);return{convertedSpineJson:S}}function lN({spineJson:n,parsedFbx:t,canonicalData:e=null,profile:r=null,options:i={}}){if(!n||typeof n!="object")throw new Error("A valid Spine JSON object is required for skeleton conversion.");if(!t||typeof t!="object")throw new Error("A valid parsed FBX payload is required for skeleton conversion.");const a=[],s=ZB(i,a),o=JB(t,a);if(!o.length)throw new Error("No FBX skeleton nodes were found for skeleton conversion.");lb(o);const u=QB(o),h=e||rb(t,{aliases:null}),l=KB(r),c={mode:s.mode,addedBones:[],remappedReferences:0,compatibilityBonesAdded:[],warnings:a};return s.scope!=="full-hierarchy"&&c.warnings.push(`Skeleton conversion scope "${s.scope}" is not supported in this runtime; using full hierarchy.`),s.mode==="spine-first"?{convertedSpineJson:nN({spineJson:n,sourceNodes:o,sourceNodeByName:u,canonicalData:h,targetBonesByCanonical:l,options:s,report:c}).convertedSpineJson,report:c}:{convertedSpineJson:hN({spineJson:n,sourceNodes:o,sourceNodeByName:u,canonicalData:h,targetBonesByCanonical:l,options:s,report:c}).convertedSpineJson,report:c}}function uN(n,t){const e=String(t||"").trim();return e?e.toUpperCase().startsWith("FBX_")?e:`FBX_${e}`:`FBX_${(String(n||"fbx_animation").split("/").pop().split("\\").pop().replace(/\.[^.]+$/,"")||"fbx_animation").replace(/[^A-Za-z0-9_]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||"animation"}`}function cN(n){const t=Array.isArray(n==null?void 0:n.frameTimes)?n.frameTimes.slice():[],e=Object.values((n==null?void 0:n.jointTracks)||{}).map(r=>({name:(r==null?void 0:r.name)||"",parentName:(r==null?void 0:r.parentName)||null,positions:Array.isArray(r==null?void 0:r.positions)?r.positions.map(i=>({x:Number.isFinite(i==null?void 0:i.x)?i.x:0,y:Number.isFinite(i==null?void 0:i.y)?i.y:0,z:Number.isFinite(i==null?void 0:i.z)?i.z:0})):[]}));return{sourceFile:(n==null?void 0:n.sourceFile)||null,clipName:(n==null?void 0:n.clipName)||null,fps:Number.isFinite(n==null?void 0:n.fps)?n.fps:0,duration:Number.isFinite(n==null?void 0:n.duration)?n.duration:0,frameTimes:t,jointTracks:e}}async function fN({fbxArrayBuffer:n,filename:t,spineJson:e,profile:r,animationName:i,options:a={}}){var d;const s=await fB(n,t,{fps:a.fps||30}),o=rb(s,{aliases:a.aliases||null});let u=e,h={mode:"disabled",addedBones:[],remappedReferences:0,compatibilityBonesAdded:[],warnings:[]};if((d=a==null?void 0:a.skeletonConversion)!=null&&d.enabled){const p=lN({spineJson:u,parsedFbx:s,canonicalData:o,profile:r,options:a.skeletonConversion});u=p.convertedSpineJson,h=p.report||h}const l=PB(o,{...(r==null?void 0:r.projection)||{},...a.projection||{}}),c=VB({spineJson:u,canonical2d:l,profile:r,animationName:uN(t,i),options:a}),f=YB(u,c.animationName,c.spineAnimation);return{...c,animationName:f.animationName,mergedSpineJson:f.mergedSpineJson,previewData:cN(s),parseWarnings:s.warnings||[],canonicalWarnings:o.warnings||[],skeletonReport:h}}Ai.registerPlugin(wx);const dN=new Set(["size","format","filter","repeat","pma","scale"]),pN=new Set(["rotate","xy","size","orig","offset","index"]),vN=2048,mN=2,Ab="manual-pot-merged.png",gN="spine-mipmap-preview-db",yN=1,sl="characters",xN="shared-history/manifest.json",Mb="shared",ai=Object.freeze({images:["powerof2/Man_39.png"],atlas:"powerof2/Man_39.atlas",skeleton:"powerof2/Man_39.json"}),bN=new Map([[9728,"NEAREST"],[9729,"LINEAR"],[9984,"NEAREST_MIPMAP_NEAREST"],[9985,"LINEAR_MIPMAP_NEAREST"],[9986,"NEAREST_MIPMAP_LINEAR"],[9987,"LINEAR_MIPMAP_LINEAR"]]),Bg=[{id:"custom",label:"Custom (manual)",viewportPreset:null,renderScale:null,fpsCap:null,cpuThrottleMs:0,refreshHz:null,notes:"Uses host browser/device characteristics."},{id:"small-phone",label:"iPhone SE (2022)",viewportPreset:"375x667",renderScale:1,fpsCap:60,cpuThrottleMs:7,refreshHz:60,notes:"Small phone class; constrained thermal/perf budget."},{id:"big-phone",label:"iPhone 15 Pro Max",viewportPreset:"430x932",renderScale:1,fpsCap:120,cpuThrottleMs:3,refreshHz:120,notes:"Large high-DPI phone class with ProMotion."},{id:"tablet",label:'iPad Air 10.9"',viewportPreset:"820x1180",renderScale:1,fpsCap:60,cpuThrottleMs:4,refreshHz:60,notes:"Tablet class with larger render surface."},{id:"laptop",label:'13" Laptop (1366x768)',viewportPreset:"1366x768",renderScale:1,fpsCap:60,cpuThrottleMs:1,refreshHz:60,notes:"Mainstream laptop class baseline."}],Ng=1.2,Ci=Object.freeze({hand:2,leg:2,expression:1}),Pb=Object.freeze({hand:[1,2],leg:[3,4],expression:[5]}),At=Object.freeze({boneColor:61664,boneAlpha:.94,jointOuterColor:61664,jointOuterAlpha:1,jointInnerColor:728868,jointInnerAlpha:.98,lengthToWidthRatio:58,minBoneWidthPx:1.35,maxBoneWidthPx:6.8,taperRatio:.32,taperWidthScale:2.4,minJointRadiusPx:2.8,maxJointRadiusPx:8.8,jointRadiusScale:1.75,jointInnerRadiusRatio:.58}),no=Object.freeze({auto:"auto",raw:"raw",spine:"spine"}),Ba=Object.freeze({perspective:"perspective",force2d:"force2d"}),fn=Object.freeze({spineFirst:"spine-first",fbxFirst:"fbx-first"}),_N="full-hierarchy",wN="auto-add-bones",Uf=1e3,Ib=30,xh=Object.freeze({yawDeg:-24,pitchDeg:16,cameraDistance:290}),k={imageInput:document.getElementById("imageInput"),atlasInput:document.getElementById("atlasInput"),jsonInput:document.getElementById("jsonInput"),animationsInput:document.getElementById("animationsInput"),retargetFbxInput:document.getElementById("retargetFbxInput"),retargetAnimationNameInput:document.getElementById("retargetAnimationNameInput"),retargetSkeletonConvertToggle:document.getElementById("retargetSkeletonConvertToggle"),retargetSkeletonModeField:document.getElementById("retargetSkeletonModeField"),retargetSkeletonModeSelect:document.getElementById("retargetSkeletonModeSelect"),retargetPreviewButton:document.getElementById("retargetPreviewButton"),retargetDownloadButton:document.getElementById("retargetDownloadButton"),retargetStatus:document.getElementById("retargetStatus"),retargetWarnings:document.getElementById("retargetWarnings"),addButton:document.getElementById("addButton"),loadStatus:document.getElementById("loadStatus"),warnings:document.getElementById("warnings"),historyStatus:document.getElementById("historyStatus"),historyList:document.getElementById("historyList"),mipmapToggle:document.getElementById("mipmapToggle"),potOverrideToggle:document.getElementById("potOverrideToggle"),deviceProfileSelect:document.getElementById("deviceProfileSelect"),deviceProfileStatus:document.getElementById("deviceProfileStatus"),viewportPreset:document.getElementById("viewportPreset"),renderScaleSelect:document.getElementById("renderScaleSelect"),fpsCapSelect:document.getElementById("fpsCapSelect"),panToggle:document.getElementById("panToggle"),scale025:document.getElementById("scale025"),scale05:document.getElementById("scale05"),scale10:document.getElementById("scale10"),animationSelectionSummary:document.getElementById("animationSelectionSummary"),animationSearchInput:document.getElementById("animationSearchInput"),primaryAnimationList:document.getElementById("primaryAnimationList"),fbxAnimationList:document.getElementById("fbxAnimationList"),secondaryHandAnimationList:document.getElementById("secondaryHandAnimationList"),secondaryLegAnimationList:document.getElementById("secondaryLegAnimationList"),secondaryExpressionAnimationList:document.getElementById("secondaryExpressionAnimationList"),clearAllSecondaryAnimationsButton:document.getElementById("clearAllSecondaryAnimationsButton"),boneList:document.getElementById("boneList"),slotList:document.getElementById("slotList"),attachmentSearchInput:document.getElementById("attachmentSearchInput"),attachmentList:document.getElementById("attachmentList"),potStatus:document.getElementById("potStatus"),renderResolutionTag:document.getElementById("renderResolutionTag"),mipEstimateTag:document.getElementById("mipEstimateTag"),mipActiveTag:document.getElementById("mipActiveTag"),perfTag:document.getElementById("perfTag"),mipmapBadge:document.getElementById("mipmapBadge"),verificationPanel:document.getElementById("verificationPanel"),logsPanel:document.getElementById("logsPanel"),clearLogsButton:document.getElementById("clearLogsButton"),debugOverlay:document.getElementById("debugOverlay"),deviceFrame:document.getElementById("deviceFrame"),stageWrap:document.querySelector(".stage-wrap"),pixiHost:document.getElementById("pixiHost"),localZoomIn:document.getElementById("localZoomIn"),localZoomOut:document.getElementById("localZoomOut"),skeletonToggleButton:document.getElementById("skeletonToggleButton"),fbxPreviewCard:document.getElementById("fbxPreviewCard"),fbxPreviewCanvas:document.getElementById("fbxPreviewCanvas"),fbxPreviewSourceSelect:document.getElementById("fbxPreviewSourceSelect"),fbxPreviewViewSelect:document.getElementById("fbxPreviewViewSelect"),fbxPreviewPlayPauseButton:document.getElementById("fbxPreviewPlayPauseButton"),fbxPreviewResetButton:document.getElementById("fbxPreviewResetButton"),fbxPreviewScrubber:document.getElementById("fbxPreviewScrubber"),fbxPreviewSpeedSelect:document.getElementById("fbxPreviewSpeedSelect"),fbxPreviewBonesToggle:document.getElementById("fbxPreviewBonesToggle"),fbxPreviewJointsToggle:document.getElementById("fbxPreviewJointsToggle"),fbxPreviewActiveAnimation:document.getElementById("fbxPreviewActiveAnimation"),fbxPreviewMeta:document.getElementById("fbxPreviewMeta"),fbxPreviewEmptyState:document.getElementById("fbxPreviewEmptyState")},Gt=new g0({resizeTo:k.pixiHost,antialias:!0,backgroundAlpha:0,autoDensity:!0,resolution:window.devicePixelRatio||1});k.pixiHost.appendChild(Gt.view);const Na=new $e;Gt.stage.addChild(Na);const I={spineObject:null,pages:[],objectUrls:[],zoom:1,dragOffsetX:0,dragOffsetY:0,dragging:!1,dragStartX:0,dragStartY:0,dragStartOffsetX:0,dragStartOffsetY:0,panEnabled:!1,panOffsetX:0,panDirection:1,requestedMipmaps:!0,npotWarnings:[],lastVerification:null,frameMsEwma:16.67,lastFrameTimestamp:0,historySupported:typeof indexedDB<"u",historyRecords:[],sharedHistoryRecords:[],historyPreviewUrls:[],activeHistoryRecordId:null,viewportBaseScale:1,localScreenZoom:1,activeDeviceProfileId:"custom",simulatedCpuThrottleMs:0,applyingDeviceProfile:!1,animationCatalog:{primary:[],fbx:[],hand:[],leg:[],expression:[]},selectedPrimaryAnimation:null,selectedSecondaryAnimations:{hand:[],leg:[],expression:[]},setupDrawOrderNames:[],setupDrawOrderIndexByName:new Map,animationSearchQuery:"",attachmentSearchQuery:"",logs:[],retargetBusy:!1,defaultRetargetBundlePromise:null,skeletonVisibilityByCharacter:new Map,currentSkeletonCharacterKey:null,skeletonVisible:!1,skeletonOverlayGraphics:null,lastLoadedBundle:null,suppressManualPotAutoReload:!1,manualPotReloadInFlight:!1,fbxPreviewMap:new Map,fbxPreviewVisible:!1,fbxPreviewPlaying:!0,fbxPreviewTimeSec:0,fbxPreviewSpeed:1,fbxPreviewSourceMode:no.auto,fbxPreviewViewMode:Ba.perspective,fbxPreviewShowBones:!0,fbxPreviewShowJoints:!0,fbxPreviewSamplerSpine:null,fbxPreviewSamplerAnim:null,fbxPreviewSamplerData:null,fbxPreviewResolvedSource:"none",fbxPreviewContextMessage:"No FBX preview data loaded.",fbxPreviewLastAnimation:null,fbxPreviewAutoOpenedOnce:!1};function pe(n,t="info"){k.loadStatus.textContent=n,go("loader",n,t==="error"?"error":t==="warn"?"warn":"info"),t==="error"?k.loadStatus.style.color="#ff5f67":t==="warn"?k.loadStatus.style.color="#ffb347":k.loadStatus.style.color="#d8e2f1"}function Vf(n=[]){if(!n.length){k.warnings.textContent="";return}k.warnings.innerHTML=n.map(t=>`<div>- ${SN(t)}</div>`).join("");for(const t of n)go("warning",t,"warn")}function Bn(n,t="info"){k.retargetStatus&&(k.retargetStatus.textContent=n,go("retarget",n,t==="error"?"error":t==="warn"?"warn":"info"),t==="error"?k.retargetStatus.style.color="#ff5f67":t==="warn"?k.retargetStatus.style.color="#ffb347":k.retargetStatus.style.color="#d8e2f1")}function Xf(n=[]){if(k.retargetWarnings){if(!n.length){k.retargetWarnings.textContent="No conversion report yet.";return}k.retargetWarnings.textContent=n.map(t=>`- ${t}`).join(`
`)}}function ci(n,t){k.mipmapBadge.textContent=n,Ur(k.mipmapBadge,t)}function Ur(n,t){n.className="badge",t==="ok"?n.classList.add("badge-ok"):t==="warn"?n.classList.add("badge-warn"):t==="bad"?n.classList.add("badge-bad"):n.classList.add("badge-neutral")}function SN(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function EN(n){if(!n)return"unknown time";try{return new Date(n).toLocaleString()}catch{return"unknown time"}}function TN(n,t){return((t==null?void 0:t.name)||(n==null?void 0:n.name)||"character").replace(/\.[^.]+$/,"")||"character"}function dn(n){if(typeof n!="string"||!n.trim())return null;const t=n.trim();if(/^(https?:|data:|blob:)/i.test(t))return t;const e="/",r=e.endsWith("/")?e:`${e}/`,i=t.replace(/^\/+/,"");return`${r}${i}`}function Cb(n,t){if(!n||typeof n=="string"&&n.startsWith("data:"))return t;try{const e=new URL(n,window.location.href);return decodeURIComponent(e.pathname.split("/").pop()||"")||t}catch{return n.split("/").pop()||t}}function AN(n,t="application/octet-stream"){const e=String(n||"").toLowerCase();return e.endsWith(".png")?"image/png":e.endsWith(".webp")?"image/webp":e.endsWith(".atlas")?"text/plain":e.endsWith(".json")?"application/json":e.endsWith(".skel")?"application/octet-stream":t}function MN(n){if(typeof n=="number"&&Number.isFinite(n))return n;if(typeof n=="string"){const t=Date.parse(n);if(Number.isFinite(t))return t}return 0}function wp(n){return(n==null?void 0:n.sourceType)===Mb&&!!(n!=null&&n.sharedBundle)}function PN(n,t){if(!n||typeof n!="object")return null;const e=Array.isArray(n.images)?n.images:[],r=e.map(v=>dn(v)).filter(Boolean),i=Array.isArray(n.imageNames)?n.imageNames.map(v=>typeof v=="string"?v.trim():"").filter(Boolean):[],a=dn(n.atlas),s=dn(n.skeleton||n.json),o=dn(n.animations||n.animationsFile||null),u=dn(n.preview||e[0]||null);if(!r.length||!a||!s)return null;const l=Cb(s,`character-${t+1}.json`).replace(/\.[^.]+$/,"")||`shared-character-${t+1}`,c=n.id?`shared-${n.id}`:`shared-${t+1}`,f=n.potOverride,p={potOverride:f===!0||!!(f&&typeof f=="object"&&(f.enabled===!0||Number.isInteger(f.width)&&Number.isInteger(f.height)&&f.width>0&&f.height>0)),mipmapsEnabled:typeof n.mipmapsEnabled=="boolean"?n.mipmapsEnabled:void 0};return{id:c,name:n.name||l,createdAt:MN(n.createdAt),imageCount:r.length,sourceType:Mb,previewUrl:u,sharedSettings:p,sharedBundle:{images:r,imageNames:i,atlas:a,skeleton:s,animations:o}}}async function mi(n,t,e){const r=await fetch(n,{cache:"no-store"});if(!r.ok)throw new Error(`Unable to fetch shared asset (${r.status}): ${n}`);const i=await r.blob(),a=Cb(n,t),s=i.type||AN(a,e);return new File([i],a,{type:s})}async function IN(n){if(!wp(n))throw new Error("History record is not a shared bundle.");const t=n.sharedBundle,e=await Promise.all(t.images.map((s,o)=>{var u;return mi(s,((u=t.imageNames)==null?void 0:u[o])||`image-${o+1}.png`,"image/png")})),r=await mi(t.atlas,"character.atlas","text/plain"),i=await mi(t.skeleton,"character.json","application/octet-stream"),a=t.animations?await mi(t.animations,"animations.json","application/json"):null;return{imageFiles:e,atlasFile:r,jsonFile:i,animationsFile:a}}function CN(n){const t=n==null?void 0:n.sharedSettings;if(!(!t||typeof t!="object")){if(Object.prototype.hasOwnProperty.call(t,"mipmapsEnabled")){const e=!!t.mipmapsEnabled;k.mipmapToggle.checked=e,I.requestedMipmaps=e}if(Object.prototype.hasOwnProperty.call(t,"potOverride")){const e=t.potOverride,r=e===!0||!!(e&&typeof e=="object");I.suppressManualPotAutoReload=!0;try{k.potOverrideToggle.checked=!!r,Gf(),k.potOverrideToggle.dispatchEvent(new Event("change"))}finally{I.suppressManualPotAutoReload=!1}}}}async function RN(){const n=dn(xN);if(!n){I.sharedHistoryRecords=[],await Xr();return}try{const t=await fetch(n,{cache:"no-store"});if(t.status===404){I.sharedHistoryRecords=[],await Xr();return}if(!t.ok)throw new Error(`Failed to fetch shared history manifest (${t.status}).`);const e=await t.json(),i=(Array.isArray(e)?e:Array.isArray(e==null?void 0:e.characters)?e.characters:[]).map((a,s)=>PN(a,s)).filter(Boolean);I.sharedHistoryRecords=i,await Xr()}catch(t){console.error(t),I.sharedHistoryRecords=[],await Xr(),Lr(t.message||"Failed to load shared history manifest.","warn")}}function FN(){return I.historySupported?new Promise((n,t)=>{const e=indexedDB.open(gN,yN);e.onupgradeneeded=()=>{const r=e.result;r.objectStoreNames.contains(sl)||r.createObjectStore(sl,{keyPath:"id"})},e.onsuccess=()=>n(e.result),e.onerror=()=>t(e.error||new Error("Failed to open history database."))}):Promise.reject(new Error("IndexedDB is not available in this browser."))}function Fl(n,t){return FN().then(e=>new Promise((r,i)=>{const a=e.transaction(sl,n),s=a.objectStore(sl);t(s,r,i),a.oncomplete=()=>e.close(),a.onerror=()=>i(a.error||new Error("History transaction failed.")),a.onabort=()=>i(a.error||new Error("History transaction aborted."))}))}async function ON(){return(await Fl("readonly",(t,e,r)=>{const i=t.getAll();i.onsuccess=()=>e(i.result||[]),i.onerror=()=>r(i.error||new Error("Failed to read history."))})).sort((t,e)=>(e.createdAt||0)-(t.createdAt||0))}async function BN(n){return Fl("readonly",(t,e,r)=>{const i=t.get(n);i.onsuccess=()=>e(i.result||null),i.onerror=()=>r(i.error||new Error("Failed to read history record."))})}async function NN(n){return Fl("readwrite",(t,e,r)=>{const i=t.put(n);i.onsuccess=()=>e(),i.onerror=()=>r(i.error||new Error("Failed to save history record."))})}async function kN(n){return Fl("readwrite",(t,e,r)=>{const i=t.delete(n);i.onsuccess=()=>e(),i.onerror=()=>r(i.error||new Error("Failed to delete history record."))})}function Lr(n,t="neutral"){k.historyStatus.textContent=n,go("history",n,t==="error"?"error":t==="warn"?"warn":"info"),t==="error"?k.historyStatus.style.color="#ff5f67":t==="warn"?k.historyStatus.style.color="#ffb347":k.historyStatus.style.color="#95a3bb"}function cs(n,t,e){if(n instanceof File)return n;if(n instanceof Blob)return new File([n],t,{type:n.type||e||"application/octet-stream"});throw new Error(`History file is invalid: ${t}`)}function LN(){for(const n of I.historyPreviewUrls)URL.revokeObjectURL(n);I.historyPreviewUrls=[]}function DN(n){var e;if(wp(n)&&n.previewUrl)return n.previewUrl;const t=(e=n.imageFiles)==null?void 0:e[0];if(!t)return null;try{const r=cs(t,"preview.png","image/png"),i=URL.createObjectURL(r);return I.historyPreviewUrls.push(i),i}catch{return null}}function UN(n){const t=document.createElement("li"),e=document.createElement("div"),r=document.createElement("img"),i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),o=document.createElement("button"),u=document.createElement("button"),h=document.createElement("div"),l=document.createElement("span"),c=wp(n);e.className="history-thumb",i.className="history-content",a.className="history-header",s.className="history-actions",u.className="history-delete",h.className="history-meta",l.className="history-active-badge",l.textContent="Active",n.id===I.activeHistoryRecordId&&l.classList.add("is-active");const f=DN(n);return r.alt=`${n.name||"character"} thumbnail`,f?r.src=f:r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><rect width="64" height="64" fill="#101827"/><circle cx="32" cy="24" r="10" fill="#3f5376"/><rect x="16" y="38" width="32" height="14" rx="6" fill="#324663"/></svg>'),e.appendChild(r),o.type="button",o.textContent=n.name||n.id,o.addEventListener("click",async()=>{try{if(c){pe(`Loading shared entry: ${n.name}`),CN(n);const d=await IN(n);await io(d,{saveHistory:!1,activeHistoryRecordId:n.id})}else{pe(`Loading history entry: ${n.name}`);const d=await BN(n.id);if(!d)throw await Xr(),new Error("History entry no longer exists.");const p=(d.imageFiles||[]).map((y,x)=>cs(y,`image-${x+1}.png`,"image/png")),v=cs(d.atlasFile,d.atlasName||"character.atlas","text/plain"),m=cs(d.jsonFile,d.jsonName||"character.json","application/octet-stream"),g=d.animationsFile?cs(d.animationsFile,d.animationsName||"animations.json","application/json"):null;await io({imageFiles:p,atlasFile:v,jsonFile:m,animationsFile:g},{saveHistory:!1,activeHistoryRecordId:d.id})}}catch(d){console.error(d),pe(d.message||"Failed to load history entry.","error")}}),u.type="button",u.textContent="Delete",u.addEventListener("click",async()=>{try{I.activeHistoryRecordId===n.id&&(I.activeHistoryRecordId=null),await kN(n.id),await Xr(),pe(`Deleted history entry: ${n.name}`)}catch(d){console.error(d),Lr(d.message||"Failed to delete history entry.","error")}}),h.textContent=c?`${n.imageCount||0} image(s)  shared preset`:`${n.imageCount||0} image(s)  ${EN(n.createdAt)}`,s.appendChild(o),c||s.appendChild(u),a.appendChild(s),a.appendChild(l),i.appendChild(a),i.appendChild(h),t.appendChild(e),t.appendChild(i),t}async function Xr(){LN();const n=Array.from(I.sharedHistoryRecords||[]);let t=[],e=null;if(I.historySupported)try{t=await ON()}catch(i){console.error(i),e=i}const r=[...n,...t].sort((i,a)=>(a.createdAt||0)-(i.createdAt||0));if(I.historyRecords=r,k.historyList.innerHTML="",!r.length){I.historySupported?Lr("No saved characters yet."):Lr("History unavailable in this browser.","warn");return}for(const i of r)k.historyList.appendChild(UN(i));if(e){Lr(e.message||"Failed to load local history.","warn");return}if(!I.historySupported&&n.length){Lr(`${n.length} shared character(s) loaded.`);return}if(n.length&&t.length){Lr(`${r.length} character(s): ${t.length} local + ${n.length} shared.`);return}if(n.length){Lr(`${n.length} shared character(s) loaded.`);return}Lr(`${t.length} saved character(s).`)}function bh(n){return n>0&&(n&n-1)===0}function kg(n){let t=1;for(;t<n;)t<<=1;return t}function Pe(n,t,e){return Math.max(t,Math.min(e,n))}function Lg(n){return n*Math.PI/180}function Rb(n){n instanceof Map?I.fbxPreviewMap=new Map(n):I.fbxPreviewMap=new Map}function Ri(){I.fbxPreviewSamplerSpine&&(!I.fbxPreviewSamplerSpine.destroyed&&!I.fbxPreviewSamplerSpine._destroyed&&I.fbxPreviewSamplerSpine.destroy({children:!0}),I.fbxPreviewSamplerSpine=null,I.fbxPreviewSamplerAnim=null,I.fbxPreviewSamplerData=null)}function Es(n=""){const t=k.fbxPreviewCanvas;if(!t)return;const e=t.getContext("2d");if(!e)return;const r=t.width,i=t.height;e.clearRect(0,0,r,i),e.fillStyle="#0f1621",e.fillRect(0,0,r,i),e.fillStyle="#8fa4c4",e.font='12px "SF Pro Text", "Helvetica Neue", sans-serif',e.textAlign="center",e.textBaseline="middle",e.fillText(n||"No preview data",r*.5,i*.5)}function VN(n){I.fbxPreviewVisible=!!n,k.fbxPreviewCard&&(k.fbxPreviewCard.classList.toggle("is-hidden",!I.fbxPreviewVisible),k.fbxPreviewCard.setAttribute("aria-hidden",String(!I.fbxPreviewVisible)),I.fbxPreviewVisible&&!I.fbxPreviewAutoOpenedOnce&&(k.fbxPreviewCard.open=!0,I.fbxPreviewAutoOpenedOnce=!0))}function Ts(n,t){k.fbxPreviewEmptyState&&(k.fbxPreviewEmptyState.textContent=n,k.fbxPreviewEmptyState.style.display=t?"block":"none")}function Dg(n){const t=!n;k.fbxPreviewPlayPauseButton&&(k.fbxPreviewPlayPauseButton.disabled=t),k.fbxPreviewResetButton&&(k.fbxPreviewResetButton.disabled=t),k.fbxPreviewScrubber&&(k.fbxPreviewScrubber.disabled=t),k.fbxPreviewBonesToggle&&(k.fbxPreviewBonesToggle.disabled=t),k.fbxPreviewJointsToggle&&(k.fbxPreviewJointsToggle.disabled=t)}function zf(){k.fbxPreviewPlayPauseButton&&(k.fbxPreviewPlayPauseButton.textContent=I.fbxPreviewPlaying?"Pause":"Play")}function Sp(n){var t,e,r;return!n||!((r=(e=(t=I.spineObject)==null?void 0:t.spineData)==null?void 0:e.animations)!=null&&r.length)?null:I.spineObject.spineData.animations.find(i=>(i==null?void 0:i.name)===n)||null}function Fb(n){if(!n)return 0;const t=Number(n.duration);if(Number.isFinite(t)&&t>0)return t;const e=Array.isArray(n.frameTimes)?n.frameTimes:[],r=Number(e[e.length-1]);return Number.isFinite(r)&&r>0?r:0}function Ol(n){if(!n||!Ya(n))return{kind:"none",label:"None",message:"Select an FBX primary animation to preview."};const t=I.fbxPreviewMap.get(n)||null,e=Sp(n),r=!!t,i=!!e,a=I.fbxPreviewSourceMode;return a===no.raw?r?{kind:"raw",label:"Raw FBX",message:"Using raw FBX sampled joints.",rawData:t}:i?{kind:"spine",label:"Spine fallback",message:"Raw FBX data unavailable; using Spine fallback.",spineAnimation:e}:{kind:"none",label:"None",message:"Raw FBX and Spine fallback data are unavailable."}:a===no.spine?i?{kind:"spine",label:"Spine fallback",message:"Using Spine animation fallback data.",spineAnimation:e}:r?{kind:"raw",label:"Raw FBX",message:"Spine fallback unavailable; using Raw FBX instead.",rawData:t}:{kind:"none",label:"None",message:"Spine fallback and raw FBX data are unavailable."}:r?{kind:"raw",label:"Raw FBX",message:"Auto source selected Raw FBX data.",rawData:t}:i?{kind:"spine",label:"Spine fallback",message:"Raw FBX cache unavailable; using Spine fallback.",spineAnimation:e}:{kind:"none",label:"None",message:"No preview source is available for this FBX animation."}}function Ep(n,t){if(!n||n.kind==="none")return 0;if(n.kind==="raw")return Fb(n.rawData);const e=n.spineAnimation||Sp(t),r=Number(e==null?void 0:e.duration);return Number.isFinite(r)&&r>0?r:0}function XN(n){var t;if((n==null?void 0:n.kind)==="raw"){const e=Number((t=n.rawData)==null?void 0:t.fps);if(Number.isFinite(e)&&e>0)return e}return Ib}function zN(n,t){if(!Number.isFinite(t)||t<=0)return 0;const e=n%t;return e<0?e+t:e}function Ob(n,t){return!Number.isFinite(t)||t<=0||t<=1e-4?0:Pe(n,0,t-1e-4)}function GN(n,t){if(!Array.isArray(n)||!n.length)return{indexA:0,indexB:0,alpha:0};if(n.length===1||t<=n[0])return{indexA:0,indexB:0,alpha:0};const e=n.length-1;if(t>=n[e])return{indexA:e,indexB:e,alpha:0};let r=0,i=e;for(;r<=i;){const c=Math.floor((r+i)/2);n[c]<=t?r=c+1:i=c-1}const a=Pe(i,0,e),s=Pe(a+1,0,e),o=n[a],h=n[s]-o,l=h>1e-6?(t-o)/h:0;return{indexA:a,indexB:s,alpha:Pe(l,0,1)}}function YN(n,t){if(!n)return null;const e=Array.isArray(n.frameTimes)?n.frameTimes:[],r=Array.isArray(n.jointTracks)?n.jointTracks:[];if(!r.length)return null;const i=Fb(n),a=Ob(t,i),s=GN(e,a),o=[];for(const u of r){const h=Array.isArray(u==null?void 0:u.positions)?u.positions:[];if(!h.length)continue;const l=h[Pe(s.indexA,0,h.length-1)]||h[0],c=h[Pe(s.indexB,0,h.length-1)]||l,f=s.alpha;o.push({name:u.name||"",parentName:u.parentName||null,x:((l==null?void 0:l.x)||0)*(1-f)+((c==null?void 0:c.x)||0)*f,y:((l==null?void 0:l.y)||0)*(1-f)+((c==null?void 0:c.y)||0)*f,z:((l==null?void 0:l.z)||0)*(1-f)+((c==null?void 0:c.z)||0)*f})}return{joints:o,duration:i,fps:Number(n.fps)||Ib,currentTime:a,frameIndex:Math.min(s.indexA+1,e.length||1),frameCount:Math.max(1,e.length),sourceFile:n.sourceFile||null,clipName:n.clipName||null}}function WN(n){var i;const t=((i=I.spineObject)==null?void 0:i.spineData)||null;if(!t||!n)return null;if(!(!I.fbxPreviewSamplerSpine||I.fbxPreviewSamplerAnim!==n||I.fbxPreviewSamplerData!==t))return I.fbxPreviewSamplerSpine;Ri();const r=new Sx(t);return r.visible=!1,r.alpha=0,r.autoUpdate=!1,r.skeleton.setToSetupPose(),r.state.setAnimation(0,n,!0),r.update(0),I.fbxPreviewSamplerSpine=r,I.fbxPreviewSamplerAnim=n,I.fbxPreviewSamplerData=t,r}function HN(n,t,e){var d,p,v,m,g;const r=WN(n);if(!r)return null;const i=(e==null?void 0:e.spineAnimation)||Sp(n);if(!i)return null;const a=Math.max(0,Number(i.duration)||0),s=Ob(t,a),o=r.state.getCurrent(0);(!o||((d=o.animation)==null?void 0:d.name)!==n)&&r.state.setAnimation(0,n,!0);const u=r.state.getCurrent(0);u&&(u.trackTime=s),r.skeleton.setToSetupPose(),r.state.apply(r.skeleton),r.skeleton.updateWorldTransform();const h=[],l=((p=r.skeleton)==null?void 0:p.bones)||[];for(const y of l)h.push({name:((v=y==null?void 0:y.data)==null?void 0:v.name)||"",parentName:((g=(m=y==null?void 0:y.parent)==null?void 0:m.data)==null?void 0:g.name)||null,x:Number.isFinite(y==null?void 0:y.worldX)?y.worldX:0,y:Number.isFinite(y==null?void 0:y.worldY)?y.worldY:0,z:0});const c=XN(e),f=Math.max(1,Math.round(a*c));return{joints:h,duration:a,fps:c,currentTime:s,frameIndex:Math.min(f,Math.max(1,Math.floor(s*c)+1)),frameCount:f,sourceFile:null,clipName:n}}function jN(n,t){const e=Number(n==null?void 0:n.x)||0,r=Number(n==null?void 0:n.y)||0,i=Number(n==null?void 0:n.z)||0;if(t===Ba.force2d)return{x:e,y:r};const a=Lg(xh.yawDeg),s=Lg(xh.pitchDeg),o=e*Math.cos(a)-i*Math.sin(a),u=e*Math.sin(a)+i*Math.cos(a),h=r*Math.cos(s)-u*Math.sin(s),l=r*Math.sin(s)+u*Math.cos(s),c=xh.cameraDistance+l,f=xh.cameraDistance/Math.max(24,c);return{x:o*f,y:h*f}}function $N(n,t,e,r){n.fillStyle="#0d141f",n.fillRect(0,0,t,e),n.strokeStyle="rgba(107, 132, 170, 0.24)",n.lineWidth=1;const i=24;for(let a=0;a<=t;a+=i)n.beginPath(),n.moveTo(a+.5,0),n.lineTo(a+.5,e),n.stroke();for(let a=0;a<=e;a+=i)n.beginPath(),n.moveTo(0,a+.5),n.lineTo(t,a+.5),n.stroke();n.strokeStyle="rgba(175, 205, 255, 0.4)",n.beginPath(),n.moveTo(0,e*.5+.5),n.lineTo(t,e*.5+.5),n.stroke(),n.fillStyle="#91abc9",n.font='11px "SF Pro Text", "Helvetica Neue", sans-serif',n.textAlign="left",n.textBaseline="top",n.fillText(r===Ba.force2d?"Force 2D":"Perspective",8,7)}function mc(n,t=1){const e=Number.isFinite(n)?Math.floor(n)>>>0:0,r=Pe(Number(t)||0,0,1),i=e>>16&255,a=e>>8&255,s=e&255;return`rgba(${i}, ${a}, ${s}, ${r})`}function qN(n){const t=Math.max(0,n)/At.lengthToWidthRatio;return Pe(t,At.minBoneWidthPx,At.maxBoneWidthPx)}function ZN(n){return Pe(Math.max(n*At.jointRadiusScale,At.minJointRadiusPx),At.minJointRadiusPx,At.maxJointRadiusPx)}function KN(n,t,e,r){const i=e.screenX-t.screenX,a=e.screenY-t.screenY,s=Math.hypot(i,a);if(!Number.isFinite(s)||s<=1e-4)return;const o=i/s,u=a/s,h=-u,l=o,c=Math.min(s*At.taperRatio,r*At.taperWidthScale),f=Math.max(s-c,0),d=t.screenX+o*f-h*r,p=t.screenY+u*f-l*r,v=t.screenX+o*f+h*r,m=t.screenY+u*f+l*r;n.beginPath(),n.moveTo(t.screenX,t.screenY),n.lineTo(d,p),n.lineTo(e.screenX,e.screenY),n.lineTo(v,m),n.closePath(),n.fill()}function JN(n){const t=k.fbxPreviewCanvas;if(!t)return;const e=t.getContext("2d");if(!e)return;const r=t.width,i=t.height;$N(e,r,i,I.fbxPreviewViewMode);const a=Array.isArray(n==null?void 0:n.joints)?n.joints:[];if(!a.length){e.fillStyle="#8fa4c4",e.font='12px "SF Pro Text", "Helvetica Neue", sans-serif',e.textAlign="center",e.textBaseline="middle",e.fillText("No joints available",r*.5,i*.5);return}const s=[];let o=1/0,u=-1/0,h=1/0,l=-1/0;for(const S of a){const E=jN(S,I.fbxPreviewViewMode);!Number.isFinite(E.x)||!Number.isFinite(E.y)||(o=Math.min(o,E.x),u=Math.max(u,E.x),h=Math.min(h,E.y),l=Math.max(l,E.y),s.push({name:S.name||"",parentName:S.parentName||null,x:E.x,y:E.y}))}if(!s.length){Es("No projected joints");return}const c=Math.max(1,u-o),f=Math.max(1,l-h),d=20,p=Math.min((r-d*2)/c,(i-d*2)/f),v=(o+u)*.5,m=(h+l)*.5,g=r*.5,y=i*.56,x=new Map;for(const S of s){const E=g+(S.x-v)*p,T=y-(S.y-m)*p;x.set(S.name,{...S,screenX:E,screenY:T})}const b=[],_=new Map,w=(S,E)=>{if(!S||!Number.isFinite(E))return;const T=_.get(S);(!Number.isFinite(T)||E>T)&&_.set(S,E)};for(const S of x.values()){if(!S.parentName){w(S.name,At.minJointRadiusPx);continue}const E=x.get(S.parentName);if(!E){w(S.name,At.minJointRadiusPx);continue}const T=Math.hypot(S.screenX-E.screenX,S.screenY-E.screenY),A=qN(T);b.push({fromPoint:E,toPoint:S,boneWidth:A});const P=ZN(A);w(E.name,P),w(S.name,P)}if(I.fbxPreviewShowBones){e.fillStyle=mc(At.boneColor,At.boneAlpha);for(const S of b)KN(e,S.fromPoint,S.toPoint,S.boneWidth)}if(I.fbxPreviewShowJoints){e.fillStyle=mc(At.jointOuterColor,At.jointOuterAlpha);for(const S of x.values()){const E=_.get(S.name)||At.minJointRadiusPx;e.beginPath(),e.arc(S.screenX,S.screenY,E,0,Math.PI*2),e.fill()}e.fillStyle=mc(At.jointInnerColor,At.jointInnerAlpha);for(const S of x.values()){const E=_.get(S.name)||At.minJointRadiusPx,T=Math.max(Math.min(E*At.jointInnerRadiusRatio,E-1e-4),0);T<=1e-4||(e.beginPath(),e.arc(S.screenX,S.screenY,T,0,Math.PI*2),e.fill())}}}function gc(n){if(!k.fbxPreviewScrubber)return;const t=Number(k.fbxPreviewScrubber.max)||Uf;if(!Number.isFinite(n)||n<=0){k.fbxPreviewScrubber.value="0";return}const e=Pe(I.fbxPreviewTimeSec/n,0,1);k.fbxPreviewScrubber.value=String(Math.round(e*t))}function Ch(n,t,e){if(k.fbxPreviewActiveAnimation&&(k.fbxPreviewActiveAnimation.textContent=`Active animation: ${e||"-"}`),!k.fbxPreviewMeta)return;if(!t){k.fbxPreviewMeta.textContent=(n==null?void 0:n.message)||"No preview sample available.";return}const r=(n==null?void 0:n.kind)==="spine"&&I.fbxPreviewViewMode===Ba.perspective?"Perspective uses 2D Spine fallback data.":"",i=t.sourceFile||t.clipName||"n/a";k.fbxPreviewMeta.textContent=`Source: ${(n==null?void 0:n.label)||"None"} | FPS: ${t.fps.toFixed(1)} | Frame: ${t.frameIndex}/${t.frameCount} | Time: ${t.currentTime.toFixed(2)}s / ${t.duration.toFixed(2)}s | Joints: ${t.joints.length} | Clip: ${i}`+(r?` | ${r}`:"")}function Fi(){const n=I.selectedPrimaryAnimation||null,t=!!(n&&Ya(n));if(VN(t),!t){I.fbxPreviewResolvedSource="none",I.fbxPreviewContextMessage="Select an FBX primary animation to preview.",I.fbxPreviewLastAnimation=null,I.fbxPreviewTimeSec=0,Dg(!1),Ts("Select an FBX primary animation to preview skeleton motion.",!0),Ch({message:I.fbxPreviewContextMessage},null,null),Ri(),Es("FBX preview hidden");return}I.fbxPreviewLastAnimation!==n&&(I.fbxPreviewLastAnimation=n,I.fbxPreviewTimeSec=0,Ri());const e=Ol(n);I.fbxPreviewResolvedSource=e.kind,I.fbxPreviewContextMessage=e.message||"";const r=e.kind!=="none";Dg(r),Ts(e.message||"No preview source available.",!r),zf()}function QN(n){if(!I.fbxPreviewVisible||!I.fbxPreviewPlaying)return;const t=I.selectedPrimaryAnimation;if(!t||!Ya(t))return;const e=Ol(t),r=Ep(e,t);if(!Number.isFinite(r)||r<=0)return;const i=(Number(n)||0)/1e3,a=Number.isFinite(I.fbxPreviewSpeed)?I.fbxPreviewSpeed:1;I.fbxPreviewTimeSec=zN(I.fbxPreviewTimeSec+i*a,r)}function hn(){var i;if(!I.fbxPreviewVisible)return;const n=I.selectedPrimaryAnimation;if(!n||!Ya(n)){Es("No FBX animation selected");return}const t=Ol(n);if(I.fbxPreviewResolvedSource=t.kind,I.fbxPreviewContextMessage=t.message||"",t.kind==="none"){Ch(t,null,n),Ts(t.message||"No preview source available.",!0),Es("No source available"),gc(0);return}const e=Ep(t,n);e>0?I.fbxPreviewTimeSec=Pe(I.fbxPreviewTimeSec,0,e):I.fbxPreviewTimeSec=0;const r=t.kind==="raw"?YN(t.rawData,I.fbxPreviewTimeSec):HN(n,I.fbxPreviewTimeSec,t);if(!r||!((i=r.joints)!=null&&i.length)){Ch(t,null,n),Ts("Preview source is available, but no joints were sampled.",!0),Es("No sampled joints"),gc(e);return}Ts(t.message||"",!1),Ch(t,r,n),gc(r.duration),JN(r)}function Bb(n){return Bg.find(t=>t.id===n)||Bg[0]}function Nb(){return Bb(I.activeDeviceProfileId)}function tk(n){I.simulatedCpuThrottleMs=Pe(Number(n)||0,0,20)}function ek(){const n=I.simulatedCpuThrottleMs;if(n<=0)return;const t=performance.now()+n;for(;performance.now()<t;);}function rk(){return k.potOverrideToggle.checked?{enabled:!0,baseSize:vN,padding:mN}:null}function Gf(){const n=k.potOverrideToggle.checked;k.potOverrideToggle.setAttribute("aria-checked",n?"true":"false")}function ol(n){return n.split("/").pop().split("\\").pop()}function Ug(n){return ol(n).replace(/\.[^.]+$/,"").toLowerCase()}function kb(n){return I.objectUrls.push(n),n}function Lb(n){return kb(URL.createObjectURL(n))}function nk(n,t="text/plain"){const e=new Blob([n],{type:t});return kb(URL.createObjectURL(e))}function Vg(){for(const n of I.objectUrls)URL.revokeObjectURL(n);I.objectUrls=[]}function yc(n,t){const e=n.indexOf(":");if(e<0)throw new Error(`Atlas parse error (${t}): expected key/value pair.`);const r=n.slice(0,e).trim(),i=n.slice(e+1).trim();if(!r)throw new Error(`Atlas parse error (${t}): empty key.`);return{key:r,value:i}}function Yf(n,t){const e=String(n??"").trim();if(!/^-?\d+$/.test(e))throw new Error(`Atlas parse error (${t}): expected integer, got "${n}".`);return Number.parseInt(e,10)}function _h(n,t){const e=String(n??"").split(",").map(r=>r.trim()).filter(Boolean);if(e.length!==2)throw new Error(`Atlas parse error (${t}): expected pair "x, y", got "${n}".`);return[Yf(e[0],t),Yf(e[1],t)]}function ik(n,t){const e=String(n??"").trim().toLowerCase();if(e==="true")return!0;if(e==="false")return!1;if(/^-?\d+$/.test(e))return Number.parseInt(e,10);throw new Error(`Atlas parse error (${t}): invalid rotate value "${n}".`)}function Db(n,t){return`${n}, ${t}`}function ak(n){return{pages:n.pages.map(t=>({name:t.name,meta:t.meta.map(e=>({key:e.key,value:e.value})),regions:t.regions.map(e=>({name:e.name,fields:e.fields.map(r=>({key:r.key,value:r.value})),parsed:{rotate:e.parsed.rotate,xy:[...e.parsed.xy],size:[...e.parsed.size],orig:[...e.parsed.orig],offset:[...e.parsed.offset],index:e.parsed.index}}))}))}}function sk(n,t,e){const r=String(e),i=n.fields.find(a=>a.key===t);i?i.value=r:n.fields.push({key:t,value:r})}function hs(n,t){const e=n.meta.find(r=>r.key===t);return e==null?void 0:e.value}function wh(n,t,e){const r=String(e),i=n.meta.find(a=>a.key===t);i?i.value=r:n.meta.push({key:t,value:r})}function ok(n){const t=n.replace(/\r/g,"").split(`
`),e=t.length,r=[];let i=0;const a=o=>{for(let u=o;u<e;u+=1)if(t[u].trim())return u;return-1},s=o=>{if(o<0||o>=e)return!1;const u=t[o],h=u.trim();if(!h||h.includes(":")||/^\s/.test(u))return!1;const l=a(o+1);if(l<0)return!1;const c=t[l],f=c.trim();if(!f||/^\s/.test(c)||!f.includes(":"))return!1;const{key:d}=yc(f,`line ${l+1}`);return dN.has(d)};for(;;){const o=a(i);if(o<0)break;if(!s(o))throw new Error(`Invalid atlas format near line ${o+1}: expected page header.`);const u=t[o].trim();i=o+1;const h=[];for(;i<e;){const c=t[i],f=c.trim();if(!f){i+=1;break}if(/^\s/.test(c)||!f.includes(":"))break;const{key:d,value:p}=yc(f,`line ${i+1}`);h.push({key:d,value:p}),i+=1}const l=[];for(;i<e;){const c=t[i],f=c.trim();if(!f){i+=1;break}if(s(i))break;if(f.includes(":")||/^\s/.test(c))throw new Error(`Invalid atlas format near line ${i+1}: expected region name.`);const d=f;i+=1;const p=[];for(;i<e;){const m=t[i],g=m.trim();if(!g){i+=1;break}if(!/^\s/.test(m))break;const{key:y,value:x}=yc(g,`line ${i+1}`);p.push({key:y,value:x}),i+=1}const v=new Map(p.map(m=>[m.key,m.value]));for(const m of pN)if(!v.has(m))throw new Error(`Invalid atlas format: region "${d}" on page "${u}" is missing required field "${m}".`);l.push({name:d,fields:p,parsed:{rotate:ik(v.get("rotate"),`region "${d}" rotate`),xy:_h(v.get("xy"),`region "${d}" xy`),size:_h(v.get("size"),`region "${d}" size`),orig:_h(v.get("orig"),`region "${d}" orig`),offset:_h(v.get("offset"),`region "${d}" offset`),index:Yf(v.get("index"),`region "${d}" index`)}})}if(!l.length)throw new Error(`Invalid atlas format: page "${u}" does not contain any regions.`);r.push({name:u,meta:h,regions:l})}if(!r.length)throw new Error("No atlas page headers found in .atlas file.");return{pages:r}}function hk(n){const t=[];return n.pages.forEach((e,r)=>{r>0&&t.push(""),t.push(e.name);for(const i of e.meta)t.push(`${i.key}: ${i.value}`);for(const i of e.regions){t.push(i.name);for(const a of i.fields)t.push(`  ${a.key}: ${a.value}`)}}),t.join(`
`)}async function lk(n){return new Promise((t,e)=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error(`Unable to decode image ${n}`)),r.src=n})}function uk(n){if(typeof n=="boolean")return n;if(typeof n=="number")return Math.abs(n)%180===90;const t=String(n??"").trim().toLowerCase();if(t==="true")return!0;if(t==="false")return!1;if(/^-?\d+$/.test(t)){const e=Number.parseInt(t,10);return Math.abs(e)%180===90}return!1}function ck(n,t){return!(n.x>=t.x+t.width||n.x+n.width<=t.x||n.y>=t.y+t.height||n.y+n.height<=t.y)}function Xg(n,t){return n.x>=t.x&&n.y>=t.y&&n.x+n.width<=t.x+t.width&&n.y+n.height<=t.y+t.height}function fk(n,t){const e=[];for(const r of n){if(!ck(r,t)){e.push(r);continue}t.x>r.x&&e.push({x:r.x,y:r.y,width:t.x-r.x,height:r.height}),t.x+t.width<r.x+r.width&&e.push({x:t.x+t.width,y:r.y,width:r.x+r.width-(t.x+t.width),height:r.height}),t.y>r.y&&e.push({x:r.x,y:r.y,width:r.width,height:t.y-r.y}),t.y+t.height<r.y+r.height&&e.push({x:r.x,y:t.y+t.height,width:r.width,height:r.y+r.height-(t.y+t.height)})}return e.filter(r=>r.width>0&&r.height>0)}function dk(n){for(let t=0;t<n.length;t+=1)for(let e=t+1;e<n.length;e+=1){if(Xg(n[t],n[e])){n.splice(t,1),t-=1;break}Xg(n[e],n[t])&&(n.splice(e,1),e-=1)}}function pk(n,t,e){let r=null,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;for(const s of n){if(t>s.width||e>s.height)continue;const o=s.width-t,u=s.height-e,h=Math.min(o,u),l=Math.max(o,u);(h<i||h===i&&l<a||h===i&&l===a&&r&&s.y<r.y||h===i&&l===a&&r&&s.y===r.y&&s.x<r.x)&&(i=h,a=l,r={x:s.x,y:s.y,width:t,height:e})}return r}function vk(n,t,e){const r=[{x:0,y:0,width:t,height:e}],i=new Map,a=[...n].sort((s,o)=>{const u=Math.max(s.packWidth,s.packHeight),h=Math.max(o.packWidth,o.packHeight);if(h!==u)return h-u;const l=o.packWidth*o.packHeight,c=s.packWidth*s.packHeight;return l!==c?l-c:s.id-o.id});for(const s of a){const o=pk(r,s.packWidth,s.packHeight);if(!o)return null;i.set(s.id,o);const u=fk(r,o);r.length=0,r.push(...u),dk(r)}return i}function mk(n,t,e,r){const i=kg(Math.max(n,e)),a=kg(Math.max(n,r)),s=[],o=[];for(let h=i;h<=t;h*=2)s.push(h);for(let h=a;h<=t;h*=2)o.push(h);const u=[];for(const h of s)for(const l of o)u.push({width:h,height:l});return u.sort((h,l)=>{const c=h.width*h.height-l.width*l.height;if(c!==0)return c;const f=Math.max(h.width,h.height)-Math.max(l.width,l.height);return f!==0?f:h.width!==l.width?h.width-l.width:h.height-l.height}),u}function gk(n,t,e,r){const i=[],a={name:Ab,meta:n.meta.map(o=>({key:o.key,value:o.value})),regions:[]};wh(a,"size",Db(e,r)),hs(a,"format")||wh(a,"format","RGBA8888"),hs(a,"filter")||wh(a,"filter","Linear,Linear"),hs(a,"repeat")||wh(a,"repeat","none");const s=["format","filter","repeat","pma","scale"];for(const o of s){const u=hs(n,o);for(let h=1;h<t.length;h+=1){const l=t[h],c=hs(l,o);!c||c===u||i.push(`Manual POT merge kept first page ${o}="${u??"(missing)"}" and ignored ${l.name} value "${c}".`)}}return{mergedPage:a,warnings:i}}function yk(n,t,e){const r=ak(n),i=[];let a=1;for(const y of r.pages){const x=t.get(y.name);if(!x)throw new Error(`Manual POT repack failed: no source image found for atlas page "${y.name}".`);for(const b of y.regions){const[_,w]=b.parsed.xy,[S,E]=b.parsed.size,T=uk(b.parsed.rotate),A=T?E:S,P=T?S:E;if(A<=0||P<=0)throw new Error(`Manual POT repack failed: region "${b.name}" has invalid size ${S}x${E}.`);if(_<0||w<0||_+A>x.width||w+P>x.height)throw new Error(`Manual POT repack failed: region "${b.name}" (${_},${w},${A},${P}) exceeds source page "${y.name}" (${x.width}x${x.height}).`);i.push({id:a,pageName:y.name,sourcePage:x,region:b,sourceX:_,sourceY:w,cropWidth:A,cropHeight:P,packWidth:A+e.padding*2,packHeight:P+e.padding*2}),a+=1}}if(!i.length)throw new Error("Manual POT repack failed: atlas contains no regions to repack.");const s=Math.max(...i.map(y=>y.packWidth)),o=Math.max(...i.map(y=>y.packHeight)),u=i.reduce((y,x)=>y+x.packWidth*x.packHeight,0),h=mk(e.baseSize,e.maxTextureSize,s,o);let l=null,c=null;for(const y of h){if(y.width*y.height<u)continue;const x=vk(i,y.width,y.height);if(x){l=y,c=x;break}}if(!l||!c)throw new Error(`Manual POT repack failed: unable to fit ${i.length} regions within MAX_TEXTURE_SIZE ${e.maxTextureSize}.`);const f=document.createElement("canvas");f.width=l.width,f.height=l.height;const d=f.getContext("2d");if(!d)throw new Error("Manual POT repack failed: unable to create 2D canvas context.");d.clearRect(0,0,f.width,f.height);for(const y of i){const x=c.get(y.id);if(!x)throw new Error(`Manual POT repack failed: no placement found for region "${y.region.name}".`);const b=x.x+e.padding,_=x.y+e.padding;d.drawImage(y.sourcePage.image,y.sourceX,y.sourceY,y.cropWidth,y.cropHeight,b,_,y.cropWidth,y.cropHeight),y.region.parsed.xy=[b,_],sk(y.region,"xy",Db(b,_))}const{mergedPage:p,warnings:v}=gk(r.pages[0],r.pages,l.width,l.height);for(const y of r.pages)p.regions.push(...y.regions);const m=[`Manual POT repacked ${i.length} regions from ${r.pages.length} page(s) into ${l.width}x${l.height}.`];(l.width!==e.baseSize||l.height!==e.baseSize)&&m.push(`Manual POT target ${e.baseSize}x${e.baseSize} auto-bumped to ${l.width}x${l.height} to fit atlas content.`),m.push(...v);const g=hk({pages:[p]});return{pageName:Ab,canvas:f,width:l.width,height:l.height,atlasText:g,warnings:m}}async function xk(n){n.valid||await new Promise((t,e)=>{const r=()=>{a(),t()},i=()=>{var s;a(),e(new Error(`BaseTexture failed to load: ${((s=n.resource)==null?void 0:s.url)||"unknown resource"}`))},a=()=>{n.off("loaded",r),n.off("error",i)};n.on("loaded",r),n.on("error",i)})}function bk(){k.primaryAnimationList.innerHTML="",k.fbxAnimationList.innerHTML="",k.secondaryHandAnimationList.innerHTML="",k.secondaryLegAnimationList.innerHTML="",k.secondaryExpressionAnimationList.innerHTML="",k.animationSelectionSummary&&(k.animationSelectionSummary.textContent="Load a character to configure primary and secondary layers."),k.clearAllSecondaryAnimationsButton&&(k.clearAllSecondaryAnimationsButton.disabled=!0),I.animationCatalog={primary:[],fbx:[],hand:[],leg:[],expression:[]},I.selectedPrimaryAnimation=null,I.selectedSecondaryAnimations={hand:[],leg:[],expression:[]},I.setupDrawOrderNames=[],I.setupDrawOrderIndexByName=new Map,k.boneList.innerHTML="",k.slotList.innerHTML="",k.attachmentList.innerHTML=""}function go(n,t,e="info"){if(!k.logsPanel||!t)return;const r=new Date,i={id:r.getTime()+Math.random(),source:n,message:t,level:e,time:r.toLocaleTimeString()};I.logs.unshift(i),I.logs.length>180&&(I.logs.length=180),k.logsPanel.innerHTML="";for(const a of I.logs){const s=document.createElement("li"),o=document.createElement("span"),u=document.createElement("span");s.className=`log-${a.level}`,o.className="log-line-meta",u.className="log-line-text",o.textContent=`${a.time}  ${a.source.toUpperCase()}`,u.textContent=a.message,s.appendChild(o),s.appendChild(u),k.logsPanel.appendChild(s)}}function _k(){I.logs=[],k.logsPanel&&(k.logsPanel.innerHTML="")}function zg(){bk(),I.skeletonOverlayGraphics&&(I.skeletonOverlayGraphics.parent&&I.skeletonOverlayGraphics.parent.removeChild(I.skeletonOverlayGraphics),!I.skeletonOverlayGraphics.destroyed&&!I.skeletonOverlayGraphics._destroyed&&I.skeletonOverlayGraphics.destroy(),I.skeletonOverlayGraphics=null),I.spineObject&&(Na.removeChild(I.spineObject),I.spineObject.destroy({children:!0}),I.spineObject=null);for(const n of I.pages)n.baseTexture&&n.baseTexture.destroy();I.pages=[],I.dragOffsetX=0,I.dragOffsetY=0,I.panOffsetX=0,I.panEnabled=!1,k.panToggle.textContent="Pan: OFF",I.lastVerification=null,I.viewportBaseScale=1,I.currentSkeletonCharacterKey=null,I.skeletonVisible=!1,I.fbxPreviewTimeSec=0,I.fbxPreviewLastAnimation=null,I.fbxPreviewResolvedSource="none",I.fbxPreviewContextMessage="No FBX preview data loaded.",Ri(),Ap(),hl(),Fi()}function zn(){const n=k.pixiHost.clientWidth,t=k.pixiHost.clientHeight;Na.x=n*.5+I.dragOffsetX+I.panOffsetX,Na.y=t*.5+I.dragOffsetY}function hl(){Na.scale.set(I.viewportBaseScale*I.zoom)}function Tp(){if(!I.spineObject){I.viewportBaseScale=1,hl();return}const n=Math.max(1,k.pixiHost.clientWidth),t=Math.max(1,k.pixiHost.clientHeight),e=I.spineObject.getLocalBounds(),r=Math.max(1,e.width),i=Math.max(1,e.height),a=n*.74/r,s=t*.82/i;I.viewportBaseScale=Pe(Math.min(a,s),.04,30),hl()}function As(n){I.zoom=Pe(n,.1,4),hl(),Pr()}function Ub(){Gt.view.style.transform=`scale(${I.localScreenZoom})`}function Gg(n){!Number.isFinite(n)||n<=0||(I.localScreenZoom=n,Ub(),Pr())}function Yg(n,t="character"){return String(n||"").toLowerCase().replace(/\.json$/i,"").replace(/\.generated(\.[^.]+)?$/i,"").replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")||t}function wk(n={}){var i,a;const t=((i=n==null?void 0:n.jsonFile)==null?void 0:i.name)||"",e=((a=n==null?void 0:n.atlasFile)==null?void 0:a.name)||"",r=Yg(t);return r&&r!=="character"?r:Yg(e)}function Sk(n){const t=n==null?void 0:n.worldTransform;if(!t)return 1;const e=Math.hypot(t.a||0,t.b||0),r=Math.hypot(t.c||0,t.d||0);return Math.max((e+r)*.5,1e-4)}function Ek(n){var e,r;if(((e=I.skeletonOverlayGraphics)!=null&&e.destroyed||(r=I.skeletonOverlayGraphics)!=null&&r._destroyed)&&(I.skeletonOverlayGraphics=null),!I.skeletonOverlayGraphics){const i=new Ia;i.name="skeleton-overlay",i.visible=!1,i.eventMode="none",I.skeletonOverlayGraphics=i}const t=I.skeletonOverlayGraphics;return(t.parent!==n||n.children[n.children.length-1]!==t)&&n.addChild(t),t}function ls(n,t,e,r,i){const a=n.matrix;return{x:t+a.tx+a.a*r+a.c*i,y:e+a.ty+a.b*r+a.d*i}}function Tk(n,t,e,r,i){if(!(t!=null&&t.matrix)||!(t!=null&&t.data))return;const a=Number.isFinite(t.data.length)?Math.abs(t.data.length):0,s=At.minBoneWidthPx/i,o=At.maxBoneWidthPx/i,u=a/At.lengthToWidthRatio,h=Pe(u,s,o);if(a>1e-4){const v=Math.min(a*At.taperRatio,h*At.taperWidthScale),m=Math.max(a-v,0),g=ls(t,e,r,0,0),y=ls(t,e,r,m,-h),x=ls(t,e,r,a,0),b=ls(t,e,r,m,h);Number.isFinite(g.x)&&Number.isFinite(g.y)&&Number.isFinite(y.x)&&Number.isFinite(y.y)&&Number.isFinite(x.x)&&Number.isFinite(x.y)&&Number.isFinite(b.x)&&Number.isFinite(b.y)&&(n.beginFill(At.boneColor,At.boneAlpha),n.moveTo(g.x,g.y),n.lineTo(y.x,y.y),n.lineTo(x.x,x.y),n.lineTo(b.x,b.y),n.lineTo(g.x,g.y),n.endFill())}const l=ls(t,e,r,0,0);if(!Number.isFinite(l.x)||!Number.isFinite(l.y))return;const c=At.minJointRadiusPx/i,f=At.maxJointRadiusPx/i,d=Pe(Math.max(h*At.jointRadiusScale,c),c,f),p=Math.max(Math.min(d*At.jointInnerRadiusRatio,d-1e-4),0);n.beginFill(At.jointOuterColor,At.jointOuterAlpha),n.drawCircle(l.x,l.y,d),n.endFill(),p>1e-4&&(n.beginFill(At.jointInnerColor,At.jointInnerAlpha),n.drawCircle(l.x,l.y,p),n.endFill())}function Vb(){const n=I.spineObject;if(!n)return;const t=Ek(n);if(!I.skeletonVisible){t.visible=!1;return}const e=n.skeleton,r=(e==null?void 0:e.bones)||[];if(!r.length){t.clear(),t.visible=!1;return}t.visible=!0,t.clear();const i=Number.isFinite(e.x)?e.x:0,a=Number.isFinite(e.y)?e.y:0,s=Sk(n);for(const o of r)Tk(t,o,i,a,s)}function Ap(){if(!k.skeletonToggleButton)return;const n=!!I.spineObject,t=n?I.skeletonVisible:!1;k.skeletonToggleButton.disabled=!n,k.skeletonToggleButton.textContent=`Skeleton: ${t?"ON":"OFF"}`,k.skeletonToggleButton.setAttribute("aria-pressed",String(t)),k.skeletonToggleButton.setAttribute("aria-label",`${t?"Hide":"Show"} skeleton`)}function Xb(n,t={}){const{silent:e=!1}=t,r=!!n;I.skeletonVisible=r,I.currentSkeletonCharacterKey&&I.skeletonVisibilityByCharacter.set(I.currentSkeletonCharacterKey,r),Ap(),Vb(),e||pe(`Skeleton: ${r?"ON":"OFF"}.`)}function Ak(n,t={}){const e=wk(n);I.currentSkeletonCharacterKey=e;const r=I.skeletonVisibilityByCharacter.has(e)?I.skeletonVisibilityByCharacter.get(e):!1;I.skeletonVisibilityByCharacter.set(e,r),Xb(r,t)}function zb(n){return String(n||"").toLowerCase().replace(/[^a-z0-9]+/g," ").trim().split(/\s+/).filter(Boolean)}function Ya(n){return String(n||"").toUpperCase().startsWith("FBX_")}function Mk(n){var e;const t=((e=n==null?void 0:n.skeleton)==null?void 0:e.drawOrder)||[];I.setupDrawOrderNames=t.map(r=>{var i;return(i=r==null?void 0:r.data)==null?void 0:i.name}).filter(Boolean),I.setupDrawOrderIndexByName=new Map(I.setupDrawOrderNames.map((r,i)=>[r,i]))}function Mp(){var e;const n=I.spineObject;if(!n||!Ya(I.selectedPrimaryAnimation))return;const t=((e=n.skeleton)==null?void 0:e.drawOrder)||null;!Array.isArray(t)||!t.length||!I.setupDrawOrderIndexByName.size||t.sort((r,i)=>{var c,f;const a=((c=r==null?void 0:r.data)==null?void 0:c.name)||"",s=((f=i==null?void 0:i.data)==null?void 0:f.name)||"",o=I.setupDrawOrderIndexByName.get(a),u=I.setupDrawOrderIndexByName.get(s),h=Number.isInteger(o)?o:Number.MAX_SAFE_INTEGER,l=Number.isInteger(u)?u:Number.MAX_SAFE_INTEGER;return h-l})}function Pk(n){var e,r;const t=((r=(e=n==null?void 0:n.skeleton)==null?void 0:e.findSlot)==null?void 0:r.call(e,"TORSO"))||null;t!=null&&t.setAttachment&&t.setAttachment(null)}function Ik(n){if(Ya(n))return"fbx";const t=zb(n),e=t.includes("part");return t.includes("expression")||t.includes("facial")||t.includes("face")||t.includes("head")&&e?"expression":t.includes("hand")&&e||t.includes("handpart")?"hand":t.includes("leg")&&e||t.includes("legpart")?"leg":"primary"}function Ck(n){const t={primary:[],fbx:[],hand:[],leg:[],expression:[]},e=n.spineData.animations||[];for(const r of e){const i=Ik(r.name);t[i].push(r.name)}return!t.primary.length&&e.length&&(t.primary=e.map(r=>r.name),t.fbx=[],t.hand=[],t.leg=[],t.expression=[]),t}function Rk(){const{animationCatalog:n}=I;[...n.primary||[],...n.fbx||[]].includes(I.selectedPrimaryAnimation)||(I.selectedPrimaryAnimation=n.primary[0]||n.fbx[0]||null);for(const e of Object.keys(Ci)){const r=new Set(n[e]),i=Ci[e],a=(I.selectedSecondaryAnimations[e]||[]).filter(s=>r.has(s)).slice(0,i);I.selectedSecondaryAnimations[e]=a}}function xc(n){return!Array.isArray(n)||!n.length?"none":n.join(", ")}function ll(){if(k.animationSelectionSummary){if(!I.selectedPrimaryAnimation){k.animationSelectionSummary.textContent="No animations were detected in this skeleton.";return}k.animationSelectionSummary.textContent=`Primary: ${I.selectedPrimaryAnimation} | Hand: ${xc(I.selectedSecondaryAnimations.hand)} | Leg: ${xc(I.selectedSecondaryAnimations.leg)} | Expression: ${xc(I.selectedSecondaryAnimations.expression)}`}}function Fk(){return Object.keys(Ci).some(n=>I.selectedSecondaryAnimations[n].length>0)}function ul(){k.clearAllSecondaryAnimationsButton&&(k.clearAllSecondaryAnimationsButton.disabled=!Fk())}function Ok(n){return String(n||"").trim().toLowerCase()}function Pp(){return I.animationSearchQuery.length>=2}function Bk(n){if(!Pp())return!0;const t=zb(n).join(" ");if(!t)return!1;if(t.includes(I.animationSearchQuery))return!0;const e=I.animationSearchQuery.split(/\s+/).filter(Boolean);return e.length>1&&e.every(r=>t.includes(r))}function Wg(n){return Pp()?n.filter(t=>Bk(t)):n}function Gb(n,t){const e=document.createElement("li");e.className="animation-empty",e.textContent=t,n.appendChild(e)}function Sh(n,t){n.innerHTML="",Gb(n,t)}function Nk(n){return n==="hand"?k.secondaryHandAnimationList:n==="leg"?k.secondaryLegAnimationList:k.secondaryExpressionAnimationList}function kk(n,t={}){const{silent:e=!1}=t;Object.prototype.hasOwnProperty.call(Ci,n)&&(I.selectedSecondaryAnimations[n]=[],Aa(),Bl(),e||pe(`Cleared all ${n} secondary animations.`))}function Lk(n={}){const{silent:t=!1}=n;for(const r of Object.keys(Ci))I.selectedSecondaryAnimations[r]=[];const e=I.spineObject;if(e){const r=e.state;for(const i of Object.values(Pb))for(const a of i)r.clearTrack(a);I.selectedPrimaryAnimation?(e.skeleton.setToSetupPose(),r.setAnimation(0,I.selectedPrimaryAnimation,!0)):r.clearTrack(0),e.update(0),ll(),ul()}else Aa();Bl(),t||pe("Cleared all secondary animations.")}function Hg(n,t,e){var a;const r=n.getCurrent(t),i=((a=r==null?void 0:r.animation)==null?void 0:a.name)||null;if(!e){r&&n.clearTrack(t);return}i!==e&&n.setAnimation(t,e,!0)}function Aa(){const n=I.spineObject;if(!n){ll(),ul(),Fi();return}const t=n.state;Hg(t,0,I.selectedPrimaryAnimation);for(const[e,r]of Object.entries(Pb)){const i=I.selectedSecondaryAnimations[e]||[];for(let a=0;a<r.length;a+=1){const s=i[a]||null;Hg(t,r[a],s)}}n.update(0),Mp(),ll(),ul(),Fi()}function Bl(){const n=I.animationCatalog.primary||[],t=I.animationCatalog.fbx||[],e=Pp();ul();const r=(i,a,s)=>{i.innerHTML="";const o=Wg(a);if(!o.length){e&&a.length?Sh(i,`No animation matches "${I.animationSearchQuery}".`):Sh(i,s);return}for(const u of o){const h=document.createElement("li"),l=document.createElement("label"),c=document.createElement("input"),f=document.createElement("span"),d=document.createElement("span");l.className="animation-option",c.type="radio",c.name="primaryAnimation",c.value=u,c.checked=I.selectedPrimaryAnimation===u,c.className="animation-option-input",f.className="animation-option-control",d.className="animation-option-text",d.textContent=u,c.addEventListener("change",()=>{c.checked&&(I.selectedPrimaryAnimation=u,Aa(),pe(`Primary animation set to "${u}".`))}),l.appendChild(c),l.appendChild(f),l.appendChild(d),h.appendChild(l),i.appendChild(h)}};r(k.primaryAnimationList,n,"No base animation found."),r(k.fbxAnimationList,t,"No FBX animation found.");for(const i of Object.keys(Ci)){const a=Nk(i),s=I.animationCatalog[i]||[],o=Wg(s);if(a.innerHTML="",!s.length){Sh(a,`No ${i} part animation found.`);continue}if(i==="expression"){const u=document.createElement("li"),h=document.createElement("label"),l=document.createElement("input"),c=document.createElement("span"),f=document.createElement("span");if(h.className="animation-option",l.type="radio",l.name="secondaryExpressionAnimation",l.value="",l.checked=I.selectedSecondaryAnimations.expression.length===0,l.className="animation-option-input",c.className="animation-option-control",f.className="animation-option-text",f.textContent="None",l.addEventListener("change",()=>{l.checked&&(kk("expression",{silent:!0}),pe("Expression overlay cleared."))}),h.appendChild(l),h.appendChild(c),h.appendChild(f),u.appendChild(h),a.appendChild(u),!o.length&&e){Gb(a,`No expression part animation matches "${I.animationSearchQuery}".`);continue}for(const d of o){const p=document.createElement("li"),v=document.createElement("label"),m=document.createElement("input"),g=document.createElement("span"),y=document.createElement("span");v.className="animation-option",m.type="radio",m.name="secondaryExpressionAnimation",m.value=d,m.checked=I.selectedSecondaryAnimations.expression[0]===d,m.className="animation-option-input",g.className="animation-option-control",y.className="animation-option-text",y.textContent=d,m.addEventListener("change",()=>{m.checked&&(I.selectedSecondaryAnimations.expression=[d],Aa(),pe("Updated layered animation playback."))}),v.appendChild(m),v.appendChild(g),v.appendChild(y),p.appendChild(v),a.appendChild(p)}continue}if(!o.length){Sh(a,`No ${i} part animation matches "${I.animationSearchQuery}".`);continue}for(const u of o){const h=document.createElement("li"),l=document.createElement("label"),c=document.createElement("input"),f=document.createElement("span"),d=document.createElement("span");l.className="animation-option",c.type="checkbox",c.value=u,c.checked=I.selectedSecondaryAnimations[i].includes(u),c.className="animation-option-input",f.className="animation-option-control",d.className="animation-option-text",d.textContent=u,c.addEventListener("change",()=>{const p=I.selectedSecondaryAnimations[i],v=Ci[i];if(c.checked){if(p.includes(u))return;if(p.length>=v){c.checked=!1,pe(`Secondary ${i} animation limit reached (${v}).`,"warn");return}p.push(u)}else I.selectedSecondaryAnimations[i]=p.filter(m=>m!==u);Aa(),pe("Updated layered animation playback.")}),l.appendChild(c),l.appendChild(f),l.appendChild(d),h.appendChild(l),a.appendChild(h)}}ll(),Fi()}function Dk(n){I.animationCatalog=Ck(n),Rk(),Bl(),Aa()}function Uk(n){k.boneList.innerHTML="";for(const t of n.skeleton.bones){const e=document.createElement("li");e.textContent=t.data.name,k.boneList.appendChild(e)}}function Vk(n){k.slotList.innerHTML="";for(const t of n.skeleton.slots){const e=document.createElement("li");e.textContent=t.data.name,k.slotList.appendChild(e)}}function Wf(n){return n?n.getAttachment?n.getAttachment():n.attachment||null:null}function Xk(n){var r;if(!n||!k.attachmentList)return;const t=((r=n.skeleton)==null?void 0:r.slots)||[],e=k.attachmentList.querySelectorAll("input.attachment-toggle-input");for(const i of e){const a=Number.parseInt(i.dataset.slotIndex||"",10),s=i.dataset.attachmentName||"";if(!Number.isInteger(a)||a<0||!s){i.checked=!1;continue}const o=Wf(t[a]);i.checked=!!(o&&o.name===s)}}function zk(n){return String(n||"").trim().toLowerCase()}function Yb(){return I.attachmentSearchQuery.length>=2}function Gk(n){if(!Yb())return!0;if(!n)return!1;const t=`${n.slotName||""} ${n.attachmentName||""}`.toLowerCase();if(t.includes(I.attachmentSearchQuery))return!0;const e=I.attachmentSearchQuery.split(/\s+/).filter(Boolean);return e.length>1&&e.every(r=>t.includes(r))}function Yk(n){return Yb()?n.filter(t=>Gk(t)):n}function Wb(n){var f;k.attachmentList.innerHTML="";const t=n.spineData,e=n.skeleton,r=e.slots||[],i=t.slots||[],a=new Map,s=(d,p,v=null)=>{var b;if(!Number.isInteger(d)||d<0||typeof p!="string"||!p.trim())return;const m=((b=i[d])==null?void 0:b.name)||`slot-${d}`,g=p.trim(),y=`${d}\0${g}`;let x=a.get(y);x||(x={slotIndex:d,slotName:m,attachmentName:g,attachmentRef:v||null},a.set(y,x)),!x.attachmentRef&&v&&(x.attachmentRef=v)};for(let d=0;d<i.length;d+=1){const p=(f=i[d])==null?void 0:f.attachmentName,v=p?e.getAttachment(d,p):null;s(d,p,v)}for(const d of t.skins||[]){if(!d||typeof d.getAttachments!="function")continue;const p=d.getAttachments()||[];for(const v of p)s(v.slotIndex,v.name,v.attachment||null)}const o=Array.from(a.values()).sort((d,p)=>{const v=d.slotIndex-p.slotIndex;return v!==0?v:d.attachmentName.localeCompare(p.attachmentName)});if(!o.length){const d=document.createElement("li");d.className="animation-empty",d.textContent="No attachments found.",k.attachmentList.appendChild(d);return}const u=Yk(o);if(!u.length){const d=document.createElement("li");d.className="animation-empty",d.textContent=`No attachments match "${I.attachmentSearchQuery}".`,k.attachmentList.appendChild(d);return}const h=new Map;for(const d of u){let p=h.get(d.slotIndex);p||(p={slotIndex:d.slotIndex,slotName:d.slotName,records:[]},h.set(d.slotIndex,p)),p.records.push(d)}const l=Array.from(h.values()).sort((d,p)=>d.slotIndex-p.slotIndex),c=(d,p={})=>{const{useRadioSelection:v=!1,radioGroupName:m=""}=p,g=r[d.slotIndex],y=Wf(g),x=!!(y&&y.name===d.attachmentName),b=document.createElement("li"),_=document.createElement("label"),w=document.createElement("input"),S=document.createElement("span"),E=document.createElement("span");return b.className="attachment-item",_.className="animation-option attachment-option",w.className="animation-option-input attachment-toggle-input",S.className="animation-option-control",E.className="animation-option-text attachment-name",w.type=v?"radio":"checkbox",v&&(w.name=m),w.checked=x,w.dataset.slotIndex=String(d.slotIndex),w.dataset.attachmentName=d.attachmentName,w.addEventListener("change",()=>{const T=r[d.slotIndex];if(T){if(v){if(!w.checked)return;d.attachmentRef?T.setAttachment(d.attachmentRef):e.setAttachment(d.slotName,d.attachmentName)}else if(w.checked)d.attachmentRef?T.setAttachment(d.attachmentRef):e.setAttachment(d.slotName,d.attachmentName);else{const A=Wf(T);A&&A.name===d.attachmentName&&T.setAttachment(null)}n.update(0),Xk(n),pe(`Attachment ${w.checked?"ON":"OFF"}: ${d.slotName} -> ${d.attachmentName}`)}}),E.textContent=v?d.attachmentName:`${d.slotName} -> ${d.attachmentName}`,_.appendChild(w),_.appendChild(S),_.appendChild(E),b.appendChild(_),b};for(const d of l){if(d.records.length<=1){const x=c(d.records[0],{useRadioSelection:!1});x.classList.add("attachment-single-item"),k.attachmentList.appendChild(x);continue}const p=document.createElement("li"),v=document.createElement("details"),m=document.createElement("summary"),g=document.createElement("ul"),y=`attachment-slot-${d.slotIndex}`;p.className="attachment-group-item",v.className="attachment-group",m.className="attachment-group-summary",m.textContent=`${d.slotName} (${d.records.length})`,g.className="attachment-group-list";for(const x of d.records){const b=c(x,{useRadioSelection:!0,radioGroupName:y});g.appendChild(b)}v.appendChild(m),v.appendChild(g),p.appendChild(v),k.attachmentList.appendChild(p)}}function Wk(n){const t=n.getLocalBounds();n.x=-t.x-t.width*.5,n.y=-t.y-t.height*.5}function Hb(n){var r;const t=Gt.renderer,e=(r=n._glTextures)==null?void 0:r[t.CONTEXT_UID];return(e==null?void 0:e.texture)||null}function jg(n){return n==null?"UNAVAILABLE":bN.get(n)||`UNKNOWN(${n})`}function Hk(n,t){return t===n.NEAREST_MIPMAP_NEAREST||t===n.LINEAR_MIPMAP_NEAREST||t===n.NEAREST_MIPMAP_LINEAR||t===n.LINEAR_MIPMAP_LINEAR}function jk(n,t){const e=Gt.renderer,r=e.gl;e.texture.bind(n,0);const i=Hb(n);if(!i)return{minFilter:null,magFilter:null,couldBind:!1};r.bindTexture(r.TEXTURE_2D,i);const a=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);const s=r.getTexParameter(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER),o=r.getTexParameter(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER);return{minFilter:s,magFilter:o,couldBind:!0}}async function jb(){if(!I.pages.length){ci("Mipmaps status: no texture loaded","neutral");return}const t=Gt.renderer.context.webGLVersion===1?"WebGL1 NPOT mipmaps are unsupported.":"WebGL2 can sample NPOT mipmaps, runtime keeps NPOT OFF for consistency.",e=I.requestedMipmaps&&I.pages.every(i=>i.isPOT);for(const i of I.pages){const a=e&&i.isPOT;i.baseTexture.mipmap=a?qe.ON:qe.OFF,i.baseTexture.scaleMode=je.LINEAR,i.baseTexture.dirtyStyleId+=1,i.baseTexture.update(),i.glSnapshot=jk(i.baseTexture,a)}Gt.renderer.render(Gt.stage),await new Promise(i=>requestAnimationFrame(i));const r=$k();e?r.samplingEnabled?ci("Mipmaps status: ENABLED (sampling)","ok"):ci("Mipmaps status: ON, but sampling not confirmed","warn"):I.pages.some(i=>!i.isPOT)?(ci("Mipmaps status: OFF (NPOT texture)","warn"),Vf([...I.npotWarnings,t])):ci("Mipmaps status: OFF (toggle disabled)","neutral")}function $k(){const n=Gt.renderer,t=n.gl,e=n.context.webGLVersion===2?"WebGL2":"WebGL1",r=t.getParameter(t.MAX_TEXTURE_SIZE),i=[];let a=!0;for(const o of I.pages){n.texture.bind(o.baseTexture,0);const u=Hb(o.baseTexture);let h=null,l=null;u&&(t.bindTexture(t.TEXTURE_2D,u),h=t.getTexParameter(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER),l=t.getTexParameter(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER));const c={page:o.atlasName,width:o.width,height:o.height,isPOT:o.isPOT,mipmapMode:o.baseTexture.mipmap,minFilter:jg(h),magFilter:jg(l)},f=c.isPOT&&o.baseTexture.mipmap===qe.ON&&h!==null&&Hk(t,h);f||(a=!1),c.sampling=f?"YES":"NO",i.push(c)}const s=[`Renderer: ${e}`,`MAX_TEXTURE_SIZE: ${r}`,`DPR: ${window.devicePixelRatio||1}`,`Zoom: ${I.zoom.toFixed(2)}x`,`Screen zoom: ${I.localScreenZoom.toFixed(2)}x`,`Skeleton scale: ${I.spineObject?I.spineObject.scale.x.toFixed(2):"n/a"}`,`Mipmaps sampling: ${a?"ENABLED":"DISABLED/UNCONFIRMED"}`,""];for(const o of i)s.push(`${o.page} | POT=${o.isPOT} | mipmap=${o.mipmapMode} | ${o.width}x${o.height} | MIN=${o.minFilter} | MAG=${o.magFilter} | sampling=${o.sampling}`);if(I.npotWarnings.length){s.push(""),s.push("NPOT warnings:");for(const o of I.npotWarnings)s.push(`- ${o}`)}return k.verificationPanel.textContent=s.join(`
`),I.lastVerification={webglVersion:e,maxTextureSize:r,pageRows:i,samplingEnabled:a},console.group("Spine Mipmap Verification"),console.log(`Renderer: ${e}`),console.log(`MAX_TEXTURE_SIZE: ${r}`),console.table(i),console.groupEnd(),Pr(),I.lastVerification}function $g(){if(!I.pages.length){k.potStatus.textContent="Texture POT: -";return}if(I.pages.length===1){const t=I.pages[0],e=t.sourceWidth&&t.sourceHeight&&(t.sourceWidth!==t.width||t.sourceHeight!==t.height)?`; source ${t.sourceWidth}x${t.sourceHeight}`:"";k.potStatus.textContent=`Texture POT: ${t.isPOT?"YES":"NO"} (${t.width}x${t.height}${e})`;return}const n=I.pages.map(t=>{const e=t.sourceWidth&&t.sourceHeight&&(t.sourceWidth!==t.width||t.sourceHeight!==t.height)?`<-${t.sourceWidth}x${t.sourceHeight}`:"";return`${t.atlasName}=${t.isPOT?"YES":"NO"}(${t.width}x${t.height}${e})`}).join(" | ");k.potStatus.textContent=`Texture POT: ${n}`}function $b(n){if(!n||n==="auto")return null;const t=n.match(/^(\d+)x(\d+)$/);if(!t)return null;const e=Number.parseInt(t[1],10),r=Number.parseInt(t[2],10);return!Number.isInteger(e)||!Number.isInteger(r)?null:{width:e,height:r}}function Ip(){const n=Math.max(1,k.pixiHost.clientWidth),t=Math.max(1,k.pixiHost.clientHeight);Gt.renderer.resize(n,t)}function qk(n){const t=$b(n);return t?t.width>=1200||t.width>t.height&&t.width>=1024?"laptop":Math.min(t.width,t.height)>=600?"tablet":"phone":"auto"}function Zk(){const n=Nb();if(k.deviceProfileStatus){if(n.id==="custom"){k.deviceProfileStatus.textContent="Custom mode.";return}k.deviceProfileStatus.textContent=`${n.label}  ${n.viewportPreset}  ${n.refreshHz}Hz`}}function Cp(n,t={}){const e=Bb(n);if(I.activeDeviceProfileId=e.id,tk(e.cpuThrottleMs),e.id!=="custom"&&!t.preserveCurrent){I.applyingDeviceProfile=!0;try{k.viewportPreset.value=e.viewportPreset,k.renderScaleSelect.value=String(e.renderScale),k.fpsCapSelect.value=String(e.fpsCap),Rp(k.viewportPreset.value),Fp(k.renderScaleSelect.value),Op(k.fpsCapSelect.value)}finally{I.applyingDeviceProfile=!1}}Zk(),Pr()}function bc(){I.applyingDeviceProfile||k.deviceProfileSelect.value==="custom"||(k.deviceProfileSelect.value="custom",Cp("custom",{preserveCurrent:!0}))}function Rp(n){const t=qk(n);k.deviceFrame.className=`device-frame mode-${t}`;const e=$b(n);e?(k.pixiHost.style.width=`${e.width}px`,k.pixiHost.style.height=`${e.height}px`,k.pixiHost.style.maxWidth="none",k.pixiHost.style.maxHeight="none",qb()):(k.pixiHost.style.width="100%",k.pixiHost.style.height="100%",k.pixiHost.style.maxWidth="100%",k.pixiHost.style.maxHeight="100%",k.deviceFrame.style.transform="none"),Ip(),Tp(),zn()}function qb(){if(!k.stageWrap||k.viewportPreset.value==="auto"){k.deviceFrame.style.transform="none";return}k.deviceFrame.style.transform="none";const n=k.stageWrap.getBoundingClientRect(),t=k.deviceFrame.getBoundingClientRect(),e=28,r=Math.max(1,n.width-e),i=Math.max(1,n.height-e),s=Math.min(r/t.width,i/t.height,.88);k.deviceFrame.style.transform=`scale(${s})`}function Fp(n){const t=n==="dpr"?window.devicePixelRatio||1:Number.parseFloat(n);!Number.isFinite(t)||t<=0||(Gt.renderer.resolution=t,Ip(),zn())}function Op(n){const t=Number.parseInt(n,10);if(!Number.isFinite(t)||t<=0){Gt.ticker.maxFPS=0;return}Gt.ticker.maxFPS=t}function Zb(){const n=Math.max(1,Math.round(k.pixiHost.clientWidth)),t=Math.max(1,Math.round(k.pixiHost.clientHeight)),e=Math.max(1,Math.round(Gt.renderer.view.width)),r=Math.max(1,Math.round(Gt.renderer.view.height)),i=Gt.renderer.resolution||1;return{cssWidth:n,cssHeight:t,renderWidth:e,renderHeight:r,resolution:i}}function Kk(){const n=Zb();k.renderResolutionTag.textContent=`Render: ${n.renderWidth}x${n.renderHeight} @${n.resolution.toFixed(2)}x (CSS ${n.cssWidth}x${n.cssHeight})`,Ur(k.renderResolutionTag,"neutral")}function Kb(){if(!I.spineObject||!I.pages.length)return null;const n=I.spineObject.getBounds(),t=Math.max(1,n.width),e=Math.max(1,n.height),r=Math.max(...I.pages.map(h=>h.width)),i=Math.max(...I.pages.map(h=>h.height)),a=Math.max(r/t,i/e),s=a>1,o=Math.floor(Math.log2(Math.max(r,i))),u=s?Pe(Math.log2(a),0,o):0;return{minifying:s,texelsPerPixel:a,estimatedLevel:u}}function Jk(){var e;const n=Kb();if(!n){k.mipEstimateTag.textContent="Mip estimate: n/a",Ur(k.mipEstimateTag,"neutral");return}k.mipEstimateTag.textContent=`Mip estimate: L${n.estimatedLevel.toFixed(2)} (${n.minifying?"minifying":"magnifying"}, ${n.texelsPerPixel.toFixed(2)} texel/px)`;const t=((e=I.lastVerification)==null?void 0:e.samplingEnabled)&&n.minifying;Ur(k.mipEstimateTag,t?"ok":n.minifying?"warn":"neutral")}function Jb(){return I.pages.length?I.pages.reduce((n,t)=>n?t.width*t.height>n.width*n.height?t:n:t,null):null}function Eh(n,t){return Math.max(1,Math.round(n/Math.pow(2,t)))}function Qk(){var h;const n=Kb(),t=Jb();if(!n||!t){k.mipActiveTag.textContent="Active mip: n/a",Ur(k.mipActiveTag,"neutral");return}if(!!!((h=I.lastVerification)!=null&&h.samplingEnabled)){k.mipActiveTag.textContent=`Active mip: L0 (${t.width}x${t.height})`,Ur(k.mipActiveTag,"warn");return}if(!n.minifying){k.mipActiveTag.textContent=`Active mip: L0 (${t.width}x${t.height})`,Ur(k.mipActiveTag,"neutral");return}const r=Math.floor(n.estimatedLevel),i=Math.ceil(n.estimatedLevel),a=Eh(t.width,r),s=Eh(t.height,r);if(r===i){k.mipActiveTag.textContent=`Active mip: L${r} (~${a}x${s})`,Ur(k.mipActiveTag,"ok");return}const o=Eh(t.width,i),u=Eh(t.height,i);k.mipActiveTag.textContent=`Active mip: L${r}-L${i} (~${a}x${s} -> ~${o}x${u})`,Ur(k.mipActiveTag,"ok")}function tL(){const n=1e3/Math.max(1e-4,I.frameMsEwma),t=Gt.ticker.maxFPS>0?Gt.ticker.maxFPS:60,e=t*.9,r=t*.6;k.perfTag.textContent=`Perf: ${I.frameMsEwma.toFixed(1)} ms (${n.toFixed(1)} FPS)`,Ur(k.perfTag,n>=e?"ok":n>=r?"warn":"bad")}function Pr(){var s;const n=Zb(),t=Jb(),e=Nb(),r=e.id==="custom"?"Custom (host)":e.label,i=(s=I.lastVerification)!=null&&s.samplingEnabled?"YES":"NO",a=k.mipActiveTag.textContent.replace(/^Active mip:\s*/,"");Kk(),Jk(),Qk(),tL(),k.debugOverlay.textContent=[`Profile: ${r}`,`Viewport: ${n.cssWidth}x${n.cssHeight} @${n.resolution.toFixed(2)}x`,`Screen zoom: ${I.localScreenZoom.toFixed(2)}x`,`Mipmaps Active (sampling): ${i}`,`Current Mip: ${a}`,`Primary Atlas: ${t?`${t.atlasName} (${t.width}x${t.height})`:"n/a"}`,`POT Eligibility: ${I.pages.length?I.pages.every(o=>o.isPOT)?"All POT":"Has NPOT (limited)":"n/a"}`].join(`
`)}function eL(n){I.panEnabled=n,k.panToggle.textContent=`Pan: ${n?"ON":"OFF"}`,n||(I.panOffsetX=0,zn())}function rL(){Gt.view.addEventListener("wheel",n=>{n.preventDefault();const t=Math.exp(-n.deltaY*.0014);As(I.zoom*t)}),Gt.view.addEventListener("pointerdown",n=>{!I.spineObject||I.panEnabled||(I.dragging=!0,I.dragStartX=n.clientX,I.dragStartY=n.clientY,I.dragStartOffsetX=I.dragOffsetX,I.dragStartOffsetY=I.dragOffsetY)}),window.addEventListener("pointermove",n=>{if(!I.dragging)return;const t=n.clientX-I.dragStartX,e=n.clientY-I.dragStartY;I.dragOffsetX=I.dragStartOffsetX+t,I.dragOffsetY=I.dragStartOffsetY+e,zn()}),window.addEventListener("pointerup",()=>{I.dragging=!1}),window.addEventListener("resize",()=>{qb(),Ip(),Tp(),zn(),Pr()})}function nL(n,t,e){const r=new Map,i=new Map,a=new Map;for(const h of t){r.set(h.name,h),i.set(ol(h.name),h);const l=Ug(h.name);a.has(l)||a.set(l,[]),a.get(l).push(h)}const s=[],o=[],u=[];for(const h of n){const l=h.name,c=ol(l);let f=r.get(l)||r.get(c);if(f||(f=i.get(l)||i.get(c)),!f){const d=a.get(Ug(c))||[];d.length===1?f=d[0]:d.length>1&&s.push(`Atlas page "${l}" matched multiple uploaded image names by stem: ${d.map(p=>p.name).join(", ")}.`)}if(!f&&n.length===1&&t.length===1&&(f=t[0],s.push(`Atlas page "${l}" did not match uploaded image name "${f.name}". Mapped atlas page to uploaded image explicitly.`)),!f){o.push(l);continue}f.name!==l&&s.push(`Mapped atlas page "${l}" -> uploaded file "${f.name}".`),u.push({atlasName:l,file:f,url:e.get(f.name)})}return{resolved:u,warnings:s,missingPages:o}}async function iL(n){const t=new Uint8Array(await n.arrayBuffer());let e=0;for(t.length>=3&&t[0]===239&&t[1]===187&&t[2]===191&&(e=3);e<t.length;){const a=t[e];if(a===32||a===9||a===10||a===13){e+=1;continue}break}const r=t[e],i=Date.now();if(r===123||r===91){const a=new TextDecoder("utf-8").decode(t);try{JSON.parse(a)}catch(s){throw new Error(`Skeleton file looks like JSON but failed to parse: ${s.message}. Re-export a valid Spine JSON skeleton.`)}return{format:"json",resourceName:`spine-${i}.json`,url:nk(a,"application/json"),xhrType:Ft.XHR_RESPONSE_TYPE.JSON,warning:null}}if(t.length>=2&&t[0]===31&&t[1]===139)throw new Error("Skeleton file is gzip-compressed. Export plain .json or .skel from Spine.");return{format:"binary",resourceName:`spine-${i}.skel`,url:Lb(n),xhrType:Ft.XHR_RESPONSE_TYPE.BUFFER,warning:`Skeleton "${n.name}" was detected as binary data and loaded as .skel.`}}function aL(){var i,a,s,o;const n=Array.from(k.imageInput.files||[]),t=((i=k.atlasInput.files)==null?void 0:i[0])||null,e=((a=k.jsonInput.files)==null?void 0:a[0])||null,r=((o=(s=k.animationsInput)==null?void 0:s.files)==null?void 0:o[0])||null;if(!n.length||!t||!e)throw new Error("Select image, atlas, and json files before pressing Add.");return{imageFiles:n,atlasFile:t,jsonFile:e,animationsFile:r}}async function Qb(n){var r,i;if(!I.historySupported)return;const t=(r=globalThis.crypto)!=null&&r.randomUUID?globalThis.crypto.randomUUID():`char-${Date.now()}`,e={id:t,name:TN(n.atlasFile,n.jsonFile),createdAt:Date.now(),imageCount:n.imageFiles.length,imageFiles:n.imageFiles,atlasFile:n.atlasFile,atlasName:n.atlasFile.name,jsonFile:n.jsonFile,jsonName:n.jsonFile.name,animationsFile:n.animationsFile||null,animationsName:((i=n.animationsFile)==null?void 0:i.name)||null};return await NN(e),t}function qg(n){var t;I.retargetBusy=!!n,k.retargetPreviewButton&&(k.retargetPreviewButton.disabled=I.retargetBusy),k.retargetDownloadButton&&(k.retargetDownloadButton.disabled=I.retargetBusy),k.retargetSkeletonConvertToggle&&(k.retargetSkeletonConvertToggle.disabled=I.retargetBusy),k.retargetSkeletonModeSelect&&(k.retargetSkeletonModeSelect.disabled=I.retargetBusy||!((t=k.retargetSkeletonConvertToggle)!=null&&t.checked))}function Hf(n){return{imageFiles:Array.from((n==null?void 0:n.imageFiles)||[]),atlasFile:(n==null?void 0:n.atlasFile)||null,jsonFile:(n==null?void 0:n.jsonFile)||null,animationsFile:(n==null?void 0:n.animationsFile)||null}}async function sL(){return I.defaultRetargetBundlePromise||(I.defaultRetargetBundlePromise=(async()=>{const n=await Promise.all(ai.images.map((a,s)=>{const o=dn(a);if(!o)throw new Error(`Default retarget image path is invalid: ${a}`);const u=a.split("/").pop()||`retarget-image-${s+1}.png`;return mi(o,u,"image/png")})),t=dn(ai.atlas);if(!t)throw new Error(`Default retarget atlas path is invalid: ${ai.atlas}`);const e=await mi(t,ai.atlas.split("/").pop()||"Man_39.atlas","text/plain"),r=dn(ai.skeleton);if(!r)throw new Error(`Default retarget skeleton path is invalid: ${ai.skeleton}`);const i=await mi(r,ai.skeleton.split("/").pop()||"Man_39.json","application/json");return{imageFiles:n,atlasFile:e,jsonFile:i,animationsFile:null}})().catch(n=>{throw I.defaultRetargetBundlePromise=null,n})),I.defaultRetargetBundlePromise}async function oL(){const n=Hf(I.lastLoadedBundle);if(n.imageFiles.length&&n.atlasFile&&n.jsonFile)return{bundle:n,source:"loaded"};const t=await sL();return{bundle:Hf(t),source:"default"}}async function hL(n){if(!I.historySupported)return null;const t=await Qb(n);return t?(I.activeHistoryRecordId=t,await Xr(),t):null}function lL(){var n;return String(((n=k.retargetAnimationNameInput)==null?void 0:n.value)||"").trim()||null}function Zg(){var t;const n=!!((t=k.retargetSkeletonConvertToggle)!=null&&t.checked);k.retargetSkeletonModeField&&k.retargetSkeletonModeField.classList.toggle("is-hidden",!n),k.retargetSkeletonModeSelect&&(k.retargetSkeletonModeSelect.disabled=I.retargetBusy||!n)}function uL(){var r,i;const n=!!((r=k.retargetSkeletonConvertToggle)!=null&&r.checked),e=String(((i=k.retargetSkeletonModeSelect)==null?void 0:i.value)||fn.spineFirst).trim().toLowerCase()===fn.fbxFirst?fn.fbxFirst:fn.spineFirst;return{enabled:n,mode:e,scope:_N,mismatchPolicy:wN}}function cL(n){if(!n||n.mode==="disabled")return null;const t=Array.isArray(n.addedBones)?n.addedBones.length:0,e=Number.isFinite(n.remappedReferences)?n.remappedReferences:0,r=Array.isArray(n.compatibilityBonesAdded)?n.compatibilityBonesAdded.length:0;return`Skeleton ${n.mode}: +${t} bone(s), ${e} remap(s), ${r} compatibility bone(s).`}function fL(n,t){const r=`${((n==null?void 0:n.name)||"character").replace(/\.[^.]+$/,"")}.generated.json`,i=`${JSON.stringify(t,null,2)}
`;return new File([i],r,{type:"application/json"})}function dL(n){const t=URL.createObjectURL(n),e=document.createElement("a");e.href=t,e.download=n.name,document.body.appendChild(e),e.click(),e.remove(),URL.revokeObjectURL(t)}async function Kg({preview:n=!1,download:t=!1}={}){var r;if(I.retargetBusy)return;const e=Array.from(((r=k.retargetFbxInput)==null?void 0:r.files)||[]);if(!e.length){Bn("Select one or more FBX files before converting.","error");return}qg(!0),Xf([]);try{const{bundle:i,source:a}=await oL(),s=i.jsonFile;if(!s)throw new Error("No target Spine JSON file is available for FBX conversion.");const o=a==="loaded"?"loaded character bundle":"default powerof2/Man_39 bundle",u=uL(),h=u.enabled?`with ${u.mode} skeleton conversion`:"animation-only mode";Bn(`Converting ${e.length} FBX animation(s) in ${h} using ${o}...`);const l=await s.text();let c;try{c=JSON.parse(l)}catch(E){throw new Error(`Target skeleton is not valid JSON: ${E.message}`)}const f=lL();let d=c;const p=[],v=new Map,m=[],g=[],y=[];for(let E=0;E<e.length;E+=1){const T=e[E];Bn(`Converting ${E+1}/${e.length}: ${T.name}`);try{const A=await fN({fbxArrayBuffer:await T.arrayBuffer(),filename:T.name,spineJson:d,profile:x2,animationName:e.length===1?f:null,options:{rootMotion:"in_place",fps:30,skeletonConversion:u}});d=A.mergedSpineJson,p.push(A.animationName),A.previewData&&v.set(A.animationName,A.previewData),g.push(...A.parseWarnings||[],...A.canonicalWarnings||[],...A.warnings||[]);const P=A.skeletonReport||null;if(P!=null&&P.mode&&P.mode!=="disabled"){const M=cL(P);M&&y.push(`${T.name}: ${M}`);for(const R of P.warnings||[])g.push(`SKELETON ${T.name}: ${R}`)}}catch(A){const P=(A==null?void 0:A.message)||"unknown conversion failure";m.push(`${T.name}: ${P}`)}}if(!p.length)throw new Error("No FBX files were converted successfully.");const x=fL(s,d),b=[...g,...y,...m.map(E=>`FAILED ${E}`)],_=m.length?"warn":"info";let w=!1;const S=u.enabled?` using ${u.mode} skeleton conversion`:"";if(t&&dL(x),n){const E={imageFiles:Array.from(i.imageFiles||[]),atlasFile:i.atlasFile,jsonFile:x,animationsFile:null};await io(E,{saveHistory:!0,activeHistoryRecordId:null,fbxPreviewMap:v}),w=!0,Bn(`Converted and previewed ${p.length}/${e.length} FBX animations${S}. Saved to history.`,_)}else{const E={imageFiles:Array.from(i.imageFiles||[]),atlasFile:i.atlasFile,jsonFile:x,animationsFile:null};try{w=!!await hL(E)}catch(T){b.push(`Failed to save generated bundle to history: ${T.message||T}`)}}n||(Rb(null),Ri(),Fi(),Bn(t?`Converted ${p.length}/${e.length} FBX animations${S} and downloaded "${x.name}"${w?". Saved to history.":"."}`:`Converted ${p.length}/${e.length} FBX animations${S}${w?". Saved to history.":"."}`,_)),Xf(b)}catch(i){console.error(i),Bn(i.message||"FBX retarget conversion failed.","error")}finally{qg(!1)}}async function io(n,t={}){var u;pe("Loading files..."),Vf([]);const e=Object.prototype.hasOwnProperty.call(t,"activeHistoryRecordId")?t.activeHistoryRecordId:void 0,r=t.fbxPreviewMap instanceof Map?t.fbxPreviewMap:null;Rb(r),I.fbxPreviewTimeSec=0,I.fbxPreviewLastAnimation=null,Ri(),zg(),Vg();const i=Array.from(n.imageFiles||[]),a=n.atlasFile||null,s=n.jsonFile||null,o=rk();if(!i.length||!a||!s){pe("Missing required files for loading character bundle.","error");return}try{const h=await a.text(),l=ok(h),c=new Map;for(const M of i)c.set(M.name,Lb(M));const f=nL(l.pages,i,c);if(f.missingPages.length)throw new Error(`Missing atlas page image(s): ${f.missingPages.join(", ")}. Upload matching PNG/WEBP files or rename atlas pages.`);const d=await Promise.all(f.resolved.map(async M=>{const R=await lk(M.url);return{atlasName:M.atlasName,file:M.file,url:M.url,image:R,width:R.naturalWidth,height:R.naturalHeight}})),p=new Map(d.map(M=>[M.atlasName,M])),v=d.some(M=>!bh(M.width)||!bh(M.height));let m=h;const g=[];let y=[];if(o&&v){const M=Gt.renderer.gl.getParameter(Gt.renderer.gl.MAX_TEXTURE_SIZE),R=yk(l,p,{baseSize:o.baseSize,padding:o.padding,maxTextureSize:M});m=R.atlasText,g.push(...R.warnings),y=[{atlasName:R.pageName,fileName:R.pageName,url:null,source:R.canvas,sourceWidth:R.width,sourceHeight:R.height,width:R.width,height:R.height,isPOT:!0,baseTexture:null,glSnapshot:null}]}else o&&!v&&g.push("Manual POT is enabled, but all source atlas pages are already POT. Repack skipped."),y=d.map(M=>({atlasName:M.atlasName,fileName:M.file.name,url:M.url,source:M.url,sourceWidth:M.width,sourceHeight:M.height,width:M.width,height:M.height,isPOT:bh(M.width)&&bh(M.height),baseTexture:null,glSnapshot:null}));I.pages=y,I.npotWarnings=y.filter(M=>!M.isPOT).map(M=>`Texture ${M.fileName} is NPOT (${M.width}x${M.height}). Mipmaps are forced OFF to avoid unreliable minification.`);for(const M of y){const R=Mt.from(M.source);await xk(R),M.baseTexture=R}const x={};for(const M of y)x[M.atlasName]=M.baseTexture,x[ol(M.atlasName)]=M.baseTexture;const b=m,_=await iL(s),w=new Ai,S=_.resourceName,T=(u=(await new Promise((M,R)=>{w.onError.add((F,N,D)=>{console.error("Loader error:",F,"resource:",(D==null?void 0:D.url)||(D==null?void 0:D.name));const X=(F==null?void 0:F.message)||(typeof F=="string"?F:"unknown loader error");R(new Error(`PIXI Loader failed while reading Spine resources: ${X}`))}),w.add(S,_.url,{xhrType:_.xhrType,metadata:{atlasRawData:b,images:x,spineSkeletonScale:1,spineMetadata:_.format==="binary"?{}:null}}).load((F,N)=>{M(N)})}))[S])==null?void 0:u.spineData;if(!T)throw new Error(`Spine data was not created by pixi-spine for ${_.format} skeleton input. Verify Spine version compatibility (3.8.x) and atlas/skeleton pair.`);const A=new Sx(T);I.spineObject=A,Na.addChild(A),Ak({jsonFile:s,atlasFile:a},{silent:!0}),Mk(A),Dk(A),A.update(0),Pk(A),Mp(),Wk(A),Tp(),As(1),zn(),Uk(A),Vk(A),Wb(A),$g(),I.npotWarnings.length?(k.mipmapToggle.checked=!1,k.mipmapToggle.disabled=!0,I.requestedMipmaps=!1):(k.mipmapToggle.disabled=!1,k.mipmapToggle.checked=!0,I.requestedMipmaps=!0);const P=[...f.warnings,...g,...I.npotWarnings];if(_.warning&&P.push(_.warning),Vf(P),await jb(),e!==void 0&&(I.activeHistoryRecordId=e,await Xr()),I.lastLoadedBundle={imageFiles:Array.from(i),atlasFile:a,jsonFile:s,animationsFile:n.animationsFile||null},pe(`Loaded Spine with ${y.length} atlas page(s).`),t.saveHistory)try{const M=await Qb(n);I.activeHistoryRecordId=M,await Xr()}catch(M){console.error(M),Lr(M.message||"Failed to save history record.","error")}}catch(h){console.error(h),zg(),Vg(),pe(h.message||"Failed to load Spine files.","error"),ci("Mipmaps status: load failed","bad"),$g(),k.verificationPanel.textContent="No GL verification yet.",Pr()}}async function pL(){let n;try{n=aL()}catch(t){pe(t.message,"error");return}await io(n,{saveHistory:!0})}function vL(){k.addButton.addEventListener("click",pL),k.retargetSkeletonConvertToggle&&(k.retargetSkeletonConvertToggle.checked=!1,k.retargetSkeletonConvertToggle.addEventListener("change",()=>{Zg()})),k.retargetSkeletonModeSelect&&(k.retargetSkeletonModeSelect.value=fn.spineFirst,k.retargetSkeletonModeSelect.addEventListener("change",n=>{const t=String(n.target.value||fn.spineFirst).trim().toLowerCase();n.target.value=t===fn.fbxFirst?fn.fbxFirst:fn.spineFirst})),Zg(),k.retargetPreviewButton&&k.retargetPreviewButton.addEventListener("click",()=>{Kg({preview:!0,download:!1})}),k.retargetDownloadButton&&k.retargetDownloadButton.addEventListener("click",()=>{Kg({preview:!1,download:!0})}),k.animationSearchInput&&k.animationSearchInput.addEventListener("input",n=>{I.animationSearchQuery=Ok(n.target.value),I.spineObject&&Bl()}),k.attachmentSearchInput&&k.attachmentSearchInput.addEventListener("input",n=>{I.attachmentSearchQuery=zk(n.target.value),I.spineObject&&Wb(I.spineObject)}),k.clearAllSecondaryAnimationsButton&&k.clearAllSecondaryAnimationsButton.addEventListener("click",()=>{Lk()}),k.clearLogsButton&&k.clearLogsButton.addEventListener("click",()=>{_k(),go("system","Logs cleared by user.","info")}),k.fbxPreviewSourceSelect&&(k.fbxPreviewSourceSelect.value=I.fbxPreviewSourceMode,k.fbxPreviewSourceSelect.addEventListener("change",n=>{const t=String(n.target.value||no.auto);Object.prototype.hasOwnProperty.call(no,t)&&(I.fbxPreviewSourceMode=t,Ri(),Fi(),hn())})),k.fbxPreviewViewSelect&&(k.fbxPreviewViewSelect.value=I.fbxPreviewViewMode,k.fbxPreviewViewSelect.addEventListener("change",n=>{const t=String(n.target.value||Ba.perspective);Object.prototype.hasOwnProperty.call(Ba,t)&&(I.fbxPreviewViewMode=t,hn())})),k.fbxPreviewPlayPauseButton&&(zf(),k.fbxPreviewPlayPauseButton.addEventListener("click",()=>{I.fbxPreviewPlaying=!I.fbxPreviewPlaying,zf(),hn()})),k.fbxPreviewResetButton&&k.fbxPreviewResetButton.addEventListener("click",()=>{I.fbxPreviewTimeSec=0,hn()}),k.fbxPreviewSpeedSelect&&(k.fbxPreviewSpeedSelect.value=String(I.fbxPreviewSpeed),k.fbxPreviewSpeedSelect.addEventListener("change",n=>{const t=Number.parseFloat(n.target.value);I.fbxPreviewSpeed=Number.isFinite(t)&&t>0?t:1})),k.fbxPreviewScrubber&&(k.fbxPreviewScrubber.max=String(Uf),k.fbxPreviewScrubber.value="0",k.fbxPreviewScrubber.addEventListener("input",n=>{const t=I.selectedPrimaryAnimation,e=Ol(t),r=Ep(e,t);if(!Number.isFinite(r)||r<=0)return;const i=Number(k.fbxPreviewScrubber.max)||Uf,a=Pe((Number.parseFloat(n.target.value)||0)/i,0,1);I.fbxPreviewTimeSec=r*a,hn()})),k.fbxPreviewBonesToggle&&(k.fbxPreviewBonesToggle.checked=I.fbxPreviewShowBones,k.fbxPreviewBonesToggle.addEventListener("change",n=>{I.fbxPreviewShowBones=!!n.target.checked,hn()})),k.fbxPreviewJointsToggle&&(k.fbxPreviewJointsToggle.checked=I.fbxPreviewShowJoints,k.fbxPreviewJointsToggle.addEventListener("change",n=>{I.fbxPreviewShowJoints=!!n.target.checked,hn()})),k.potOverrideToggle.addEventListener("change",async()=>{var n,t,e,r;if(Gf(),!(I.suppressManualPotAutoReload||I.manualPotReloadInFlight)&&!(!((t=(n=I.lastLoadedBundle)==null?void 0:n.imageFiles)!=null&&t.length)||!((e=I.lastLoadedBundle)!=null&&e.atlasFile)||!((r=I.lastLoadedBundle)!=null&&r.jsonFile))){I.manualPotReloadInFlight=!0;try{pe("Applying Manual POT setting..."),await io(Hf(I.lastLoadedBundle),{saveHistory:!1,activeHistoryRecordId:I.activeHistoryRecordId,fbxPreviewMap:I.fbxPreviewMap})}finally{I.manualPotReloadInFlight=!1}}}),Gf(),k.deviceProfileSelect.addEventListener("change",n=>{Cp(n.target.value)}),k.viewportPreset.addEventListener("change",n=>{bc(),Rp(n.target.value),Pr()}),k.renderScaleSelect.addEventListener("change",n=>{bc(),Fp(n.target.value),Pr()}),k.fpsCapSelect.addEventListener("change",n=>{bc(),Op(n.target.value),Pr()}),k.mipmapToggle.addEventListener("change",async n=>{I.requestedMipmaps=n.target.checked,I.pages.length&&await jb()}),k.scale025.addEventListener("click",()=>As(.25)),k.scale05.addEventListener("click",()=>As(.5)),k.scale10.addEventListener("click",()=>As(1)),k.localZoomIn&&k.localZoomIn.addEventListener("click",()=>{Gg(I.localScreenZoom*Ng)}),k.localZoomOut&&k.localZoomOut.addEventListener("click",()=>{Gg(I.localScreenZoom/Ng)}),k.skeletonToggleButton&&k.skeletonToggleButton.addEventListener("click",()=>{I.spineObject&&Xb(!I.skeletonVisible)}),k.panToggle.addEventListener("click",()=>{I.spineObject&&eL(!I.panEnabled)}),Xr(),RN(),Bn("Waiting for FBX input."),Xf([]),Ap(),Fi(),hn()}Gt.ticker.add(n=>{const t=performance.now();if(I.lastFrameTimestamp>0){const e=t-I.lastFrameTimestamp;I.frameMsEwma=I.frameMsEwma*.9+e*.1}I.lastFrameTimestamp=t,I.panEnabled&&(I.panOffsetX+=1.2*n*I.panDirection,Math.abs(I.panOffsetX)>42&&(I.panDirection*=-1),zn()),Mp(),Vb(),QN(Gt.ticker.deltaMS),hn(),ek(),Pr()});vL();rL();Rp(k.viewportPreset.value);Fp(k.renderScaleSelect.value);Op(k.fpsCapSelect.value);Cp(k.deviceProfileSelect.value,{preserveCurrent:!0});Ub();zn();Pr();ci("Mipmaps status: waiting for texture","neutral");pe("Waiting for files.");
